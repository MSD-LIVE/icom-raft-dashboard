import{O as Ro,z as F9,s as gr,P as Al,Q as Cl,b as ht,f as Fe,v as Me,i as Jt,h as Ce,n as fi,l as Rr,R as zs,e as Ye,a as Mt,c as Je,g as At,S as Gw,T as Rn,U as vb,V as Yn,W as La,X as Ga,u as Or,m as Ur,o as Vr,A as Ph,Y as N9,Z as O1,_ as pk,r as Ev,$ as Ya,t as wa,d as Sa,j as Il,p as er,a0 as Yi,x as Fr,a1 as Od,D as Yw,a2 as Li,a3 as R9,a4 as mk,k as ua,a5 as _u,a6 as U1,a7 as _k,a8 as Jw,a9 as mm,aa as _m,ab as vu,ac as xu,w as qt,ad as gk,ae as yk}from"../chunks/scheduler.BM6EWmWr.js";import{S as jr,i as qr,t as rt,g as Ji,a as mt,c as Ki,b as ii,d as ri,m as ai,e as si,f as V1}from"../chunks/index.BJs2j2Y4.js";import{w as mc,r as ky,b as x_}from"../chunks/paths.--l8Nz7e.js";const bk=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Qs(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function gm(t,e){const n={},i={},o={$$scope:1};let u=t.length;for(;u--;){const h=t[u],c=e[u];if(c){for(const b in h)b in c||(i[b]=1);for(const b in c)o[b]||(n[b]=c[b],o[b]=1);t[u]=c}else for(const b in h)o[b]=1}for(const h in i)h in n||(n[h]=void 0);return n}const w_=Math.min,_h=Math.max,S_=Math.round,F0=Math.floor,wu=t=>({x:t,y:t}),vk={left:"right",right:"left",bottom:"top",top:"bottom"},xk={start:"end",end:"start"};function Kw(t,e,n){return _h(t,w_(e,n))}function j1(t,e){return typeof t=="function"?t(e):t}function vh(t){return t.split("-")[0]}function q1(t){return t.split("-")[1]}function O9(t){return t==="x"?"y":"x"}function U9(t){return t==="y"?"height":"width"}function H1(t){return["top","bottom"].includes(vh(t))?"y":"x"}function V9(t){return O9(H1(t))}function wk(t,e,n){n===void 0&&(n=!1);const i=q1(t),o=V9(t),u=U9(o);let h=o==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[u]>e.floating[u]&&(h=I_(h)),[h,I_(h)]}function Sk(t){const e=I_(t);return[xb(t),e,xb(e)]}function xb(t){return t.replace(/start|end/g,e=>xk[e])}function Ik(t,e,n){const i=["left","right"],o=["right","left"],u=["top","bottom"],h=["bottom","top"];switch(t){case"top":case"bottom":return n?e?o:i:e?i:o;case"left":case"right":return e?u:h;default:return[]}}function Tk(t,e,n,i){const o=q1(t);let u=Ik(vh(t),n==="start",i);return o&&(u=u.map(h=>h+"-"+o),e&&(u=u.concat(u.map(xb)))),u}function I_(t){return t.replace(/left|right|bottom|top/g,e=>vk[e])}function Mk(t){return{top:0,right:0,bottom:0,left:0,...t}}function Ak(t){return typeof t!="number"?Mk(t):{top:t,right:t,bottom:t,left:t}}function T_(t){const{x:e,y:n,width:i,height:o}=t;return{width:i,height:o,top:n,left:e,right:e+i,bottom:n+o,x:e,y:n}}function Xw(t,e,n){let{reference:i,floating:o}=t;const u=H1(e),h=V9(e),c=U9(h),b=vh(e),w=u==="y",S=i.x+i.width/2-o.width/2,M=i.y+i.height/2-o.height/2,A=i[c]/2-o[c]/2;let P;switch(b){case"top":P={x:S,y:i.y-o.height};break;case"bottom":P={x:S,y:i.y+i.height};break;case"right":P={x:i.x+i.width,y:M};break;case"left":P={x:i.x-o.width,y:M};break;default:P={x:i.x,y:i.y}}switch(q1(e)){case"start":P[h]-=A*(n&&w?-1:1);break;case"end":P[h]+=A*(n&&w?-1:1);break}return P}const Ck=async(t,e,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:u=[],platform:h}=n,c=u.filter(Boolean),b=await(h.isRTL==null?void 0:h.isRTL(e));let w=await h.getElementRects({reference:t,floating:e,strategy:o}),{x:S,y:M}=Xw(w,i,b),A=i,P={},B=0;for(let U=0;U<c.length;U++){const{name:J,fn:Q}=c[U],{x:K,y:le,data:ee,reset:oe}=await Q({x:S,y:M,initialPlacement:i,placement:A,strategy:o,middlewareData:P,rects:w,platform:h,elements:{reference:t,floating:e}});S=K??S,M=le??M,P={...P,[J]:{...P[J],...ee}},oe&&B<=50&&(B++,typeof oe=="object"&&(oe.placement&&(A=oe.placement),oe.rects&&(w=oe.rects===!0?await h.getElementRects({reference:t,floating:e,strategy:o}):oe.rects),{x:S,y:M}=Xw(w,A,b)),U=-1)}return{x:S,y:M,placement:A,strategy:o,middlewareData:P}};async function j9(t,e){var n;e===void 0&&(e={});const{x:i,y:o,platform:u,rects:h,elements:c,strategy:b}=t,{boundary:w="clippingAncestors",rootBoundary:S="viewport",elementContext:M="floating",altBoundary:A=!1,padding:P=0}=j1(e,t),B=Ak(P),J=c[A?M==="floating"?"reference":"floating":M],Q=T_(await u.getClippingRect({element:(n=await(u.isElement==null?void 0:u.isElement(J)))==null||n?J:J.contextElement||await(u.getDocumentElement==null?void 0:u.getDocumentElement(c.floating)),boundary:w,rootBoundary:S,strategy:b})),K=M==="floating"?{x:i,y:o,width:h.floating.width,height:h.floating.height}:h.reference,le=await(u.getOffsetParent==null?void 0:u.getOffsetParent(c.floating)),ee=await(u.isElement==null?void 0:u.isElement(le))?await(u.getScale==null?void 0:u.getScale(le))||{x:1,y:1}:{x:1,y:1},oe=T_(u.convertOffsetParentRelativeRectToViewportRelativeRect?await u.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:K,offsetParent:le,strategy:b}):K);return{top:(Q.top-oe.top+B.top)/ee.y,bottom:(oe.bottom-Q.bottom+B.bottom)/ee.y,left:(Q.left-oe.left+B.left)/ee.x,right:(oe.right-Q.right+B.right)/ee.x}}const kk=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:o,middlewareData:u,rects:h,initialPlacement:c,platform:b,elements:w}=e,{mainAxis:S=!0,crossAxis:M=!0,fallbackPlacements:A,fallbackStrategy:P="bestFit",fallbackAxisSideDirection:B="none",flipAlignment:U=!0,...J}=j1(t,e);if((n=u.arrow)!=null&&n.alignmentOffset)return{};const Q=vh(o),K=vh(c)===c,le=await(b.isRTL==null?void 0:b.isRTL(w.floating)),ee=A||(K||!U?[I_(c)]:Sk(c));!A&&B!=="none"&&ee.push(...Tk(c,U,B,le));const oe=[c,...ee],Z=await j9(e,J),ne=[];let be=((i=u.flip)==null?void 0:i.overflows)||[];if(S&&ne.push(Z[Q]),M){const ye=wk(o,h,le);ne.push(Z[ye[0]],Z[ye[1]])}if(be=[...be,{placement:o,overflows:ne}],!ne.every(ye=>ye<=0)){var me,Te;const ye=(((me=u.flip)==null?void 0:me.index)||0)+1,qe=oe[ye];if(qe)return{data:{index:ye,overflows:be},reset:{placement:qe}};let He=(Te=be.filter(Be=>Be.overflows[0]<=0).sort((Be,lt)=>Be.overflows[1]-lt.overflows[1])[0])==null?void 0:Te.placement;if(!He)switch(P){case"bestFit":{var Y;const Be=(Y=be.map(lt=>[lt.placement,lt.overflows.filter(Ge=>Ge>0).reduce((Ge,ot)=>Ge+ot,0)]).sort((lt,Ge)=>lt[1]-Ge[1])[0])==null?void 0:Y[0];Be&&(He=Be);break}case"initialPlacement":He=c;break}if(o!==He)return{reset:{placement:He}}}return{}}}};async function Ek(t,e){const{placement:n,platform:i,elements:o}=t,u=await(i.isRTL==null?void 0:i.isRTL(o.floating)),h=vh(n),c=q1(n),b=H1(n)==="y",w=["left","top"].includes(h)?-1:1,S=u&&b?-1:1,M=j1(e,t);let{mainAxis:A,crossAxis:P,alignmentAxis:B}=typeof M=="number"?{mainAxis:M,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...M};return c&&typeof B=="number"&&(P=c==="end"?B*-1:B),b?{x:P*S,y:A*w}:{x:A*w,y:P*S}}const Dk=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:o,y:u,placement:h,middlewareData:c}=e,b=await Ek(e,t);return h===((n=c.offset)==null?void 0:n.placement)&&(i=c.arrow)!=null&&i.alignmentOffset?{}:{x:o+b.x,y:u+b.y,data:{...b,placement:h}}}}},Pk=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:o}=e,{mainAxis:u=!0,crossAxis:h=!1,limiter:c={fn:J=>{let{x:Q,y:K}=J;return{x:Q,y:K}}},...b}=j1(t,e),w={x:n,y:i},S=await j9(e,b),M=H1(vh(o)),A=O9(M);let P=w[A],B=w[M];if(u){const J=A==="y"?"top":"left",Q=A==="y"?"bottom":"right",K=P+S[J],le=P-S[Q];P=Kw(K,P,le)}if(h){const J=M==="y"?"top":"left",Q=M==="y"?"bottom":"right",K=B+S[J],le=B-S[Q];B=Kw(K,B,le)}const U=c.fn({...e,[A]:P,[M]:B});return{...U,data:{x:U.x-n,y:U.y-i}}}}};function gf(t){return q9(t)?(t.nodeName||"").toLowerCase():"#document"}function Ls(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function kc(t){var e;return(e=(q9(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function q9(t){return t instanceof Node||t instanceof Ls(t).Node}function kl(t){return t instanceof Element||t instanceof Ls(t).Element}function El(t){return t instanceof HTMLElement||t instanceof Ls(t).HTMLElement}function Qw(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ls(t).ShadowRoot}function ym(t){const{overflow:e,overflowX:n,overflowY:i,display:o}=Oo(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(o)}function Lk(t){return["table","td","th"].includes(gf(t))}function Dv(t){const e=Pv(),n=Oo(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function zk(t){let e=Su(t);for(;El(e)&&!Jd(e);){if(Dv(e))return e;e=Su(e)}return null}function Pv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Jd(t){return["html","body","#document"].includes(gf(t))}function Oo(t){return Ls(t).getComputedStyle(t)}function W1(t){return kl(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Su(t){if(gf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Qw(t)&&t.host||kc(t);return Qw(e)?e.host:e}function H9(t){const e=Su(t);return Jd(e)?t.ownerDocument?t.ownerDocument.body:t.body:El(e)&&ym(e)?e:H9(e)}function Zp(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const o=H9(t),u=o===((i=t.ownerDocument)==null?void 0:i.body),h=Ls(o);return u?e.concat(h,h.visualViewport||[],ym(o)?o:[],h.frameElement&&n?Zp(h.frameElement):[]):e.concat(o,Zp(o,[],n))}function W9(t){const e=Oo(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const o=El(t),u=o?t.offsetWidth:n,h=o?t.offsetHeight:i,c=S_(n)!==u||S_(i)!==h;return c&&(n=u,i=h),{width:n,height:i,$:c}}function Lv(t){return kl(t)?t:t.contextElement}function Ud(t){const e=Lv(t);if(!El(e))return wu(1);const n=e.getBoundingClientRect(),{width:i,height:o,$:u}=W9(e);let h=(u?S_(n.width):n.width)/i,c=(u?S_(n.height):n.height)/o;return(!h||!Number.isFinite(h))&&(h=1),(!c||!Number.isFinite(c))&&(c=1),{x:h,y:c}}const Bk=wu(0);function Z9(t){const e=Ls(t);return!Pv()||!e.visualViewport?Bk:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Fk(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ls(t)?!1:e}function xh(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const o=t.getBoundingClientRect(),u=Lv(t);let h=wu(1);e&&(i?kl(i)&&(h=Ud(i)):h=Ud(t));const c=Fk(u,n,i)?Z9(u):wu(0);let b=(o.left+c.x)/h.x,w=(o.top+c.y)/h.y,S=o.width/h.x,M=o.height/h.y;if(u){const A=Ls(u),P=i&&kl(i)?Ls(i):i;let B=A,U=B.frameElement;for(;U&&i&&P!==B;){const J=Ud(U),Q=U.getBoundingClientRect(),K=Oo(U),le=Q.left+(U.clientLeft+parseFloat(K.paddingLeft))*J.x,ee=Q.top+(U.clientTop+parseFloat(K.paddingTop))*J.y;b*=J.x,w*=J.y,S*=J.x,M*=J.y,b+=le,w+=ee,B=Ls(U),U=B.frameElement}}return T_({width:S,height:M,x:b,y:w})}const Nk=[":popover-open",":modal"];function zv(t){return Nk.some(e=>{try{return t.matches(e)}catch{return!1}})}function Rk(t){let{elements:e,rect:n,offsetParent:i,strategy:o}=t;const u=o==="fixed",h=kc(i),c=e?zv(e.floating):!1;if(i===h||c&&u)return n;let b={scrollLeft:0,scrollTop:0},w=wu(1);const S=wu(0),M=El(i);if((M||!M&&!u)&&((gf(i)!=="body"||ym(h))&&(b=W1(i)),El(i))){const A=xh(i);w=Ud(i),S.x=A.x+i.clientLeft,S.y=A.y+i.clientTop}return{width:n.width*w.x,height:n.height*w.y,x:n.x*w.x-b.scrollLeft*w.x+S.x,y:n.y*w.y-b.scrollTop*w.y+S.y}}function Ok(t){return Array.from(t.getClientRects())}function G9(t){return xh(kc(t)).left+W1(t).scrollLeft}function Uk(t){const e=kc(t),n=W1(t),i=t.ownerDocument.body,o=_h(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),u=_h(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let h=-n.scrollLeft+G9(t);const c=-n.scrollTop;return Oo(i).direction==="rtl"&&(h+=_h(e.clientWidth,i.clientWidth)-o),{width:o,height:u,x:h,y:c}}function Vk(t,e){const n=Ls(t),i=kc(t),o=n.visualViewport;let u=i.clientWidth,h=i.clientHeight,c=0,b=0;if(o){u=o.width,h=o.height;const w=Pv();(!w||w&&e==="fixed")&&(c=o.offsetLeft,b=o.offsetTop)}return{width:u,height:h,x:c,y:b}}function jk(t,e){const n=xh(t,!0,e==="fixed"),i=n.top+t.clientTop,o=n.left+t.clientLeft,u=El(t)?Ud(t):wu(1),h=t.clientWidth*u.x,c=t.clientHeight*u.y,b=o*u.x,w=i*u.y;return{width:h,height:c,x:b,y:w}}function $w(t,e,n){let i;if(e==="viewport")i=Vk(t,n);else if(e==="document")i=Uk(kc(t));else if(kl(e))i=jk(e,n);else{const o=Z9(t);i={...e,x:e.x-o.x,y:e.y-o.y}}return T_(i)}function Y9(t,e){const n=Su(t);return n===e||!kl(n)||Jd(n)?!1:Oo(n).position==="fixed"||Y9(n,e)}function qk(t,e){const n=e.get(t);if(n)return n;let i=Zp(t,[],!1).filter(c=>kl(c)&&gf(c)!=="body"),o=null;const u=Oo(t).position==="fixed";let h=u?Su(t):t;for(;kl(h)&&!Jd(h);){const c=Oo(h),b=Dv(h);!b&&c.position==="fixed"&&(o=null),(u?!b&&!o:!b&&c.position==="static"&&!!o&&["absolute","fixed"].includes(o.position)||ym(h)&&!b&&Y9(t,h))?i=i.filter(S=>S!==h):o=c,h=Su(h)}return e.set(t,i),i}function Hk(t){let{element:e,boundary:n,rootBoundary:i,strategy:o}=t;const h=[...n==="clippingAncestors"?zv(e)?[]:qk(e,this._c):[].concat(n),i],c=h[0],b=h.reduce((w,S)=>{const M=$w(e,S,o);return w.top=_h(M.top,w.top),w.right=w_(M.right,w.right),w.bottom=w_(M.bottom,w.bottom),w.left=_h(M.left,w.left),w},$w(e,c,o));return{width:b.right-b.left,height:b.bottom-b.top,x:b.left,y:b.top}}function Wk(t){const{width:e,height:n}=W9(t);return{width:e,height:n}}function Zk(t,e,n){const i=El(e),o=kc(e),u=n==="fixed",h=xh(t,!0,u,e);let c={scrollLeft:0,scrollTop:0};const b=wu(0);if(i||!i&&!u)if((gf(e)!=="body"||ym(o))&&(c=W1(e)),i){const M=xh(e,!0,u,e);b.x=M.x+e.clientLeft,b.y=M.y+e.clientTop}else o&&(b.x=G9(o));const w=h.left+c.scrollLeft-b.x,S=h.top+c.scrollTop-b.y;return{x:w,y:S,width:h.width,height:h.height}}function Ey(t){return Oo(t).position==="static"}function e8(t,e){return!El(t)||Oo(t).position==="fixed"?null:e?e(t):t.offsetParent}function J9(t,e){const n=Ls(t);if(zv(t))return n;if(!El(t)){let o=Su(t);for(;o&&!Jd(o);){if(kl(o)&&!Ey(o))return o;o=Su(o)}return n}let i=e8(t,e);for(;i&&Lk(i)&&Ey(i);)i=e8(i,e);return i&&Jd(i)&&Ey(i)&&!Dv(i)?n:i||zk(t)||n}const Gk=async function(t){const e=this.getOffsetParent||J9,n=this.getDimensions,i=await n(t.floating);return{reference:Zk(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function Yk(t){return Oo(t).direction==="rtl"}const Jk={convertOffsetParentRelativeRectToViewportRelativeRect:Rk,getDocumentElement:kc,getClippingRect:Hk,getOffsetParent:J9,getElementRects:Gk,getClientRects:Ok,getDimensions:Wk,getScale:Ud,isElement:kl,isRTL:Yk};function Kk(t,e){let n=null,i;const o=kc(t);function u(){var c;clearTimeout(i),(c=n)==null||c.disconnect(),n=null}function h(c,b){c===void 0&&(c=!1),b===void 0&&(b=1),u();const{left:w,top:S,width:M,height:A}=t.getBoundingClientRect();if(c||e(),!M||!A)return;const P=F0(S),B=F0(o.clientWidth-(w+M)),U=F0(o.clientHeight-(S+A)),J=F0(w),K={rootMargin:-P+"px "+-B+"px "+-U+"px "+-J+"px",threshold:_h(0,w_(1,b))||1};let le=!0;function ee(oe){const Z=oe[0].intersectionRatio;if(Z!==b){if(!le)return h();Z?h(!1,Z):i=setTimeout(()=>{h(!1,1e-7)},1e3)}le=!1}try{n=new IntersectionObserver(ee,{...K,root:o.ownerDocument})}catch{n=new IntersectionObserver(ee,K)}n.observe(t)}return h(!0),u}function Xk(t,e,n,i){i===void 0&&(i={});const{ancestorScroll:o=!0,ancestorResize:u=!0,elementResize:h=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:b=!1}=i,w=Lv(t),S=o||u?[...w?Zp(w):[],...Zp(e)]:[];S.forEach(Q=>{o&&Q.addEventListener("scroll",n,{passive:!0}),u&&Q.addEventListener("resize",n)});const M=w&&c?Kk(w,n):null;let A=-1,P=null;h&&(P=new ResizeObserver(Q=>{let[K]=Q;K&&K.target===w&&P&&(P.unobserve(e),cancelAnimationFrame(A),A=requestAnimationFrame(()=>{var le;(le=P)==null||le.observe(e)})),n()}),w&&!b&&P.observe(w),P.observe(e));let B,U=b?xh(t):null;b&&J();function J(){const Q=xh(t);U&&(Q.x!==U.x||Q.y!==U.y||Q.width!==U.width||Q.height!==U.height)&&n(),U=Q,B=requestAnimationFrame(J)}return n(),()=>{var Q;S.forEach(K=>{o&&K.removeEventListener("scroll",n),u&&K.removeEventListener("resize",n)}),M==null||M(),(Q=P)==null||Q.disconnect(),P=null,b&&cancelAnimationFrame(B)}}const Qk=Dk,$k=Pk,eE=kk,tE=(t,e,n)=>{const i=new Map,o={platform:Jk,...n},u={...o.platform,_c:i};return Ck(t,e,{...o,platform:u})};function nE(t){let e,n;const i={autoUpdate:!0};let o=t;const u=S=>({...i,...t||{},...S||{}}),h=S=>{e&&n&&(o=u(S),tE(e,n,o).then(M=>{Object.assign(n.style,{position:M.strategy,left:`${M.x}px`,top:`${M.y}px`}),o!=null&&o.onComputed&&o.onComputed(M)}))},c=S=>{if("subscribe"in S)return w(S),{};e=S,h()},b=(S,M)=>{let A;n=S,o=u(M),setTimeout(()=>h(M),0),h(M);const P=()=>{A&&(A(),A=void 0)},B=({autoUpdate:U}=o||{})=>{P(),U!==!1&&F9().then(()=>Xk(e,n,()=>h(o),U===!0?{}:U))};return A=B(),{update(U){h(U),A=B(U)},destroy(){P()}}},w=S=>{const M=S.subscribe(A=>{e===void 0?(e=A,h()):(Object.assign(e,A),h())});Ro(M)};return[c,b,h]}function iE({loadOptions:t,filterText:e,items:n,multiple:i,value:o,itemId:u,groupBy:h,filterSelectedItems:c,itemFilter:b,convertStringItemsToObjects:w,filterGroupedItems:S,label:M}){if(n&&t)return n;if(!n)return[];n&&n.length>0&&typeof n[0]!="object"&&(n=w(n));let A=n.filter(P=>{let B=b(P[M],e,P);return B&&i&&(o!=null&&o.length)&&(B=!o.some(U=>c?U[u]===P[u]:!1)),B});return h&&(A=S(A)),A}async function rE({dispatch:t,loadOptions:e,convertStringItemsToObjects:n,filterText:i}){let o=await e(i).catch(u=>{console.warn("svelte-select loadOptions error :>> ",u),t("error",{type:"loadOptions",details:u})});if(o&&!o.cancelled)return o?(o&&o.length>0&&typeof o[0]!="object"&&(o=n(o)),t("loaded",{items:o})):o=[],{filteredItems:o,loading:!1,focused:!0,listOpen:!0}}function aE(t){let e,n;return{c(){e=Al("svg"),n=Al("path"),this.h()},l(i){e=Cl(i,"svg",{width:!0,height:!0,viewBox:!0,focusable:!0,"aria-hidden":!0,class:!0});var o=ht(e);n=Cl(o,"path",{fill:!0,d:!0}),ht(n).forEach(Fe),o.forEach(Fe),this.h()},h(){Me(n,"fill","currentColor"),Me(n,"d",`M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747
          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0
          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502
          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0
          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z`),Me(e,"width","100%"),Me(e,"height","100%"),Me(e,"viewBox","0 0 20 20"),Me(e,"focusable","false"),Me(e,"aria-hidden","true"),Me(e,"class","svelte-qbd276")},m(i,o){Jt(i,e,o),Ce(e,n)},p:fi,i:fi,o:fi,d(i){i&&Fe(e)}}}class sE extends jr{constructor(e){super(),qr(this,e,null,aE,gr,{})}}function oE(t){let e,n;return{c(){e=Al("svg"),n=Al("path"),this.h()},l(i){e=Cl(i,"svg",{width:!0,height:!0,viewBox:!0,focusable:!0,"aria-hidden":!0,role:!0,class:!0});var o=ht(e);n=Cl(o,"path",{fill:!0,d:!0}),ht(n).forEach(Fe),o.forEach(Fe),this.h()},h(){Me(n,"fill","currentColor"),Me(n,"d",`M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124
    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z`),Me(e,"width","100%"),Me(e,"height","100%"),Me(e,"viewBox","-2 -2 50 50"),Me(e,"focusable","false"),Me(e,"aria-hidden","true"),Me(e,"role","presentation"),Me(e,"class","svelte-whdbu1")},m(i,o){Jt(i,e,o),Ce(e,n)},p:fi,i:fi,o:fi,d(i){i&&Fe(e)}}}class M_ extends jr{constructor(e){super(),qr(this,e,null,oE,gr,{})}}function lE(t){let e,n;return{c(){e=Al("svg"),n=Al("circle"),this.h()},l(i){e=Cl(i,"svg",{class:!0,viewBox:!0});var o=ht(e);n=Cl(o,"circle",{class:!0,cx:!0,cy:!0,r:!0,fill:!0,stroke:!0,"stroke-width":!0,"stroke-miterlimit":!0}),ht(n).forEach(Fe),o.forEach(Fe),this.h()},h(){Me(n,"class","circle_path svelte-1p3nqvd"),Me(n,"cx","50"),Me(n,"cy","50"),Me(n,"r","20"),Me(n,"fill","none"),Me(n,"stroke","currentColor"),Me(n,"stroke-width","5"),Me(n,"stroke-miterlimit","10"),Me(e,"class","loading svelte-1p3nqvd"),Me(e,"viewBox","25 25 50 50")},m(i,o){Jt(i,e,o),Ce(e,n)},p:fi,i:fi,o:fi,d(i){i&&Fe(e)}}}class cE extends jr{constructor(e){super(),qr(this,e,null,lE,gr,{})}}const uE=t=>({value:t[0]&8}),t8=t=>({value:t[3]}),hE=t=>({value:t[0]&8}),n8=t=>({value:t[3]}),dE=t=>({listOpen:t[0]&64}),i8=t=>({listOpen:t[6]}),fE=t=>({}),r8=t=>({}),pE=t=>({}),a8=t=>({}),mE=t=>({selection:t[0]&8}),s8=t=>({selection:t[3]});function o8(t,e,n){const i=t.slice();return i[126]=e[n],i[128]=n,i}const _E=t=>({}),l8=t=>({}),gE=t=>({selection:t[0]&8}),c8=t=>({selection:t[126],index:t[128]}),yE=t=>({}),u8=t=>({}),bE=t=>({}),h8=t=>({}),vE=t=>({}),d8=t=>({});function f8(t,e,n){const i=t.slice();return i[126]=e[n],i[128]=n,i}const xE=t=>({item:t[0]&16777216}),p8=t=>({item:t[126],index:t[128]}),wE=t=>({filteredItems:t[0]&16777216}),m8=t=>({filteredItems:t[24]}),SE=t=>({}),_8=t=>({});function g8(t){let e,n,i,o,u,h,c,b,w=t[50]["list-prepend"]&&y8(t);const S=[ME,TE,IE],M=[];function A(B,U){return B[50].list?0:B[24].length>0?1:B[19]?-1:2}~(i=A(t))&&(o=M[i]=S[i](t));let P=t[50]["list-append"]&&v8(t);return{c(){e=Ye("div"),w&&w.c(),n=Mt(),o&&o.c(),u=Mt(),P&&P.c(),this.h()},l(B){e=Je(B,"DIV",{class:!0,role:!0});var U=ht(e);w&&w.l(U),n=At(U),o&&o.l(U),u=At(U),P&&P.l(U),U.forEach(Fe),this.h()},h(){Me(e,"class","svelte-select-list svelte-u3g5ju"),Me(e,"role","none"),Rn(e,"prefloat",t[28])},m(B,U){Jt(B,e,U),w&&w.m(e,null),Ce(e,n),~i&&M[i].m(e,null),Ce(e,u),P&&P.m(e,null),t[91](e),h=!0,c||(b=[Ga(t[49].call(null,e)),Yn(e,"scroll",t[41]),Yn(e,"pointerup",Ya(La(t[85]))),Yn(e,"mousedown",Ya(La(t[86])))],c=!0)},p(B,U){B[50]["list-prepend"]?w?(w.p(B,U),U[1]&524288&&rt(w,1)):(w=y8(B),w.c(),rt(w,1),w.m(e,n)):w&&(Ji(),mt(w,1,1,()=>{w=null}),Ki());let J=i;i=A(B),i===J?~i&&M[i].p(B,U):(o&&(Ji(),mt(M[J],1,1,()=>{M[J]=null}),Ki()),~i?(o=M[i],o?o.p(B,U):(o=M[i]=S[i](B),o.c()),rt(o,1),o.m(e,u)):o=null),B[50]["list-append"]?P?(P.p(B,U),U[1]&524288&&rt(P,1)):(P=v8(B),P.c(),rt(P,1),P.m(e,null)):P&&(Ji(),mt(P,1,1,()=>{P=null}),Ki()),(!h||U[0]&268435456)&&Rn(e,"prefloat",B[28])},i(B){h||(rt(w),rt(o),rt(P),h=!0)},o(B){mt(w),mt(o),mt(P),h=!1},d(B){B&&Fe(e),w&&w.d(),~i&&M[i].d(),P&&P.d(),t[91](null),c=!1,Ph(b)}}}function y8(t){let e;const n=t[83]["list-prepend"],i=Rr(n,t,t[82],_8);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u[2]&1048576)&&Or(i,n,o,o[82],e?Vr(n,o[82],u,SE):Ur(o[82]),_8)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function IE(t){let e;const n=t[83].empty,i=Rr(n,t,t[82],d8),o=i||AE();return{c(){o&&o.c()},l(u){o&&o.l(u)},m(u,h){o&&o.m(u,h),e=!0},p(u,h){i&&i.p&&(!e||h[2]&1048576)&&Or(i,n,u,u[82],e?Vr(n,u[82],h,vE):Ur(u[82]),d8)},i(u){e||(rt(o,u),e=!0)},o(u){mt(o,u),e=!1},d(u){o&&o.d(u)}}}function TE(t){let e,n,i=Qs(t[24]),o=[];for(let h=0;h<i.length;h+=1)o[h]=b8(f8(t,i,h));const u=h=>mt(o[h],1,1,()=>{o[h]=null});return{c(){for(let h=0;h<o.length;h+=1)o[h].c();e=er()},l(h){for(let c=0;c<o.length;c+=1)o[c].l(h);e=er()},m(h,c){for(let b=0;b<o.length;b+=1)o[b]&&o[b].m(h,c);Jt(h,e,c),n=!0},p(h,c){if(c[0]&1627402376|c[1]&28672|c[2]&1048576){i=Qs(h[24]);let b;for(b=0;b<i.length;b+=1){const w=f8(h,i,b);o[b]?(o[b].p(w,c),rt(o[b],1)):(o[b]=b8(w),o[b].c(),rt(o[b],1),o[b].m(e.parentNode,e))}for(Ji(),b=i.length;b<o.length;b+=1)u(b);Ki()}},i(h){if(!n){for(let c=0;c<i.length;c+=1)rt(o[c]);n=!0}},o(h){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)mt(o[c]);n=!1},d(h){h&&Fe(e),Od(o,h)}}}function ME(t){let e;const n=t[83].list,i=Rr(n,t,t[82],m8);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u[0]&16777216|u[2]&1048576)&&Or(i,n,o,o[82],e?Vr(n,o[82],u,wE):Ur(o[82]),m8)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function AE(t){let e,n="No options";return{c(){e=Ye("div"),e.textContent=n,this.h()},l(i){e=Je(i,"DIV",{class:!0,"data-svelte-h":!0}),Li(e)!=="svelte-16ffy3h"&&(e.textContent=n),this.h()},h(){Me(e,"class","empty svelte-u3g5ju")},m(i,o){Jt(i,e,o)},p:fi,d(i){i&&Fe(e)}}}function CE(t){var i;let e=((i=t[126])==null?void 0:i[t[12]])+"",n;return{c(){n=wa(e)},l(o){n=Sa(o,e)},m(o,u){Jt(o,n,u)},p(o,u){var h;u[0]&16781312&&e!==(e=((h=o[126])==null?void 0:h[o[12]])+"")&&Il(n,e)},d(o){o&&Fe(n)}}}function b8(t){let e,n,i,o,u,h,c,b;const w=t[83].item,S=Rr(w,t,t[82],p8),M=S||CE(t);function A(){return t[88](t[128])}function P(){return t[89](t[128])}function B(){return t[90](t[126],t[128])}return{c(){e=Ye("div"),n=Ye("div"),M&&M.c(),u=Mt(),this.h()},l(U){e=Je(U,"DIV",{class:!0,tabindex:!0,role:!0});var J=ht(e);n=Je(J,"DIV",{class:!0});var Q=ht(n);M&&M.l(Q),Q.forEach(Fe),u=At(J),J.forEach(Fe),this.h()},h(){var U;Me(n,"class","item svelte-u3g5ju"),Rn(n,"list-group-title",t[126].groupHeader),Rn(n,"active",t[45](t[126],t[3],t[13])),Rn(n,"first",UE(t[128])),Rn(n,"hover",t[7]===t[128]),Rn(n,"group-item",t[126].groupItem),Rn(n,"not-selectable",((U=t[126])==null?void 0:U.selectable)===!1),Me(e,"class","list-item svelte-u3g5ju"),Me(e,"tabindex","-1"),Me(e,"role","none")},m(U,J){Jt(U,e,J),Ce(e,n),M&&M.m(n,null),Ce(e,u),h=!0,c||(b=[Ga(i=t[46].call(null,n,{scroll:t[45](t[126],t[3],t[13]),listDom:t[30]})),Ga(o=t[47].call(null,n,{scroll:t[29]===t[128],listDom:t[30]})),Yn(e,"mouseover",A),Yn(e,"focus",P),Yn(e,"click",Ya(B)),Yn(e,"keydown",Ya(La(t[87])))],c=!0)},p(U,J){var Q;t=U,S?S.p&&(!h||J[0]&16777216|J[2]&1048576)&&Or(S,w,t,t[82],h?Vr(w,t[82],J,xE):Ur(t[82]),p8):M&&M.p&&(!h||J[0]&16781312)&&M.p(t,h?J:[-1,-1,-1,-1,-1]),i&&Yw(i.update)&&J[0]&1090527240&&i.update.call(null,{scroll:t[45](t[126],t[3],t[13]),listDom:t[30]}),o&&Yw(o.update)&&J[0]&1610612736&&o.update.call(null,{scroll:t[29]===t[128],listDom:t[30]}),(!h||J[0]&16777216)&&Rn(n,"list-group-title",t[126].groupHeader),(!h||J[0]&16785416|J[1]&16384)&&Rn(n,"active",t[45](t[126],t[3],t[13])),(!h||J[0]&128)&&Rn(n,"hover",t[7]===t[128]),(!h||J[0]&16777216)&&Rn(n,"group-item",t[126].groupItem),(!h||J[0]&16777216)&&Rn(n,"not-selectable",((Q=t[126])==null?void 0:Q.selectable)===!1)},i(U){h||(rt(M,U),h=!0)},o(U){mt(M,U),h=!1},d(U){U&&Fe(e),M&&M.d(U),c=!1,Ph(b)}}}function v8(t){let e;const n=t[83]["list-append"],i=Rr(n,t,t[82],h8);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u[2]&1048576)&&Or(i,n,o,o[82],e?Vr(n,o[82],u,bE):Ur(o[82]),h8)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function x8(t){let e,n,i,o,u;return{c(){e=Ye("span"),n=wa(t[32]),i=Mt(),o=Ye("span"),u=wa(t[31]),this.h()},l(h){e=Je(h,"SPAN",{id:!0,class:!0});var c=ht(e);n=Sa(c,t[32]),c.forEach(Fe),i=At(h),o=Je(h,"SPAN",{id:!0,class:!0});var b=ht(o);u=Sa(b,t[31]),b.forEach(Fe),this.h()},h(){Me(e,"id","aria-selection"),Me(e,"class","svelte-u3g5ju"),Me(o,"id","aria-context"),Me(o,"class","svelte-u3g5ju")},m(h,c){Jt(h,e,c),Ce(e,n),Jt(h,i,c),Jt(h,o,c),Ce(o,u)},p(h,c){c[1]&2&&Il(n,h[32]),c[1]&1&&Il(u,h[31])},d(h){h&&(Fe(e),Fe(i),Fe(o))}}}function w8(t){let e,n,i,o;const u=[EE,kE],h=[];function c(b,w){return b[9]?0:1}return e=c(t),n=h[e]=u[e](t),{c(){n.c(),i=er()},l(b){n.l(b),i=er()},m(b,w){h[e].m(b,w),Jt(b,i,w),o=!0},p(b,w){let S=e;e=c(b),e===S?h[e].p(b,w):(Ji(),mt(h[S],1,1,()=>{h[S]=null}),Ki(),n=h[e],n?n.p(b,w):(n=h[e]=u[e](b),n.c()),rt(n,1),n.m(i.parentNode,i))},i(b){o||(rt(n),o=!0)},o(b){mt(n),o=!1},d(b){b&&Fe(i),h[e].d(b)}}}function kE(t){let e,n;const i=t[83].selection,o=Rr(i,t,t[82],s8),u=o||DE(t);return{c(){e=Ye("div"),u&&u.c(),this.h()},l(h){e=Je(h,"DIV",{class:!0});var c=ht(e);u&&u.l(c),c.forEach(Fe),this.h()},h(){Me(e,"class","selected-item svelte-u3g5ju"),Rn(e,"hide-selected-item",t[35])},m(h,c){Jt(h,e,c),u&&u.m(e,null),n=!0},p(h,c){o?o.p&&(!n||c[0]&8|c[2]&1048576)&&Or(o,i,h,h[82],n?Vr(i,h[82],c,mE):Ur(h[82]),s8):u&&u.p&&(!n||c[0]&4104)&&u.p(h,n?c:[-1,-1,-1,-1,-1]),(!n||c[1]&16)&&Rn(e,"hide-selected-item",h[35])},i(h){n||(rt(u,h),n=!0)},o(h){mt(u,h),n=!1},d(h){h&&Fe(e),u&&u.d(h)}}}function EE(t){let e,n,i=Qs(t[3]),o=[];for(let h=0;h<i.length;h+=1)o[h]=I8(o8(t,i,h));const u=h=>mt(o[h],1,1,()=>{o[h]=null});return{c(){for(let h=0;h<o.length;h+=1)o[h].c();e=er()},l(h){for(let c=0;c<o.length;c+=1)o[c].l(h);e=er()},m(h,c){for(let b=0;b<o.length;b+=1)o[b]&&o[b].m(h,c);Jt(h,e,c),n=!0},p(h,c){if(c[0]&67116040|c[1]&32|c[2]&1048576){i=Qs(h[3]);let b;for(b=0;b<i.length;b+=1){const w=o8(h,i,b);o[b]?(o[b].p(w,c),rt(o[b],1)):(o[b]=I8(w),o[b].c(),rt(o[b],1),o[b].m(e.parentNode,e))}for(Ji(),b=i.length;b<o.length;b+=1)u(b);Ki()}},i(h){if(!n){for(let c=0;c<i.length;c+=1)rt(o[c]);n=!0}},o(h){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)mt(o[c]);n=!1},d(h){h&&Fe(e),Od(o,h)}}}function DE(t){let e=t[3][t[12]]+"",n;return{c(){n=wa(e)},l(i){n=Sa(i,e)},m(i,o){Jt(i,n,o)},p(i,o){o[0]&4104&&e!==(e=i[3][i[12]]+"")&&Il(n,e)},d(i){i&&Fe(n)}}}function PE(t){let e=t[126][t[12]]+"",n;return{c(){n=wa(e)},l(i){n=Sa(i,e)},m(i,o){Jt(i,n,o)},p(i,o){o[0]&4104&&e!==(e=i[126][i[12]]+"")&&Il(n,e)},d(i){i&&Fe(n)}}}function S8(t){let e,n,i,o;const u=t[83]["multi-clear-icon"],h=Rr(u,t,t[82],l8),c=h||LE();function b(){return t[92](t[128])}return{c(){e=Ye("div"),c&&c.c(),this.h()},l(w){e=Je(w,"DIV",{class:!0});var S=ht(e);c&&c.l(S),S.forEach(Fe),this.h()},h(){Me(e,"class","multi-item-clear svelte-u3g5ju")},m(w,S){Jt(w,e,S),c&&c.m(e,null),n=!0,i||(o=Yn(e,"pointerup",Ya(La(b))),i=!0)},p(w,S){t=w,h&&h.p&&(!n||S[2]&1048576)&&Or(h,u,t,t[82],n?Vr(u,t[82],S,_E):Ur(t[82]),l8)},i(w){n||(rt(c,w),n=!0)},o(w){mt(c,w),n=!1},d(w){w&&Fe(e),c&&c.d(w),i=!1,o()}}}function LE(t){let e,n;return e=new M_({}),{c(){ii(e.$$.fragment)},l(i){ri(e.$$.fragment,i)},m(i,o){ai(e,i,o),n=!0},i(i){n||(rt(e.$$.fragment,i),n=!0)},o(i){mt(e.$$.fragment,i),n=!1},d(i){si(e,i)}}}function I8(t){let e,n,i,o,u,h,c;const b=t[83].selection,w=Rr(b,t,t[82],c8),S=w||PE(t);let M=!t[11]&&!t[10]&&M_&&S8(t);function A(){return t[93](t[128])}return{c(){e=Ye("div"),n=Ye("span"),S&&S.c(),i=Mt(),M&&M.c(),o=Mt(),this.h()},l(P){e=Je(P,"DIV",{class:!0,role:!0});var B=ht(e);n=Je(B,"SPAN",{class:!0});var U=ht(n);S&&S.l(U),U.forEach(Fe),i=At(B),M&&M.l(B),o=At(B),B.forEach(Fe),this.h()},h(){Me(n,"class","multi-item-text svelte-u3g5ju"),Me(e,"class","multi-item svelte-u3g5ju"),Me(e,"role","none"),Rn(e,"active",t[26]===t[128]),Rn(e,"disabled",t[11])},m(P,B){Jt(P,e,B),Ce(e,n),S&&S.m(n,null),Ce(e,i),M&&M.m(e,null),Ce(e,o),u=!0,h||(c=[Yn(e,"click",La(A)),Yn(e,"keydown",Ya(La(t[84])))],h=!0)},p(P,B){t=P,w?w.p&&(!u||B[0]&8|B[2]&1048576)&&Or(w,b,t,t[82],u?Vr(b,t[82],B,gE):Ur(t[82]),c8):S&&S.p&&(!u||B[0]&4104)&&S.p(t,u?B:[-1,-1,-1,-1,-1]),!t[11]&&!t[10]&&M_?M?(M.p(t,B),B[0]&3072&&rt(M,1)):(M=S8(t),M.c(),rt(M,1),M.m(e,o)):M&&(Ji(),mt(M,1,1,()=>{M=null}),Ki()),(!u||B[0]&67108864)&&Rn(e,"active",t[26]===t[128]),(!u||B[0]&2048)&&Rn(e,"disabled",t[11])},i(P){u||(rt(S,P),rt(M),u=!0)},o(P){mt(S,P),mt(M),u=!1},d(P){P&&Fe(e),S&&S.d(P),M&&M.d(),h=!1,Ph(c)}}}function T8(t){let e,n;const i=t[83]["loading-icon"],o=Rr(i,t,t[82],a8),u=o||zE();return{c(){e=Ye("div"),u&&u.c(),this.h()},l(h){e=Je(h,"DIV",{class:!0,"aria-hidden":!0});var c=ht(e);u&&u.l(c),c.forEach(Fe),this.h()},h(){Me(e,"class","icon loading svelte-u3g5ju"),Me(e,"aria-hidden","true")},m(h,c){Jt(h,e,c),u&&u.m(e,null),n=!0},p(h,c){o&&o.p&&(!n||c[2]&1048576)&&Or(o,i,h,h[82],n?Vr(i,h[82],c,pE):Ur(h[82]),a8)},i(h){n||(rt(u,h),n=!0)},o(h){mt(u,h),n=!1},d(h){h&&Fe(e),u&&u.d(h)}}}function zE(t){let e,n;return e=new cE({}),{c(){ii(e.$$.fragment)},l(i){ri(e.$$.fragment,i)},m(i,o){ai(e,i,o),n=!0},i(i){n||(rt(e.$$.fragment,i),n=!0)},o(i){mt(e.$$.fragment,i),n=!1},d(i){si(e,i)}}}function M8(t){let e,n,i,o;const u=t[83]["clear-icon"],h=Rr(u,t,t[82],r8),c=h||BE();return{c(){e=Ye("button"),c&&c.c(),this.h()},l(b){e=Je(b,"BUTTON",{type:!0,class:!0});var w=ht(e);c&&c.l(w),w.forEach(Fe),this.h()},h(){Me(e,"type","button"),Me(e,"class","icon clear-select svelte-u3g5ju")},m(b,w){Jt(b,e,w),c&&c.m(e,null),n=!0,i||(o=Yn(e,"click",t[22]),i=!0)},p(b,w){h&&h.p&&(!n||w[2]&1048576)&&Or(h,u,b,b[82],n?Vr(u,b[82],w,fE):Ur(b[82]),r8)},i(b){n||(rt(c,b),n=!0)},o(b){mt(c,b),n=!1},d(b){b&&Fe(e),c&&c.d(b),i=!1,o()}}}function BE(t){let e,n;return e=new M_({}),{c(){ii(e.$$.fragment)},l(i){ri(e.$$.fragment,i)},m(i,o){ai(e,i,o),n=!0},i(i){n||(rt(e.$$.fragment,i),n=!0)},o(i){mt(e.$$.fragment,i),n=!1},d(i){si(e,i)}}}function A8(t){let e,n;const i=t[83]["chevron-icon"],o=Rr(i,t,t[82],i8),u=o||FE();return{c(){e=Ye("div"),u&&u.c(),this.h()},l(h){e=Je(h,"DIV",{class:!0,"aria-hidden":!0});var c=ht(e);u&&u.l(c),c.forEach(Fe),this.h()},h(){Me(e,"class","icon chevron svelte-u3g5ju"),Me(e,"aria-hidden","true")},m(h,c){Jt(h,e,c),u&&u.m(e,null),n=!0},p(h,c){o&&o.p&&(!n||c[0]&64|c[2]&1048576)&&Or(o,i,h,h[82],n?Vr(i,h[82],c,dE):Ur(h[82]),i8)},i(h){n||(rt(u,h),n=!0)},o(h){mt(u,h),n=!1},d(h){h&&Fe(e),u&&u.d(h)}}}function FE(t){let e,n;return e=new sE({}),{c(){ii(e.$$.fragment)},l(i){ri(e.$$.fragment,i)},m(i,o){ai(e,i,o),n=!0},i(i){n||(rt(e.$$.fragment,i),n=!0)},o(i){mt(e.$$.fragment,i),n=!1},d(i){si(e,i)}}}function NE(t){let e,n;return{c(){e=Ye("input"),this.h()},l(i){e=Je(i,"INPUT",{name:!0,type:!0,class:!0}),this.h()},h(){Me(e,"name",t[8]),Me(e,"type","hidden"),e.value=n=t[3]?JSON.stringify(t[3]):null,Me(e,"class","svelte-u3g5ju")},m(i,o){Jt(i,e,o)},p(i,o){o[0]&256&&Me(e,"name",i[8]),o[0]&8&&n!==(n=i[3]?JSON.stringify(i[3]):null)&&(e.value=n)},d(i){i&&Fe(e)}}}function C8(t){let e;const n=t[83].required,i=Rr(n,t,t[82],t8),o=i||RE();return{c(){o&&o.c()},l(u){o&&o.l(u)},m(u,h){o&&o.m(u,h),e=!0},p(u,h){i&&i.p&&(!e||h[0]&8|h[2]&1048576)&&Or(i,n,u,u[82],e?Vr(n,u[82],h,uE):Ur(u[82]),t8)},i(u){e||(rt(o,u),e=!0)},o(u){mt(o,u),e=!1},d(u){o&&o.d(u)}}}function RE(t){let e;return{c(){e=Ye("select"),this.h()},l(n){e=Je(n,"SELECT",{class:!0,tabindex:!0,"aria-hidden":!0}),ht(e).forEach(Fe),this.h()},h(){Me(e,"class","required svelte-u3g5ju"),e.required=!0,Me(e,"tabindex","-1"),Me(e,"aria-hidden","true")},m(n,i){Jt(n,e,i)},p:fi,d(n){n&&Fe(e)}}}function OE(t){let e,n,i,o,u,h,c,b,w,S,M,A,P,B,U,J,Q,K,le,ee,oe=t[6]&&g8(t),Z=t[2]&&x8(t);const ne=t[83].prepend,be=Rr(ne,t,t[82],u8);let me=t[25]&&w8(t),Te=[{readOnly:S=!t[17]},t[27],{placeholder:t[33]},{style:t[18]},{disabled:t[11]}],Y={};for(let je=0;je<Te.length;je+=1)Y=zs(Y,Te[je]);let ye=t[5]&&T8(t),qe=t[34]&&M8(t),He=t[20]&&A8(t);const Be=t[83]["input-hidden"],lt=Rr(Be,t,t[82],n8),Ge=lt||NE(t);let ot=t[16]&&(!t[3]||t[3].length===0)&&C8(t);return{c(){e=Ye("div"),oe&&oe.c(),n=Mt(),i=Ye("span"),Z&&Z.c(),o=Mt(),u=Ye("div"),be&&be.c(),h=Mt(),c=Ye("div"),me&&me.c(),b=Mt(),w=Ye("input"),M=Mt(),A=Ye("div"),ye&&ye.c(),P=Mt(),qe&&qe.c(),B=Mt(),He&&He.c(),U=Mt(),Ge&&Ge.c(),J=Mt(),ot&&ot.c(),this.h()},l(je){e=Je(je,"DIV",{class:!0,style:!0,role:!0});var Ve=ht(e);oe&&oe.l(Ve),n=At(Ve),i=Je(Ve,"SPAN",{"aria-live":!0,"aria-atomic":!0,"aria-relevant":!0,class:!0});var $e=ht(i);Z&&Z.l($e),$e.forEach(Fe),o=At(Ve),u=Je(Ve,"DIV",{class:!0});var st=ht(u);be&&be.l(st),st.forEach(Fe),h=At(Ve),c=Je(Ve,"DIV",{class:!0});var ct=ht(c);me&&me.l(ct),b=At(ct),w=Je(ct,"INPUT",{placeholder:!0,style:!0}),ct.forEach(Fe),M=At(Ve),A=Je(Ve,"DIV",{class:!0});var Pt=ht(A);ye&&ye.l(Pt),P=At(Pt),qe&&qe.l(Pt),B=At(Pt),He&&He.l(Pt),Pt.forEach(Fe),U=At(Ve),Ge&&Ge.l(Ve),J=At(Ve),ot&&ot.l(Ve),Ve.forEach(Fe),this.h()},h(){Me(i,"aria-live","polite"),Me(i,"aria-atomic","false"),Me(i,"aria-relevant","additions text"),Me(i,"class","a11y-text svelte-u3g5ju"),Me(u,"class","prepend svelte-u3g5ju"),Gw(w,Y),Rn(w,"svelte-u3g5ju",!0),Me(c,"class","value-container svelte-u3g5ju"),Me(A,"class","indicators svelte-u3g5ju"),Me(e,"class",Q="svelte-select "+t[21]+" svelte-u3g5ju"),Me(e,"style",t[14]),Me(e,"role","none"),Rn(e,"multi",t[9]),Rn(e,"disabled",t[11]),Rn(e,"focused",t[2]),Rn(e,"list-open",t[6]),Rn(e,"show-chevron",t[20]),Rn(e,"error",t[15])},m(je,Ve){Jt(je,e,Ve),oe&&oe.m(e,null),Ce(e,n),Ce(e,i),Z&&Z.m(i,null),Ce(e,o),Ce(e,u),be&&be.m(u,null),Ce(e,h),Ce(e,c),me&&me.m(c,null),Ce(c,b),Ce(c,w),w.autofocus&&w.focus(),t[94](w),vb(w,t[4]),Ce(e,M),Ce(e,A),ye&&ye.m(A,null),Ce(A,P),qe&&qe.m(A,null),Ce(A,B),He&&He.m(A,null),Ce(e,U),Ge&&Ge.m(e,null),Ce(e,J),ot&&ot.m(e,null),t[96](e),K=!0,le||(ee=[Yn(window,"click",t[42]),Yn(window,"keydown",t[37]),Yn(w,"keydown",t[37]),Yn(w,"blur",t[39]),Yn(w,"focus",t[38]),Yn(w,"input",t[95]),Yn(e,"pointerup",La(t[40])),Ga(t[48].call(null,e))],le=!0)},p(je,Ve){je[6]?oe?(oe.p(je,Ve),Ve[0]&64&&rt(oe,1)):(oe=g8(je),oe.c(),rt(oe,1),oe.m(e,n)):oe&&(Ji(),mt(oe,1,1,()=>{oe=null}),Ki()),je[2]?Z?Z.p(je,Ve):(Z=x8(je),Z.c(),Z.m(i,null)):Z&&(Z.d(1),Z=null),be&&be.p&&(!K||Ve[2]&1048576)&&Or(be,ne,je,je[82],K?Vr(ne,je[82],Ve,yE):Ur(je[82]),u8),je[25]?me?(me.p(je,Ve),Ve[0]&33554432&&rt(me,1)):(me=w8(je),me.c(),rt(me,1),me.m(c,b)):me&&(Ji(),mt(me,1,1,()=>{me=null}),Ki()),Gw(w,Y=gm(Te,[(!K||Ve[0]&131072&&S!==(S=!je[17]))&&{readOnly:S},Ve[0]&134217728&&je[27],(!K||Ve[1]&4)&&{placeholder:je[33]},(!K||Ve[0]&262144)&&{style:je[18]},(!K||Ve[0]&2048)&&{disabled:je[11]}])),Ve[0]&16&&w.value!==je[4]&&vb(w,je[4]),Rn(w,"svelte-u3g5ju",!0),je[5]?ye?(ye.p(je,Ve),Ve[0]&32&&rt(ye,1)):(ye=T8(je),ye.c(),rt(ye,1),ye.m(A,P)):ye&&(Ji(),mt(ye,1,1,()=>{ye=null}),Ki()),je[34]?qe?(qe.p(je,Ve),Ve[1]&8&&rt(qe,1)):(qe=M8(je),qe.c(),rt(qe,1),qe.m(A,B)):qe&&(Ji(),mt(qe,1,1,()=>{qe=null}),Ki()),je[20]?He?(He.p(je,Ve),Ve[0]&1048576&&rt(He,1)):(He=A8(je),He.c(),rt(He,1),He.m(A,null)):He&&(Ji(),mt(He,1,1,()=>{He=null}),Ki()),lt?lt.p&&(!K||Ve[0]&8|Ve[2]&1048576)&&Or(lt,Be,je,je[82],K?Vr(Be,je[82],Ve,hE):Ur(je[82]),n8):Ge&&Ge.p&&(!K||Ve[0]&264)&&Ge.p(je,K?Ve:[-1,-1,-1,-1,-1]),je[16]&&(!je[3]||je[3].length===0)?ot?(ot.p(je,Ve),Ve[0]&65544&&rt(ot,1)):(ot=C8(je),ot.c(),rt(ot,1),ot.m(e,null)):ot&&(Ji(),mt(ot,1,1,()=>{ot=null}),Ki()),(!K||Ve[0]&2097152&&Q!==(Q="svelte-select "+je[21]+" svelte-u3g5ju"))&&Me(e,"class",Q),(!K||Ve[0]&16384)&&Me(e,"style",je[14]),(!K||Ve[0]&2097664)&&Rn(e,"multi",je[9]),(!K||Ve[0]&2099200)&&Rn(e,"disabled",je[11]),(!K||Ve[0]&2097156)&&Rn(e,"focused",je[2]),(!K||Ve[0]&2097216)&&Rn(e,"list-open",je[6]),(!K||Ve[0]&3145728)&&Rn(e,"show-chevron",je[20]),(!K||Ve[0]&2129920)&&Rn(e,"error",je[15])},i(je){K||(rt(oe),rt(be,je),rt(me),rt(ye),rt(qe),rt(He),rt(Ge,je),rt(ot),K=!0)},o(je){mt(oe),mt(be,je),mt(me),mt(ye),mt(qe),mt(He),mt(Ge,je),mt(ot),K=!1},d(je){je&&Fe(e),oe&&oe.d(),Z&&Z.d(),be&&be.d(je),me&&me.d(),t[94](null),ye&&ye.d(),qe&&qe.d(),He&&He.d(),Ge&&Ge.d(je),ot&&ot.d(),t[96](null),le=!1,Ph(ee)}}}function k8(t){return t.map((e,n)=>({index:n,value:e,label:`${e}`}))}function UE(t){return t===0}function VE(t){return t.groupHeader&&t.selectable||t.selectable||!t.hasOwnProperty("selectable")}function jE(t,e,n){let i,o,u,h,c,b,w,S,M,{$$slots:A={},$$scope:P}=e;const B=N9(A),U=O1();let{justValue:J=null}=e,{filter:Q=iE}=e,{getItems:K=rE}=e,{id:le=null}=e,{name:ee=null}=e,{container:oe=void 0}=e,{input:Z=void 0}=e,{multiple:ne=!1}=e,{multiFullItemClearable:be=!1}=e,{disabled:me=!1}=e,{focused:Te=!1}=e,{value:Y=null}=e,{filterText:ye=""}=e,{placeholder:qe="Please select"}=e,{placeholderAlwaysShow:He=!1}=e,{items:Be=null}=e,{label:lt="label"}=e,{itemFilter:Ge=(fe,zt,Nn)=>`${fe}`.toLowerCase().includes(zt.toLowerCase())}=e,{groupBy:ot=void 0}=e,{groupFilter:je=fe=>fe}=e,{groupHeaderSelectable:Ve=!1}=e,{itemId:$e="value"}=e,{loadOptions:st=void 0}=e,{containerStyles:ct=""}=e,{hasError:Pt=!1}=e,{filterSelectedItems:Ut=!0}=e,{required:Lt=!1}=e,{closeListOnChange:gt=!0}=e,{clearFilterTextOnBlur:Bt=!0}=e,{createGroupHeaderItem:tt=(fe,zt)=>({value:fe,[lt]:fe})}=e;const Le=()=>w;let{searchable:ut=!0}=e,{inputStyles:Re=""}=e,{clearable:Ke=!0}=e,{loading:Ee=!1}=e,{listOpen:wt=!1}=e,De,{debounce:wn=(fe,zt=1)=>{clearTimeout(De),De=setTimeout(fe,zt)}}=e,{debounceWait:Wn=300}=e,{hideEmptyState:on=!1}=e,{inputAttributes:An={}}=e,{listAutoWidth:yr=!0}=e,{showChevron:br=!1}=e,{listOffset:Zn=5}=e,{hoverItemIndex:Tn=0}=e,{floatingConfig:pi={}}=e,{class:vr=""}=e,Jn,dt,at,Un;function ji(){if(typeof Y=="string"){let fe=(Be||[]).find(zt=>zt[$e]===Y);n(3,Y=fe||{[$e]:Y,label:Y})}else ne&&Array.isArray(Y)&&Y.length>0&&n(3,Y=Y.map(fe=>typeof fe=="string"?{value:fe,label:fe}:fe))}let Bn;function Ne(){n(27,Bn=Object.assign({autocapitalize:"none",autocomplete:"off",autocorrect:"off",spellcheck:!1,tabindex:0,type:"text","aria-autocomplete":"list"},An)),le&&n(27,Bn.id=le,Bn),ut||n(27,Bn.readonly=!0,Bn)}function yt(fe){const zt=[],Nn={};fe.forEach(Ra=>{const Lr=ot(Ra);zt.includes(Lr)||(zt.push(Lr),Nn[Lr]=[],Lr&&Nn[Lr].push(Object.assign(tt(Lr,Ra),{id:Lr,groupHeader:!0,selectable:Ve}))),Nn[Lr].push(Object.assign({groupItem:!!Lr},Ra))});const Hi=[];return je(zt).forEach(Ra=>{Nn[Ra]&&Hi.push(...Nn[Ra])}),Hi}function Zt(){if(ne){JSON.stringify(Y)!==JSON.stringify(dt)&&j()&&U("input",Y);return}(!dt||JSON.stringify(Y[$e])!==JSON.stringify(dt[$e]))&&U("input",Y)}function ti(){Y&&(Array.isArray(Y)?n(3,Y=[...Y]):n(3,Y=[Y]))}function Gn(){Y&&n(3,Y=null)}function Qt(){const fe=w.findIndex(zt=>zt[$e]===Y[$e]);ar(fe,!0)}function qi(fe){U("hoverItem",fe)}function ar(fe=0,zt){n(7,Tn=fe<0?0:fe),!zt&&ot&&w[Tn]&&!w[Tn].selectable&&mi(1)}function Oi(){!st&&ye.length===0||(st?wn(async function(){n(5,Ee=!0);let fe=await K({dispatch:U,loadOptions:st,convertStringItemsToObjects:k8,filterText:ye});fe?(n(5,Ee=fe.loading),n(6,wt=wt?fe.listOpen:ye.length>0),n(2,Te=wt&&fe.focused),n(51,Be=ot?yt(fe.filteredItems):fe.filteredItems)):(n(5,Ee=!1),n(2,Te=!0),n(6,wt=!0))},Wn):(n(6,wt=!0),ne&&n(26,Jn=void 0)))}function ie(fe){wt&&U("filter",fe)}pk(async()=>{n(78,dt=Y),n(79,at=ye),n(80,Un=ne)});function V(){return ne?Y?Y.map(fe=>fe[$e]):null:Y&&Y[$e]}function j(){let fe=!0;if(Y){const zt=[],Nn=[];Y.forEach(Hi=>{zt.includes(Hi[$e])?fe=!1:(zt.push(Hi[$e]),Nn.push(Hi))}),fe||n(3,Y=Nn)}return fe}function H(fe){let zt=fe?fe[$e]:Y[$e];return Be.find(Nn=>Nn[$e]===zt)}function se(fe){!fe||fe.length===0||fe.some(zt=>typeof zt!="object")||!Y||(ne?Y.some(zt=>!zt||!zt[$e]):!Y[$e])||(Array.isArray(Y)?n(3,Y=Y.map(zt=>H(zt)||zt)):n(3,Y=H()||Y))}async function _e(fe){const zt=Y[fe];Y.length===1?n(3,Y=void 0):n(3,Y=Y.filter(Nn=>Nn!==zt)),U("clear",zt)}function xe(fe){if(Te)switch(fe.stopPropagation(),fe.key){case"Escape":fe.preventDefault(),Ue();break;case"Enter":if(fe.preventDefault(),wt){if(w.length===0)break;const zt=w[Tn];if(Y&&!ne&&Y[$e]===zt[$e]){Ue();break}else $n(w[Tn])}break;case"ArrowDown":fe.preventDefault(),wt?mi(1):(n(6,wt=!0),n(26,Jn=void 0));break;case"ArrowUp":fe.preventDefault(),wt?mi(-1):(n(6,wt=!0),n(26,Jn=void 0));break;case"Tab":if(wt&&Te){if(w.length===0||Y&&Y[$e]===w[Tn][$e])return Ue();fe.preventDefault(),$n(w[Tn]),Ue()}break;case"Backspace":if(!ne||ye.length>0)return;if(ne&&Y&&Y.length>0){if(_e(Jn!==void 0?Jn:Y.length-1),Jn===0||Jn===void 0)break;n(26,Jn=Y.length>Jn?Jn-1:void 0)}break;case"ArrowLeft":if(!Y||!ne||ye.length>0)return;Jn===void 0?n(26,Jn=Y.length-1):Y.length>Jn&&Jn!==0&&n(26,Jn-=1);break;case"ArrowRight":if(!Y||!ne||ye.length>0||Jn===void 0)return;Jn===Y.length-1?n(26,Jn=void 0):Jn<Y.length-1&&n(26,Jn+=1);break}}function we(fe){Te&&Z===(document==null?void 0:document.activeElement)||(fe&&U("focus",fe),Z==null||Z.focus(),n(2,Te=!0))}async function de(fe){Fn||(wt||Te)&&(U("blur",fe),Ue(),n(2,Te=!1),n(26,Jn=void 0),Z==null||Z.blur())}function Pe(){if(!me){if(ye.length>0)return n(6,wt=!0);n(6,wt=!wt)}}function Xe(){U("clear",Y),n(3,Y=void 0),Ue(),we()}Ev(()=>{wt&&n(2,Te=!0),Te&&Z&&Z.focus()});function We(fe){if(fe){n(4,ye="");const zt=Object.assign({},fe);if(zt.groupHeader&&!zt.selectable)return;n(3,Y=ne?Y?Y.concat([zt]):[zt]:n(3,Y=zt)),setTimeout(()=>{gt&&Ue(),n(26,Jn=void 0),U("change",Y),U("select",fe)})}}function Ue(){Bt&&n(4,ye=""),n(6,wt=!1)}let{ariaValues:Ft=fe=>`Option ${fe}, selected.`}=e,{ariaListOpen:Nt=(fe,zt)=>`You are currently focused on option ${fe}. There are ${zt} results available.`}=e,{ariaFocused:gn=()=>"Select is focused, type to refine list, press down to open the menu."}=e;function Kt(fe){let zt;return fe&&Y.length>0?zt=Y.map(Nn=>Nn[lt]).join(", "):zt=Y[lt],Ft(zt)}function tn(){if(!w||w.length===0)return"";let fe=w[Tn];if(wt&&fe){let zt=w?w.length:0;return Nt(fe[lt],zt)}else return gn()}let en=null,Kn;function ni(){clearTimeout(Kn),Kn=setTimeout(()=>{Fn=!1},100)}function nn(fe){!wt&&!Te&&oe&&!oe.contains(fe.target)&&!(en!=null&&en.contains(fe.target))&&de()}Ro(()=>{en==null||en.remove()});let Fn=!1;function $n(fe){!fe||fe.selectable===!1||We(fe)}function Ai(fe){Fn||n(7,Tn=fe)}function xr(fe){const{item:zt,i:Nn}=fe;if((zt==null?void 0:zt.selectable)!==!1){if(Y&&!ne&&Y[$e]===zt[$e])return Ue();VE(zt)&&(n(7,Tn=Nn),$n(zt))}}function mi(fe){if(w.filter(Hi=>!Object.hasOwn(Hi,"selectable")||Hi.selectable===!0).length===0)return n(7,Tn=0);fe>0&&Tn===w.length-1?n(7,Tn=0):fe<0&&Tn===0?n(7,Tn=w.length-1):n(7,Tn=Tn+fe);const Nn=w[Tn];if(Nn&&Nn.selectable===!1){(fe===1||fe===-1)&&mi(fe);return}}function sr(fe,zt,Nn){if(!ne)return zt&&zt[Nn]===fe[Nn]}const ps=Ta,Vn=Ta;function Ta(fe){return{update(zt){zt.scroll&&(ni(),fe.scrollIntoView({behavior:"auto",block:"nearest"}))}}}function uo(){const{width:fe}=oe.getBoundingClientRect();n(23,en.style.width=yr?fe+"px":"auto",en)}let _i={strategy:"absolute",placement:"bottom-start",middleware:[Qk(Zn),eE(),$k()],autoUpdate:!1};const[Bi,fa,wr]=nE(_i);let or=!0;function Xr(fe,zt){if(!fe||!zt)return n(28,or=!0);setTimeout(()=>{n(28,or=!1)},0)}function Sr(fe){Yi.call(this,t,fe)}function Ci(fe){Yi.call(this,t,fe)}function pa(fe){Yi.call(this,t,fe)}function Na(fe){Yi.call(this,t,fe)}const Xn=fe=>Ai(fe),Pr=fe=>Ai(fe),tr=(fe,zt)=>xr({item:fe,i:zt});function ho(fe){Fr[fe?"unshift":"push"](()=>{en=fe,n(23,en)})}const Qr=fe=>_e(fe),Hr=fe=>be?_e(fe):{};function $r(fe){Fr[fe?"unshift":"push"](()=>{Z=fe,n(1,Z)})}function zn(){ye=this.value,n(4,ye)}function Ma(fe){Fr[fe?"unshift":"push"](()=>{oe=fe,n(0,oe)})}return t.$$set=fe=>{"justValue"in fe&&n(52,J=fe.justValue),"filter"in fe&&n(53,Q=fe.filter),"getItems"in fe&&n(54,K=fe.getItems),"id"in fe&&n(55,le=fe.id),"name"in fe&&n(8,ee=fe.name),"container"in fe&&n(0,oe=fe.container),"input"in fe&&n(1,Z=fe.input),"multiple"in fe&&n(9,ne=fe.multiple),"multiFullItemClearable"in fe&&n(10,be=fe.multiFullItemClearable),"disabled"in fe&&n(11,me=fe.disabled),"focused"in fe&&n(2,Te=fe.focused),"value"in fe&&n(3,Y=fe.value),"filterText"in fe&&n(4,ye=fe.filterText),"placeholder"in fe&&n(56,qe=fe.placeholder),"placeholderAlwaysShow"in fe&&n(57,He=fe.placeholderAlwaysShow),"items"in fe&&n(51,Be=fe.items),"label"in fe&&n(12,lt=fe.label),"itemFilter"in fe&&n(58,Ge=fe.itemFilter),"groupBy"in fe&&n(59,ot=fe.groupBy),"groupFilter"in fe&&n(60,je=fe.groupFilter),"groupHeaderSelectable"in fe&&n(61,Ve=fe.groupHeaderSelectable),"itemId"in fe&&n(13,$e=fe.itemId),"loadOptions"in fe&&n(62,st=fe.loadOptions),"containerStyles"in fe&&n(14,ct=fe.containerStyles),"hasError"in fe&&n(15,Pt=fe.hasError),"filterSelectedItems"in fe&&n(63,Ut=fe.filterSelectedItems),"required"in fe&&n(16,Lt=fe.required),"closeListOnChange"in fe&&n(64,gt=fe.closeListOnChange),"clearFilterTextOnBlur"in fe&&n(65,Bt=fe.clearFilterTextOnBlur),"createGroupHeaderItem"in fe&&n(66,tt=fe.createGroupHeaderItem),"searchable"in fe&&n(17,ut=fe.searchable),"inputStyles"in fe&&n(18,Re=fe.inputStyles),"clearable"in fe&&n(68,Ke=fe.clearable),"loading"in fe&&n(5,Ee=fe.loading),"listOpen"in fe&&n(6,wt=fe.listOpen),"debounce"in fe&&n(69,wn=fe.debounce),"debounceWait"in fe&&n(70,Wn=fe.debounceWait),"hideEmptyState"in fe&&n(19,on=fe.hideEmptyState),"inputAttributes"in fe&&n(71,An=fe.inputAttributes),"listAutoWidth"in fe&&n(72,yr=fe.listAutoWidth),"showChevron"in fe&&n(20,br=fe.showChevron),"listOffset"in fe&&n(73,Zn=fe.listOffset),"hoverItemIndex"in fe&&n(7,Tn=fe.hoverItemIndex),"floatingConfig"in fe&&n(74,pi=fe.floatingConfig),"class"in fe&&n(21,vr=fe.class),"ariaValues"in fe&&n(75,Ft=fe.ariaValues),"ariaListOpen"in fe&&n(76,Nt=fe.ariaListOpen),"ariaFocused"in fe&&n(77,gn=fe.ariaFocused),"$$scope"in fe&&n(82,P=fe.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&8|t.$$.dirty[1]&1048576&&Y&&ji(),t.$$.dirty[0]&131072|t.$$.dirty[2]&512&&(An||!ut)&&Ne(),t.$$.dirty[0]&512&&ne&&ti(),t.$$.dirty[0]&512|t.$$.dirty[2]&262144&&Un&&!ne&&Gn(),t.$$.dirty[0]&520&&ne&&Y&&Y.length>1&&j(),t.$$.dirty[0]&8&&Y&&Zt(),t.$$.dirty[0]&520|t.$$.dirty[2]&65536&&!Y&&ne&&dt&&U("input",Y),t.$$.dirty[0]&6&&!Te&&Z&&Ue(),t.$$.dirty[0]&16|t.$$.dirty[2]&131072&&ye!==at&&Oi(),t.$$.dirty[0]&12824|t.$$.dirty[1]&407896064|t.$$.dirty[2]&3&&n(24,w=Q({loadOptions:st,filterText:ye,items:Be,multiple:ne,value:Y,itemId:$e,groupBy:ot,label:lt,filterSelectedItems:Ut,itemFilter:Ge,convertStringItemsToObjects:k8,filterGroupedItems:yt})),t.$$.dirty[0]&16777800&&!ne&&wt&&Y&&w&&Qt(),t.$$.dirty[0]&576&&wt&&ne&&n(7,Tn=0),t.$$.dirty[0]&16&&ye&&n(7,Tn=0),t.$$.dirty[0]&128&&qi(Tn),t.$$.dirty[0]&520&&n(25,i=ne?Y&&Y.length>0:Y),t.$$.dirty[0]&33554448&&n(35,o=i&&ye.length>0),t.$$.dirty[0]&33556512|t.$$.dirty[2]&64&&n(34,u=i&&Ke&&!me&&!Ee),t.$$.dirty[0]&520|t.$$.dirty[1]&100663296&&n(33,h=He&&ne||ne&&(Y==null?void 0:Y.length)===0?qe:Y?"":qe),t.$$.dirty[0]&520&&n(32,c=Y?Kt(ne):""),t.$$.dirty[0]&16777412&&n(31,b=tn()),t.$$.dirty[1]&1048576&&se(Be),t.$$.dirty[0]&8712&&n(52,J=V()),t.$$.dirty[0]&520|t.$$.dirty[2]&65536&&!ne&&dt&&!Y&&U("input",Y),t.$$.dirty[0]&16777800&&wt&&w&&!ne&&!Y&&ar(),t.$$.dirty[0]&16777216&&ie(w),t.$$.dirty[0]&1|t.$$.dirty[2]&4096&&oe&&(pi==null?void 0:pi.autoUpdate)===void 0&&n(81,_i.autoUpdate=!0,_i),t.$$.dirty[0]&1|t.$$.dirty[2]&528384&&oe&&pi&&wr(Object.assign(_i,pi)),t.$$.dirty[0]&8388608&&n(30,S=!!en),t.$$.dirty[0]&8388672&&Xr(en,wt),t.$$.dirty[0]&8388673&&wt&&oe&&en&&uo(),t.$$.dirty[0]&128&&n(29,M=Tn),t.$$.dirty[0]&70&&Z&&wt&&!Te&&we()},[oe,Z,Te,Y,ye,Ee,wt,Tn,ee,ne,be,me,lt,$e,ct,Pt,Lt,ut,Re,on,br,vr,Xe,en,w,i,Jn,Bn,or,M,S,b,c,h,u,o,_e,xe,we,de,Pe,ni,nn,Ai,xr,sr,ps,Vn,Bi,fa,B,Be,J,Q,K,le,qe,He,Ge,ot,je,Ve,st,Ut,gt,Bt,tt,Le,Ke,wn,Wn,An,yr,Zn,pi,Ft,Nt,gn,dt,at,Un,_i,P,A,Sr,Ci,pa,Na,Xn,Pr,tr,ho,Qr,Hr,$r,zn,Ma]}class K9 extends jr{constructor(e){super(),qr(this,e,jE,OE,gr,{justValue:52,filter:53,getItems:54,id:55,name:8,container:0,input:1,multiple:9,multiFullItemClearable:10,disabled:11,focused:2,value:3,filterText:4,placeholder:56,placeholderAlwaysShow:57,items:51,label:12,itemFilter:58,groupBy:59,groupFilter:60,groupHeaderSelectable:61,itemId:13,loadOptions:62,containerStyles:14,hasError:15,filterSelectedItems:63,required:16,closeListOnChange:64,clearFilterTextOnBlur:65,createGroupHeaderItem:66,getFilteredItems:67,searchable:17,inputStyles:18,clearable:68,loading:5,listOpen:6,debounce:69,debounceWait:70,hideEmptyState:19,inputAttributes:71,listAutoWidth:72,showChevron:20,listOffset:73,hoverItemIndex:7,floatingConfig:74,class:21,handleClear:22,ariaValues:75,ariaListOpen:76,ariaFocused:77},null,[-1,-1,-1,-1,-1])}get getFilteredItems(){return this.$$.ctx[67]}get handleClear(){return this.$$.ctx[22]}}let qE=Date.now();function Z1(t){return`${t}-${qE++}`}const Bv=Symbol.for("svelte-maplibre");function yf(){return mk(Bv)}function HE(t){let e=new WeakMap;return n=>{var h;let i=e.get(n.originalEvent);if(i!==void 0)return i;let u=(h=n.target.queryRenderedFeatures(n.point).find(c=>{var b;return(b=t.get(c.layer.id))==null?void 0:b.interactive}))==null?void 0:h.layer.id;return e.set(n.originalEvent,u),u}}function WE(){let t=new Map;return R9(Bv,{map:mc(null),source:ky(null),layer:ky(null),popupTarget:ky(null),cluster:mc(),loadedImages:mc(new Set),minzoom:mc(0),maxzoom:mc(24),layerEvent:mc(null),layerInfo:t,eventTopMost:HE(t)})}function E8(t){return{subscribe:t.subscribe}}function X9({key:t,setPopupTarget:e=!1,setCluster:n=!1,setMouseEvent:i=!1}){let o=yf(),u=mc(null),h=E8(u),c={...o,[t]:E8(u)};if(e&&(c.popupTarget=h),i){let b=mc(null);c.layerEvent=b,o.layerEvent=b}return n&&(c.cluster=mc()),R9(Bv,c),{...o,self:u}}function ZE(){return X9({key:"source",setCluster:!0})}function GE(t=!0){return X9({key:"layer",setPopupTarget:t,setMouseEvent:t})}function YE(t){return"layerType"in t&&t.layerType==="deckgl"}var JE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Q9(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var $9={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.3.2/LICENSE.txt
 */(function(t,e){(function(n,i){t.exports=i()})(JE,function(){var n={},i={};function o(h,c,b){if(i[h]=b,h==="index"){var w="var sharedModule = {}; ("+i.shared+")(sharedModule); ("+i.worker+")(sharedModule);",S={};return i.shared(S),i.index(n,S),typeof window<"u"&&n.setWorkerUrl(window.URL.createObjectURL(new Blob([w],{type:"text/javascript"}))),n}}o("shared",["exports"],function(h){function c(s,r,l,f){return new(l||(l=Promise))(function(m,y){function x(D){try{C(f.next(D))}catch(z){y(z)}}function I(D){try{C(f.throw(D))}catch(z){y(z)}}function C(D){var z;D.done?m(D.value):(z=D.value,z instanceof l?z:new l(function(F){F(z)})).then(x,I)}C((f=f.apply(s,r||[])).next())})}function b(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}typeof SuppressedError=="function"&&SuppressedError;var w=S;function S(s,r){this.x=s,this.y=r}S.prototype={clone:function(){return new S(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,r){return this.clone()._rotateAround(s,r)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var r=s.x-this.x,l=s.y-this.y;return r*r+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,r){return Math.atan2(this.x*r-this.y*s,this.x*s+this.y*r)},_matMult:function(s){var r=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=r,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var r=Math.cos(s),l=Math.sin(s),f=l*this.x+r*this.y;return this.x=r*this.x-l*this.y,this.y=f,this},_rotateAround:function(s,r){var l=Math.cos(s),f=Math.sin(s),m=r.y+f*(this.x-r.x)+l*(this.y-r.y);return this.x=r.x+l*(this.x-r.x)-f*(this.y-r.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},S.convert=function(s){return s instanceof S?s:Array.isArray(s)?new S(s[0],s[1]):s};var M=b(w),A=P;function P(s,r,l,f){this.cx=3*s,this.bx=3*(l-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(f-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=l,this.p2y=f}P.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var l=s,f=0;f<8;f++){var m=this.sampleCurveX(l)-s;if(Math.abs(m)<r)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=m/y}var x=0,I=1;for(l=s,f=0;f<20&&(m=this.sampleCurveX(l),!(Math.abs(m-s)<r));f++)s>m?x=l:I=l,l=.5*(I-x)+x;return l},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var B=b(A);let U,J;function Q(){return U==null&&(U=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),U}function K(){if(J==null&&(J=!1,Q())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let f=0;f<5*5;f++){const m=4*f;r.fillStyle=`rgb(${m},${m+1},${m+2})`,r.fillRect(f%5,Math.floor(f/5),1,1)}const l=r.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&l[f]!==f){J=!0;break}}}return J||!1}function le(s,r,l,f){const m=new B(s,r,l,f);return y=>m.solve(y)}const ee=le(.25,.1,.25,1);function oe(s,r,l){return Math.min(l,Math.max(r,s))}function Z(s,r,l){const f=l-r,m=((s-r)%f+f)%f+r;return m===r?l:m}function ne(s,...r){for(const l of r)for(const f in l)s[f]=l[f];return s}let be=1;function me(s,r,l){const f={};for(const m in s)f[m]=r.call(this,s[m],m,s);return f}function Te(s,r,l){const f={};for(const m in s)r.call(this,s[m],m,s)&&(f[m]=s[m]);return f}function Y(s){return Array.isArray(s)?s.map(Y):typeof s=="object"&&s?me(s,Y):s}const ye={};function qe(s){ye[s]||(typeof console<"u"&&console.warn(s),ye[s]=!0)}function He(s,r,l){return(l.y-s.y)*(r.x-s.x)>(r.y-s.y)*(l.x-s.x)}function Be(s){return typeof WorkerGlobalScope<"u"&&s!==void 0&&s instanceof WorkerGlobalScope}let lt=null;function Ge(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap}const ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function je(s,r,l,f,m){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(s,{timestamp:0});try{const x=y==null?void 0:y.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const I=x.startsWith("BGR"),C=new Uint8ClampedArray(f*m*4);if(yield y.copyTo(C,function(D,z,F,O,q){const G=4*Math.max(-z,0),$=(Math.max(0,F)-F)*O*4+G,ae=4*O,he=Math.max(0,z),ke=Math.max(0,F);return{rect:{x:he,y:ke,width:Math.min(D.width,z+O)-he,height:Math.min(D.height,F+q)-ke},layout:[{offset:$,stride:ae}]}}(s,r,l,f,m)),I)for(let D=0;D<C.length;D+=4){const z=C[D];C[D]=C[D+2],C[D+2]=z}return C}finally{y.close()}})}let Ve,$e;const st="AbortError";function ct(){return new Error(st)}const Pt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ut(s){return Pt.REGISTERED_PROTOCOLS[s.substring(0,s.indexOf("://"))]}const Lt="global-dispatcher";class gt extends Error{constructor(r,l,f,m){super(`AJAXError: ${l} (${r}): ${f}`),this.status=r,this.statusText=l,this.url=f,this.body=m}}const Bt=()=>Be(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,tt=function(s,r){if(/:\/\//.test(s.url)&&!/^https?:|^file:/.test(s.url)){const f=Ut(s.url);if(f)return f(s,r);if(Be(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,targetMapId:Lt},r)}if(!(/^file:/.test(l=s.url)||/^file:/.test(Bt())&&!/^\w+:/.test(l))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,m){return c(this,void 0,void 0,function*(){const y=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Bt(),signal:m.signal});f.type==="json"&&y.headers.set("Accept","application/json");const x=yield fetch(y);if(!x.ok){const D=yield x.blob();throw new gt(x.status,x.statusText,f.url,D)}let I;I=f.type==="arrayBuffer"||f.type==="image"?x.arrayBuffer():f.type==="json"?x.json():x.text();const C=yield I;if(m.signal.aborted)throw ct();return{data:C,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}})}(s,r);if(Be(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:s,mustQueue:!0,targetMapId:Lt},r)}var l;return function(f,m){return new Promise((y,x)=>{const I=new XMLHttpRequest;I.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(I.responseType="arraybuffer");for(const C in f.headers)I.setRequestHeader(C,f.headers[C]);f.type==="json"&&(I.responseType="text",I.setRequestHeader("Accept","application/json")),I.withCredentials=f.credentials==="include",I.onerror=()=>{x(new Error(I.statusText))},I.onload=()=>{if(!m.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let C=I.response;if(f.type==="json")try{C=JSON.parse(I.response)}catch(D){return void x(D)}y({data:C,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const C=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});x(new gt(I.status,I.statusText,f.url,C))}},m.signal.addEventListener("abort",()=>{I.abort(),x(ct())}),I.send(f.body)})}(s,r)};function Le(s){if(!s||s.indexOf("://")<=0||s.indexOf("data:image/")===0||s.indexOf("blob:")===0)return!0;const r=new URL(s),l=window.location;return r.protocol===l.protocol&&r.host===l.host}function ut(s,r,l){l[s]&&l[s].indexOf(r)!==-1||(l[s]=l[s]||[],l[s].push(r))}function Re(s,r,l){if(l&&l[s]){const f=l[s].indexOf(r);f!==-1&&l[s].splice(f,1)}}class Ke{constructor(r,l={}){ne(this,l),this.type=r}}class Ee extends Ke{constructor(r,l={}){super("error",ne({error:r},l))}}class wt{on(r,l){return this._listeners=this._listeners||{},ut(r,l,this._listeners),this}off(r,l){return Re(r,l,this._listeners),Re(r,l,this._oneTimeListeners),this}once(r,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},ut(r,l,this._oneTimeListeners),this):new Promise(f=>this.once(r,f))}fire(r,l){typeof r=="string"&&(r=new Ke(r,l||{}));const f=r.type;if(this.listens(f)){r.target=this;const m=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const I of m)I.call(this,r);const y=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const I of y)Re(f,I,this._oneTimeListeners),I.call(this,r);const x=this._eventedParent;x&&(ne(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof Ee&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,l){return this._eventedParent=r,this._eventedParentData=l,this}}var De={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const wn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Wn(s,r){const l={};for(const f in s)f!=="ref"&&(l[f]=s[f]);return wn.forEach(f=>{f in r&&(l[f]=r[f])}),l}function on(s,r){if(Array.isArray(s)){if(!Array.isArray(r)||s.length!==r.length)return!1;for(let l=0;l<s.length;l++)if(!on(s[l],r[l]))return!1;return!0}if(typeof s=="object"&&s!==null&&r!==null){if(typeof r!="object"||Object.keys(s).length!==Object.keys(r).length)return!1;for(const l in s)if(!on(s[l],r[l]))return!1;return!0}return s===r}function An(s,r){s.push(r)}function yr(s,r,l){An(l,{command:"addSource",args:[s,r[s]]})}function br(s,r,l){An(r,{command:"removeSource",args:[s]}),l[s]=!0}function Zn(s,r,l,f){br(s,l,f),yr(s,r,l)}function Tn(s,r,l){let f;for(f in s[l])if(Object.prototype.hasOwnProperty.call(s[l],f)&&f!=="data"&&!on(s[l][f],r[l][f]))return!1;for(f in r[l])if(Object.prototype.hasOwnProperty.call(r[l],f)&&f!=="data"&&!on(s[l][f],r[l][f]))return!1;return!0}function pi(s,r,l,f,m,y){s=s||{},r=r||{};for(const x in s)Object.prototype.hasOwnProperty.call(s,x)&&(on(s[x],r[x])||l.push({command:y,args:[f,x,r[x],m]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(s,x)&&(on(s[x],r[x])||l.push({command:y,args:[f,x,r[x],m]}))}function vr(s){return s.id}function Jn(s,r){return s[r.id]=r,s}class dt{constructor(r,l,f,m){this.message=(r?`${r}: `:"")+f,m&&(this.identifier=m),l!=null&&l.__line__&&(this.line=l.__line__)}}function at(s,...r){for(const l of r)for(const f in l)s[f]=l[f];return s}class Un extends Error{constructor(r,l){super(l),this.message=l,this.key=r}}class ji{constructor(r,l=[]){this.parent=r,this.bindings={};for(const[f,m]of l)this.bindings[f]=m}concat(r){return new ji(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Bn={kind:"null"},Ne={kind:"number"},yt={kind:"string"},Zt={kind:"boolean"},ti={kind:"color"},Gn={kind:"object"},Qt={kind:"value"},qi={kind:"collator"},ar={kind:"formatted"},Oi={kind:"padding"},ie={kind:"resolvedImage"},V={kind:"variableAnchorOffsetCollection"};function j(s,r){return{kind:"array",itemType:s,N:r}}function H(s){if(s.kind==="array"){const r=H(s.itemType);return typeof s.N=="number"?`array<${r}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${r}>`}return s.kind}const se=[Bn,Ne,yt,Zt,ti,ar,Gn,j(Qt),Oi,ie,V];function _e(s,r){if(r.kind==="error")return null;if(s.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!_e(s.itemType,r.itemType))&&(typeof s.N!="number"||s.N===r.N))return null}else{if(s.kind===r.kind)return null;if(s.kind==="value"){for(const l of se)if(!_e(l,r))return null}}return`Expected ${H(s)} but found ${H(r)} instead.`}function xe(s,r){return r.some(l=>l.kind===s.kind)}function we(s,r){return r.some(l=>l==="null"?s===null:l==="array"?Array.isArray(s):l==="object"?s&&!Array.isArray(s)&&typeof s=="object":l===typeof s)}function de(s,r){return s.kind==="array"&&r.kind==="array"?s.itemType.kind===r.itemType.kind&&typeof s.N=="number":s.kind===r.kind}const Pe=.96422,Xe=.82521,We=4/29,Ue=6/29,Ft=3*Ue*Ue,Nt=Ue*Ue*Ue,gn=Math.PI/180,Kt=180/Math.PI;function tn(s){return(s%=360)<0&&(s+=360),s}function en([s,r,l,f]){let m,y;const x=ni((.2225045*(s=Kn(s))+.7168786*(r=Kn(r))+.0606169*(l=Kn(l)))/1);s===r&&r===l?m=y=x:(m=ni((.4360747*s+.3850649*r+.1430804*l)/Pe),y=ni((.0139322*s+.0971045*r+.7141733*l)/Xe));const I=116*x-16;return[I<0?0:I,500*(m-x),200*(x-y),f]}function Kn(s){return s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function ni(s){return s>Nt?Math.pow(s,1/3):s/Ft+We}function nn([s,r,l,f]){let m=(s+16)/116,y=isNaN(r)?m:m+r/500,x=isNaN(l)?m:m-l/200;return m=1*$n(m),y=Pe*$n(y),x=Xe*$n(x),[Fn(3.1338561*y-1.6168667*m-.4906146*x),Fn(-.9787684*y+1.9161415*m+.033454*x),Fn(.0719453*y-.2289914*m+1.4052427*x),f]}function Fn(s){return(s=s<=.00304?12.92*s:1.055*Math.pow(s,1/2.4)-.055)<0?0:s>1?1:s}function $n(s){return s>Ue?s*s*s:Ft*(s-We)}function Ai(s){return parseInt(s.padEnd(2,s),16)/255}function xr(s,r){return mi(r?s/100:s,0,1)}function mi(s,r,l){return Math.min(Math.max(r,s),l)}function sr(s){return!s.some(Number.isNaN)}const ps={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Vn{constructor(r,l,f,m=1,y=!0){this.r=r,this.g=l,this.b=f,this.a=m,y||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[r,l,f,m]))}static parse(r){if(r instanceof Vn)return r;if(typeof r!="string")return;const l=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const m=ps[f];if(m){const[x,I,C]=m;return[x/255,I/255,C/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const x=f.length<6?1:2;let I=1;return[Ai(f.slice(I,I+=x)),Ai(f.slice(I,I+=x)),Ai(f.slice(I,I+=x)),Ai(f.slice(I,I+x)||"ff")]}if(f.startsWith("rgb")){const x=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[I,C,D,z,F,O,q,G,$,ae,he,ke]=x,ge=[z||" ",q||" ",ae].join("");if(ge==="  "||ge==="  /"||ge===",,"||ge===",,,"){const Ie=[D,O,$].join(""),Ze=Ie==="%%%"?100:Ie===""?255:0;if(Ze){const et=[mi(+C/Ze,0,1),mi(+F/Ze,0,1),mi(+G/Ze,0,1),he?xr(+he,ke):1];if(sr(et))return et}}return}}const y=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[x,I,C,D,z,F,O,q,G]=y,$=[C||" ",z||" ",O].join("");if($==="  "||$==="  /"||$===",,"||$===",,,"){const ae=[+I,mi(+D,0,100),mi(+F,0,100),q?xr(+q,G):1];if(sr(ae))return function([he,ke,ge,Ie]){function Ze(et){const kt=(et+he/30)%12,Wt=ke*Math.min(ge,1-ge);return ge-Wt*Math.max(-1,Math.min(kt-3,9-kt,1))}return he=tn(he),ke/=100,ge/=100,[Ze(0),Ze(8),Ze(4),Ie]}(ae)}}}(r);return l?new Vn(...l,!1):void 0}get rgb(){const{r,g:l,b:f,a:m}=this,y=m||1/0;return this.overwriteGetter("rgb",[r/y,l/y,f/y,m])}get hcl(){return this.overwriteGetter("hcl",function(r){const[l,f,m,y]=en(r),x=Math.sqrt(f*f+m*m);return[Math.round(1e4*x)?tn(Math.atan2(m,f)*Kt):NaN,x,l,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",en(this.rgb))}overwriteGetter(r,l){return Object.defineProperty(this,r,{value:l}),l}toString(){const[r,l,f,m]=this.rgb;return`rgba(${[r,l,f].map(y=>Math.round(255*y)).join(",")},${m})`}}Vn.black=new Vn(0,0,0,1),Vn.white=new Vn(1,1,1,1),Vn.transparent=new Vn(0,0,0,0),Vn.red=new Vn(1,0,0,1);class Ta{constructor(r,l,f){this.sensitivity=r?l?"variant":"case":l?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,l){return this.collator.compare(r,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class uo{constructor(r,l,f,m,y){this.text=r,this.image=l,this.scale=f,this.fontStack=m,this.textColor=y}}class _i{constructor(r){this.sections=r}static fromString(r){return new _i([new uo(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof _i?r:_i.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class Bi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Bi)return r;if(typeof r=="number")return new Bi([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const l of r)if(typeof l!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new Bi(r)}}toString(){return JSON.stringify(this.values)}}const fa=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class wr{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof wr)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let l=0;l<r.length;l+=2){const f=r[l],m=r[l+1];if(typeof f!="string"||!fa.has(f)||!Array.isArray(m)||m.length!==2||typeof m[0]!="number"||typeof m[1]!="number")return}return new wr(r)}}toString(){return JSON.stringify(this.values)}}class or{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new or({name:r,available:!1}):null}}function Xr(s,r,l,f){return typeof s=="number"&&s>=0&&s<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof l=="number"&&l>=0&&l<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[s,r,l,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[s,r,l,f]:[s,r,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Sr(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Vn||s instanceof Ta||s instanceof _i||s instanceof Bi||s instanceof wr||s instanceof or)return!0;if(Array.isArray(s)){for(const r of s)if(!Sr(r))return!1;return!0}if(typeof s=="object"){for(const r in s)if(!Sr(s[r]))return!1;return!0}return!1}function Ci(s){if(s===null)return Bn;if(typeof s=="string")return yt;if(typeof s=="boolean")return Zt;if(typeof s=="number")return Ne;if(s instanceof Vn)return ti;if(s instanceof Ta)return qi;if(s instanceof _i)return ar;if(s instanceof Bi)return Oi;if(s instanceof wr)return V;if(s instanceof or)return ie;if(Array.isArray(s)){const r=s.length;let l;for(const f of s){const m=Ci(f);if(l){if(l===m)continue;l=Qt;break}l=m}return j(l||Qt,r)}return Gn}function pa(s){const r=typeof s;return s===null?"":r==="string"||r==="number"||r==="boolean"?String(s):s instanceof Vn||s instanceof _i||s instanceof Bi||s instanceof wr||s instanceof or?s.toString():JSON.stringify(s)}class Na{constructor(r,l){this.type=r,this.value=l}static parse(r,l){if(r.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Sr(r[1]))return l.error("invalid value");const f=r[1];let m=Ci(f);const y=l.expectedType;return m.kind!=="array"||m.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(m=y),new Na(m,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Xn{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Pr={string:yt,number:Ne,boolean:Zt,object:Gn};class tr{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");let f,m=1;const y=r[0];if(y==="array"){let I,C;if(r.length>2){const D=r[1];if(typeof D!="string"||!(D in Pr)||D==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);I=Pr[D],m++}else I=Qt;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return l.error('The length argument to "array" must be a positive integer literal',2);C=r[2],m++}f=j(I,C)}else{if(!Pr[y])throw new Error(`Types doesn't contain name = ${y}`);f=Pr[y]}const x=[];for(;m<r.length;m++){const I=l.parse(r[m],m,Qt);if(!I)return null;x.push(I)}return new tr(f,x)}evaluate(r){for(let l=0;l<this.args.length;l++){const f=this.args[l].evaluate(r);if(!_e(this.type,Ci(f)))return f;if(l===this.args.length-1)throw new Xn(`Expected value to be of type ${H(this.type)}, but found ${H(Ci(f))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const ho={"to-boolean":Zt,"to-color":ti,"to-number":Ne,"to-string":yt};class Qr{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const f=r[0];if(!ho[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&r.length!==2)return l.error("Expected one argument.");const m=ho[f],y=[];for(let x=1;x<r.length;x++){const I=l.parse(r[x],x,Qt);if(!I)return null;y.push(I)}return new Qr(m,y)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let l,f;for(const m of this.args){if(l=m.evaluate(r),f=null,l instanceof Vn)return l;if(typeof l=="string"){const y=r.parseColor(l);if(y)return y}else if(Array.isArray(l)&&(f=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Xr(l[0],l[1],l[2],l[3]),!f))return new Vn(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Xn(f||`Could not parse color from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"padding":{let l;for(const f of this.args){l=f.evaluate(r);const m=Bi.parse(l);if(m)return m}throw new Xn(`Could not parse padding from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"variableAnchorOffsetCollection":{let l;for(const f of this.args){l=f.evaluate(r);const m=wr.parse(l);if(m)return m}throw new Xn(`Could not parse variableAnchorOffsetCollection from value '${typeof l=="string"?l:JSON.stringify(l)}'`)}case"number":{let l=null;for(const f of this.args){if(l=f.evaluate(r),l===null)return 0;const m=Number(l);if(!isNaN(m))return m}throw new Xn(`Could not convert ${JSON.stringify(l)} to number.`)}case"formatted":return _i.fromString(pa(this.args[0].evaluate(r)));case"resolvedImage":return or.fromString(pa(this.args[0].evaluate(r)));default:return pa(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Hr=["Unknown","Point","LineString","Polygon"];class $r{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Hr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let l=this._parseColorCache[r];return l||(l=this._parseColorCache[r]=Vn.parse(r)),l}}class zn{constructor(r,l,f=[],m,y=new ji,x=[]){this.registry=r,this.path=f,this.key=f.map(I=>`[${I}]`).join(""),this.scope=y,this.errors=x,this.expectedType=m,this._isConstant=l}parse(r,l,f,m,y={}){return l?this.concat(l,f,m)._parse(r,y):this._parse(r,y)}_parse(r,l){function f(m,y,x){return x==="assert"?new tr(y,[m]):x==="coerce"?new Qr(y,[m]):m}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=r[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[m];if(y){let x=y.parse(r,this);if(!x)return null;if(this.expectedType){const I=this.expectedType,C=x.type;if(I.kind!=="string"&&I.kind!=="number"&&I.kind!=="boolean"&&I.kind!=="object"&&I.kind!=="array"||C.kind!=="value")if(I.kind!=="color"&&I.kind!=="formatted"&&I.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string")if(I.kind!=="padding"||C.kind!=="value"&&C.kind!=="number"&&C.kind!=="array")if(I.kind!=="variableAnchorOffsetCollection"||C.kind!=="value"&&C.kind!=="array"){if(this.checkSubtype(I,C))return null}else x=f(x,I,l.typeAnnotation||"coerce");else x=f(x,I,l.typeAnnotation||"coerce");else x=f(x,I,l.typeAnnotation||"coerce");else x=f(x,I,l.typeAnnotation||"assert")}if(!(x instanceof Na)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const I=new $r;try{x=new Na(x.type,x.evaluate(I))}catch(C){return this.error(C.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,l,f){const m=typeof r=="number"?this.path.concat(r):this.path,y=f?this.scope.concat(f):this.scope;return new zn(this.registry,this._isConstant,m,l||null,y,this.errors)}error(r,...l){const f=`${this.key}${l.map(m=>`[${m}]`).join("")}`;this.errors.push(new Un(f,r))}checkSubtype(r,l){const f=_e(r,l);return f&&this.error(f),f}}class Ma{constructor(r,l){this.type=l.type,this.bindings=[].concat(r),this.result=l}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const l of this.bindings)r(l[1]);r(this.result)}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const f=[];for(let y=1;y<r.length-1;y+=2){const x=r[y];if(typeof x!="string")return l.error(`Expected string, but found ${typeof x} instead.`,y);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",y);const I=l.parse(r[y+1],y+1);if(!I)return null;f.push([x,I])}const m=l.parse(r[r.length-1],r.length-1,l.expectedType,f);return m?new Ma(f,m):null}outputDefined(){return this.result.outputDefined()}}class fe{constructor(r,l){this.type=l.type,this.name=r,this.boundExpression=l}static parse(r,l){if(r.length!==2||typeof r[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const f=r[1];return l.scope.has(f)?new fe(f,l.scope.get(f)):l.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class zt{constructor(r,l,f){this.type=r,this.index=l,this.input=f}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const f=l.parse(r[1],1,Ne),m=l.parse(r[2],2,j(l.expectedType||Qt));return f&&m?new zt(m.type.itemType,f,m):null}evaluate(r){const l=this.index.evaluate(r),f=this.input.evaluate(r);if(l<0)throw new Xn(`Array index out of bounds: ${l} < 0.`);if(l>=f.length)throw new Xn(`Array index out of bounds: ${l} > ${f.length-1}.`);if(l!==Math.floor(l))throw new Xn(`Array index must be an integer, but found ${l} instead.`);return f[l]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Nn{constructor(r,l){this.type=Zt,this.needle=r,this.haystack=l}static parse(r,l){if(r.length!==3)return l.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const f=l.parse(r[1],1,Qt),m=l.parse(r[2],2,Qt);return f&&m?xe(f.type,[Zt,yt,Ne,Bn,Qt])?new Nn(f,m):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${H(f.type)} instead`):null}evaluate(r){const l=this.needle.evaluate(r),f=this.haystack.evaluate(r);if(!f)return!1;if(!we(l,["boolean","string","number","null"]))throw new Xn(`Expected first argument to be of type boolean, string, number or null, but found ${H(Ci(l))} instead.`);if(!we(f,["string","array"]))throw new Xn(`Expected second argument to be of type array or string, but found ${H(Ci(f))} instead.`);return f.indexOf(l)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class Hi{constructor(r,l,f){this.type=Ne,this.needle=r,this.haystack=l,this.fromIndex=f}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const f=l.parse(r[1],1,Qt),m=l.parse(r[2],2,Qt);if(!f||!m)return null;if(!xe(f.type,[Zt,yt,Ne,Bn,Qt]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${H(f.type)} instead`);if(r.length===4){const y=l.parse(r[3],3,Ne);return y?new Hi(f,m,y):null}return new Hi(f,m)}evaluate(r){const l=this.needle.evaluate(r),f=this.haystack.evaluate(r);if(!we(l,["boolean","string","number","null"]))throw new Xn(`Expected first argument to be of type boolean, string, number or null, but found ${H(Ci(l))} instead.`);if(!we(f,["string","array"]))throw new Xn(`Expected second argument to be of type array or string, but found ${H(Ci(f))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(r);return f.indexOf(l,m)}return f.indexOf(l)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Ra{constructor(r,l,f,m,y,x){this.inputType=r,this.type=l,this.input=f,this.cases=m,this.outputs=y,this.otherwise=x}static parse(r,l){if(r.length<5)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return l.error("Expected an even number of arguments.");let f,m;l.expectedType&&l.expectedType.kind!=="value"&&(m=l.expectedType);const y={},x=[];for(let D=2;D<r.length-1;D+=2){let z=r[D];const F=r[D+1];Array.isArray(z)||(z=[z]);const O=l.concat(D);if(z.length===0)return O.error("Expected at least one branch label.");for(const G of z){if(typeof G!="number"&&typeof G!="string")return O.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return O.error("Numeric branch labels must be integer values.");if(f){if(O.checkSubtype(f,Ci(G)))return null}else f=Ci(G);if(y[String(G)]!==void 0)return O.error("Branch labels must be unique.");y[String(G)]=x.length}const q=l.parse(F,D,m);if(!q)return null;m=m||q.type,x.push(q)}const I=l.parse(r[1],1,Qt);if(!I)return null;const C=l.parse(r[r.length-1],r.length-1,m);return C?I.type.kind!=="value"&&l.concat(1).checkSubtype(f,I.type)?null:new Ra(f,m,I,y,x,C):null}evaluate(r){const l=this.input.evaluate(r);return(Ci(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class Lr{constructor(r,l,f){this.type=r,this.branches=l,this.otherwise=f}static parse(r,l){if(r.length<4)return l.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return l.error("Expected an odd number of arguments.");let f;l.expectedType&&l.expectedType.kind!=="value"&&(f=l.expectedType);const m=[];for(let x=1;x<r.length-1;x+=2){const I=l.parse(r[x],x,Zt);if(!I)return null;const C=l.parse(r[x+1],x+1,f);if(!C)return null;m.push([I,C]),f=f||C.type}const y=l.parse(r[r.length-1],r.length-1,f);if(!y)return null;if(!f)throw new Error("Can't infer output type");return new Lr(f,m,y)}evaluate(r){for(const[l,f]of this.branches)if(l.evaluate(r))return f.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[l,f]of this.branches)r(l),r(f);r(this.otherwise)}outputDefined(){return this.branches.every(([r,l])=>l.outputDefined())&&this.otherwise.outputDefined()}}class Wr{constructor(r,l,f,m){this.type=r,this.input=l,this.beginIndex=f,this.endIndex=m}static parse(r,l){if(r.length<=2||r.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const f=l.parse(r[1],1,Qt),m=l.parse(r[2],2,Ne);if(!f||!m)return null;if(!xe(f.type,[j(Qt),yt,Qt]))return l.error(`Expected first argument to be of type array or string, but found ${H(f.type)} instead`);if(r.length===4){const y=l.parse(r[3],3,Ne);return y?new Wr(f.type,f,m,y):null}return new Wr(f.type,f,m)}evaluate(r){const l=this.input.evaluate(r),f=this.beginIndex.evaluate(r);if(!we(l,["string","array"]))throw new Xn(`Expected first argument to be of type array or string, but found ${H(Ci(l))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(r);return l.slice(f,m)}return l.slice(f)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function is(s,r){const l=s.length-1;let f,m,y=0,x=l,I=0;for(;y<=x;)if(I=Math.floor((y+x)/2),f=s[I],m=s[I+1],f<=r){if(I===l||r<m)return I;y=I+1}else{if(!(f>r))throw new Xn("Input is not a number.");x=I-1}return 0}class fo{constructor(r,l,f){this.type=r,this.input=l,this.labels=[],this.outputs=[];for(const[m,y]of f)this.labels.push(m),this.outputs.push(y)}static parse(r,l){if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return l.error("Expected an even number of arguments.");const f=l.parse(r[1],1,Ne);if(!f)return null;const m=[];let y=null;l.expectedType&&l.expectedType.kind!=="value"&&(y=l.expectedType);for(let x=1;x<r.length;x+=2){const I=x===1?-1/0:r[x],C=r[x+1],D=x,z=x+1;if(typeof I!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(m.length&&m[m.length-1][0]>=I)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const F=l.parse(C,z,y);if(!F)return null;y=y||F.type,m.push([I,F])}return new fo(y,f,m)}evaluate(r){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(r);const m=this.input.evaluate(r);if(m<=l[0])return f[0].evaluate(r);const y=l.length;return m>=l[y-1]?f[y-1].evaluate(r):f[is(l,m)].evaluate(r)}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function po(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Fu=rs;function rs(s,r,l,f){this.cx=3*s,this.bx=3*(l-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(f-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=r,this.p2x=l,this.p2y=f}rs.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,r){if(r===void 0&&(r=1e-6),s<0)return 0;if(s>1)return 1;for(var l=s,f=0;f<8;f++){var m=this.sampleCurveX(l)-s;if(Math.abs(m)<r)return l;var y=this.sampleCurveDerivativeX(l);if(Math.abs(y)<1e-6)break;l-=m/y}var x=0,I=1;for(l=s,f=0;f<20&&(m=this.sampleCurveX(l),!(Math.abs(m-s)<r));f++)s>m?x=l:I=l,l=.5*(I-x)+x;return l},solve:function(s,r){return this.sampleCurveY(this.solveCurveX(s,r))}};var ms=po(Fu);function ma(s,r,l){return s+l*(r-s)}function Ol(s,r,l){return s.map((f,m)=>ma(f,r[m],l))}const Ir={number:ma,color:function(s,r,l,f="rgb"){switch(f){case"rgb":{const[m,y,x,I]=Ol(s.rgb,r.rgb,l);return new Vn(m,y,x,I,!1)}case"hcl":{const[m,y,x,I]=s.hcl,[C,D,z,F]=r.hcl;let O,q;if(isNaN(m)||isNaN(C))isNaN(m)?isNaN(C)?O=NaN:(O=C,x!==1&&x!==0||(q=D)):(O=m,z!==1&&z!==0||(q=y));else{let ke=C-m;C>m&&ke>180?ke-=360:C<m&&m-C>180&&(ke+=360),O=m+l*ke}const[G,$,ae,he]=function([ke,ge,Ie,Ze]){return ke=isNaN(ke)?0:ke*gn,nn([Ie,Math.cos(ke)*ge,Math.sin(ke)*ge,Ze])}([O,q??ma(y,D,l),ma(x,z,l),ma(I,F,l)]);return new Vn(G,$,ae,he,!1)}case"lab":{const[m,y,x,I]=nn(Ol(s.lab,r.lab,l));return new Vn(m,y,x,I,!1)}}},array:Ol,padding:function(s,r,l){return new Bi(Ol(s.values,r.values,l))},variableAnchorOffsetCollection:function(s,r,l){const f=s.values,m=r.values;if(f.length!==m.length)throw new Xn(`Cannot interpolate values of different length. from: ${s.toString()}, to: ${r.toString()}`);const y=[];for(let x=0;x<f.length;x+=2){if(f[x]!==m[x])throw new Xn(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${f[x]}, to[${x}]: ${m[x]}`);y.push(f[x]);const[I,C]=f[x+1],[D,z]=m[x+1];y.push([ma(I,D,l),ma(C,z,l)])}return new wr(y)}};class Fi{constructor(r,l,f,m,y){this.type=r,this.operator=l,this.interpolation=f,this.input=m,this.labels=[],this.outputs=[];for(const[x,I]of y)this.labels.push(x),this.outputs.push(I)}static interpolationFactor(r,l,f,m){let y=0;if(r.name==="exponential")y=_s(l,r.base,f,m);else if(r.name==="linear")y=_s(l,1,f,m);else if(r.name==="cubic-bezier"){const x=r.controlPoints;y=new ms(x[0],x[1],x[2],x[3]).solve(_s(l,1,f,m))}return y}static parse(r,l){let[f,m,y,...x]=r;if(!Array.isArray(m)||m.length===0)return l.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const D=m[1];if(typeof D!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:D}}else{if(m[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const D=m.slice(1);if(D.length!==4||D.some(z=>typeof z!="number"||z<0||z>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:D}}}if(r.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(y=l.parse(y,2,Ne),!y)return null;const I=[];let C=null;f==="interpolate-hcl"||f==="interpolate-lab"?C=ti:l.expectedType&&l.expectedType.kind!=="value"&&(C=l.expectedType);for(let D=0;D<x.length;D+=2){const z=x[D],F=x[D+1],O=D+3,q=D+4;if(typeof z!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(I.length&&I[I.length-1][0]>=z)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const G=l.parse(F,q,C);if(!G)return null;C=C||G.type,I.push([z,G])}return de(C,Ne)||de(C,ti)||de(C,Oi)||de(C,V)||de(C,j(Ne))?new Fi(C,f,m,y,I):l.error(`Type ${H(C)} is not interpolatable.`)}evaluate(r){const l=this.labels,f=this.outputs;if(l.length===1)return f[0].evaluate(r);const m=this.input.evaluate(r);if(m<=l[0])return f[0].evaluate(r);const y=l.length;if(m>=l[y-1])return f[y-1].evaluate(r);const x=is(l,m),I=Fi.interpolationFactor(this.interpolation,m,l[x],l[x+1]),C=f[x].evaluate(r),D=f[x+1].evaluate(r);switch(this.operator){case"interpolate":return Ir[this.type.kind](C,D,I);case"interpolate-hcl":return Ir.color(C,D,I,"hcl");case"interpolate-lab":return Ir.color(C,D,I,"lab")}}eachChild(r){r(this.input);for(const l of this.outputs)r(l)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function _s(s,r,l,f){const m=f-l,y=s-l;return m===0?0:r===1?y/m:(Math.pow(r,y)-1)/(Math.pow(r,m)-1)}class Jo{constructor(r,l){this.type=r,this.args=l}static parse(r,l){if(r.length<2)return l.error("Expectected at least one argument.");let f=null;const m=l.expectedType;m&&m.kind!=="value"&&(f=m);const y=[];for(const I of r.slice(1)){const C=l.parse(I,1+y.length,f,void 0,{typeAnnotation:"omit"});if(!C)return null;f=f||C.type,y.push(C)}if(!f)throw new Error("No output type");const x=m&&y.some(I=>_e(m,I.type));return new Jo(x?Qt:f,y)}evaluate(r){let l,f=null,m=0;for(const y of this.args)if(m++,f=y.evaluate(r),f&&f instanceof or&&!f.available&&(l||(l=f.name),f=null,m===this.args.length&&(f=l)),f!==null)break;return f}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function gs(s,r){return s==="=="||s==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Ko(s,r,l,f){return f.compare(r,l)===0}function ys(s,r,l){const f=s!=="=="&&s!=="!=";return class e4{constructor(y,x,I){this.type=Zt,this.lhs=y,this.rhs=x,this.collator=I,this.hasUntypedArgument=y.type.kind==="value"||x.type.kind==="value"}static parse(y,x){if(y.length!==3&&y.length!==4)return x.error("Expected two or three arguments.");const I=y[0];let C=x.parse(y[1],1,Qt);if(!C)return null;if(!gs(I,C.type))return x.concat(1).error(`"${I}" comparisons are not supported for type '${H(C.type)}'.`);let D=x.parse(y[2],2,Qt);if(!D)return null;if(!gs(I,D.type))return x.concat(2).error(`"${I}" comparisons are not supported for type '${H(D.type)}'.`);if(C.type.kind!==D.type.kind&&C.type.kind!=="value"&&D.type.kind!=="value")return x.error(`Cannot compare types '${H(C.type)}' and '${H(D.type)}'.`);f&&(C.type.kind==="value"&&D.type.kind!=="value"?C=new tr(D.type,[C]):C.type.kind!=="value"&&D.type.kind==="value"&&(D=new tr(C.type,[D])));let z=null;if(y.length===4){if(C.type.kind!=="string"&&D.type.kind!=="string"&&C.type.kind!=="value"&&D.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(z=x.parse(y[3],3,qi),!z)return null}return new e4(C,D,z)}evaluate(y){const x=this.lhs.evaluate(y),I=this.rhs.evaluate(y);if(f&&this.hasUntypedArgument){const C=Ci(x),D=Ci(I);if(C.kind!==D.kind||C.kind!=="string"&&C.kind!=="number")throw new Xn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${C.kind}, ${D.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const C=Ci(x),D=Ci(I);if(C.kind!=="string"||D.kind!=="string")return r(y,x,I)}return this.collator?l(y,x,I,this.collator.evaluate(y)):r(y,x,I)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const Nu=ys("==",function(s,r,l){return r===l},Ko),bs=ys("!=",function(s,r,l){return r!==l},function(s,r,l,f){return!Ko(0,r,l,f)}),Aa=ys("<",function(s,r,l){return r<l},function(s,r,l,f){return f.compare(r,l)<0}),Oa=ys(">",function(s,r,l){return r>l},function(s,r,l,f){return f.compare(r,l)>0}),mo=ys("<=",function(s,r,l){return r<=l},function(s,r,l,f){return f.compare(r,l)<=0}),Ru=ys(">=",function(s,r,l){return r>=l},function(s,r,l,f){return f.compare(r,l)>=0});class Ul{constructor(r,l,f){this.type=qi,this.locale=f,this.caseSensitive=r,this.diacriticSensitive=l}static parse(r,l){if(r.length!==2)return l.error("Expected one argument.");const f=r[1];if(typeof f!="object"||Array.isArray(f))return l.error("Collator options argument must be an object.");const m=l.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Zt);if(!m)return null;const y=l.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Zt);if(!y)return null;let x=null;return f.locale&&(x=l.parse(f.locale,1,yt),!x)?null:new Ul(m,y,x)}evaluate(r){return new Ta(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class Ou{constructor(r,l,f,m,y){this.type=yt,this.number=r,this.locale=l,this.currency=f,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(r,l){if(r.length!==3)return l.error("Expected two arguments.");const f=l.parse(r[1],1,Ne);if(!f)return null;const m=r[2];if(typeof m!="object"||Array.isArray(m))return l.error("NumberFormat options argument must be an object.");let y=null;if(m.locale&&(y=l.parse(m.locale,1,yt),!y))return null;let x=null;if(m.currency&&(x=l.parse(m.currency,1,yt),!x))return null;let I=null;if(m["min-fraction-digits"]&&(I=l.parse(m["min-fraction-digits"],1,Ne),!I))return null;let C=null;return m["max-fraction-digits"]&&(C=l.parse(m["max-fraction-digits"],1,Ne),!C)?null:new Ou(f,y,x,I,C)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class Vl{constructor(r){this.type=ar,this.sections=r}static parse(r,l){if(r.length<2)return l.error("Expected at least one argument.");const f=r[1];if(!Array.isArray(f)&&typeof f=="object")return l.error("First argument must be an image or text section.");const m=[];let y=!1;for(let x=1;x<=r.length-1;++x){const I=r[x];if(y&&typeof I=="object"&&!Array.isArray(I)){y=!1;let C=null;if(I["font-scale"]&&(C=l.parse(I["font-scale"],1,Ne),!C))return null;let D=null;if(I["text-font"]&&(D=l.parse(I["text-font"],1,j(yt)),!D))return null;let z=null;if(I["text-color"]&&(z=l.parse(I["text-color"],1,ti),!z))return null;const F=m[m.length-1];F.scale=C,F.font=D,F.textColor=z}else{const C=l.parse(r[x],1,Qt);if(!C)return null;const D=C.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,m.push({content:C,scale:null,font:null,textColor:null})}}return new Vl(m)}evaluate(r){return new _i(this.sections.map(l=>{const f=l.content.evaluate(r);return Ci(f)===ie?new uo("",f,null,null,null):new uo(pa(f),null,l.scale?l.scale.evaluate(r):null,l.font?l.font.evaluate(r).join(","):null,l.textColor?l.textColor.evaluate(r):null)}))}eachChild(r){for(const l of this.sections)r(l.content),l.scale&&r(l.scale),l.font&&r(l.font),l.textColor&&r(l.textColor)}outputDefined(){return!1}}class Rs{constructor(r){this.type=ie,this.input=r}static parse(r,l){if(r.length!==2)return l.error("Expected two arguments.");const f=l.parse(r[1],1,yt);return f?new Rs(f):l.error("No image name provided.")}evaluate(r){const l=this.input.evaluate(r),f=or.fromString(l);return f&&r.availableImages&&(f.available=r.availableImages.indexOf(l)>-1),f}eachChild(r){r(this.input)}outputDefined(){return!1}}class Wi{constructor(r){this.type=Ne,this.input=r}static parse(r,l){if(r.length!==2)return l.error(`Expected 1 argument, but found ${r.length-1} instead.`);const f=l.parse(r[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${H(f.type)} instead.`):new Wi(f):null}evaluate(r){const l=this.input.evaluate(r);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Xn(`Expected value to be of type string or array, but found ${H(Ci(l))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const lr=8192;function sn(s,r){const l=(180+s[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,m=Math.pow(2,r.z);return[Math.round(l*m*lr),Math.round(f*m*lr)]}function Os(s,r){const l=Math.pow(2,r.z);return[(m=(s[0]/lr+r.x)/l,360*m-180),(f=(s[1]/lr+r.y)/l,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,m}function Zi(s,r){s[0]=Math.min(s[0],r[0]),s[1]=Math.min(s[1],r[1]),s[2]=Math.max(s[2],r[0]),s[3]=Math.max(s[3],r[1])}function ki(s,r){return!(s[0]<=r[0]||s[2]>=r[2]||s[1]<=r[1]||s[3]>=r[3])}function Vh(s,r,l){const f=s[0]-r[0],m=s[1]-r[1],y=s[0]-l[0],x=s[1]-l[1];return f*x-y*m==0&&f*y<=0&&m*x<=0}function as(s,r,l,f){return(m=[f[0]-l[0],f[1]-l[1]])[0]*(y=[r[0]-s[0],r[1]-s[1]])[1]-m[1]*y[0]!=0&&!(!Sn(s,r,l,f)||!Sn(l,f,s,r));var m,y}function jh(s,r,l){for(const f of l)for(let m=0;m<f.length-1;++m)if(as(s,r,f[m],f[m+1]))return!0;return!1}function xt(s,r,l=!1){let f=!1;for(const I of r)for(let C=0;C<I.length-1;C++){if(Vh(s,I[C],I[C+1]))return l;(y=I[C])[1]>(m=s)[1]!=(x=I[C+1])[1]>m[1]&&m[0]<(x[0]-y[0])*(m[1]-y[1])/(x[1]-y[1])+y[0]&&(f=!f)}var m,y,x;return f}function Qi(s,r){for(const l of r)if(xt(s,l))return!0;return!1}function Ni(s,r){for(const l of s)if(!xt(l,r))return!1;for(let l=0;l<s.length-1;++l)if(jh(s[l],s[l+1],r))return!1;return!0}function Us(s,r){for(const l of r)if(Ni(s,l))return!0;return!1}function Sn(s,r,l,f){const m=f[0]-l[0],y=f[1]-l[1],x=(s[0]-l[0])*y-m*(s[1]-l[1]),I=(r[0]-l[0])*y-m*(r[1]-l[1]);return x>0&&I<0||x<0&&I>0}function Tr(s,r,l){const f=[];for(let m=0;m<s.length;m++){const y=[];for(let x=0;x<s[m].length;x++){const I=sn(s[m][x],l);Zi(r,I),y.push(I)}f.push(y)}return f}function jl(s,r,l){const f=[];for(let m=0;m<s.length;m++){const y=Tr(s[m],r,l);f.push(y)}return f}function ql(s,r,l,f){if(s[0]<l[0]||s[0]>l[2]){const m=.5*f;let y=s[0]-l[0]>m?-f:l[0]-s[0]>m?f:0;y===0&&(y=s[0]-l[2]>m?-f:l[2]-s[0]>m?f:0),s[0]+=y}Zi(r,s)}function Hl(s,r,l,f){const m=Math.pow(2,f.z)*lr,y=[f.x*lr,f.y*lr],x=[];for(const I of s)for(const C of I){const D=[C.x+y[0],C.y+y[1]];ql(D,r,l,m),x.push(D)}return x}function _o(s,r,l,f){const m=Math.pow(2,f.z)*lr,y=[f.x*lr,f.y*lr],x=[];for(const C of s){const D=[];for(const z of C){const F=[z.x+y[0],z.y+y[1]];Zi(r,F),D.push(F)}x.push(D)}if(r[2]-r[0]<=m/2){(I=r)[0]=I[1]=1/0,I[2]=I[3]=-1/0;for(const C of x)for(const D of C)ql(D,r,l,m)}var I;return x}class vs{constructor(r,l){this.type=Zt,this.geojson=r,this.geometries=l}static parse(r,l){if(r.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Sr(r[1])){const f=r[1];if(f.type==="FeatureCollection"){const m=[];for(const y of f.features){const{type:x,coordinates:I}=y.geometry;x==="Polygon"&&m.push(I),x==="MultiPolygon"&&m.push(...I)}if(m.length)return new vs(f,{type:"MultiPolygon",coordinates:m})}else if(f.type==="Feature"){const m=f.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new vs(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new vs(f,f)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(l,f){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(f.type==="Polygon"){const I=Tr(f.coordinates,y,x),C=Hl(l.geometry(),m,y,x);if(!ki(m,y))return!1;for(const D of C)if(!xt(D,I))return!1}if(f.type==="MultiPolygon"){const I=jl(f.coordinates,y,x),C=Hl(l.geometry(),m,y,x);if(!ki(m,y))return!1;for(const D of C)if(!Qi(D,I))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(l,f){const m=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(f.type==="Polygon"){const I=Tr(f.coordinates,y,x),C=_o(l.geometry(),m,y,x);if(!ki(m,y))return!1;for(const D of C)if(!Ni(D,I))return!1}if(f.type==="MultiPolygon"){const I=jl(f.coordinates,y,x),C=_o(l.geometry(),m,y,x);if(!ki(m,y))return!1;for(const D of C)if(!Us(D,I))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Uu=class{constructor(s=[],r=Nc){if(this.data=s,this.length=this.data.length,this.compare=r,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(s){this.data.push(s),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const s=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),s}peek(){return this.data[0]}_up(s){const{data:r,compare:l}=this,f=r[s];for(;s>0;){const m=s-1>>1,y=r[m];if(l(f,y)>=0)break;r[s]=y,s=m}r[s]=f}_down(s){const{data:r,compare:l}=this,f=this.length>>1,m=r[s];for(;s<f;){let y=1+(s<<1),x=r[y];const I=y+1;if(I<this.length&&l(r[I],x)<0&&(y=I,x=r[I]),l(x,m)>=0)break;r[s]=x,s=y}r[s]=m}};function Nc(s,r){return s<r?-1:s>r?1:0}function qh(s,r,l,f,m){Wl(s,r,l,f||s.length-1,m||Rc)}function Wl(s,r,l,f,m){for(;f>l;){if(f-l>600){var y=f-l+1,x=r-l+1,I=Math.log(y),C=.5*Math.exp(2*I/3),D=.5*Math.sqrt(I*C*(y-C)/y)*(x-y/2<0?-1:1);Wl(s,r,Math.max(l,Math.floor(r-x*C/y+D)),Math.min(f,Math.floor(r+(y-x)*C/y+D)),m)}var z=s[r],F=l,O=f;for(Vs(s,l,r),m(s[f],z)>0&&Vs(s,l,f);F<O;){for(Vs(s,F,O),F++,O--;m(s[F],z)<0;)F++;for(;m(s[O],z)>0;)O--}m(s[l],z)===0?Vs(s,l,O):Vs(s,++O,f),O<=r&&(l=O+1),r<=O&&(f=O-1)}}function Vs(s,r,l){var f=s[r];s[r]=s[l],s[l]=f}function Rc(s,r){return s<r?-1:s>r?1:0}function go(s,r){if(s.length<=1)return[s];const l=[];let f,m;for(const y of s){const x=Oc(y);x!==0&&(y.area=Math.abs(x),m===void 0&&(m=x<0),m===x<0?(f&&l.push(f),f=[y]):f.push(y))}if(f&&l.push(f),r>1)for(let y=0;y<l.length;y++)l[y].length<=r||(qh(l[y],r,1,l[y].length-1,Vu),l[y]=l[y].slice(0,r));return l}function Vu(s,r){return r.area-s.area}function Oc(s){let r=0;for(let l,f,m=0,y=s.length,x=y-1;m<y;x=m++)l=s[m],f=s[x],r+=(f.x-l.x)*(l.y+f.y);return r}const ju=1/298.257223563,qu=ju*(2-ju),nr=Math.PI/180;class Xo{constructor(r){const l=6378.137*nr*1e3,f=Math.cos(r*nr),m=1/(1-qu*(1-f*f)),y=Math.sqrt(m);this.kx=l*y*f,this.ky=l*y*m*(1-qu)}distance(r,l){const f=this.wrap(r[0]-l[0])*this.kx,m=(r[1]-l[1])*this.ky;return Math.sqrt(f*f+m*m)}pointOnLine(r,l){let f,m,y,x,I=1/0;for(let C=0;C<r.length-1;C++){let D=r[C][0],z=r[C][1],F=this.wrap(r[C+1][0]-D)*this.kx,O=(r[C+1][1]-z)*this.ky,q=0;F===0&&O===0||(q=(this.wrap(l[0]-D)*this.kx*F+(l[1]-z)*this.ky*O)/(F*F+O*O),q>1?(D=r[C+1][0],z=r[C+1][1]):q>0&&(D+=F/this.kx*q,z+=O/this.ky*q)),F=this.wrap(l[0]-D)*this.kx,O=(l[1]-z)*this.ky;const G=F*F+O*O;G<I&&(I=G,f=D,m=z,y=C,x=q)}return{point:[f,m],index:y,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Zl(s,r){return r[0]-s[0]}function yo(s){return s[1]-s[0]+1}function Ca(s,r){return s[1]>=s[0]&&s[1]<r}function Qo(s,r){if(s[0]>s[1])return[null,null];const l=yo(s);if(r){if(l===2)return[s,null];const m=Math.floor(l/2);return[[s[0],s[0]+m],[s[0]+m,s[1]]]}if(l===1)return[s,null];const f=Math.floor(l/2)-1;return[[s[0],s[0]+f],[s[0]+f+1,s[1]]]}function Uc(s,r){if(!Ca(r,s.length))return[1/0,1/0,-1/0,-1/0];const l=[1/0,1/0,-1/0,-1/0];for(let f=r[0];f<=r[1];++f)Zi(l,s[f]);return l}function $o(s){const r=[1/0,1/0,-1/0,-1/0];for(const l of s)for(const f of l)Zi(r,f);return r}function vi(s){return s[0]!==-1/0&&s[1]!==-1/0&&s[2]!==1/0&&s[3]!==1/0}function Vc(s,r,l){if(!vi(s)||!vi(r))return NaN;let f=0,m=0;return s[2]<r[0]&&(f=r[0]-s[2]),s[0]>r[2]&&(f=s[0]-r[2]),s[1]>r[3]&&(m=s[1]-r[3]),s[3]<r[1]&&(m=r[1]-s[3]),l.distance([0,0],[f,m])}function dn(s,r,l){const f=l.pointOnLine(r,s);return l.distance(s,f.point)}function js(s,r,l,f,m){const y=Math.min(dn(s,[l,f],m),dn(r,[l,f],m)),x=Math.min(dn(l,[s,r],m),dn(f,[s,r],m));return Math.min(y,x)}function xi(s,r,l,f,m){if(!Ca(r,s.length)||!Ca(f,l.length))return 1/0;let y=1/0;for(let x=r[0];x<r[1];++x){const I=s[x],C=s[x+1];for(let D=f[0];D<f[1];++D){const z=l[D],F=l[D+1];if(as(I,C,z,F))return 0;y=Math.min(y,js(I,C,z,F,m))}}return y}function oi(s,r,l,f,m){if(!Ca(r,s.length)||!Ca(f,l.length))return NaN;let y=1/0;for(let x=r[0];x<=r[1];++x)for(let I=f[0];I<=f[1];++I)if(y=Math.min(y,m.distance(s[x],l[I])),y===0)return y;return y}function bo(s,r,l){if(xt(s,r,!0))return 0;let f=1/0;for(const m of r){const y=m[0],x=m[m.length-1];if(y!==x&&(f=Math.min(f,dn(s,[x,y],l)),f===0))return f;const I=l.pointOnLine(m,s);if(f=Math.min(f,l.distance(s,I.point)),f===0)return f}return f}function Hu(s,r,l,f){if(!Ca(r,s.length))return NaN;for(let y=r[0];y<=r[1];++y)if(xt(s[y],l,!0))return 0;let m=1/0;for(let y=r[0];y<r[1];++y){const x=s[y],I=s[y+1];for(const C of l)for(let D=0,z=C.length,F=z-1;D<z;F=D++){const O=C[F],q=C[D];if(as(x,I,O,q))return 0;m=Math.min(m,js(x,I,O,q,f))}}return m}function el(s,r){for(const l of s)for(const f of l)if(xt(f,r,!0))return!0;return!1}function jc(s,r,l,f=1/0){const m=$o(s),y=$o(r);if(f!==1/0&&Vc(m,y,l)>=f)return f;if(ki(m,y)){if(el(s,r))return 0}else if(el(r,s))return 0;let x=1/0;for(const I of s)for(let C=0,D=I.length,z=D-1;C<D;z=C++){const F=I[z],O=I[C];for(const q of r)for(let G=0,$=q.length,ae=$-1;G<$;ae=G++){const he=q[ae],ke=q[G];if(as(F,O,he,ke))return 0;x=Math.min(x,js(F,O,he,ke,l))}}return x}function Wu(s,r,l,f,m,y){if(!y)return;const x=Vc(Uc(f,y),m,l);x<r&&s.push([x,y,[0,0]])}function vo(s,r,l,f,m,y,x){if(!y||!x)return;const I=Vc(Uc(f,y),Uc(m,x),l);I<r&&s.push([I,y,x])}function xo(s,r,l,f,m=1/0){let y=Math.min(f.distance(s[0],l[0][0]),m);if(y===0)return y;const x=new Uu([[0,[0,s.length-1],[0,0]]],Zl),I=$o(l);for(;x.length>0;){const C=x.pop();if(C[0]>=y)continue;const D=C[1],z=r?50:100;if(yo(D)<=z){if(!Ca(D,s.length))return NaN;if(r){const F=Hu(s,D,l,f);if(isNaN(F)||F===0)return F;y=Math.min(y,F)}else for(let F=D[0];F<=D[1];++F){const O=bo(s[F],l,f);if(y=Math.min(y,O),y===0)return 0}}else{const F=Qo(D,r);Wu(x,y,f,s,I,F[0]),Wu(x,y,f,s,I,F[1])}}return y}function tl(s,r,l,f,m,y=1/0){let x=Math.min(y,m.distance(s[0],l[0]));if(x===0)return x;const I=new Uu([[0,[0,s.length-1],[0,l.length-1]]],Zl);for(;I.length>0;){const C=I.pop();if(C[0]>=x)continue;const D=C[1],z=C[2],F=r?50:100,O=f?50:100;if(yo(D)<=F&&yo(z)<=O){if(!Ca(D,s.length)&&Ca(z,l.length))return NaN;let q;if(r&&f)q=xi(s,D,l,z,m),x=Math.min(x,q);else if(r&&!f){const G=s.slice(D[0],D[1]+1);for(let $=z[0];$<=z[1];++$)if(q=dn(l[$],G,m),x=Math.min(x,q),x===0)return x}else if(!r&&f){const G=l.slice(z[0],z[1]+1);for(let $=D[0];$<=D[1];++$)if(q=dn(s[$],G,m),x=Math.min(x,q),x===0)return x}else q=oi(s,D,l,z,m),x=Math.min(x,q)}else{const q=Qo(D,r),G=Qo(z,f);vo(I,x,m,s,l,q[0],G[0]),vo(I,x,m,s,l,q[0],G[1]),vo(I,x,m,s,l,q[1],G[0]),vo(I,x,m,s,l,q[1],G[1])}}return x}function wo(s){return s.type==="MultiPolygon"?s.coordinates.map(r=>({type:"Polygon",coordinates:r})):s.type==="MultiLineString"?s.coordinates.map(r=>({type:"LineString",coordinates:r})):s.type==="MultiPoint"?s.coordinates.map(r=>({type:"Point",coordinates:r})):[s]}class Ua{constructor(r,l){this.type=Ne,this.geojson=r,this.geometries=l}static parse(r,l){if(r.length!==2)return l.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Sr(r[1])){const f=r[1];if(f.type==="FeatureCollection")return new Ua(f,f.features.map(m=>wo(m.geometry)).flat());if(f.type==="Feature")return new Ua(f,wo(f.geometry));if("type"in f&&"coordinates"in f)return new Ua(f,wo(f))}return l.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(l,f){const m=l.geometry(),y=m.flat().map(C=>Os([C.x,C.y],l.canonical));if(m.length===0)return NaN;const x=new Xo(y[0][1]);let I=1/0;for(const C of f){switch(C.type){case"Point":I=Math.min(I,tl(y,!1,[C.coordinates],!1,x,I));break;case"LineString":I=Math.min(I,tl(y,!1,C.coordinates,!0,x,I));break;case"Polygon":I=Math.min(I,xo(y,!1,C.coordinates,x,I))}if(I===0)return I}return I}(r,this.geometries);if(r.geometryType()==="LineString")return function(l,f){const m=l.geometry(),y=m.flat().map(C=>Os([C.x,C.y],l.canonical));if(m.length===0)return NaN;const x=new Xo(y[0][1]);let I=1/0;for(const C of f){switch(C.type){case"Point":I=Math.min(I,tl(y,!0,[C.coordinates],!1,x,I));break;case"LineString":I=Math.min(I,tl(y,!0,C.coordinates,!0,x,I));break;case"Polygon":I=Math.min(I,xo(y,!0,C.coordinates,x,I))}if(I===0)return I}return I}(r,this.geometries);if(r.geometryType()==="Polygon")return function(l,f){const m=l.geometry();if(m.length===0||m[0].length===0)return NaN;const y=go(m,0).map(C=>C.map(D=>D.map(z=>Os([z.x,z.y],l.canonical)))),x=new Xo(y[0][0][0][1]);let I=1/0;for(const C of f)for(const D of y){switch(C.type){case"Point":I=Math.min(I,xo([C.coordinates],!1,D,x,I));break;case"LineString":I=Math.min(I,xo(C.coordinates,!0,D,x,I));break;case"Polygon":I=Math.min(I,jc(D,C.coordinates,x,I))}if(I===0)return I}return I}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const qs={"==":Nu,"!=":bs,">":Oa,"<":Aa,">=":Ru,"<=":mo,array:tr,at:zt,boolean:tr,case:Lr,coalesce:Jo,collator:Ul,format:Vl,image:Rs,in:Nn,"index-of":Hi,interpolate:Fi,"interpolate-hcl":Fi,"interpolate-lab":Fi,length:Wi,let:Ma,literal:Na,match:Ra,number:tr,"number-format":Ou,object:tr,slice:Wr,step:fo,string:tr,"to-boolean":Qr,"to-color":Qr,"to-number":Qr,"to-string":Qr,var:fe,within:vs,distance:Ua};class Mr{constructor(r,l,f,m){this.name=r,this.type=l,this._evaluate=f,this.args=m}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,l){const f=r[0],m=Mr.definitions[f];if(!m)return l.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,I=x.filter(([D])=>!Array.isArray(D)||D.length===r.length-1);let C=null;for(const[D,z]of I){C=new zn(l.registry,Hh,l.path,null,l.scope);const F=[];let O=!1;for(let q=1;q<r.length;q++){const G=r[q],$=Array.isArray(D)?D[q-1]:D.type,ae=C.parse(G,1+F.length,$);if(!ae){O=!0;break}F.push(ae)}if(!O)if(Array.isArray(D)&&D.length!==F.length)C.error(`Expected ${D.length} arguments, but found ${F.length} instead.`);else{for(let q=0;q<F.length;q++){const G=Array.isArray(D)?D[q]:D.type,$=F[q];C.concat(q+1).checkSubtype(G,$.type)}if(C.errors.length===0)return new Mr(f,y,z,F)}}if(I.length===1)l.errors.push(...C.errors);else{const D=(I.length?I:x).map(([F])=>{return O=F,Array.isArray(O)?`(${O.map(H).join(", ")})`:`(${H(O.type)}...)`;var O}).join(" | "),z=[];for(let F=1;F<r.length;F++){const O=l.parse(r[F],1+z.length);if(!O)return null;z.push(H(O.type))}l.error(`Expected arguments of type ${D}, but found (${z.join(", ")}) instead.`)}return null}static register(r,l){Mr.definitions=l;for(const f in l)r[f]=Mr}}function Gl(s,[r,l,f,m]){r=r.evaluate(s),l=l.evaluate(s),f=f.evaluate(s);const y=m?m.evaluate(s):1,x=Xr(r,l,f,y);if(x)throw new Xn(x);return new Vn(r/255,l/255,f/255,y,!1)}function Zu(s,r){return s in r}function qc(s,r){const l=r[s];return l===void 0?null:l}function Ar(s){return{type:s}}function Hh(s){if(s instanceof fe)return Hh(s.boundExpression);if(s instanceof Mr&&s.name==="error"||s instanceof Ul||s instanceof vs||s instanceof Ua)return!1;const r=s instanceof Qr||s instanceof tr;let l=!0;return s.eachChild(f=>{l=r?l&&Hh(f):l&&f instanceof Na}),!!l&&Wh(s)&&Zh(s,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Wh(s){if(s instanceof Mr&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof vs||s instanceof Ua)return!1;let r=!0;return s.eachChild(l=>{r&&!Wh(l)&&(r=!1)}),r}function Gu(s){if(s instanceof Mr&&s.name==="feature-state")return!1;let r=!0;return s.eachChild(l=>{r&&!Gu(l)&&(r=!1)}),r}function Zh(s,r){if(s instanceof Mr&&r.indexOf(s.name)>=0)return!1;let l=!0;return s.eachChild(f=>{l&&!Zh(f,r)&&(l=!1)}),l}function Mf(s){return{result:"success",value:s}}function Yl(s){return{result:"error",value:s}}function So(s){return s["property-type"]==="data-driven"||s["property-type"]==="cross-faded-data-driven"}function Ym(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Gh(s){return!!s.expression&&s.expression.interpolated}function Qn(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Hc(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Yh(s){return s}function Yu(s,r){const l=r.type==="color",f=s.stops&&typeof s.stops[0][0]=="object",m=f||!(f||s.property!==void 0),y=s.type||(Gh(r)?"exponential":"interval");if(l||r.type==="padding"){const z=l?Vn.parse:Bi.parse;(s=at({},s)).stops&&(s.stops=s.stops.map(F=>[F[0],z(F[1])])),s.default=z(s.default?s.default:r.default)}if(s.colorSpace&&(x=s.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${s.colorSpace}"`);var x;let I,C,D;if(y==="exponential")I=Cf;else if(y==="interval")I=Jm;else if(y==="categorical"){I=Af,C=Object.create(null);for(const z of s.stops)C[z[0]]=z[1];D=typeof s.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);I=Jh}if(f){const z={},F=[];for(let G=0;G<s.stops.length;G++){const $=s.stops[G],ae=$[0].zoom;z[ae]===void 0&&(z[ae]={zoom:ae,type:s.type,property:s.property,default:s.default,stops:[]},F.push(ae)),z[ae].stops.push([$[0].value,$[1]])}const O=[];for(const G of F)O.push([z[G].zoom,Yu(z[G],r)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:Fi.interpolationFactor.bind(void 0,q),zoomStops:O.map(G=>G[0]),evaluate:({zoom:G},$)=>Cf({stops:O,base:s.base},r,G).evaluate(G,$)}}if(m){const z=y==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:Fi.interpolationFactor.bind(void 0,z),zoomStops:s.stops.map(F=>F[0]),evaluate:({zoom:F})=>I(s,r,F,C,D)}}return{kind:"source",evaluate(z,F){const O=F&&F.properties?F.properties[s.property]:void 0;return O===void 0?Wc(s.default,r.default):I(s,r,O,C,D)}}}function Wc(s,r,l){return s!==void 0?s:r!==void 0?r:l!==void 0?l:void 0}function Af(s,r,l,f,m){return Wc(typeof l===m?f[l]:void 0,s.default,r.default)}function Jm(s,r,l){if(Qn(l)!=="number")return Wc(s.default,r.default);const f=s.stops.length;if(f===1||l<=s.stops[0][0])return s.stops[0][1];if(l>=s.stops[f-1][0])return s.stops[f-1][1];const m=is(s.stops.map(y=>y[0]),l);return s.stops[m][1]}function Cf(s,r,l){const f=s.base!==void 0?s.base:1;if(Qn(l)!=="number")return Wc(s.default,r.default);const m=s.stops.length;if(m===1||l<=s.stops[0][0])return s.stops[0][1];if(l>=s.stops[m-1][0])return s.stops[m-1][1];const y=is(s.stops.map(z=>z[0]),l),x=function(z,F,O,q){const G=q-O,$=z-O;return G===0?0:F===1?$/G:(Math.pow(F,$)-1)/(Math.pow(F,G)-1)}(l,f,s.stops[y][0],s.stops[y+1][0]),I=s.stops[y][1],C=s.stops[y+1][1],D=Ir[r.type]||Yh;return typeof I.evaluate=="function"?{evaluate(...z){const F=I.evaluate.apply(void 0,z),O=C.evaluate.apply(void 0,z);if(F!==void 0&&O!==void 0)return D(F,O,x,s.colorSpace)}}:D(I,C,x,s.colorSpace)}function Jh(s,r,l){switch(r.type){case"color":l=Vn.parse(l);break;case"formatted":l=_i.fromString(l.toString());break;case"resolvedImage":l=or.fromString(l.toString());break;case"padding":l=Bi.parse(l);break;default:Qn(l)===r.type||r.type==="enum"&&r.values[l]||(l=void 0)}return Wc(l,s.default,r.default)}Mr.register(qs,{error:[{kind:"error"},[yt],(s,[r])=>{throw new Xn(r.evaluate(s))}],typeof:[yt,[Qt],(s,[r])=>H(Ci(r.evaluate(s)))],"to-rgba":[j(Ne,4),[ti],(s,[r])=>{const[l,f,m,y]=r.evaluate(s).rgb;return[255*l,255*f,255*m,y]}],rgb:[ti,[Ne,Ne,Ne],Gl],rgba:[ti,[Ne,Ne,Ne,Ne],Gl],has:{type:Zt,overloads:[[[yt],(s,[r])=>Zu(r.evaluate(s),s.properties())],[[yt,Gn],(s,[r,l])=>Zu(r.evaluate(s),l.evaluate(s))]]},get:{type:Qt,overloads:[[[yt],(s,[r])=>qc(r.evaluate(s),s.properties())],[[yt,Gn],(s,[r,l])=>qc(r.evaluate(s),l.evaluate(s))]]},"feature-state":[Qt,[yt],(s,[r])=>qc(r.evaluate(s),s.featureState||{})],properties:[Gn,[],s=>s.properties()],"geometry-type":[yt,[],s=>s.geometryType()],id:[Qt,[],s=>s.id()],zoom:[Ne,[],s=>s.globals.zoom],"heatmap-density":[Ne,[],s=>s.globals.heatmapDensity||0],"line-progress":[Ne,[],s=>s.globals.lineProgress||0],accumulated:[Qt,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[Ne,Ar(Ne),(s,r)=>{let l=0;for(const f of r)l+=f.evaluate(s);return l}],"*":[Ne,Ar(Ne),(s,r)=>{let l=1;for(const f of r)l*=f.evaluate(s);return l}],"-":{type:Ne,overloads:[[[Ne,Ne],(s,[r,l])=>r.evaluate(s)-l.evaluate(s)],[[Ne],(s,[r])=>-r.evaluate(s)]]},"/":[Ne,[Ne,Ne],(s,[r,l])=>r.evaluate(s)/l.evaluate(s)],"%":[Ne,[Ne,Ne],(s,[r,l])=>r.evaluate(s)%l.evaluate(s)],ln2:[Ne,[],()=>Math.LN2],pi:[Ne,[],()=>Math.PI],e:[Ne,[],()=>Math.E],"^":[Ne,[Ne,Ne],(s,[r,l])=>Math.pow(r.evaluate(s),l.evaluate(s))],sqrt:[Ne,[Ne],(s,[r])=>Math.sqrt(r.evaluate(s))],log10:[Ne,[Ne],(s,[r])=>Math.log(r.evaluate(s))/Math.LN10],ln:[Ne,[Ne],(s,[r])=>Math.log(r.evaluate(s))],log2:[Ne,[Ne],(s,[r])=>Math.log(r.evaluate(s))/Math.LN2],sin:[Ne,[Ne],(s,[r])=>Math.sin(r.evaluate(s))],cos:[Ne,[Ne],(s,[r])=>Math.cos(r.evaluate(s))],tan:[Ne,[Ne],(s,[r])=>Math.tan(r.evaluate(s))],asin:[Ne,[Ne],(s,[r])=>Math.asin(r.evaluate(s))],acos:[Ne,[Ne],(s,[r])=>Math.acos(r.evaluate(s))],atan:[Ne,[Ne],(s,[r])=>Math.atan(r.evaluate(s))],min:[Ne,Ar(Ne),(s,r)=>Math.min(...r.map(l=>l.evaluate(s)))],max:[Ne,Ar(Ne),(s,r)=>Math.max(...r.map(l=>l.evaluate(s)))],abs:[Ne,[Ne],(s,[r])=>Math.abs(r.evaluate(s))],round:[Ne,[Ne],(s,[r])=>{const l=r.evaluate(s);return l<0?-Math.round(-l):Math.round(l)}],floor:[Ne,[Ne],(s,[r])=>Math.floor(r.evaluate(s))],ceil:[Ne,[Ne],(s,[r])=>Math.ceil(r.evaluate(s))],"filter-==":[Zt,[yt,Qt],(s,[r,l])=>s.properties()[r.value]===l.value],"filter-id-==":[Zt,[Qt],(s,[r])=>s.id()===r.value],"filter-type-==":[Zt,[yt],(s,[r])=>s.geometryType()===r.value],"filter-<":[Zt,[yt,Qt],(s,[r,l])=>{const f=s.properties()[r.value],m=l.value;return typeof f==typeof m&&f<m}],"filter-id-<":[Zt,[Qt],(s,[r])=>{const l=s.id(),f=r.value;return typeof l==typeof f&&l<f}],"filter->":[Zt,[yt,Qt],(s,[r,l])=>{const f=s.properties()[r.value],m=l.value;return typeof f==typeof m&&f>m}],"filter-id->":[Zt,[Qt],(s,[r])=>{const l=s.id(),f=r.value;return typeof l==typeof f&&l>f}],"filter-<=":[Zt,[yt,Qt],(s,[r,l])=>{const f=s.properties()[r.value],m=l.value;return typeof f==typeof m&&f<=m}],"filter-id-<=":[Zt,[Qt],(s,[r])=>{const l=s.id(),f=r.value;return typeof l==typeof f&&l<=f}],"filter->=":[Zt,[yt,Qt],(s,[r,l])=>{const f=s.properties()[r.value],m=l.value;return typeof f==typeof m&&f>=m}],"filter-id->=":[Zt,[Qt],(s,[r])=>{const l=s.id(),f=r.value;return typeof l==typeof f&&l>=f}],"filter-has":[Zt,[Qt],(s,[r])=>r.value in s.properties()],"filter-has-id":[Zt,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Zt,[j(yt)],(s,[r])=>r.value.indexOf(s.geometryType())>=0],"filter-id-in":[Zt,[j(Qt)],(s,[r])=>r.value.indexOf(s.id())>=0],"filter-in-small":[Zt,[yt,j(Qt)],(s,[r,l])=>l.value.indexOf(s.properties()[r.value])>=0],"filter-in-large":[Zt,[yt,j(Qt)],(s,[r,l])=>function(f,m,y,x){for(;y<=x;){const I=y+x>>1;if(m[I]===f)return!0;m[I]>f?x=I-1:y=I+1}return!1}(s.properties()[r.value],l.value,0,l.value.length-1)],all:{type:Zt,overloads:[[[Zt,Zt],(s,[r,l])=>r.evaluate(s)&&l.evaluate(s)],[Ar(Zt),(s,r)=>{for(const l of r)if(!l.evaluate(s))return!1;return!0}]]},any:{type:Zt,overloads:[[[Zt,Zt],(s,[r,l])=>r.evaluate(s)||l.evaluate(s)],[Ar(Zt),(s,r)=>{for(const l of r)if(l.evaluate(s))return!0;return!1}]]},"!":[Zt,[Zt],(s,[r])=>!r.evaluate(s)],"is-supported-script":[Zt,[yt],(s,[r])=>{const l=s.globals&&s.globals.isSupportedScript;return!l||l(r.evaluate(s))}],upcase:[yt,[yt],(s,[r])=>r.evaluate(s).toUpperCase()],downcase:[yt,[yt],(s,[r])=>r.evaluate(s).toLowerCase()],concat:[yt,Ar(Qt),(s,r)=>r.map(l=>pa(l.evaluate(s))).join("")],"resolved-locale":[yt,[qi],(s,[r])=>r.evaluate(s).resolvedLocale()]});class kf{constructor(r,l){var f;this.expression=r,this._warningHistory={},this._evaluator=new $r,this._defaultValue=l?(f=l).type==="color"&&Hc(f.default)?new Vn(0,0,0,0):f.type==="color"?Vn.parse(f.default)||null:f.type==="padding"?Bi.parse(f.default)||null:f.type==="variableAnchorOffsetCollection"?wr.parse(f.default)||null:f.default===void 0?null:f.default:null,this._enumValues=l&&l.type==="enum"?l.values:null}evaluateWithoutErrorHandling(r,l,f,m,y,x){return this._evaluator.globals=r,this._evaluator.feature=l,this._evaluator.featureState=f,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,l,f,m,y,x){this._evaluator.globals=r,this._evaluator.feature=l||null,this._evaluator.featureState=f||null,this._evaluator.canonical=m,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=x||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new Xn(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function Kh(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in qs}function Xh(s,r){const l=new zn(qs,Hh,[],r?function(m){const y={color:ti,string:yt,number:Ne,enum:yt,boolean:Zt,formatted:ar,padding:Oi,resolvedImage:ie,variableAnchorOffsetCollection:V};return m.type==="array"?j(y[m.value]||Qt,m.length):y[m.type]}(r):void 0),f=l.parse(s,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Mf(new kf(f,r)):Yl(l.errors)}class Ef{constructor(r,l){this.kind=r,this._styleExpression=l,this.isStateDependent=r!=="constant"&&!Gu(l.expression)}evaluateWithoutErrorHandling(r,l,f,m,y,x){return this._styleExpression.evaluateWithoutErrorHandling(r,l,f,m,y,x)}evaluate(r,l,f,m,y,x){return this._styleExpression.evaluate(r,l,f,m,y,x)}}class Df{constructor(r,l,f,m){this.kind=r,this.zoomStops=f,this._styleExpression=l,this.isStateDependent=r!=="camera"&&!Gu(l.expression),this.interpolationType=m}evaluateWithoutErrorHandling(r,l,f,m,y,x){return this._styleExpression.evaluateWithoutErrorHandling(r,l,f,m,y,x)}evaluate(r,l,f,m,y,x){return this._styleExpression.evaluate(r,l,f,m,y,x)}interpolationFactor(r,l,f){return this.interpolationType?Fi.interpolationFactor(this.interpolationType,r,l,f):0}}function Ju(s,r){const l=Xh(s,r);if(l.result==="error")return l;const f=l.value.expression,m=Wh(f);if(!m&&!So(r))return Yl([new Un("","data expressions not supported")]);const y=Zh(f,["zoom"]);if(!y&&!Ym(r))return Yl([new Un("","zoom expressions not supported")]);const x=ea(f);return x||y?x instanceof Un?Yl([x]):x instanceof Fi&&!Gh(r)?Yl([new Un("",'"interpolate" expressions cannot be used with this property')]):Mf(x?new Df(m?"camera":"composite",l.value,x.labels,x instanceof Fi?x.interpolation:void 0):new Ef(m?"constant":"source",l.value)):Yl([new Un("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Jl{constructor(r,l){this._parameters=r,this._specification=l,at(this,Yu(this._parameters,this._specification))}static deserialize(r){return new Jl(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function ea(s){let r=null;if(s instanceof Ma)r=ea(s.result);else if(s instanceof Jo){for(const l of s.args)if(r=ea(l),r)break}else(s instanceof fo||s instanceof Fi)&&s.input instanceof Mr&&s.input.name==="zoom"&&(r=s);return r instanceof Un||s.eachChild(l=>{const f=ea(l);f instanceof Un?r=f:!r&&f?r=new Un("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&f&&r!==f&&(r=new Un("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function Kl(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const r of s.slice(1))if(!Kl(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const Km={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Pf(s){if(s==null)return{filter:()=>!0,needGeometry:!1};Kl(s)||(s=Ku(s));const r=Xh(s,Km);if(r.result==="error")throw new Error(r.value.map(l=>`${l.key}: ${l.message}`).join(", "));return{filter:(l,f,m)=>r.value.evaluate(l,f,{},m),needGeometry:Zc(s)}}function Bg(s,r){return s<r?-1:s>r?1:0}function Zc(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let r=1;r<s.length;r++)if(Zc(s[r]))return!0;return!1}function Ku(s){if(!s)return!0;const r=s[0];return s.length<=1?r!=="any":r==="=="?Xu(s[1],s[2],"=="):r==="!="?$h(Xu(s[1],s[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Xu(s[1],s[2],r):r==="any"?(l=s.slice(1),["any"].concat(l.map(Ku))):r==="all"?["all"].concat(s.slice(1).map(Ku)):r==="none"?["all"].concat(s.slice(1).map(Ku).map($h)):r==="in"?Xm(s[1],s.slice(2)):r==="!in"?$h(Xm(s[1],s.slice(2))):r==="has"?Qh(s[1]):r!=="!has"||$h(Qh(s[1]));var l}function Xu(s,r,l){switch(s){case"$type":return[`filter-type-${l}`,r];case"$id":return[`filter-id-${l}`,r];default:return[`filter-${l}`,s,r]}}function Xm(s,r){if(r.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(l=>typeof l!=typeof r[0])?["filter-in-large",s,["literal",r.sort(Bg)]]:["filter-in-small",s,["literal",r]]}}function Qh(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function $h(s){return["!",s]}function Xl(s){const r=typeof s;if(r==="number"||r==="boolean"||r==="string"||s==null)return JSON.stringify(s);if(Array.isArray(s)){let m="[";for(const y of s)m+=`${Xl(y)},`;return`${m}]`}const l=Object.keys(s).sort();let f="{";for(let m=0;m<l.length;m++)f+=`${JSON.stringify(l[m])}:${Xl(s[l[m]])},`;return`${f}}`}function Fg(s){let r="";for(const l of wn)r+=`/${Xl(s[l])}`;return r}function ed(s){const r=s.value;return r?[new dt(s.key,r,"constants have been deprecated as of v8")]:[]}function Gi(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Io(s){if(Array.isArray(s))return s.map(Io);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const r={};for(const l in s)r[l]=Io(s[l]);return r}return Gi(s)}function Va(s){const r=s.key,l=s.value,f=s.valueSpec||{},m=s.objectElementValidators||{},y=s.style,x=s.styleSpec,I=s.validateSpec;let C=[];const D=Qn(l);if(D!=="object")return[new dt(r,l,`object expected, ${D} found`)];for(const z in l){const F=z.split(".")[0],O=f[F]||f["*"];let q;if(m[F])q=m[F];else if(f[F])q=I;else if(m["*"])q=m["*"];else{if(!f["*"]){C.push(new dt(r,l[z],`unknown property "${z}"`));continue}q=I}C=C.concat(q({key:(r&&`${r}.`)+z,value:l[z],valueSpec:O,style:y,styleSpec:x,object:l,objectKey:z,validateSpec:I},l))}for(const z in f)m[z]||f[z].required&&f[z].default===void 0&&l[z]===void 0&&C.push(new dt(r,l,`missing required property "${z}"`));return C}function td(s){const r=s.value,l=s.valueSpec,f=s.style,m=s.styleSpec,y=s.key,x=s.arrayElementValidator||s.validateSpec;if(Qn(r)!=="array")return[new dt(y,r,`array expected, ${Qn(r)} found`)];if(l.length&&r.length!==l.length)return[new dt(y,r,`array length ${l.length} expected, length ${r.length} found`)];if(l["min-length"]&&r.length<l["min-length"])return[new dt(y,r,`array length at least ${l["min-length"]} expected, length ${r.length} found`)];let I={type:l.value,values:l.values};m.$version<7&&(I.function=l.function),Qn(l.value)==="object"&&(I=l.value);let C=[];for(let D=0;D<r.length;D++)C=C.concat(x({array:r,arrayIndex:D,value:r[D],valueSpec:I,validateSpec:s.validateSpec,style:f,styleSpec:m,key:`${y}[${D}]`}));return C}function Lf(s){const r=s.key,l=s.value,f=s.valueSpec;let m=Qn(l);return m==="number"&&l!=l&&(m="NaN"),m!=="number"?[new dt(r,l,`number expected, ${m} found`)]:"minimum"in f&&l<f.minimum?[new dt(r,l,`${l} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&l>f.maximum?[new dt(r,l,`${l} is greater than the maximum value ${f.maximum}`)]:[]}function nd(s){const r=s.valueSpec,l=Gi(s.value.type);let f,m,y,x={};const I=l!=="categorical"&&s.value.property===void 0,C=!I,D=Qn(s.value.stops)==="array"&&Qn(s.value.stops[0])==="array"&&Qn(s.value.stops[0][0])==="object",z=Va({key:s.key,value:s.value,valueSpec:s.styleSpec.function,validateSpec:s.validateSpec,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(q){if(l==="identity")return[new dt(q.key,q.value,'identity function may not have a "stops" property')];let G=[];const $=q.value;return G=G.concat(td({key:q.key,value:$,valueSpec:q.valueSpec,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:F})),Qn($)==="array"&&$.length===0&&G.push(new dt(q.key,$,"array must have at least one stop")),G},default:function(q){return q.validateSpec({key:q.key,value:q.value,valueSpec:r,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec})}}});return l==="identity"&&I&&z.push(new dt(s.key,s.value,'missing required property "property"')),l==="identity"||s.value.stops||z.push(new dt(s.key,s.value,'missing required property "stops"')),l==="exponential"&&s.valueSpec.expression&&!Gh(s.valueSpec)&&z.push(new dt(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(C&&!So(s.valueSpec)?z.push(new dt(s.key,s.value,"property functions not supported")):I&&!Ym(s.valueSpec)&&z.push(new dt(s.key,s.value,"zoom functions not supported"))),l!=="categorical"&&!D||s.value.property!==void 0||z.push(new dt(s.key,s.value,'"property" property is required')),z;function F(q){let G=[];const $=q.value,ae=q.key;if(Qn($)!=="array")return[new dt(ae,$,`array expected, ${Qn($)} found`)];if($.length!==2)return[new dt(ae,$,`array length 2 expected, length ${$.length} found`)];if(D){if(Qn($[0])!=="object")return[new dt(ae,$,`object expected, ${Qn($[0])} found`)];if($[0].zoom===void 0)return[new dt(ae,$,"object stop key must have zoom")];if($[0].value===void 0)return[new dt(ae,$,"object stop key must have value")];if(y&&y>Gi($[0].zoom))return[new dt(ae,$[0].zoom,"stop zoom values must appear in ascending order")];Gi($[0].zoom)!==y&&(y=Gi($[0].zoom),m=void 0,x={}),G=G.concat(Va({key:`${ae}[0]`,value:$[0],valueSpec:{zoom:{}},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:Lf,value:O}}))}else G=G.concat(O({key:`${ae}[0]`,value:$[0],valueSpec:{},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec},$));return Kh(Io($[1]))?G.concat([new dt(`${ae}[1]`,$[1],"expressions are not allowed in function stops.")]):G.concat(q.validateSpec({key:`${ae}[1]`,value:$[1],valueSpec:r,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec}))}function O(q,G){const $=Qn(q.value),ae=Gi(q.value),he=q.value!==null?q.value:G;if(f){if($!==f)return[new dt(q.key,he,`${$} stop domain type must match previous stop domain type ${f}`)]}else f=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new dt(q.key,he,"stop domain value must be a number, string, or boolean")];if($!=="number"&&l!=="categorical"){let ke=`number expected, ${$} found`;return So(r)&&l===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new dt(q.key,he,ke)]}return l!=="categorical"||$!=="number"||isFinite(ae)&&Math.floor(ae)===ae?l!=="categorical"&&$==="number"&&m!==void 0&&ae<m?[new dt(q.key,he,"stop domain values must appear in ascending order")]:(m=ae,l==="categorical"&&ae in x?[new dt(q.key,he,"stop domain values must be unique")]:(x[ae]=!0,[])):[new dt(q.key,he,`integer expected, found ${ae}`)]}}function To(s){const r=(s.expressionContext==="property"?Ju:Xh)(Io(s.value),s.valueSpec);if(r.result==="error")return r.value.map(f=>new dt(`${s.key}${f.key}`,s.value,f.message));const l=r.value.expression||r.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!l.outputDefined())return[new dt(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Gu(l))return[new dt(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter"&&!Gu(l))return[new dt(s.key,s.value,'"feature-state" data expressions are not supported with filters.')];if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!Zh(l,["zoom","feature-state"]))return[new dt(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Wh(l))return[new dt(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Gc(s){const r=s.key,l=s.value,f=s.valueSpec,m=[];return Array.isArray(f.values)?f.values.indexOf(Gi(l))===-1&&m.push(new dt(r,l,`expected one of [${f.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(f.values).indexOf(Gi(l))===-1&&m.push(new dt(r,l,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(l)} found`)),m}function id(s){return Kl(Io(s.value))?To(at({},s,{expressionContext:"filter",valueSpec:{value:"boolean"}})):zf(s)}function zf(s){const r=s.value,l=s.key;if(Qn(r)!=="array")return[new dt(l,r,`array expected, ${Qn(r)} found`)];const f=s.styleSpec;let m,y=[];if(r.length<1)return[new dt(l,r,"filter array must have at least 1 element")];switch(y=y.concat(Gc({key:`${l}[0]`,value:r[0],valueSpec:f.filter_operator,style:s.style,styleSpec:s.styleSpec})),Gi(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Gi(r[1])==="$type"&&y.push(new dt(l,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&y.push(new dt(l,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(m=Qn(r[1]),m!=="string"&&y.push(new dt(`${l}[1]`,r[1],`string expected, ${m} found`)));for(let x=2;x<r.length;x++)m=Qn(r[x]),Gi(r[1])==="$type"?y=y.concat(Gc({key:`${l}[${x}]`,value:r[x],valueSpec:f.geometry_type,style:s.style,styleSpec:s.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&y.push(new dt(`${l}[${x}]`,r[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)y=y.concat(zf({key:`${l}[${x}]`,value:r[x],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":m=Qn(r[1]),r.length!==2?y.push(new dt(l,r,`filter array for "${r[0]}" operator must have 2 elements`)):m!=="string"&&y.push(new dt(`${l}[1]`,r[1],`string expected, ${m} found`))}return y}function Bf(s,r){const l=s.key,f=s.validateSpec,m=s.style,y=s.styleSpec,x=s.value,I=s.objectKey,C=y[`${r}_${s.layerType}`];if(!C)return[];const D=I.match(/^(.*)-transition$/);if(r==="paint"&&D&&C[D[1]]&&C[D[1]].transition)return f({key:l,value:x,valueSpec:y.transition,style:m,styleSpec:y});const z=s.valueSpec||C[I];if(!z)return[new dt(l,x,`unknown property "${I}"`)];let F;if(Qn(x)==="string"&&So(z)&&!z.tokens&&(F=/^{([^}]+)}$/.exec(x)))return[new dt(l,x,`"${I}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const O=[];return s.layerType==="symbol"&&(I==="text-field"&&m&&!m.glyphs&&O.push(new dt(l,x,'use of "text-field" requires a style "glyphs" property')),I==="text-font"&&Hc(Io(x))&&Gi(x.type)==="identity"&&O.push(new dt(l,x,'"text-font" does not support identity functions'))),O.concat(f({key:s.key,value:x,valueSpec:z,style:m,styleSpec:y,expressionContext:"property",propertyType:r,propertyKey:I}))}function rd(s){return Bf(s,"paint")}function Ff(s){return Bf(s,"layout")}function Qm(s){let r=[];const l=s.value,f=s.key,m=s.style,y=s.styleSpec;l.type||l.ref||r.push(new dt(f,l,'either "type" or "ref" is required'));let x=Gi(l.type);const I=Gi(l.ref);if(l.id){const C=Gi(l.id);for(let D=0;D<s.arrayIndex;D++){const z=m.layers[D];Gi(z.id)===C&&r.push(new dt(f,l.id,`duplicate layer id "${l.id}", previously used at line ${z.id.__line__}`))}}if("ref"in l){let C;["type","source","source-layer","filter","layout"].forEach(D=>{D in l&&r.push(new dt(f,l[D],`"${D}" is prohibited for ref layers`))}),m.layers.forEach(D=>{Gi(D.id)===I&&(C=D)}),C?C.ref?r.push(new dt(f,l.ref,"ref cannot reference another ref layer")):x=Gi(C.type):r.push(new dt(f,l.ref,`ref layer "${I}" not found`))}else if(x!=="background")if(l.source){const C=m.sources&&m.sources[l.source],D=C&&Gi(C.type);C?D==="vector"&&x==="raster"?r.push(new dt(f,l.source,`layer "${l.id}" requires a raster source`)):D!=="raster-dem"&&x==="hillshade"?r.push(new dt(f,l.source,`layer "${l.id}" requires a raster-dem source`)):D==="raster"&&x!=="raster"?r.push(new dt(f,l.source,`layer "${l.id}" requires a vector source`)):D!=="vector"||l["source-layer"]?D==="raster-dem"&&x!=="hillshade"?r.push(new dt(f,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!l.paint||!l.paint["line-gradient"]||D==="geojson"&&C.lineMetrics||r.push(new dt(f,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new dt(f,l,`layer "${l.id}" must specify a "source-layer"`)):r.push(new dt(f,l.source,`source "${l.source}" not found`))}else r.push(new dt(f,l,'missing required property "source"'));return r=r.concat(Va({key:f,value:l,valueSpec:y.layer,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,objectElementValidators:{"*":()=>[],type:()=>s.validateSpec({key:`${f}.type`,value:l.type,valueSpec:y.layer.type,style:s.style,styleSpec:s.styleSpec,validateSpec:s.validateSpec,object:l,objectKey:"type"}),filter:id,layout:C=>Va({layer:l,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":D=>Ff(at({layerType:x},D))}}),paint:C=>Va({layer:l,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":D=>rd(at({layerType:x},D))}})}})),r}function nl(s){const r=s.value,l=s.key,f=Qn(r);return f!=="string"?[new dt(l,r,`string expected, ${f} found`)]:[]}const $m={promoteId:function({key:s,value:r}){if(Qn(r)==="string")return nl({key:s,value:r});{const l=[];for(const f in r)l.push(...nl({key:`${s}.${f}`,value:r[f]}));return l}}};function Nf(s){const r=s.value,l=s.key,f=s.styleSpec,m=s.style,y=s.validateSpec;if(!r.type)return[new dt(l,r,'"type" is required')];const x=Gi(r.type);let I;switch(x){case"vector":case"raster":return I=Va({key:l,value:r,valueSpec:f[`source_${x.replace("-","_")}`],style:s.style,styleSpec:f,objectElementValidators:$m,validateSpec:y}),I;case"raster-dem":return I=function(C){var D;const z=(D=C.sourceName)!==null&&D!==void 0?D:"",F=C.value,O=C.styleSpec,q=O.source_raster_dem,G=C.style;let $=[];const ae=Qn(F);if(F===void 0)return $;if(ae!=="object")return $.push(new dt("source_raster_dem",F,`object expected, ${ae} found`)),$;const he=Gi(F.encoding)==="custom",ke=["redFactor","greenFactor","blueFactor","baseShift"],ge=C.value.encoding?`"${C.value.encoding}"`:"Default";for(const Ie in F)!he&&ke.includes(Ie)?$.push(new dt(Ie,F[Ie],`In "${z}": "${Ie}" is only valid when "encoding" is set to "custom". ${ge} encoding found`)):q[Ie]?$=$.concat(C.validateSpec({key:Ie,value:F[Ie],valueSpec:q[Ie],validateSpec:C.validateSpec,style:G,styleSpec:O})):$.push(new dt(Ie,F[Ie],`unknown property "${Ie}"`));return $}({sourceName:l,value:r,style:s.style,styleSpec:f,validateSpec:y}),I;case"geojson":if(I=Va({key:l,value:r,valueSpec:f.source_geojson,style:m,styleSpec:f,validateSpec:y,objectElementValidators:$m}),r.cluster)for(const C in r.clusterProperties){const[D,z]=r.clusterProperties[C],F=typeof D=="string"?[D,["accumulated"],["get",C]]:D;I.push(...To({key:`${l}.${C}.map`,value:z,validateSpec:y,expressionContext:"cluster-map"})),I.push(...To({key:`${l}.${C}.reduce`,value:F,validateSpec:y,expressionContext:"cluster-reduce"}))}return I;case"video":return Va({key:l,value:r,valueSpec:f.source_video,style:m,validateSpec:y,styleSpec:f});case"image":return Va({key:l,value:r,valueSpec:f.source_image,style:m,validateSpec:y,styleSpec:f});case"canvas":return[new dt(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Gc({key:`${l}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,validateSpec:y,styleSpec:f})}}function Rf(s){const r=s.value,l=s.styleSpec,f=l.light,m=s.style;let y=[];const x=Qn(r);if(r===void 0)return y;if(x!=="object")return y=y.concat([new dt("light",r,`object expected, ${x} found`)]),y;for(const I in r){const C=I.match(/^(.*)-transition$/);y=y.concat(C&&f[C[1]]&&f[C[1]].transition?s.validateSpec({key:I,value:r[I],valueSpec:l.transition,validateSpec:s.validateSpec,style:m,styleSpec:l}):f[I]?s.validateSpec({key:I,value:r[I],valueSpec:f[I],validateSpec:s.validateSpec,style:m,styleSpec:l}):[new dt(I,r[I],`unknown property "${I}"`)])}return y}function Of(s){const r=s.value,l=s.styleSpec,f=l.sky,m=s.style,y=Qn(r);if(r===void 0)return[];if(y!=="object")return[new dt("sky",r,`object expected, ${y} found`)];let x=[];for(const I in r)x=x.concat(f[I]?s.validateSpec({key:I,value:r[I],valueSpec:f[I],style:m,styleSpec:l}):[new dt(I,r[I],`unknown property "${I}"`)]);return x}function e0(s){const r=s.value,l=s.styleSpec,f=l.terrain,m=s.style;let y=[];const x=Qn(r);if(r===void 0)return y;if(x!=="object")return y=y.concat([new dt("terrain",r,`object expected, ${x} found`)]),y;for(const I in r)y=y.concat(f[I]?s.validateSpec({key:I,value:r[I],valueSpec:f[I],validateSpec:s.validateSpec,style:m,styleSpec:l}):[new dt(I,r[I],`unknown property "${I}"`)]);return y}function t0(s){let r=[];const l=s.value,f=s.key;if(Array.isArray(l)){const m=[],y=[];for(const x in l)l[x].id&&m.includes(l[x].id)&&r.push(new dt(f,l,`all the sprites' ids must be unique, but ${l[x].id} is duplicated`)),m.push(l[x].id),l[x].url&&y.includes(l[x].url)&&r.push(new dt(f,l,`all the sprites' URLs must be unique, but ${l[x].url} is duplicated`)),y.push(l[x].url),r=r.concat(Va({key:`${f}[${x}]`,value:l[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:s.validateSpec}));return r}return nl({key:f,value:l})}const Uf={"*":()=>[],array:td,boolean:function(s){const r=s.value,l=s.key,f=Qn(r);return f!=="boolean"?[new dt(l,r,`boolean expected, ${f} found`)]:[]},number:Lf,color:function(s){const r=s.key,l=s.value,f=Qn(l);return f!=="string"?[new dt(r,l,`color expected, ${f} found`)]:Vn.parse(String(l))?[]:[new dt(r,l,`color expected, "${l}" found`)]},constants:ed,enum:Gc,filter:id,function:nd,layer:Qm,object:Va,source:Nf,light:Rf,sky:Of,terrain:e0,string:nl,formatted:function(s){return nl(s).length===0?[]:To(s)},resolvedImage:function(s){return nl(s).length===0?[]:To(s)},padding:function(s){const r=s.key,l=s.value;if(Qn(l)==="array"){if(l.length<1||l.length>4)return[new dt(r,l,`padding requires 1 to 4 values; ${l.length} values found`)];const f={type:"number"};let m=[];for(let y=0;y<l.length;y++)m=m.concat(s.validateSpec({key:`${r}[${y}]`,value:l[y],validateSpec:s.validateSpec,valueSpec:f}));return m}return Lf({key:r,value:l,valueSpec:{}})},variableAnchorOffsetCollection:function(s){const r=s.key,l=s.value,f=Qn(l),m=s.styleSpec;if(f!=="array"||l.length<1||l.length%2!=0)return[new dt(r,l,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let x=0;x<l.length;x+=2)y=y.concat(Gc({key:`${r}[${x}]`,value:l[x],valueSpec:m.layout_symbol["text-anchor"]})),y=y.concat(td({key:`${r}[${x+1}]`,value:l[x+1],valueSpec:{length:2,value:"number"},validateSpec:s.validateSpec,style:s.style,styleSpec:m}));return y},sprite:t0};function Yc(s){const r=s.value,l=s.valueSpec,f=s.styleSpec;return s.validateSpec=Yc,l.expression&&Hc(Gi(r))?nd(s):l.expression&&Kh(Io(r))?To(s):l.type&&Uf[l.type]?Uf[l.type](s):Va(at({},s,{valueSpec:l.type?f[l.type]:l}))}function Vf(s){const r=s.value,l=s.key,f=nl(s);return f.length||(r.indexOf("{fontstack}")===-1&&f.push(new dt(l,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&f.push(new dt(l,r,'"glyphs" url must include a "{range}" token'))),f}function ss(s,r=De){let l=[];return l=l.concat(Yc({key:"",value:s,valueSpec:r.$root,styleSpec:r,style:s,validateSpec:Yc,objectElementValidators:{glyphs:Vf,"*":()=>[]}})),s.constants&&(l=l.concat(ed({key:"constants",value:s.constants,style:s,styleSpec:r,validateSpec:Yc}))),n0(l)}function ja(s){return function(r){return s({...r,validateSpec:Yc})}}function n0(s){return[].concat(s).sort((r,l)=>r.line-l.line)}function os(s){return function(...r){return n0(s.apply(this,r))}}ss.source=os(ja(Nf)),ss.sprite=os(ja(t0)),ss.glyphs=os(ja(Vf)),ss.light=os(ja(Rf)),ss.sky=os(ja(Of)),ss.terrain=os(ja(e0)),ss.layer=os(ja(Qm)),ss.filter=os(ja(id)),ss.paintProperty=os(ja(rd)),ss.layoutProperty=os(ja(Ff));const Qu=ss,Ng=Qu.light,i0=Qu.paintProperty,r0=Qu.layoutProperty;function jf(s,r){let l=!1;if(r&&r.length)for(const f of r)s.fire(new Ee(new Error(f.message))),l=!0;return l}class $u{constructor(r,l,f){const m=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(l=x[1])+2*(f=x[2]);for(let C=0;C<this.d*this.d;C++){const D=x[3+C],z=x[3+C+1];m.push(D===z?null:x.subarray(D,z))}const I=x[3+m.length+1];this.keys=x.subarray(x[3+m.length],I),this.bboxes=x.subarray(I),this.insert=this._insertReadonly}else{this.d=l+2*f;for(let x=0;x<this.d*this.d;x++)m.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=r,this.padding=f,this.scale=l/r,this.uid=0;const y=f/l*r;this.min=-y,this.max=r+y}insert(r,l,f,m,y){this._forEachCell(l,f,m,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(m),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,l,f,m,y,x){this.cells[y].push(x)}query(r,l,f,m,y){const x=this.min,I=this.max;if(r<=x&&l<=x&&I<=f&&I<=m&&!y)return Array.prototype.slice.call(this.keys);{const C=[];return this._forEachCell(r,l,f,m,this._queryCell,C,{},y),C}}_queryCell(r,l,f,m,y,x,I,C){const D=this.cells[y];if(D!==null){const z=this.keys,F=this.bboxes;for(let O=0;O<D.length;O++){const q=D[O];if(I[q]===void 0){const G=4*q;(C?C(F[G+0],F[G+1],F[G+2],F[G+3]):r<=F[G+2]&&l<=F[G+3]&&f>=F[G+0]&&m>=F[G+1])?(I[q]=!0,x.push(z[q])):I[q]=!1}}}}_forEachCell(r,l,f,m,y,x,I,C){const D=this._convertToCellCoord(r),z=this._convertToCellCoord(l),F=this._convertToCellCoord(f),O=this._convertToCellCoord(m);for(let q=D;q<=F;q++)for(let G=z;G<=O;G++){const $=this.d*G+q;if((!C||C(this._convertFromCellCoord(q),this._convertFromCellCoord(G),this._convertFromCellCoord(q+1),this._convertFromCellCoord(G+1)))&&y.call(this,r,l,f,m,$,x,I,C))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,l=3+this.cells.length+1+1;let f=0;for(let x=0;x<this.cells.length;x++)f+=this.cells[x].length;const m=new Int32Array(l+f+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let y=l;for(let x=0;x<r.length;x++){const I=r[x];m[3+x]=y,m.set(I,y),y+=I.length}return m[3+r.length]=y,m.set(this.keys,y),y+=this.keys.length,m[3+r.length+1]=y,m.set(this.bboxes,y),y+=this.bboxes.length,m.buffer}static serialize(r,l){const f=r.toArrayBuffer();return l&&l.push(f),{buffer:f}}static deserialize(r){return new $u(r.buffer)}}const il={};function Rt(s,r,l={}){if(il[s])throw new Error(`${s} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:s,writeable:!1}),il[s]={klass:r,omit:l.omit||[],shallow:l.shallow||[]}}Rt("Object",Object),Rt("TransferableGridIndex",$u),Rt("Color",Vn),Rt("Error",Error),Rt("AJAXError",gt),Rt("ResolvedImage",or),Rt("StylePropertyFunction",Jl),Rt("StyleExpression",kf,{omit:["_evaluator"]}),Rt("ZoomDependentExpression",Df),Rt("ZoomConstantExpression",Ef),Rt("CompoundExpression",Mr,{omit:["_evaluate"]});for(const s in qs)qs[s]._classRegistryKey||Rt(`Expression_${s}`,qs[s]);function a0(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function eh(s,r){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error)return s;if(a0(s)||Ge(s))return r&&r.push(s),s;if(ArrayBuffer.isView(s)){const l=s;return r&&r.push(l.buffer),l}if(s instanceof ImageData)return r&&r.push(s.data.buffer),s;if(Array.isArray(s)){const l=[];for(const f of s)l.push(eh(f,r));return l}if(typeof s=="object"){const l=s.constructor,f=l._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${l.name}`);if(!il[f])throw new Error(`${f} is not registered.`);const m=l.serialize?l.serialize(s,r):{};if(l.serialize){if(r&&m===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in s){if(!s.hasOwnProperty(y)||il[f].omit.indexOf(y)>=0)continue;const x=s[y];m[y]=il[f].shallow.indexOf(y)>=0?x:eh(x,r)}s instanceof Error&&(m.message=s.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(m.$name=f),m}throw new Error("can't serialize object of type "+typeof s)}function Hs(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||s instanceof Blob||s instanceof Error||a0(s)||Ge(s)||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(Hs);if(typeof s=="object"){const r=s.$name||"Object";if(!il[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:l}=il[r];if(!l)throw new Error(`can't deserialize unregistered class ${r}`);if(l.deserialize)return l.deserialize(s);const f=Object.create(l.prototype);for(const m of Object.keys(s)){if(m==="$name")continue;const y=s[m];f[m]=il[r].shallow.indexOf(m)>=0?y:Hs(y)}return f}throw new Error("can't deserialize object of type "+typeof s)}class s0{constructor(){this.first=!0}update(r,l){const f=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=l):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=l),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=f,!0))}}const Ct={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function qf(s){for(const r of s)if(Hf(r.charCodeAt(0)))return!0;return!1}function Rg(s){for(const r of s)if(!o0(r.charCodeAt(0)))return!1;return!0}function o0(s){return!(Ct.Arabic(s)||Ct["Arabic Supplement"](s)||Ct["Arabic Extended-A"](s)||Ct["Arabic Presentation Forms-A"](s)||Ct["Arabic Presentation Forms-B"](s))}function Hf(s){return!(s!==746&&s!==747&&(s<4352||!(Ct["Bopomofo Extended"](s)||Ct.Bopomofo(s)||Ct["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||Ct["CJK Compatibility Ideographs"](s)||Ct["CJK Compatibility"](s)||Ct["CJK Radicals Supplement"](s)||Ct["CJK Strokes"](s)||!(!Ct["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Ct["CJK Unified Ideographs Extension A"](s)||Ct["CJK Unified Ideographs"](s)||Ct["Enclosed CJK Letters and Months"](s)||Ct["Hangul Compatibility Jamo"](s)||Ct["Hangul Jamo Extended-A"](s)||Ct["Hangul Jamo Extended-B"](s)||Ct["Hangul Jamo"](s)||Ct["Hangul Syllables"](s)||Ct.Hiragana(s)||Ct["Ideographic Description Characters"](s)||Ct.Kanbun(s)||Ct["Kangxi Radicals"](s)||Ct["Katakana Phonetic Extensions"](s)||Ct.Katakana(s)&&s!==12540||!(!Ct["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Ct["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||Ct["Unified Canadian Aboriginal Syllabics"](s)||Ct["Unified Canadian Aboriginal Syllabics Extended"](s)||Ct["Vertical Forms"](s)||Ct["Yijing Hexagram Symbols"](s)||Ct["Yi Syllables"](s)||Ct["Yi Radicals"](s))))}function l0(s){return!(Hf(s)||function(r){return!!(Ct["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Ct["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Ct["Letterlike Symbols"](r)||Ct["Number Forms"](r)||Ct["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Ct["Control Pictures"](r)&&r!==9251||Ct["Optical Character Recognition"](r)||Ct["Enclosed Alphanumerics"](r)||Ct["Geometric Shapes"](r)||Ct["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Ct["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Ct["CJK Symbols and Punctuation"](r)||Ct.Katakana(r)||Ct["Private Use Area"](r)||Ct["CJK Compatibility Forms"](r)||Ct["Small Form Variants"](r)||Ct["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(s))}function rl(s){return s>=1424&&s<=2303||Ct["Arabic Presentation Forms-A"](s)||Ct["Arabic Presentation Forms-B"](s)}function c0(s,r){return!(!r&&rl(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||Ct.Khmer(s))}function Wf(s){for(const r of s)if(rl(r.charCodeAt(0)))return!0;return!1}const al=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(s){this.pluginStatus=s.pluginStatus,this.pluginURL=s.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(s){this.applyArabicShaping=s.applyArabicShaping,this.processBidirectionalText=s.processBidirectionalText,this.processStyledBidirectionalText=s.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class wi{constructor(r,l){this.zoom=r,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new s0,this.transition={})}isSupportedScript(r){return function(l,f){for(const m of l)if(!c0(m.charCodeAt(0),f))return!1;return!0}(r,al.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,l=r-Math.floor(r),f=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:l+(1-l)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*l}}}class ad{constructor(r,l){this.property=r,this.value=l,this.expression=function(f,m){if(Hc(f))return new Jl(f,m);if(Kh(f)){const y=Ju(f,m);if(y.result==="error")throw new Error(y.value.map(x=>`${x.key}: ${x.message}`).join(", "));return y.value}{let y=f;return m.type==="color"&&typeof f=="string"?y=Vn.parse(f):m.type!=="padding"||typeof f!="number"&&!Array.isArray(f)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(f)&&(y=wr.parse(f)):y=Bi.parse(f),{kind:"constant",evaluate:()=>y}}}(l===void 0?r.specification.default:l,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,l,f){return this.property.possiblyEvaluate(this,r,l,f)}}class Jc{constructor(r){this.property=r,this.value=new ad(r,void 0)}transitioned(r,l){return new u0(this.property,this.value,l,ne({},r.transition,this.transition),r.now)}untransitioned(){return new u0(this.property,this.value,null,{},0)}}class Kc{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Y(this._values[r].value.value)}setValue(r,l){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Jc(this._values[r].property)),this._values[r].value=new ad(this._values[r].property,l===null?void 0:Y(l))}getTransition(r){return Y(this._values[r].transition)}setTransition(r,l){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Jc(this._values[r].property)),this._values[r].transition=Y(l)||void 0}serialize(){const r={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(r[l]=f);const m=this.getTransition(l);m!==void 0&&(r[`${l}-transition`]=m)}return r}transitioned(r,l){const f=new Zf(this._properties);for(const m of Object.keys(this._values))f._values[m]=this._values[m].transitioned(r,l._values[m]);return f}untransitioned(){const r=new Zf(this._properties);for(const l of Object.keys(this._values))r._values[l]=this._values[l].untransitioned();return r}}class u0{constructor(r,l,f,m,y){this.property=r,this.value=l,this.begin=y+m.delay||0,this.end=this.begin+m.duration||0,r.specification.transition&&(m.delay||m.duration)&&(this.prior=f)}possiblyEvaluate(r,l,f){const m=r.now||0,y=this.value.possiblyEvaluate(r,l,f),x=this.prior;if(x){if(m>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(m<this.begin)return x.possiblyEvaluate(r,l,f);{const I=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,l,f),y,function(C){if(C<=0)return 0;if(C>=1)return 1;const D=C*C,z=D*C;return 4*(C<.5?z:3*(C-D)+z-.75)}(I))}}return y}}class Zf{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,l,f){const m=new sd(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(r,l,f);return m}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class th{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return Y(this._values[r].value)}setValue(r,l){this._values[r]=new ad(this._values[r].property,l===null?void 0:Y(l))}serialize(){const r={};for(const l of Object.keys(this._values)){const f=this.getValue(l);f!==void 0&&(r[l]=f)}return r}possiblyEvaluate(r,l,f){const m=new sd(this._properties);for(const y of Object.keys(this._values))m._values[y]=this._values[y].possiblyEvaluate(r,l,f);return m}}class Ws{constructor(r,l,f){this.property=r,this.value=l,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,l,f,m){return this.property.evaluate(this.value,this.parameters,r,l,f,m)}}class sd{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Gt{constructor(r){this.specification=r}possiblyEvaluate(r,l){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(l)}interpolate(r,l,f){const m=Ir[this.specification.type];return m?m(r,l,f):r}}class Xt{constructor(r,l){this.specification=r,this.overrides=l}possiblyEvaluate(r,l,f,m){return new Ws(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(l,null,{},f,m)}:r.expression,l)}interpolate(r,l,f){if(r.value.kind!=="constant"||l.value.kind!=="constant")return r;if(r.value.value===void 0||l.value.value===void 0)return new Ws(this,{kind:"constant",value:void 0},r.parameters);const m=Ir[this.specification.type];if(m){const y=m(r.value.value,l.value.value,f);return new Ws(this,{kind:"constant",value:y},r.parameters)}return r}evaluate(r,l,f,m,y,x){return r.kind==="constant"?r.value:r.evaluate(l,f,m,y,x)}}class g extends Xt{possiblyEvaluate(r,l,f,m){if(r.value===void 0)return new Ws(this,{kind:"constant",value:void 0},l);if(r.expression.kind==="constant"){const y=r.expression.evaluate(l,null,{},f,m),x=r.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,I=this._calculate(x,x,x,l);return new Ws(this,{kind:"constant",value:I},l)}if(r.expression.kind==="camera"){const y=this._calculate(r.expression.evaluate({zoom:l.zoom-1}),r.expression.evaluate({zoom:l.zoom}),r.expression.evaluate({zoom:l.zoom+1}),l);return new Ws(this,{kind:"constant",value:y},l)}return new Ws(this,r.expression,l)}evaluate(r,l,f,m,y,x){if(r.kind==="source"){const I=r.evaluate(l,f,m,y,x);return this._calculate(I,I,I,l)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(l.zoom)-1},f,m),r.evaluate({zoom:Math.floor(l.zoom)},f,m),r.evaluate({zoom:Math.floor(l.zoom)+1},f,m),l):r.value}_calculate(r,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:f,to:l}}interpolate(r){return r}}class a{constructor(r){this.specification=r}possiblyEvaluate(r,l,f,m){if(r.value!==void 0){if(r.expression.kind==="constant"){const y=r.expression.evaluate(l,null,{},f,m);return this._calculate(y,y,y,l)}return this._calculate(r.expression.evaluate(new wi(Math.floor(l.zoom-1),l)),r.expression.evaluate(new wi(Math.floor(l.zoom),l)),r.expression.evaluate(new wi(Math.floor(l.zoom+1),l)),l)}}_calculate(r,l,f,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:r,to:l}:{from:f,to:l}}interpolate(r){return r}}class d{constructor(r){this.specification=r}possiblyEvaluate(r,l,f,m){return!!r.expression.evaluate(l,null,{},f,m)}interpolate(){return!1}}class p{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const l in r){const f=r[l];f.specification.overridable&&this.overridableProperties.push(l);const m=this.defaultPropertyValues[l]=new ad(f,void 0),y=this.defaultTransitionablePropertyValues[l]=new Jc(f);this.defaultTransitioningPropertyValues[l]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=m.possiblyEvaluate({})}}}Rt("DataDrivenProperty",Xt),Rt("DataConstantProperty",Gt),Rt("CrossFadedDataDrivenProperty",g),Rt("CrossFadedProperty",a),Rt("ColorRampProperty",d);const _="-transition";class v extends wt{constructor(r,l){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),l.layout&&(this._unevaluatedLayout=new th(l.layout)),l.paint)){this._transitionablePaint=new Kc(l.paint);for(const f in r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(const f in r.layout)this.setLayoutProperty(f,r.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sd(l.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,l,f={}){l!=null&&this._validate(r0,`layers.${this.id}.layout.${r}`,r,l,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,l):this.visibility=l)}getPaintProperty(r){return r.endsWith(_)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,l,f={}){if(l!=null&&this._validate(i0,`layers.${this.id}.paint.${r}`,r,l,f))return!1;if(r.endsWith(_))return this._transitionablePaint.setTransition(r.slice(0,-11),l||void 0),!1;{const m=this._transitionablePaint._values[r],y=m.property.specification["property-type"]==="cross-faded-data-driven",x=m.value.isDataDriven(),I=m.value;this._transitionablePaint.setValue(r,l),this._handleSpecialPaintPropertyUpdate(r);const C=this._transitionablePaint._values[r].value;return C.isDataDriven()||x||y||this._handleOverridablePaintPropertyUpdate(r,I,C)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,l,f){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,l){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,l)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Te(r,(l,f)=>!(l===void 0||f==="layout"&&!Object.keys(l).length||f==="paint"&&!Object.keys(l).length))}_validate(r,l,f,m,y={}){return(!y||y.validate!==!1)&&jf(this,r.call(Qu,{key:l,layerType:this.type,objectKey:f,value:m,styleSpec:De,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const l=this.paint.get(r);if(l instanceof Ws&&So(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}}const T={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class k{constructor(r,l){this._structArray=r,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class E{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,l){return r._trim(),l&&(r.isTransferred=!0,l.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const l=Object.create(this.prototype);return l.arrayBuffer=r.arrayBuffer,l.length=r.length,l.capacity=r.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function L(s,r=1){let l=0,f=0;return{members:s.map(m=>{const y=T[m.type].BYTES_PER_ELEMENT,x=l=R(l,Math.max(r,y)),I=m.components||1;return f=Math.max(f,y),l+=y*I,{name:m.name,type:m.type,components:I,offset:x}}),size:R(l,Math.max(f,r)),alignment:r}}function R(s,r){return Math.ceil(s/r)*r}class N extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,l)}emplace(r,l,f){const m=2*r;return this.int16[m+0]=l,this.int16[m+1]=f,r}}N.prototype.bytesPerElement=4,Rt("StructArrayLayout2i4",N);class W extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)}emplace(r,l,f,m){const y=3*r;return this.int16[y+0]=l,this.int16[y+1]=f,this.int16[y+2]=m,r}}W.prototype.bytesPerElement=6,Rt("StructArrayLayout3i6",W);class X extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,r,l,f,m)}emplace(r,l,f,m,y){const x=4*r;return this.int16[x+0]=l,this.int16[x+1]=f,this.int16[x+2]=m,this.int16[x+3]=y,r}}X.prototype.bytesPerElement=8,Rt("StructArrayLayout4i8",X);class te extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x){const I=this.length;return this.resize(I+1),this.emplace(I,r,l,f,m,y,x)}emplace(r,l,f,m,y,x,I){const C=6*r;return this.int16[C+0]=l,this.int16[C+1]=f,this.int16[C+2]=m,this.int16[C+3]=y,this.int16[C+4]=x,this.int16[C+5]=I,r}}te.prototype.bytesPerElement=12,Rt("StructArrayLayout2i4i12",te);class ue extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x){const I=this.length;return this.resize(I+1),this.emplace(I,r,l,f,m,y,x)}emplace(r,l,f,m,y,x,I){const C=4*r,D=8*r;return this.int16[C+0]=l,this.int16[C+1]=f,this.uint8[D+4]=m,this.uint8[D+5]=y,this.uint8[D+6]=x,this.uint8[D+7]=I,r}}ue.prototype.bytesPerElement=8,Rt("StructArrayLayout2i4ub8",ue);class re extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,l)}emplace(r,l,f){const m=2*r;return this.float32[m+0]=l,this.float32[m+1]=f,r}}re.prototype.bytesPerElement=8,Rt("StructArrayLayout2f8",re);class pe extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x,I,C,D,z){const F=this.length;return this.resize(F+1),this.emplace(F,r,l,f,m,y,x,I,C,D,z)}emplace(r,l,f,m,y,x,I,C,D,z,F){const O=10*r;return this.uint16[O+0]=l,this.uint16[O+1]=f,this.uint16[O+2]=m,this.uint16[O+3]=y,this.uint16[O+4]=x,this.uint16[O+5]=I,this.uint16[O+6]=C,this.uint16[O+7]=D,this.uint16[O+8]=z,this.uint16[O+9]=F,r}}pe.prototype.bytesPerElement=20,Rt("StructArrayLayout10ui20",pe);class ve extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x,I,C,D,z,F,O){const q=this.length;return this.resize(q+1),this.emplace(q,r,l,f,m,y,x,I,C,D,z,F,O)}emplace(r,l,f,m,y,x,I,C,D,z,F,O,q){const G=12*r;return this.int16[G+0]=l,this.int16[G+1]=f,this.int16[G+2]=m,this.int16[G+3]=y,this.uint16[G+4]=x,this.uint16[G+5]=I,this.uint16[G+6]=C,this.uint16[G+7]=D,this.int16[G+8]=z,this.int16[G+9]=F,this.int16[G+10]=O,this.int16[G+11]=q,r}}ve.prototype.bytesPerElement=24,Rt("StructArrayLayout4i4ui4i24",ve);class ce extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)}emplace(r,l,f,m){const y=3*r;return this.float32[y+0]=l,this.float32[y+1]=f,this.float32[y+2]=m,r}}ce.prototype.bytesPerElement=12,Rt("StructArrayLayout3f12",ce);class Se extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint32[1*r+0]=l,r}}Se.prototype.bytesPerElement=4,Rt("StructArrayLayout1ul4",Se);class ze extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x,I,C,D){const z=this.length;return this.resize(z+1),this.emplace(z,r,l,f,m,y,x,I,C,D)}emplace(r,l,f,m,y,x,I,C,D,z){const F=10*r,O=5*r;return this.int16[F+0]=l,this.int16[F+1]=f,this.int16[F+2]=m,this.int16[F+3]=y,this.int16[F+4]=x,this.int16[F+5]=I,this.uint32[O+3]=C,this.uint16[F+8]=D,this.uint16[F+9]=z,r}}ze.prototype.bytesPerElement=20,Rt("StructArrayLayout6i1ul2ui20",ze);class Oe extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x){const I=this.length;return this.resize(I+1),this.emplace(I,r,l,f,m,y,x)}emplace(r,l,f,m,y,x,I){const C=6*r;return this.int16[C+0]=l,this.int16[C+1]=f,this.int16[C+2]=m,this.int16[C+3]=y,this.int16[C+4]=x,this.int16[C+5]=I,r}}Oe.prototype.bytesPerElement=12,Rt("StructArrayLayout2i2i2i12",Oe);class Qe extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,r,l,f,m,y)}emplace(r,l,f,m,y,x){const I=4*r,C=8*r;return this.float32[I+0]=l,this.float32[I+1]=f,this.float32[I+2]=m,this.int16[C+6]=y,this.int16[C+7]=x,r}}Qe.prototype.bytesPerElement=16,Rt("StructArrayLayout2f1f2i16",Qe);class ft extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x){const I=this.length;return this.resize(I+1),this.emplace(I,r,l,f,m,y,x)}emplace(r,l,f,m,y,x,I){const C=16*r,D=4*r,z=8*r;return this.uint8[C+0]=l,this.uint8[C+1]=f,this.float32[D+1]=m,this.float32[D+2]=y,this.int16[z+6]=x,this.int16[z+7]=I,r}}ft.prototype.bytesPerElement=16,Rt("StructArrayLayout2ub2f2i16",ft);class Et extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)}emplace(r,l,f,m){const y=3*r;return this.uint16[y+0]=l,this.uint16[y+1]=f,this.uint16[y+2]=m,r}}Et.prototype.bytesPerElement=6,Rt("StructArrayLayout3ui6",Et);class Dt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x,I,C,D,z,F,O,q,G,$,ae,he){const ke=this.length;return this.resize(ke+1),this.emplace(ke,r,l,f,m,y,x,I,C,D,z,F,O,q,G,$,ae,he)}emplace(r,l,f,m,y,x,I,C,D,z,F,O,q,G,$,ae,he,ke){const ge=24*r,Ie=12*r,Ze=48*r;return this.int16[ge+0]=l,this.int16[ge+1]=f,this.uint16[ge+2]=m,this.uint16[ge+3]=y,this.uint32[Ie+2]=x,this.uint32[Ie+3]=I,this.uint32[Ie+4]=C,this.uint16[ge+10]=D,this.uint16[ge+11]=z,this.uint16[ge+12]=F,this.float32[Ie+7]=O,this.float32[Ie+8]=q,this.uint8[Ze+36]=G,this.uint8[Ze+37]=$,this.uint8[Ze+38]=ae,this.uint32[Ie+10]=he,this.int16[ge+22]=ke,r}}Dt.prototype.bytesPerElement=48,Rt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Dt);class pt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,f,m,y,x,I,C,D,z,F,O,q,G,$,ae,he,ke,ge,Ie,Ze,et,kt,Wt,It,vt,Ot,Yt){const Tt=this.length;return this.resize(Tt+1),this.emplace(Tt,r,l,f,m,y,x,I,C,D,z,F,O,q,G,$,ae,he,ke,ge,Ie,Ze,et,kt,Wt,It,vt,Ot,Yt)}emplace(r,l,f,m,y,x,I,C,D,z,F,O,q,G,$,ae,he,ke,ge,Ie,Ze,et,kt,Wt,It,vt,Ot,Yt,Tt){const nt=32*r,Ht=16*r;return this.int16[nt+0]=l,this.int16[nt+1]=f,this.int16[nt+2]=m,this.int16[nt+3]=y,this.int16[nt+4]=x,this.int16[nt+5]=I,this.int16[nt+6]=C,this.int16[nt+7]=D,this.uint16[nt+8]=z,this.uint16[nt+9]=F,this.uint16[nt+10]=O,this.uint16[nt+11]=q,this.uint16[nt+12]=G,this.uint16[nt+13]=$,this.uint16[nt+14]=ae,this.uint16[nt+15]=he,this.uint16[nt+16]=ke,this.uint16[nt+17]=ge,this.uint16[nt+18]=Ie,this.uint16[nt+19]=Ze,this.uint16[nt+20]=et,this.uint16[nt+21]=kt,this.uint16[nt+22]=Wt,this.uint32[Ht+12]=It,this.float32[Ht+13]=vt,this.float32[Ht+14]=Ot,this.uint16[nt+30]=Yt,this.uint16[nt+31]=Tt,r}}pt.prototype.bytesPerElement=64,Rt("StructArrayLayout8i15ui1ul2f2ui64",pt);class _t extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.float32[1*r+0]=l,r}}_t.prototype.bytesPerElement=4,Rt("StructArrayLayout1f4",_t);class jt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)}emplace(r,l,f,m){const y=3*r;return this.uint16[6*r+0]=l,this.float32[y+1]=f,this.float32[y+2]=m,r}}jt.prototype.bytesPerElement=12,Rt("StructArrayLayout1ui2f12",jt);class rn extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l,f){const m=this.length;return this.resize(m+1),this.emplace(m,r,l,f)}emplace(r,l,f,m){const y=4*r;return this.uint32[2*r+0]=l,this.uint16[y+2]=f,this.uint16[y+3]=m,r}}rn.prototype.bytesPerElement=8,Rt("StructArrayLayout1ul2ui8",rn);class bt extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,l){const f=this.length;return this.resize(f+1),this.emplace(f,r,l)}emplace(r,l,f){const m=2*r;return this.uint16[m+0]=l,this.uint16[m+1]=f,r}}bt.prototype.bytesPerElement=4,Rt("StructArrayLayout2ui4",bt);class St extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const l=this.length;return this.resize(l+1),this.emplace(l,r)}emplace(r,l){return this.uint16[1*r+0]=l,r}}St.prototype.bytesPerElement=2,Rt("StructArrayLayout1ui2",St);class $t extends E{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,l,f,m){const y=this.length;return this.resize(y+1),this.emplace(y,r,l,f,m)}emplace(r,l,f,m,y){const x=4*r;return this.float32[x+0]=l,this.float32[x+1]=f,this.float32[x+2]=m,this.float32[x+3]=y,r}}$t.prototype.bytesPerElement=16,Rt("StructArrayLayout4f16",$t);class Ei extends k{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new M(this.anchorPointX,this.anchorPointY)}}Ei.prototype.size=20;class xn extends ze{get(r){return new Ei(this,r)}}Rt("CollisionBoxArray",xn);class Dn extends k{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Dn.prototype.size=48;class Di extends Dt{get(r){return new Dn(this,r)}}Rt("PlacedSymbolArray",Di);class ta extends k{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ta.prototype.size=64;class xs extends pt{get(r){return new ta(this,r)}}Rt("SymbolInstanceArray",xs);class Pi extends _t{getoffsetX(r){return this.float32[1*r+0]}}Rt("GlyphOffsetArray",Pi);class ka extends W{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}Rt("SymbolLineVertexArray",ka);class _a extends k{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}_a.prototype.size=12;class na extends jt{get(r){return new _a(this,r)}}Rt("TextAnchorOffsetArray",na);class ia extends k{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ia.prototype.size=8;class ws extends rn{get(r){return new ia(this,r)}}Rt("FeatureIndexArray",ws);class Ql extends N{}class od extends N{}class Xc extends N{}class $l extends te{}class ld extends ue{}class Gf extends re{}class Zr extends pe{}class Ss extends ve{}class sl extends ce{}class Qc extends Se{}class ra extends Oe{}class aa extends ft{}class zr extends Et{}class Ui extends bt{}const $c=L([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yf}=$c;class Cr{constructor(r=[]){this.segments=r}prepareSegment(r,l,f,m){let y=this.segments[this.segments.length-1];return r>Cr.MAX_VERTEX_ARRAY_LENGTH&&qe(`Max vertices per segment is ${Cr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!y||y.vertexLength+r>Cr.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==m)&&(y={vertexOffset:l.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},m!==void 0&&(y.sortKey=m),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const r of this.segments)for(const l in r.vaos)r.vaos[l].destroy()}static simpleSegment(r,l,f,m){return new Cr([{vertexOffset:r,primitiveOffset:l,vertexLength:f,primitiveLength:m,vaos:{},sortKey:0}])}}function h0(s,r){return 256*(s=oe(Math.floor(s),0,255))+oe(Math.floor(r),0,255)}Cr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rt("SegmentVector",Cr);const cd=L([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ud={exports:{}},ol={exports:{}};ol.exports=function(s,r){var l,f,m,y,x,I,C,D;for(f=s.length-(l=3&s.length),m=r,x=3432918353,I=461845907,D=0;D<f;)C=255&s.charCodeAt(D)|(255&s.charCodeAt(++D))<<8|(255&s.charCodeAt(++D))<<16|(255&s.charCodeAt(++D))<<24,++D,m=27492+(65535&(y=5*(65535&(m=(m^=C=(65535&(C=(C=(65535&C)*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*I+(((C>>>16)*I&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(C=0,l){case 3:C^=(255&s.charCodeAt(D+2))<<16;case 2:C^=(255&s.charCodeAt(D+1))<<8;case 1:m^=C=(65535&(C=(C=(65535&(C^=255&s.charCodeAt(D)))*x+(((C>>>16)*x&65535)<<16)&4294967295)<<15|C>>>17))*I+(((C>>>16)*I&65535)<<16)&4294967295}return m^=s.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var d0=ol.exports,Jf={exports:{}};Jf.exports=function(s,r){for(var l,f=s.length,m=r^f,y=0;f>=4;)l=1540483477*(65535&(l=255&s.charCodeAt(y)|(255&s.charCodeAt(++y))<<8|(255&s.charCodeAt(++y))<<16|(255&s.charCodeAt(++y))<<24))+((1540483477*(l>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),f-=4,++y;switch(f){case 3:m^=(255&s.charCodeAt(y+2))<<16;case 2:m^=(255&s.charCodeAt(y+1))<<8;case 1:m=1540483477*(65535&(m^=255&s.charCodeAt(y)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var Kf=d0,Xf=Jf.exports;ud.exports=Kf,ud.exports.murmur3=Kf,ud.exports.murmur2=Xf;var hd=b(ud.exports);class eu{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,l,f,m){this.ids.push(ux(r)),this.positions.push(l,f,m)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const l=ux(r);let f=0,m=this.ids.length-1;for(;f<m;){const x=f+m>>1;this.ids[x]>=l?m=x:f=x+1}const y=[];for(;this.ids[f]===l;)y.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return y}static serialize(r,l){const f=new Float64Array(r.ids),m=new Uint32Array(r.positions);return Og(f,m,0,f.length-1),l&&l.push(f.buffer,m.buffer),{ids:f,positions:m}}static deserialize(r){const l=new eu;return l.ids=r.ids,l.positions=r.positions,l.indexed=!0,l}}function ux(s){const r=+s;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:hd(String(s))}function Og(s,r,l,f){for(;l<f;){const m=s[l+f>>1];let y=l-1,x=f+1;for(;;){do y++;while(s[y]<m);do x--;while(s[x]>m);if(y>=x)break;f0(s,y,x),f0(r,3*y,3*x),f0(r,3*y+1,3*x+1),f0(r,3*y+2,3*x+2)}x-l<f-x?(Og(s,r,l,x),l=x+1):(Og(s,r,x+1,f),f=x)}}function f0(s,r,l){const f=s[r];s[r]=s[l],s[l]=f}Rt("FeaturePositionMap",eu);class nh{constructor(r,l){this.gl=r.gl,this.location=l}}class p0 extends nh{constructor(r,l){super(r,l),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class hx extends nh{constructor(r,l){super(r,l),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class dx extends nh{constructor(r,l){super(r,l),this.current=Vn.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const wC=new Float32Array(16);function Ug(s){return[h0(255*s.r,255*s.g),h0(255*s.b,255*s.a)]}class Qf{constructor(r,l,f){this.value=r,this.uniformNames=l.map(m=>`u_${m}`),this.type=f}setUniform(r,l,f){r.set(f.constantOr(this.value))}getBinding(r,l,f){return this.type==="color"?new dx(r,l):new p0(r,l)}}class dd{constructor(r,l){this.uniformNames=l.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,l){this.pixelRatioFrom=l.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=l.tlbr,this.patternTo=r.tlbr}setUniform(r,l,f,m){const y=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&r.set(y)}getBinding(r,l,f){return f.substr(0,9)==="u_pattern"?new hx(r,l):new p0(r,l)}}class ec{constructor(r,l,f,m){this.expression=r,this.type=f,this.maxValue=0,this.paintVertexAttributes=l.map(y=>({name:`a_${y}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(r,l,f,m,y){const x=this.paintVertexArray.length,I=this.expression.evaluate(new wi(0),l,{},m,[],y);this.paintVertexArray.resize(r),this._setPaintValue(x,r,I)}updatePaintArray(r,l,f,m){const y=this.expression.evaluate({zoom:0},f,m);this._setPaintValue(r,l,y)}_setPaintValue(r,l,f){if(this.type==="color"){const m=Ug(f);for(let y=r;y<l;y++)this.paintVertexArray.emplace(y,m[0],m[1])}else{for(let m=r;m<l;m++)this.paintVertexArray.emplace(m,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Mo{constructor(r,l,f,m,y,x){this.expression=r,this.uniformNames=l.map(I=>`u_${I}_t`),this.type=f,this.useIntegerZoom=m,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=l.map(I=>({name:`a_${I}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(r,l,f,m,y){const x=this.expression.evaluate(new wi(this.zoom),l,{},m,[],y),I=this.expression.evaluate(new wi(this.zoom+1),l,{},m,[],y),C=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(C,r,x,I)}updatePaintArray(r,l,f,m){const y=this.expression.evaluate({zoom:this.zoom},f,m),x=this.expression.evaluate({zoom:this.zoom+1},f,m);this._setPaintValue(r,l,y,x)}_setPaintValue(r,l,f,m){if(this.type==="color"){const y=Ug(f),x=Ug(m);for(let I=r;I<l;I++)this.paintVertexArray.emplace(I,y[0],y[1],x[0],x[1])}else{for(let y=r;y<l;y++)this.paintVertexArray.emplace(y,f,m);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(m))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,l){const f=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,m=oe(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);r.set(m)}getBinding(r,l,f){return new p0(r,l)}}class tu{constructor(r,l,f,m,y,x){this.expression=r,this.type=l,this.useIntegerZoom=f,this.zoom=m,this.layerId=x,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(r,l,f){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(m,r,l.patterns&&l.patterns[this.layerId],f)}updatePaintArray(r,l,f,m,y){this._setPaintValues(r,l,f.patterns&&f.patterns[this.layerId],y)}_setPaintValues(r,l,f,m){if(!m||!f)return;const{min:y,mid:x,max:I}=f,C=m[y],D=m[x],z=m[I];if(C&&D&&z)for(let F=r;F<l;F++)this.zoomInPaintVertexArray.emplace(F,D.tl[0],D.tl[1],D.br[0],D.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],D.pixelRatio,C.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,D.tl[0],D.tl[1],D.br[0],D.br[1],z.tl[0],z.tl[1],z.br[0],z.br[1],D.pixelRatio,z.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,cd.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,cd.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class fx{constructor(r,l,f){this.binders={},this._buffers=[];const m=[];for(const y in r.paint._values){if(!f(y))continue;const x=r.paint.get(y);if(!(x instanceof Ws&&So(x.property.specification)))continue;const I=SC(y,r.type),C=x.value,D=x.property.specification.type,z=x.property.useIntegerZoom,F=x.property.specification["property-type"],O=F==="cross-faded"||F==="cross-faded-data-driven";if(C.kind==="constant")this.binders[y]=O?new dd(C.value,I):new Qf(C.value,I,D),m.push(`/u_${y}`);else if(C.kind==="source"||O){const q=px(y,D,"source");this.binders[y]=O?new tu(C,D,z,l,q,r.id):new ec(C,I,D,q),m.push(`/a_${y}`)}else{const q=px(y,D,"composite");this.binders[y]=new Mo(C,I,D,z,l,q),m.push(`/z_${y}`)}}this.cacheKey=m.sort().join("")}getMaxValue(r){const l=this.binders[r];return l instanceof ec||l instanceof Mo?l.maxValue:0}populatePaintArrays(r,l,f,m,y){for(const x in this.binders){const I=this.binders[x];(I instanceof ec||I instanceof Mo||I instanceof tu)&&I.populatePaintArray(r,l,f,m,y)}}setConstantPatternPositions(r,l){for(const f in this.binders){const m=this.binders[f];m instanceof dd&&m.setConstantPatternPositions(r,l)}}updatePaintArrays(r,l,f,m,y){let x=!1;for(const I in r){const C=l.getPositions(I);for(const D of C){const z=f.feature(D.index);for(const F in this.binders){const O=this.binders[F];if((O instanceof ec||O instanceof Mo||O instanceof tu)&&O.expression.isStateDependent===!0){const q=m.paint.get(F);O.expression=q.value,O.updatePaintArray(D.start,D.end,z,r[I],y),x=!0}}}}return x}defines(){const r=[];for(const l in this.binders){const f=this.binders[l];(f instanceof Qf||f instanceof dd)&&r.push(...f.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return r}getBinderAttributes(){const r=[];for(const l in this.binders){const f=this.binders[l];if(f instanceof ec||f instanceof Mo)for(let m=0;m<f.paintVertexAttributes.length;m++)r.push(f.paintVertexAttributes[m].name);else if(f instanceof tu)for(let m=0;m<cd.members.length;m++)r.push(cd.members[m].name)}return r}getBinderUniforms(){const r=[];for(const l in this.binders){const f=this.binders[l];if(f instanceof Qf||f instanceof dd||f instanceof Mo)for(const m of f.uniformNames)r.push(m)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,l){const f=[];for(const m in this.binders){const y=this.binders[m];if(y instanceof Qf||y instanceof dd||y instanceof Mo){for(const x of y.uniformNames)if(l[x]){const I=y.getBinding(r,l[x],x);f.push({name:x,property:m,binding:I})}}}return f}setUniforms(r,l,f,m){for(const{name:y,property:x,binding:I}of l)this.binders[x].setUniform(I,m,f.get(x),y)}updatePaintBuffers(r){this._buffers=[];for(const l in this.binders){const f=this.binders[l];if(r&&f instanceof tu){const m=r.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(f instanceof ec||f instanceof Mo)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(r){for(const l in this.binders){const f=this.binders[l];(f instanceof ec||f instanceof Mo||f instanceof tu)&&f.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const l=this.binders[r];(l instanceof ec||l instanceof Mo||l instanceof tu)&&l.destroy()}}}class ih{constructor(r,l,f=()=>!0){this.programConfigurations={};for(const m of r)this.programConfigurations[m.id]=new fx(m,l,f);this.needsUpload=!1,this._featureMap=new eu,this._bufferOffset=0}populatePaintArrays(r,l,f,m,y,x){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(r,l,m,y,x);l.id!==void 0&&this._featureMap.add(l.id,f,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,l,f,m){for(const y of f)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(r,this._featureMap,l,y,m)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function SC(s,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[s]||[s.replace(`${r}-`,"").replace(/-/g,"_")]}function px(s,r,l){const f={color:{source:re,composite:$t},number:{source:_t,composite:re}},m=function(y){return{"line-pattern":{source:Zr,composite:Zr},"fill-pattern":{source:Zr,composite:Zr},"fill-extrusion-pattern":{source:Zr,composite:Zr}}[y]}(s);return m&&m[l]||f[r][l]}Rt("ConstantBinder",Qf),Rt("CrossFadedConstantBinder",dd),Rt("SourceExpressionBinder",ec),Rt("CrossFadedCompositeBinder",tu),Rt("CompositeExpressionBinder",Mo),Rt("ProgramConfiguration",fx,{omit:["_buffers"]}),Rt("ProgramConfigurationSet",ih);const cr=8192,Vg=Math.pow(2,14)-1,mx=-Vg-1;function rh(s){const r=cr/s.extent,l=s.loadGeometry();for(let f=0;f<l.length;f++){const m=l[f];for(let y=0;y<m.length;y++){const x=m[y],I=Math.round(x.x*r),C=Math.round(x.y*r);x.x=oe(I,mx,Vg),x.y=oe(C,mx,Vg),(I<x.x||I>x.x+1||C<x.y||C>x.y+1)&&qe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return l}function ah(s,r){return{type:s.type,id:s.id,properties:s.properties,geometry:r?rh(s):[]}}function m0(s,r,l,f,m){s.emplaceBack(2*r+(f+1)/2,2*l+(m+1)/2)}class jg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new od,this.indexArray=new zr,this.segments=new Cr,this.programConfigurations=new ih(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,f){const m=this.layers[0],y=[];let x=null,I=!1;m.type==="circle"&&(x=m.layout.get("circle-sort-key"),I=!x.isConstant());for(const{feature:C,id:D,index:z,sourceLayerIndex:F}of r){const O=this.layers[0]._featureFilter.needGeometry,q=ah(C,O);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),q,f))continue;const G=I?x.evaluate(q,{},f):void 0,$={id:D,properties:C.properties,type:C.type,sourceLayerIndex:F,index:z,geometry:O?q.geometry:rh(C),patterns:{},sortKey:G};y.push($)}I&&y.sort((C,D)=>C.sortKey-D.sortKey);for(const C of y){const{geometry:D,index:z,sourceLayerIndex:F}=C,O=r[z].feature;this.addFeature(C,D,z,f),l.featureIndex.insert(O,D,z,F,this.index)}}update(r,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Yf),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,l,f,m){for(const y of l)for(const x of y){const I=x.x,C=x.y;if(I<0||I>=cr||C<0||C>=cr)continue;const D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),z=D.vertexLength;m0(this.layoutVertexArray,I,C,-1,-1),m0(this.layoutVertexArray,I,C,1,-1),m0(this.layoutVertexArray,I,C,1,1),m0(this.layoutVertexArray,I,C,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+3,z+2),D.vertexLength+=4,D.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,{},m)}}function _x(s,r){for(let l=0;l<s.length;l++)if(fd(r,s[l]))return!0;for(let l=0;l<r.length;l++)if(fd(s,r[l]))return!0;return!!qg(s,r)}function IC(s,r,l){return!!fd(s,r)||!!Hg(r,s,l)}function gx(s,r){if(s.length===1)return bx(r,s[0]);for(let l=0;l<r.length;l++){const f=r[l];for(let m=0;m<f.length;m++)if(fd(s,f[m]))return!0}for(let l=0;l<s.length;l++)if(bx(r,s[l]))return!0;for(let l=0;l<r.length;l++)if(qg(s,r[l]))return!0;return!1}function TC(s,r,l){if(s.length>1){if(qg(s,r))return!0;for(let f=0;f<r.length;f++)if(Hg(r[f],s,l))return!0}for(let f=0;f<s.length;f++)if(Hg(s[f],r,l))return!0;return!1}function qg(s,r){if(s.length===0||r.length===0)return!1;for(let l=0;l<s.length-1;l++){const f=s[l],m=s[l+1];for(let y=0;y<r.length-1;y++)if(MC(f,m,r[y],r[y+1]))return!0}return!1}function MC(s,r,l,f){return He(s,l,f)!==He(r,l,f)&&He(s,r,l)!==He(s,r,f)}function Hg(s,r,l){const f=l*l;if(r.length===1)return s.distSqr(r[0])<f;for(let m=1;m<r.length;m++)if(yx(s,r[m-1],r[m])<f)return!0;return!1}function yx(s,r,l){const f=r.distSqr(l);if(f===0)return s.distSqr(r);const m=((s.x-r.x)*(l.x-r.x)+(s.y-r.y)*(l.y-r.y))/f;return s.distSqr(m<0?r:m>1?l:l.sub(r)._mult(m)._add(r))}function bx(s,r){let l,f,m,y=!1;for(let x=0;x<s.length;x++){l=s[x];for(let I=0,C=l.length-1;I<l.length;C=I++)f=l[I],m=l[C],f.y>r.y!=m.y>r.y&&r.x<(m.x-f.x)*(r.y-f.y)/(m.y-f.y)+f.x&&(y=!y)}return y}function fd(s,r){let l=!1;for(let f=0,m=s.length-1;f<s.length;m=f++){const y=s[f],x=s[m];y.y>r.y!=x.y>r.y&&r.x<(x.x-y.x)*(r.y-y.y)/(x.y-y.y)+y.x&&(l=!l)}return l}function AC(s,r,l){const f=l[0],m=l[2];if(s.x<f.x&&r.x<f.x||s.x>m.x&&r.x>m.x||s.y<f.y&&r.y<f.y||s.y>m.y&&r.y>m.y)return!1;const y=He(s,r,l[0]);return y!==He(s,r,l[1])||y!==He(s,r,l[2])||y!==He(s,r,l[3])}function $f(s,r,l){const f=r.paint.get(s).value;return f.kind==="constant"?f.value:l.programConfigurations.get(r.id).getMaxValue(s)}function _0(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function g0(s,r,l,f,m){if(!r[0]&&!r[1])return s;const y=M.convert(r)._mult(m);l==="viewport"&&y._rotate(-f);const x=[];for(let I=0;I<s.length;I++)x.push(s[I].sub(y));return x}let vx,xx;Rt("CircleBucket",jg,{omit:["layers"]});var CC={get paint(){return xx=xx||new p({"circle-radius":new Xt(De.paint_circle["circle-radius"]),"circle-color":new Xt(De.paint_circle["circle-color"]),"circle-blur":new Xt(De.paint_circle["circle-blur"]),"circle-opacity":new Xt(De.paint_circle["circle-opacity"]),"circle-translate":new Gt(De.paint_circle["circle-translate"]),"circle-translate-anchor":new Gt(De.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Gt(De.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Gt(De.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xt(De.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xt(De.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xt(De.paint_circle["circle-stroke-opacity"])})},get layout(){return vx=vx||new p({"circle-sort-key":new Xt(De.layout_circle["circle-sort-key"])})}},Ea=1e-6,pd=typeof Float32Array<"u"?Float32Array:Array;function Wg(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function wx(s,r,l){var f=r[0],m=r[1],y=r[2],x=r[3],I=r[4],C=r[5],D=r[6],z=r[7],F=r[8],O=r[9],q=r[10],G=r[11],$=r[12],ae=r[13],he=r[14],ke=r[15],ge=l[0],Ie=l[1],Ze=l[2],et=l[3];return s[0]=ge*f+Ie*I+Ze*F+et*$,s[1]=ge*m+Ie*C+Ze*O+et*ae,s[2]=ge*y+Ie*D+Ze*q+et*he,s[3]=ge*x+Ie*z+Ze*G+et*ke,s[4]=(ge=l[4])*f+(Ie=l[5])*I+(Ze=l[6])*F+(et=l[7])*$,s[5]=ge*m+Ie*C+Ze*O+et*ae,s[6]=ge*y+Ie*D+Ze*q+et*he,s[7]=ge*x+Ie*z+Ze*G+et*ke,s[8]=(ge=l[8])*f+(Ie=l[9])*I+(Ze=l[10])*F+(et=l[11])*$,s[9]=ge*m+Ie*C+Ze*O+et*ae,s[10]=ge*y+Ie*D+Ze*q+et*he,s[11]=ge*x+Ie*z+Ze*G+et*ke,s[12]=(ge=l[12])*f+(Ie=l[13])*I+(Ze=l[14])*F+(et=l[15])*$,s[13]=ge*m+Ie*C+Ze*O+et*ae,s[14]=ge*y+Ie*D+Ze*q+et*he,s[15]=ge*x+Ie*z+Ze*G+et*ke,s}Math.hypot||(Math.hypot=function(){for(var s=0,r=arguments.length;r--;)s+=arguments[r]*arguments[r];return Math.sqrt(s)});var ep,kC=wx;function y0(s,r,l){var f=r[0],m=r[1],y=r[2],x=r[3];return s[0]=l[0]*f+l[4]*m+l[8]*y+l[12]*x,s[1]=l[1]*f+l[5]*m+l[9]*y+l[13]*x,s[2]=l[2]*f+l[6]*m+l[10]*y+l[14]*x,s[3]=l[3]*f+l[7]*m+l[11]*y+l[15]*x,s}ep=new pd(4),pd!=Float32Array&&(ep[0]=0,ep[1]=0,ep[2]=0,ep[3]=0);class EC extends v{constructor(r){super(r,CC)}createBucket(r){return new jg(r)}queryRadius(r){const l=r;return $f("circle-radius",this,l)+$f("circle-stroke-width",this,l)+_0(this.paint.get("circle-translate"))}queryIntersectsFeature(r,l,f,m,y,x,I,C){const D=g0(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,I),z=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f),F=this.paint.get("circle-pitch-alignment")==="map",O=F?D:function(G,$){return G.map(ae=>Sx(ae,$))}(D,C),q=F?z*I:z;for(const G of m)for(const $ of G){const ae=F?$:Sx($,C);let he=q;const ke=y0([],[$.x,$.y,0,1],C);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?he*=ke[3]/x.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(he*=x.cameraToCenterDistance/ke[3]),IC(O,ae,he))return!0}return!1}}function Sx(s,r){const l=y0([],[s.x,s.y,0,1],r);return new M(l[0]/l[3],l[1]/l[3])}class Ix extends jg{}let Tx;Rt("HeatmapBucket",Ix,{omit:["layers"]});var DC={get paint(){return Tx=Tx||new p({"heatmap-radius":new Xt(De.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xt(De.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Gt(De.paint_heatmap["heatmap-intensity"]),"heatmap-color":new d(De.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Gt(De.paint_heatmap["heatmap-opacity"])})}};function Zg(s,{width:r,height:l},f,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==r*l*f)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${r*l*f}`)}else m=new Uint8Array(r*l*f);return s.width=r,s.height=l,s.data=m,s}function Mx(s,{width:r,height:l},f){if(r===s.width&&l===s.height)return;const m=Zg({},{width:r,height:l},f);Gg(s,m,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,r),height:Math.min(s.height,l)},f),s.width=r,s.height=l,s.data=m.data}function Gg(s,r,l,f,m,y){if(m.width===0||m.height===0)return r;if(m.width>s.width||m.height>s.height||l.x>s.width-m.width||l.y>s.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>r.width||m.height>r.height||f.x>r.width-m.width||f.y>r.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=s.data,I=r.data;if(x===I)throw new Error("srcData equals dstData, so image is already copied");for(let C=0;C<m.height;C++){const D=((l.y+C)*s.width+l.x)*y,z=((f.y+C)*r.width+f.x)*y;for(let F=0;F<m.width*y;F++)I[z+F]=x[D+F]}return r}class tp{constructor(r,l){Zg(this,r,1,l)}resize(r){Mx(this,r,1)}clone(){return new tp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,f,m,y){Gg(r,l,f,m,y,1)}}class Is{constructor(r,l){Zg(this,r,4,l)}resize(r){Mx(this,r,4)}replace(r,l){l?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Is({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,l,f,m,y){Gg(r,l,f,m,y,4)}}function Ax(s){const r={},l=s.resolution||256,f=s.clips?s.clips.length:1,m=s.image||new Is({width:l,height:f});if(Math.log(l)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${l}`);const y=(x,I,C)=>{r[s.evaluationKey]=C;const D=s.expression.evaluate(r);m.data[x+I+0]=Math.floor(255*D.r/D.a),m.data[x+I+1]=Math.floor(255*D.g/D.a),m.data[x+I+2]=Math.floor(255*D.b/D.a),m.data[x+I+3]=Math.floor(255*D.a)};if(s.clips)for(let x=0,I=0;x<f;++x,I+=4*l)for(let C=0,D=0;C<l;C++,D+=4){const z=C/(l-1),{start:F,end:O}=s.clips[x];y(I,D,F*(1-z)+O*z)}else for(let x=0,I=0;x<l;x++,I+=4)y(0,I,x/(l-1));return m}Rt("AlphaImage",tp),Rt("RGBAImage",Is);class PC extends v{createBucket(r){return new Ix(r)}constructor(r){super(r,DC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ax({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Cx;var LC={get paint(){return Cx=Cx||new p({"hillshade-illumination-direction":new Gt(De.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Gt(De.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Gt(De.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Gt(De.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Gt(De.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Gt(De.paint_hillshade["hillshade-accent-color"])})}};class zC extends v{constructor(r){super(r,LC)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const BC=L([{name:"a_pos",components:2,type:"Int16"}],4),{members:FC}=BC;var Yg={exports:{}};function b0(s,r,l){l=l||2;var f,m,y,x,I,C,D,z=r&&r.length,F=z?r[0]*l:s.length,O=kx(s,0,F,l,!0),q=[];if(!O||O.next===O.prev)return q;if(z&&(O=function($,ae,he,ke){var ge,Ie,Ze,et=[];for(ge=0,Ie=ae.length;ge<Ie;ge++)(Ze=kx($,ae[ge]*ke,ge<Ie-1?ae[ge+1]*ke:$.length,ke,!1))===Ze.next&&(Ze.steiner=!0),et.push(HC(Ze));for(et.sort(VC),ge=0;ge<et.length;ge++)he=jC(et[ge],he);return he}(s,r,O,l)),s.length>80*l){f=y=s[0],m=x=s[1];for(var G=l;G<F;G+=l)(I=s[G])<f&&(f=I),(C=s[G+1])<m&&(m=C),I>y&&(y=I),C>x&&(x=C);D=(D=Math.max(y-f,x-m))!==0?32767/D:0}return np(O,q,l,f,m,D,0),q}function kx(s,r,l,f,m){var y,x;if(m===Xg(s,r,l,f)>0)for(y=r;y<l;y+=f)x=Px(y,s[y],s[y+1],x);else for(y=l-f;y>=r;y-=f)x=Px(y,s[y],s[y+1],x);return x&&v0(x,x.next)&&(rp(x),x=x.next),x}function sh(s,r){if(!s)return s;r||(r=s);var l,f=s;do if(l=!1,f.steiner||!v0(f,f.next)&&ir(f.prev,f,f.next)!==0)f=f.next;else{if(rp(f),(f=r=f.prev)===f.next)break;l=!0}while(l||f!==r);return r}function np(s,r,l,f,m,y,x){if(s){!x&&y&&function(z,F,O,q){var G=z;do G.z===0&&(G.z=Jg(G.x,G.y,F,O,q)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==z);G.prevZ.nextZ=null,G.prevZ=null,function($){var ae,he,ke,ge,Ie,Ze,et,kt,Wt=1;do{for(he=$,$=null,Ie=null,Ze=0;he;){for(Ze++,ke=he,et=0,ae=0;ae<Wt&&(et++,ke=ke.nextZ);ae++);for(kt=Wt;et>0||kt>0&&ke;)et!==0&&(kt===0||!ke||he.z<=ke.z)?(ge=he,he=he.nextZ,et--):(ge=ke,ke=ke.nextZ,kt--),Ie?Ie.nextZ=ge:$=ge,ge.prevZ=Ie,Ie=ge;he=ke}Ie.nextZ=null,Wt*=2}while(Ze>1)}(G)}(s,f,m,y);for(var I,C,D=s;s.prev!==s.next;)if(I=s.prev,C=s.next,y?RC(s,f,m,y):NC(s))r.push(I.i/l|0),r.push(s.i/l|0),r.push(C.i/l|0),rp(s),s=C.next,D=C.next;else if((s=C)===D){x?x===1?np(s=OC(sh(s),r,l),r,l,f,m,y,2):x===2&&UC(s,r,l,f,m,y):np(sh(s),r,l,f,m,y,1);break}}}function NC(s){var r=s.prev,l=s,f=s.next;if(ir(r,l,f)>=0)return!1;for(var m=r.x,y=l.x,x=f.x,I=r.y,C=l.y,D=f.y,z=m<y?m<x?m:x:y<x?y:x,F=I<C?I<D?I:D:C<D?C:D,O=m>y?m>x?m:x:y>x?y:x,q=I>C?I>D?I:D:C>D?C:D,G=f.next;G!==r;){if(G.x>=z&&G.x<=O&&G.y>=F&&G.y<=q&&md(m,I,y,C,x,D,G.x,G.y)&&ir(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function RC(s,r,l,f){var m=s.prev,y=s,x=s.next;if(ir(m,y,x)>=0)return!1;for(var I=m.x,C=y.x,D=x.x,z=m.y,F=y.y,O=x.y,q=I<C?I<D?I:D:C<D?C:D,G=z<F?z<O?z:O:F<O?F:O,$=I>C?I>D?I:D:C>D?C:D,ae=z>F?z>O?z:O:F>O?F:O,he=Jg(q,G,r,l,f),ke=Jg($,ae,r,l,f),ge=s.prevZ,Ie=s.nextZ;ge&&ge.z>=he&&Ie&&Ie.z<=ke;){if(ge.x>=q&&ge.x<=$&&ge.y>=G&&ge.y<=ae&&ge!==m&&ge!==x&&md(I,z,C,F,D,O,ge.x,ge.y)&&ir(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,Ie.x>=q&&Ie.x<=$&&Ie.y>=G&&Ie.y<=ae&&Ie!==m&&Ie!==x&&md(I,z,C,F,D,O,Ie.x,Ie.y)&&ir(Ie.prev,Ie,Ie.next)>=0))return!1;Ie=Ie.nextZ}for(;ge&&ge.z>=he;){if(ge.x>=q&&ge.x<=$&&ge.y>=G&&ge.y<=ae&&ge!==m&&ge!==x&&md(I,z,C,F,D,O,ge.x,ge.y)&&ir(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;Ie&&Ie.z<=ke;){if(Ie.x>=q&&Ie.x<=$&&Ie.y>=G&&Ie.y<=ae&&Ie!==m&&Ie!==x&&md(I,z,C,F,D,O,Ie.x,Ie.y)&&ir(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.nextZ}return!0}function OC(s,r,l){var f=s;do{var m=f.prev,y=f.next.next;!v0(m,y)&&Ex(m,f,f.next,y)&&ip(m,y)&&ip(y,m)&&(r.push(m.i/l|0),r.push(f.i/l|0),r.push(y.i/l|0),rp(f),rp(f.next),f=s=y),f=f.next}while(f!==s);return sh(f)}function UC(s,r,l,f,m,y){var x=s;do{for(var I=x.next.next;I!==x.prev;){if(x.i!==I.i&&WC(x,I)){var C=Dx(x,I);return x=sh(x,x.next),C=sh(C,C.next),np(x,r,l,f,m,y,0),void np(C,r,l,f,m,y,0)}I=I.next}x=x.next}while(x!==s)}function VC(s,r){return s.x-r.x}function jC(s,r){var l=function(m,y){var x,I=y,C=m.x,D=m.y,z=-1/0;do{if(D<=I.y&&D>=I.next.y&&I.next.y!==I.y){var F=I.x+(D-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(F<=C&&F>z&&(z=F,x=I.x<I.next.x?I:I.next,F===C))return x}I=I.next}while(I!==y);if(!x)return null;var O,q=x,G=x.x,$=x.y,ae=1/0;I=x;do C>=I.x&&I.x>=G&&C!==I.x&&md(D<$?C:z,D,G,$,D<$?z:C,D,I.x,I.y)&&(O=Math.abs(D-I.y)/(C-I.x),ip(I,m)&&(O<ae||O===ae&&(I.x>x.x||I.x===x.x&&qC(x,I)))&&(x=I,ae=O)),I=I.next;while(I!==q);return x}(s,r);if(!l)return r;var f=Dx(l,s);return sh(f,f.next),sh(l,l.next)}function qC(s,r){return ir(s.prev,s,r.prev)<0&&ir(r.next,s,s.next)<0}function Jg(s,r,l,f,m){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-l)*m|0)|s<<8))|s<<4))|s<<2))|s<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-f)*m|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function HC(s){var r=s,l=s;do(r.x<l.x||r.x===l.x&&r.y<l.y)&&(l=r),r=r.next;while(r!==s);return l}function md(s,r,l,f,m,y,x,I){return(m-x)*(r-I)>=(s-x)*(y-I)&&(s-x)*(f-I)>=(l-x)*(r-I)&&(l-x)*(y-I)>=(m-x)*(f-I)}function WC(s,r){return s.next.i!==r.i&&s.prev.i!==r.i&&!function(l,f){var m=l;do{if(m.i!==l.i&&m.next.i!==l.i&&m.i!==f.i&&m.next.i!==f.i&&Ex(m,m.next,l,f))return!0;m=m.next}while(m!==l);return!1}(s,r)&&(ip(s,r)&&ip(r,s)&&function(l,f){var m=l,y=!1,x=(l.x+f.x)/2,I=(l.y+f.y)/2;do m.y>I!=m.next.y>I&&m.next.y!==m.y&&x<(m.next.x-m.x)*(I-m.y)/(m.next.y-m.y)+m.x&&(y=!y),m=m.next;while(m!==l);return y}(s,r)&&(ir(s.prev,s,r.prev)||ir(s,r.prev,r))||v0(s,r)&&ir(s.prev,s,s.next)>0&&ir(r.prev,r,r.next)>0)}function ir(s,r,l){return(r.y-s.y)*(l.x-r.x)-(r.x-s.x)*(l.y-r.y)}function v0(s,r){return s.x===r.x&&s.y===r.y}function Ex(s,r,l,f){var m=w0(ir(s,r,l)),y=w0(ir(s,r,f)),x=w0(ir(l,f,s)),I=w0(ir(l,f,r));return m!==y&&x!==I||!(m!==0||!x0(s,l,r))||!(y!==0||!x0(s,f,r))||!(x!==0||!x0(l,s,f))||!(I!==0||!x0(l,r,f))}function x0(s,r,l){return r.x<=Math.max(s.x,l.x)&&r.x>=Math.min(s.x,l.x)&&r.y<=Math.max(s.y,l.y)&&r.y>=Math.min(s.y,l.y)}function w0(s){return s>0?1:s<0?-1:0}function ip(s,r){return ir(s.prev,s,s.next)<0?ir(s,r,s.next)>=0&&ir(s,s.prev,r)>=0:ir(s,r,s.prev)<0||ir(s,s.next,r)<0}function Dx(s,r){var l=new Kg(s.i,s.x,s.y),f=new Kg(r.i,r.x,r.y),m=s.next,y=r.prev;return s.next=r,r.prev=s,l.next=m,m.prev=l,f.next=l,l.prev=f,y.next=f,f.prev=y,f}function Px(s,r,l,f){var m=new Kg(s,r,l);return f?(m.next=f.next,m.prev=f,f.next.prev=m,f.next=m):(m.prev=m,m.next=m),m}function rp(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Kg(s,r,l){this.i=s,this.x=r,this.y=l,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xg(s,r,l,f){for(var m=0,y=r,x=l-f;y<l;y+=f)m+=(s[x]-s[y])*(s[y+1]+s[x+1]),x=y;return m}Yg.exports=b0,Yg.exports.default=b0,b0.deviation=function(s,r,l,f){var m=r&&r.length,y=Math.abs(Xg(s,0,m?r[0]*l:s.length,l));if(m)for(var x=0,I=r.length;x<I;x++)y-=Math.abs(Xg(s,r[x]*l,x<I-1?r[x+1]*l:s.length,l));var C=0;for(x=0;x<f.length;x+=3){var D=f[x]*l,z=f[x+1]*l,F=f[x+2]*l;C+=Math.abs((s[D]-s[F])*(s[z+1]-s[D+1])-(s[D]-s[z])*(s[F+1]-s[D+1]))}return y===0&&C===0?0:Math.abs((C-y)/y)},b0.flatten=function(s){for(var r=s[0][0].length,l={vertices:[],holes:[],dimensions:r},f=0,m=0;m<s.length;m++){for(var y=0;y<s[m].length;y++)for(var x=0;x<r;x++)l.vertices.push(s[m][y][x]);m>0&&l.holes.push(f+=s[m-1].length)}return l};var Lx=b(Yg.exports);function Qg(s,r,l){const f=l.patternDependencies;let m=!1;for(const y of r){const x=y.paint.get(`${s}-pattern`);x.isConstant()||(m=!0);const I=x.constantOr(null);I&&(m=!0,f[I.to]=!0,f[I.from]=!0)}return m}function $g(s,r,l,f,m){const y=m.patternDependencies;for(const x of r){const I=x.paint.get(`${s}-pattern`).value;if(I.kind!=="constant"){let C=I.evaluate({zoom:f-1},l,{},m.availableImages),D=I.evaluate({zoom:f},l,{},m.availableImages),z=I.evaluate({zoom:f+1},l,{},m.availableImages);C=C&&C.name?C.name:C,D=D&&D.name?D.name:D,z=z&&z.name?z.name:z,y[C]=!0,y[D]=!0,y[z]=!0,l.patterns[x.id]={min:C,mid:D,max:z}}}return l}class ey{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Xc,this.indexArray=new zr,this.indexArray2=new Ui,this.programConfigurations=new ih(r.layers,r.zoom),this.segments=new Cr,this.segments2=new Cr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,f){this.hasPattern=Qg("fill",this.layers,l);const m=this.layers[0].layout.get("fill-sort-key"),y=!m.isConstant(),x=[];for(const{feature:I,id:C,index:D,sourceLayerIndex:z}of r){const F=this.layers[0]._featureFilter.needGeometry,O=ah(I,F);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),O,f))continue;const q=y?m.evaluate(O,{},f,l.availableImages):void 0,G={id:C,properties:I.properties,type:I.type,sourceLayerIndex:z,index:D,geometry:F?O.geometry:rh(I),patterns:{},sortKey:q};x.push(G)}y&&x.sort((I,C)=>I.sortKey-C.sortKey);for(const I of x){const{geometry:C,index:D,sourceLayerIndex:z}=I;if(this.hasPattern){const F=$g("fill",this.layers,I,this.zoom,l);this.patternFeatures.push(F)}else this.addFeature(I,C,D,f,{});l.featureIndex.insert(r[D].feature,C,D,z,this.index)}}update(r,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,f)}addFeatures(r,l,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,FC),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,l,f,m,y){for(const x of go(l,500)){let I=0;for(const q of x)I+=q.length;const C=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),D=C.vertexLength,z=[],F=[];for(const q of x){if(q.length===0)continue;q!==x[0]&&F.push(z.length/2);const G=this.segments2.prepareSegment(q.length,this.layoutVertexArray,this.indexArray2),$=G.vertexLength;this.layoutVertexArray.emplaceBack(q[0].x,q[0].y),this.indexArray2.emplaceBack($+q.length-1,$),z.push(q[0].x),z.push(q[0].y);for(let ae=1;ae<q.length;ae++)this.layoutVertexArray.emplaceBack(q[ae].x,q[ae].y),this.indexArray2.emplaceBack($+ae-1,$+ae),z.push(q[ae].x),z.push(q[ae].y);G.vertexLength+=q.length,G.primitiveLength+=q.length}const O=Lx(z,F);for(let q=0;q<O.length;q+=3)this.indexArray.emplaceBack(D+O[q],D+O[q+1],D+O[q+2]);C.vertexLength+=I,C.primitiveLength+=O.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,y,m)}}let zx,Bx;Rt("FillBucket",ey,{omit:["layers","patternFeatures"]});var ZC={get paint(){return Bx=Bx||new p({"fill-antialias":new Gt(De.paint_fill["fill-antialias"]),"fill-opacity":new Xt(De.paint_fill["fill-opacity"]),"fill-color":new Xt(De.paint_fill["fill-color"]),"fill-outline-color":new Xt(De.paint_fill["fill-outline-color"]),"fill-translate":new Gt(De.paint_fill["fill-translate"]),"fill-translate-anchor":new Gt(De.paint_fill["fill-translate-anchor"]),"fill-pattern":new g(De.paint_fill["fill-pattern"])})},get layout(){return zx=zx||new p({"fill-sort-key":new Xt(De.layout_fill["fill-sort-key"])})}};class GC extends v{constructor(r){super(r,ZC)}recalculate(r,l){super.recalculate(r,l);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new ey(r)}queryRadius(){return _0(this.paint.get("fill-translate"))}queryIntersectsFeature(r,l,f,m,y,x,I){return gx(g0(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,I),m)}isTileClipped(){return!0}}const YC=L([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),JC=L([{name:"a_centroid",components:2,type:"Int16"}],4),{members:KC}=YC;var nu={},XC=w,Fx=_d;function _d(s,r,l,f,m){this.properties={},this.extent=l,this.type=0,this._pbf=s,this._geometry=-1,this._keys=f,this._values=m,s.readFields(QC,this,r)}function QC(s,r,l){s==1?r.id=l.readVarint():s==2?function(f,m){for(var y=f.readVarint()+f.pos;f.pos<y;){var x=m._keys[f.readVarint()],I=m._values[f.readVarint()];m.properties[x]=I}}(l,r):s==3?r.type=l.readVarint():s==4&&(r._geometry=l.pos)}function $C(s){for(var r,l,f=0,m=0,y=s.length,x=y-1;m<y;x=m++)f+=((l=s[x]).x-(r=s[m]).x)*(r.y+l.y);return f}_d.types=["Unknown","Point","LineString","Polygon"],_d.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var r,l=s.readVarint()+s.pos,f=1,m=0,y=0,x=0,I=[];s.pos<l;){if(m<=0){var C=s.readVarint();f=7&C,m=C>>3}if(m--,f===1||f===2)y+=s.readSVarint(),x+=s.readSVarint(),f===1&&(r&&I.push(r),r=[]),r.push(new XC(y,x));else{if(f!==7)throw new Error("unknown command "+f);r&&r.push(r[0].clone())}}return r&&I.push(r),I},_d.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var r=s.readVarint()+s.pos,l=1,f=0,m=0,y=0,x=1/0,I=-1/0,C=1/0,D=-1/0;s.pos<r;){if(f<=0){var z=s.readVarint();l=7&z,f=z>>3}if(f--,l===1||l===2)(m+=s.readSVarint())<x&&(x=m),m>I&&(I=m),(y+=s.readSVarint())<C&&(C=y),y>D&&(D=y);else if(l!==7)throw new Error("unknown command "+l)}return[x,C,I,D]},_d.prototype.toGeoJSON=function(s,r,l){var f,m,y=this.extent*Math.pow(2,l),x=this.extent*s,I=this.extent*r,C=this.loadGeometry(),D=_d.types[this.type];function z(q){for(var G=0;G<q.length;G++){var $=q[G];q[G]=[360*($.x+x)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*($.y+I)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var F=[];for(f=0;f<C.length;f++)F[f]=C[f][0];z(C=F);break;case 2:for(f=0;f<C.length;f++)z(C[f]);break;case 3:for(C=function(q){var G=q.length;if(G<=1)return[q];for(var $,ae,he=[],ke=0;ke<G;ke++){var ge=$C(q[ke]);ge!==0&&(ae===void 0&&(ae=ge<0),ae===ge<0?($&&he.push($),$=[q[ke]]):$.push(q[ke]))}return $&&he.push($),he}(C),f=0;f<C.length;f++)for(m=0;m<C[f].length;m++)z(C[f][m])}C.length===1?C=C[0]:D="Multi"+D;var O={type:"Feature",geometry:{type:D,coordinates:C},properties:this.properties};return"id"in this&&(O.id=this.id),O};var e7=Fx,Nx=Rx;function Rx(s,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(t7,this,r),this.length=this._features.length}function t7(s,r,l){s===15?r.version=l.readVarint():s===1?r.name=l.readString():s===5?r.extent=l.readVarint():s===2?r._features.push(l.pos):s===3?r._keys.push(l.readString()):s===4&&r._values.push(function(f){for(var m=null,y=f.readVarint()+f.pos;f.pos<y;){var x=f.readVarint()>>3;m=x===1?f.readString():x===2?f.readFloat():x===3?f.readDouble():x===4?f.readVarint64():x===5?f.readVarint():x===6?f.readSVarint():x===7?f.readBoolean():null}return m}(l))}Rx.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var r=this._pbf.readVarint()+this._pbf.pos;return new e7(this._pbf,r,this.extent,this._keys,this._values)};var n7=Nx;function i7(s,r,l){if(s===3){var f=new n7(l,l.readVarint()+l.pos);f.length&&(r[f.name]=f)}}nu.VectorTile=function(s,r){this.layers=s.readFields(i7,{},r)},nu.VectorTileFeature=Fx,nu.VectorTileLayer=Nx;const r7=nu.VectorTileFeature.types,ty=Math.pow(2,13);function ap(s,r,l,f,m,y,x,I){s.emplaceBack(r,l,2*Math.floor(f*ty)+x,m*ty*2,y*ty*2,Math.round(I))}class ny{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new $l,this.centroidVertexArray=new Ql,this.indexArray=new zr,this.programConfigurations=new ih(r.layers,r.zoom),this.segments=new Cr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,f){this.features=[],this.hasPattern=Qg("fill-extrusion",this.layers,l);for(const{feature:m,id:y,index:x,sourceLayerIndex:I}of r){const C=this.layers[0]._featureFilter.needGeometry,D=ah(m,C);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),D,f))continue;const z={id:y,sourceLayerIndex:I,index:x,geometry:C?D.geometry:rh(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push($g("fill-extrusion",this.layers,z,this.zoom,l)):this.addFeature(z,z.geometry,x,f,{}),l.featureIndex.insert(m,z.geometry,x,I,this.index,!0)}}addFeatures(r,l,f){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,l,f)}}update(r,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,f)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,KC),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,JC.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,l,f,m,y){const x={x:0,y:0,vertexCount:0};for(const I of go(l,500)){let C=0;for(const G of I)C+=G.length;let D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const G of I){if(G.length===0||s7(G))continue;let $=0;for(let ae=0;ae<G.length;ae++){const he=G[ae];if(ae>=1){const ke=G[ae-1];if(!a7(he,ke)){D.vertexLength+4>Cr.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ge=he.sub(ke)._perp()._unit(),Ie=ke.dist(he);$+Ie>32768&&($=0),ap(this.layoutVertexArray,he.x,he.y,ge.x,ge.y,0,0,$),ap(this.layoutVertexArray,he.x,he.y,ge.x,ge.y,0,1,$),x.x+=2*he.x,x.y+=2*he.y,x.vertexCount+=2,$+=Ie,ap(this.layoutVertexArray,ke.x,ke.y,ge.x,ge.y,0,0,$),ap(this.layoutVertexArray,ke.x,ke.y,ge.x,ge.y,0,1,$),x.x+=2*ke.x,x.y+=2*ke.y,x.vertexCount+=2;const Ze=D.vertexLength;this.indexArray.emplaceBack(Ze,Ze+2,Ze+1),this.indexArray.emplaceBack(Ze+1,Ze+2,Ze+3),D.vertexLength+=4,D.primitiveLength+=2}}}}if(D.vertexLength+C>Cr.MAX_VERTEX_ARRAY_LENGTH&&(D=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray)),r7[r.type]!=="Polygon")continue;const z=[],F=[],O=D.vertexLength;for(const G of I)if(G.length!==0){G!==I[0]&&F.push(z.length/2);for(let $=0;$<G.length;$++){const ae=G[$];ap(this.layoutVertexArray,ae.x,ae.y,0,0,1,1,0),x.x+=ae.x,x.y+=ae.y,x.vertexCount+=1,z.push(ae.x),z.push(ae.y)}}const q=Lx(z,F);for(let G=0;G<q.length;G+=3)this.indexArray.emplaceBack(O+q[G],O+q[G+2],O+q[G+1]);D.primitiveLength+=q.length/3,D.vertexLength+=C}for(let I=0;I<x.vertexCount;I++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,y,m)}}function a7(s,r){return s.x===r.x&&(s.x<0||s.x>cr)||s.y===r.y&&(s.y<0||s.y>cr)}function s7(s){return s.every(r=>r.x<0)||s.every(r=>r.x>cr)||s.every(r=>r.y<0)||s.every(r=>r.y>cr)}let Ox;Rt("FillExtrusionBucket",ny,{omit:["layers","features"]});var o7={get paint(){return Ox=Ox||new p({"fill-extrusion-opacity":new Gt(De["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xt(De["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Gt(De["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Gt(De["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new g(De["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xt(De["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xt(De["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Gt(De["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class l7 extends v{constructor(r){super(r,o7)}createBucket(r){return new ny(r)}queryRadius(){return _0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,l,f,m,y,x,I,C){const D=g0(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,I),z=this.paint.get("fill-extrusion-height").evaluate(l,f),F=this.paint.get("fill-extrusion-base").evaluate(l,f),O=function(G,$,ae,he){const ke=[];for(const ge of G){const Ie=[ge.x,ge.y,0,1];y0(Ie,Ie,$),ke.push(new M(Ie[0]/Ie[3],Ie[1]/Ie[3]))}return ke}(D,C),q=function(G,$,ae,he){const ke=[],ge=[],Ie=he[8]*$,Ze=he[9]*$,et=he[10]*$,kt=he[11]*$,Wt=he[8]*ae,It=he[9]*ae,vt=he[10]*ae,Ot=he[11]*ae;for(const Yt of G){const Tt=[],nt=[];for(const Ht of Yt){const Vt=Ht.x,yn=Ht.y,ui=he[0]*Vt+he[4]*yn+he[12],hi=he[1]*Vt+he[5]*yn+he[13],ur=he[2]*Vt+he[6]*yn+he[14],Ms=he[3]*Vt+he[7]*yn+he[15],ga=ur+et,Er=Ms+kt,Gr=ui+Wt,ya=hi+It,Da=ur+vt,ba=Ms+Ot,hr=new M((ui+Ie)/Er,(hi+Ze)/Er);hr.z=ga/Er,Tt.push(hr);const Br=new M(Gr/ba,ya/ba);Br.z=Da/ba,nt.push(Br)}ke.push(Tt),ge.push(nt)}return[ke,ge]}(m,F,z,C);return function(G,$,ae){let he=1/0;gx(ae,$)&&(he=Ux(ae,$[0]));for(let ke=0;ke<$.length;ke++){const ge=$[ke],Ie=G[ke];for(let Ze=0;Ze<ge.length-1;Ze++){const et=ge[Ze],kt=[et,ge[Ze+1],Ie[Ze+1],Ie[Ze],et];_x(ae,kt)&&(he=Math.min(he,Ux(ae,kt)))}}return he!==1/0&&he}(q[0],q[1],O)}}function sp(s,r){return s.x*r.x+s.y*r.y}function Ux(s,r){if(s.length===1){let l=0;const f=r[l++];let m;for(;!m||f.equals(m);)if(m=r[l++],!m)return 1/0;for(;l<r.length;l++){const y=r[l],x=s[0],I=m.sub(f),C=y.sub(f),D=x.sub(f),z=sp(I,I),F=sp(I,C),O=sp(C,C),q=sp(D,I),G=sp(D,C),$=z*O-F*F,ae=(O*q-F*G)/$,he=(z*G-F*q)/$,ke=f.z*(1-ae-he)+m.z*ae+y.z*he;if(isFinite(ke))return ke}return 1/0}{let l=1/0;for(const f of r)l=Math.min(l,f.z);return l}}const c7=L([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:u7}=c7,h7=L([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:d7}=h7,f7=nu.VectorTileFeature.types,p7=Math.cos(Math.PI/180*37.5),Vx=Math.pow(2,14)/.5;class iy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(l=>l.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new ld,this.layoutVertexArray2=new Gf,this.indexArray=new zr,this.programConfigurations=new ih(r.layers,r.zoom),this.segments=new Cr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}populate(r,l,f){this.hasPattern=Qg("line",this.layers,l);const m=this.layers[0].layout.get("line-sort-key"),y=!m.isConstant(),x=[];for(const{feature:I,id:C,index:D,sourceLayerIndex:z}of r){const F=this.layers[0]._featureFilter.needGeometry,O=ah(I,F);if(!this.layers[0]._featureFilter.filter(new wi(this.zoom),O,f))continue;const q=y?m.evaluate(O,{},f):void 0,G={id:C,properties:I.properties,type:I.type,sourceLayerIndex:z,index:D,geometry:F?O.geometry:rh(I),patterns:{},sortKey:q};x.push(G)}y&&x.sort((I,C)=>I.sortKey-C.sortKey);for(const I of x){const{geometry:C,index:D,sourceLayerIndex:z}=I;if(this.hasPattern){const F=$g("line",this.layers,I,this.zoom,l);this.patternFeatures.push(F)}else this.addFeature(I,C,D,f,{});l.featureIndex.insert(r[D].feature,C,D,z,this.index)}}update(r,l,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,l,this.stateDependentLayers,f)}addFeatures(r,l,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,l,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,d7)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,u7),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,l,f,m,y){const x=this.layers[0].layout,I=x.get("line-join").evaluate(r,{}),C=x.get("line-cap"),D=x.get("line-miter-limit"),z=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const F of l)this.addLine(F,r,I,C,D,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,f,y,m)}addLine(r,l,f,m,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let he=0;he<r.length-1;he++)this.totalDistance+=r[he].dist(r[he+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const I=f7[l.type]==="Polygon";let C=r.length;for(;C>=2&&r[C-1].equals(r[C-2]);)C--;let D=0;for(;D<C-1&&r[D].equals(r[D+1]);)D++;if(C<(I?3:2))return;f==="bevel"&&(y=1.05);const z=this.overscaling<=16?15*cr/(512*this.overscaling):0,F=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let O,q,G,$,ae;this.e1=this.e2=-1,I&&(O=r[C-2],ae=r[D].sub(O)._unit()._perp());for(let he=D;he<C;he++){if(G=he===C-1?I?r[D+1]:void 0:r[he+1],G&&r[he].equals(G))continue;ae&&($=ae),O&&(q=O),O=r[he],ae=G?G.sub(O)._unit()._perp():$,$=$||ae;let ke=$.add(ae);ke.x===0&&ke.y===0||ke._unit();const ge=$.x*ae.x+$.y*ae.y,Ie=ke.x*ae.x+ke.y*ae.y,Ze=Ie!==0?1/Ie:1/0,et=2*Math.sqrt(2-2*Ie),kt=Ie<p7&&q&&G,Wt=$.x*ae.y-$.y*ae.x>0;if(kt&&he>D){const Ot=O.dist(q);if(Ot>2*z){const Yt=O.sub(O.sub(q)._mult(z/Ot)._round());this.updateDistance(q,Yt),this.addCurrentVertex(Yt,$,0,0,F),q=Yt}}const It=q&&G;let vt=It?f:I?"butt":m;if(It&&vt==="round"&&(Ze<x?vt="miter":Ze<=2&&(vt="fakeround")),vt==="miter"&&Ze>y&&(vt="bevel"),vt==="bevel"&&(Ze>2&&(vt="flipbevel"),Ze<y&&(vt="miter")),q&&this.updateDistance(q,O),vt==="miter")ke._mult(Ze),this.addCurrentVertex(O,ke,0,0,F);else if(vt==="flipbevel"){if(Ze>100)ke=ae.mult(-1);else{const Ot=Ze*$.add(ae).mag()/$.sub(ae).mag();ke._perp()._mult(Ot*(Wt?-1:1))}this.addCurrentVertex(O,ke,0,0,F),this.addCurrentVertex(O,ke.mult(-1),0,0,F)}else if(vt==="bevel"||vt==="fakeround"){const Ot=-Math.sqrt(Ze*Ze-1),Yt=Wt?Ot:0,Tt=Wt?0:Ot;if(q&&this.addCurrentVertex(O,$,Yt,Tt,F),vt==="fakeround"){const nt=Math.round(180*et/Math.PI/20);for(let Ht=1;Ht<nt;Ht++){let Vt=Ht/nt;if(Vt!==.5){const ui=Vt-.5;Vt+=Vt*ui*(Vt-1)*((1.0904+ge*(ge*(3.55645-1.43519*ge)-3.2452))*ui*ui+(.848013+ge*(.215638*ge-1.06021)))}const yn=ae.sub($)._mult(Vt)._add($)._unit()._mult(Wt?-1:1);this.addHalfVertex(O,yn.x,yn.y,!1,Wt,0,F)}}G&&this.addCurrentVertex(O,ae,-Yt,-Tt,F)}else if(vt==="butt")this.addCurrentVertex(O,ke,0,0,F);else if(vt==="square"){const Ot=q?1:-1;this.addCurrentVertex(O,ke,Ot,Ot,F)}else vt==="round"&&(q&&(this.addCurrentVertex(O,$,0,0,F),this.addCurrentVertex(O,$,1,1,F,!0)),G&&(this.addCurrentVertex(O,ae,-1,-1,F,!0),this.addCurrentVertex(O,ae,0,0,F)));if(kt&&he<C-1){const Ot=O.dist(G);if(Ot>2*z){const Yt=O.add(G.sub(O)._mult(z/Ot)._round());this.updateDistance(O,Yt),this.addCurrentVertex(Yt,ae,0,0,F),O=Yt}}}}addCurrentVertex(r,l,f,m,y,x=!1){const I=l.y*m-l.x,C=-l.y-l.x*m;this.addHalfVertex(r,l.x+l.y*f,l.y-l.x*f,x,!1,f,y),this.addHalfVertex(r,I,C,x,!0,-m,y),this.distance>Vx/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,l,f,m,y,x))}addHalfVertex({x:r,y:l},f,m,y,x,I,C){const D=.5*(this.lineClips?this.scaledDistance*(Vx-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(y?1:0),(l<<1)+(x?1:0),Math.round(63*f)+128,Math.round(63*m)+128,1+(I===0?0:I<0?-1:1)|(63&D)<<2,D>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const z=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),C.primitiveLength++),x?this.e2=z:this.e1=z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,l){this.distance+=r.dist(l),this.updateScaledDistance()}}let jx,qx;Rt("LineBucket",iy,{omit:["layers","patternFeatures"]});var Hx={get paint(){return qx=qx||new p({"line-opacity":new Xt(De.paint_line["line-opacity"]),"line-color":new Xt(De.paint_line["line-color"]),"line-translate":new Gt(De.paint_line["line-translate"]),"line-translate-anchor":new Gt(De.paint_line["line-translate-anchor"]),"line-width":new Xt(De.paint_line["line-width"]),"line-gap-width":new Xt(De.paint_line["line-gap-width"]),"line-offset":new Xt(De.paint_line["line-offset"]),"line-blur":new Xt(De.paint_line["line-blur"]),"line-dasharray":new a(De.paint_line["line-dasharray"]),"line-pattern":new g(De.paint_line["line-pattern"]),"line-gradient":new d(De.paint_line["line-gradient"])})},get layout(){return jx=jx||new p({"line-cap":new Gt(De.layout_line["line-cap"]),"line-join":new Xt(De.layout_line["line-join"]),"line-miter-limit":new Gt(De.layout_line["line-miter-limit"]),"line-round-limit":new Gt(De.layout_line["line-round-limit"]),"line-sort-key":new Xt(De.layout_line["line-sort-key"])})}};class m7 extends Xt{possiblyEvaluate(r,l){return l=new wi(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,zoomHistory:l.zoomHistory,transition:l.transition}),super.possiblyEvaluate(r,l)}evaluate(r,l,f,m){return l=ne({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(r,l,f,m)}}let S0;class _7 extends v{constructor(r){super(r,Hx),this.gradientVersion=0,S0||(S0=new m7(Hx.paint.properties["line-width"].specification),S0.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const l=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(l)&&l._styleExpression.expression instanceof fo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,l){super.recalculate(r,l),this.paint._values["line-floorwidth"]=S0.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new iy(r)}queryRadius(r){const l=r,f=Wx($f("line-width",this,l),$f("line-gap-width",this,l)),m=$f("line-offset",this,l);return f/2+Math.abs(m)+_0(this.paint.get("line-translate"))}queryIntersectsFeature(r,l,f,m,y,x,I){const C=g0(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,I),D=I/2*Wx(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),z=this.paint.get("line-offset").evaluate(l,f);return z&&(m=function(F,O){const q=[];for(let G=0;G<F.length;G++){const $=F[G],ae=[];for(let he=0;he<$.length;he++){const ke=$[he-1],ge=$[he],Ie=$[he+1],Ze=he===0?new M(0,0):ge.sub(ke)._unit()._perp(),et=he===$.length-1?new M(0,0):Ie.sub(ge)._unit()._perp(),kt=Ze._add(et)._unit(),Wt=kt.x*et.x+kt.y*et.y;Wt!==0&&kt._mult(1/Wt),ae.push(kt._mult(O)._add(ge))}q.push(ae)}return q}(m,z*I)),function(F,O,q){for(let G=0;G<O.length;G++){const $=O[G];if(F.length>=3){for(let ae=0;ae<$.length;ae++)if(fd(F,$[ae]))return!0}if(TC(F,$,q))return!0}return!1}(C,m,D)}isTileClipped(){return!0}}function Wx(s,r){return r>0?r+2*s:s}const g7=L([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),y7=L([{name:"a_projected_pos",components:3,type:"Float32"}],4);L([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const b7=L([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);L([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Zx=L([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),v7=L([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function x7(s,r,l){return s.sections.forEach(f=>{f.text=function(m,y,x){const I=y.layout.get("text-transform").evaluate(x,{});return I==="uppercase"?m=m.toLocaleUpperCase():I==="lowercase"&&(m=m.toLocaleLowerCase()),al.applyArabicShaping&&(m=al.applyArabicShaping(m)),m}(f.text,r,l)}),s}L([{name:"triangle",components:3,type:"Uint16"}]),L([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),L([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),L([{type:"Float32",name:"offsetX"}]),L([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),L([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const op={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var kr=24,Gx=ci,Yx=function(s,r,l,f,m){var y,x,I=8*m-f-1,C=(1<<I)-1,D=C>>1,z=-7,F=m-1,O=-1,q=s[r+F];for(F+=O,y=q&(1<<-z)-1,q>>=-z,z+=I;z>0;y=256*y+s[r+F],F+=O,z-=8);for(x=y&(1<<-z)-1,y>>=-z,z+=f;z>0;x=256*x+s[r+F],F+=O,z-=8);if(y===0)y=1-D;else{if(y===C)return x?NaN:1/0*(q?-1:1);x+=Math.pow(2,f),y-=D}return(q?-1:1)*x*Math.pow(2,y-f)},Jx=function(s,r,l,f,m,y){var x,I,C,D=8*y-m-1,z=(1<<D)-1,F=z>>1,O=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=0,G=1,$=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(I=isNaN(r)?1:0,x=z):(x=Math.floor(Math.log(r)/Math.LN2),r*(C=Math.pow(2,-x))<1&&(x--,C*=2),(r+=x+F>=1?O/C:O*Math.pow(2,1-F))*C>=2&&(x++,C/=2),x+F>=z?(I=0,x=z):x+F>=1?(I=(r*C-1)*Math.pow(2,m),x+=F):(I=r*Math.pow(2,F-1)*Math.pow(2,m),x=0));m>=8;s[l+q]=255&I,q+=G,I/=256,m-=8);for(x=x<<m|I,D+=m;D>0;s[l+q]=255&x,q+=G,x/=256,D-=8);s[l+q-G]|=128*$};function ci(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}ci.Varint=0,ci.Fixed64=1,ci.Bytes=2,ci.Fixed32=5;var ry=4294967296,Kx=1/ry,Xx=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function tc(s){return s.type===ci.Bytes?s.readVarint()+s.pos:s.pos+1}function gd(s,r,l){return l?4294967296*r+(s>>>0):4294967296*(r>>>0)+(s>>>0)}function Qx(s,r,l){var f=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));l.realloc(f);for(var m=l.pos-1;m>=s;m--)l.buf[m+f]=l.buf[m]}function w7(s,r){for(var l=0;l<s.length;l++)r.writeVarint(s[l])}function S7(s,r){for(var l=0;l<s.length;l++)r.writeSVarint(s[l])}function I7(s,r){for(var l=0;l<s.length;l++)r.writeFloat(s[l])}function T7(s,r){for(var l=0;l<s.length;l++)r.writeDouble(s[l])}function M7(s,r){for(var l=0;l<s.length;l++)r.writeBoolean(s[l])}function A7(s,r){for(var l=0;l<s.length;l++)r.writeFixed32(s[l])}function C7(s,r){for(var l=0;l<s.length;l++)r.writeSFixed32(s[l])}function k7(s,r){for(var l=0;l<s.length;l++)r.writeFixed64(s[l])}function E7(s,r){for(var l=0;l<s.length;l++)r.writeSFixed64(s[l])}function I0(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+16777216*s[r+3]}function yd(s,r,l){s[l]=r,s[l+1]=r>>>8,s[l+2]=r>>>16,s[l+3]=r>>>24}function $x(s,r){return(s[r]|s[r+1]<<8|s[r+2]<<16)+(s[r+3]<<24)}ci.prototype={destroy:function(){this.buf=null},readFields:function(s,r,l){for(l=l||this.length;this.pos<l;){var f=this.readVarint(),m=f>>3,y=this.pos;this.type=7&f,s(m,r,this),this.pos===y&&this.skip(f)}return r},readMessage:function(s,r){return this.readFields(s,r,this.readVarint()+this.pos)},readFixed32:function(){var s=I0(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=$x(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=I0(this.buf,this.pos)+I0(this.buf,this.pos+4)*ry;return this.pos+=8,s},readSFixed64:function(){var s=I0(this.buf,this.pos)+$x(this.buf,this.pos+4)*ry;return this.pos+=8,s},readFloat:function(){var s=Yx(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Yx(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var r,l,f=this.buf;return r=127&(l=f[this.pos++]),l<128?r:(r|=(127&(l=f[this.pos++]))<<7,l<128?r:(r|=(127&(l=f[this.pos++]))<<14,l<128?r:(r|=(127&(l=f[this.pos++]))<<21,l<128?r:function(m,y,x){var I,C,D=x.buf;if(I=(112&(C=D[x.pos++]))>>4,C<128||(I|=(127&(C=D[x.pos++]))<<3,C<128)||(I|=(127&(C=D[x.pos++]))<<10,C<128)||(I|=(127&(C=D[x.pos++]))<<17,C<128)||(I|=(127&(C=D[x.pos++]))<<24,C<128)||(I|=(1&(C=D[x.pos++]))<<31,C<128))return gd(m,I,y);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(l=f[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,r=this.pos;return this.pos=s,s-r>=12&&Xx?function(l,f,m){return Xx.decode(l.subarray(f,m))}(this.buf,r,s):function(l,f,m){for(var y="",x=f;x<m;){var I,C,D,z=l[x],F=null,O=z>239?4:z>223?3:z>191?2:1;if(x+O>m)break;O===1?z<128&&(F=z):O===2?(192&(I=l[x+1]))==128&&(F=(31&z)<<6|63&I)<=127&&(F=null):O===3?(C=l[x+2],(192&(I=l[x+1]))==128&&(192&C)==128&&((F=(15&z)<<12|(63&I)<<6|63&C)<=2047||F>=55296&&F<=57343)&&(F=null)):O===4&&(C=l[x+2],D=l[x+3],(192&(I=l[x+1]))==128&&(192&C)==128&&(192&D)==128&&((F=(15&z)<<18|(63&I)<<12|(63&C)<<6|63&D)<=65535||F>=1114112)&&(F=null)),F===null?(F=65533,O=1):F>65535&&(F-=65536,y+=String.fromCharCode(F>>>10&1023|55296),F=56320|1023&F),y+=String.fromCharCode(F),x+=O}return y}(this.buf,r,s)},readBytes:function(){var s=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,s);return this.pos=s,r},readPackedVarint:function(s,r){if(this.type!==ci.Bytes)return s.push(this.readVarint(r));var l=tc(this);for(s=s||[];this.pos<l;)s.push(this.readVarint(r));return s},readPackedSVarint:function(s){if(this.type!==ci.Bytes)return s.push(this.readSVarint());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==ci.Bytes)return s.push(this.readBoolean());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==ci.Bytes)return s.push(this.readFloat());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==ci.Bytes)return s.push(this.readDouble());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==ci.Bytes)return s.push(this.readFixed32());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==ci.Bytes)return s.push(this.readSFixed32());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==ci.Bytes)return s.push(this.readFixed64());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==ci.Bytes)return s.push(this.readSFixed64());var r=tc(this);for(s=s||[];this.pos<r;)s.push(this.readSFixed64());return s},skip:function(s){var r=7&s;if(r===ci.Varint)for(;this.buf[this.pos++]>127;);else if(r===ci.Bytes)this.pos=this.readVarint()+this.pos;else if(r===ci.Fixed32)this.pos+=4;else{if(r!==ci.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(s,r){this.writeVarint(s<<3|r)},realloc:function(s){for(var r=this.length||16;r<this.pos+s;)r*=2;if(r!==this.length){var l=new Uint8Array(r);l.set(this.buf),this.buf=l,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),yd(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),yd(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),yd(this.buf,-1&s,this.pos),yd(this.buf,Math.floor(s*Kx),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),yd(this.buf,-1&s,this.pos),yd(this.buf,Math.floor(s*Kx),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?function(r,l){var f,m;if(r>=0?(f=r%4294967296|0,m=r/4294967296|0):(m=~(-r/4294967296),4294967295^(f=~(-r%4294967296))?f=f+1|0:(f=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");l.realloc(10),function(y,x,I){I.buf[I.pos++]=127&y|128,y>>>=7,I.buf[I.pos++]=127&y|128,y>>>=7,I.buf[I.pos++]=127&y|128,y>>>=7,I.buf[I.pos++]=127&y|128,I.buf[I.pos]=127&(y>>>=7)}(f,0,l),function(y,x){var I=(7&y)<<4;x.buf[x.pos++]|=I|((y>>>=3)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y|((y>>>=7)?128:0),y&&(x.buf[x.pos++]=127&y)))))}(m,l)}(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var r=this.pos;this.pos=function(f,m,y){for(var x,I,C=0;C<m.length;C++){if((x=m.charCodeAt(C))>55295&&x<57344){if(!I){x>56319||C+1===m.length?(f[y++]=239,f[y++]=191,f[y++]=189):I=x;continue}if(x<56320){f[y++]=239,f[y++]=191,f[y++]=189,I=x;continue}x=I-55296<<10|x-56320|65536,I=null}else I&&(f[y++]=239,f[y++]=191,f[y++]=189,I=null);x<128?f[y++]=x:(x<2048?f[y++]=x>>6|192:(x<65536?f[y++]=x>>12|224:(f[y++]=x>>18|240,f[y++]=x>>12&63|128),f[y++]=x>>6&63|128),f[y++]=63&x|128)}return y}(this.buf,s,this.pos);var l=this.pos-r;l>=128&&Qx(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeFloat:function(s){this.realloc(4),Jx(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Jx(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var r=s.length;this.writeVarint(r),this.realloc(r);for(var l=0;l<r;l++)this.buf[this.pos++]=s[l]},writeRawMessage:function(s,r){this.pos++;var l=this.pos;s(r,this);var f=this.pos-l;f>=128&&Qx(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f},writeMessage:function(s,r,l){this.writeTag(s,ci.Bytes),this.writeRawMessage(r,l)},writePackedVarint:function(s,r){r.length&&this.writeMessage(s,w7,r)},writePackedSVarint:function(s,r){r.length&&this.writeMessage(s,S7,r)},writePackedBoolean:function(s,r){r.length&&this.writeMessage(s,M7,r)},writePackedFloat:function(s,r){r.length&&this.writeMessage(s,I7,r)},writePackedDouble:function(s,r){r.length&&this.writeMessage(s,T7,r)},writePackedFixed32:function(s,r){r.length&&this.writeMessage(s,A7,r)},writePackedSFixed32:function(s,r){r.length&&this.writeMessage(s,C7,r)},writePackedFixed64:function(s,r){r.length&&this.writeMessage(s,k7,r)},writePackedSFixed64:function(s,r){r.length&&this.writeMessage(s,E7,r)},writeBytesField:function(s,r){this.writeTag(s,ci.Bytes),this.writeBytes(r)},writeFixed32Field:function(s,r){this.writeTag(s,ci.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(s,r){this.writeTag(s,ci.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(s,r){this.writeTag(s,ci.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(s,r){this.writeTag(s,ci.Fixed64),this.writeSFixed64(r)},writeVarintField:function(s,r){this.writeTag(s,ci.Varint),this.writeVarint(r)},writeSVarintField:function(s,r){this.writeTag(s,ci.Varint),this.writeSVarint(r)},writeStringField:function(s,r){this.writeTag(s,ci.Bytes),this.writeString(r)},writeFloatField:function(s,r){this.writeTag(s,ci.Fixed32),this.writeFloat(r)},writeDoubleField:function(s,r){this.writeTag(s,ci.Fixed64),this.writeDouble(r)},writeBooleanField:function(s,r){this.writeVarintField(s,!!r)}};var ay=b(Gx);const sy=3;function D7(s,r,l){s===1&&l.readMessage(P7,r)}function P7(s,r,l){if(s===3){const{id:f,bitmap:m,width:y,height:x,left:I,top:C,advance:D}=l.readMessage(L7,{});r.push({id:f,bitmap:new tp({width:y+2*sy,height:x+2*sy},m),metrics:{width:y,height:x,left:I,top:C,advance:D}})}}function L7(s,r,l){s===1?r.id=l.readVarint():s===2?r.bitmap=l.readBytes():s===3?r.width=l.readVarint():s===4?r.height=l.readVarint():s===5?r.left=l.readSVarint():s===6?r.top=l.readSVarint():s===7&&(r.advance=l.readVarint())}const ew=sy;function tw(s){let r=0,l=0;for(const x of s)r+=x.w*x.h,l=Math.max(l,x.w);s.sort((x,I)=>I.h-x.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),l),h:1/0}];let m=0,y=0;for(const x of s)for(let I=f.length-1;I>=0;I--){const C=f[I];if(!(x.w>C.w||x.h>C.h)){if(x.x=C.x,x.y=C.y,y=Math.max(y,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===C.w&&x.h===C.h){const D=f.pop();I<f.length&&(f[I]=D)}else x.h===C.h?(C.x+=x.w,C.w-=x.w):x.w===C.w?(C.y+=x.h,C.h-=x.h):(f.push({x:C.x+x.w,y:C.y,w:C.w-x.w,h:x.h}),C.y+=x.h,C.h-=x.h);break}}return{w:m,h:y,fill:r/(m*y)||0}}const qa=1;class oy{constructor(r,{pixelRatio:l,version:f,stretchX:m,stretchY:y,content:x,textFitWidth:I,textFitHeight:C}){this.paddedRect=r,this.pixelRatio=l,this.stretchX=m,this.stretchY=y,this.content=x,this.version=f,this.textFitWidth=I,this.textFitHeight=C}get tl(){return[this.paddedRect.x+qa,this.paddedRect.y+qa]}get br(){return[this.paddedRect.x+this.paddedRect.w-qa,this.paddedRect.y+this.paddedRect.h-qa]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*qa)/this.pixelRatio,(this.paddedRect.h-2*qa)/this.pixelRatio]}}class nw{constructor(r,l){const f={},m={};this.haveRenderCallbacks=[];const y=[];this.addImages(r,f,y),this.addImages(l,m,y);const{w:x,h:I}=tw(y),C=new Is({width:x||1,height:I||1});for(const D in r){const z=r[D],F=f[D].paddedRect;Is.copy(z.data,C,{x:0,y:0},{x:F.x+qa,y:F.y+qa},z.data)}for(const D in l){const z=l[D],F=m[D].paddedRect,O=F.x+qa,q=F.y+qa,G=z.data.width,$=z.data.height;Is.copy(z.data,C,{x:0,y:0},{x:O,y:q},z.data),Is.copy(z.data,C,{x:0,y:$-1},{x:O,y:q-1},{width:G,height:1}),Is.copy(z.data,C,{x:0,y:0},{x:O,y:q+$},{width:G,height:1}),Is.copy(z.data,C,{x:G-1,y:0},{x:O-1,y:q},{width:1,height:$}),Is.copy(z.data,C,{x:0,y:0},{x:O+G,y:q},{width:1,height:$})}this.image=C,this.iconPositions=f,this.patternPositions=m}addImages(r,l,f){for(const m in r){const y=r[m],x={x:0,y:0,w:y.data.width+2*qa,h:y.data.height+2*qa};f.push(x),l[m]=new oy(x,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(r,l){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in r.updatedImages)this.patchUpdatedImage(this.iconPositions[f],r.getImage(f),l),this.patchUpdatedImage(this.patternPositions[f],r.getImage(f),l)}patchUpdatedImage(r,l,f){if(!r||!l||r.version===l.version)return;r.version=l.version;const[m,y]=r.tl;f.update(l.data,void 0,{x:m,y})}}var iu;Rt("ImagePosition",oy),Rt("ImageAtlas",nw),h.ah=void 0,(iu=h.ah||(h.ah={}))[iu.none=0]="none",iu[iu.horizontal=1]="horizontal",iu[iu.vertical=2]="vertical",iu[iu.horizontalOnly=3]="horizontalOnly";const lp=-17;class cp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,l){const f=new cp;return f.scale=r||1,f.fontStack=l,f}static forImage(r){const l=new cp;return l.imageName=r,l}}class bd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,l){const f=new bd;for(let m=0;m<r.sections.length;m++){const y=r.sections[m];y.image?f.addImageSection(y):f.addTextSection(y,l)}return f}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let l="";for(let f=0;f<r.length;f++){const m=r.charCodeAt(f+1)||null,y=r.charCodeAt(f-1)||null;l+=m&&l0(m)&&!op[r[f+1]]||y&&l0(y)&&!op[r[f-1]]||!op[r[f]]?r[f]:op[r[f]]}return l}(this.text)}trim(){let r=0;for(let f=0;f<this.text.length&&M0[this.text.charCodeAt(f)];f++)r++;let l=this.text.length;for(let f=this.text.length-1;f>=0&&f>=r&&M0[this.text.charCodeAt(f)];f--)l--;this.text=this.text.substring(r,l),this.sectionIndex=this.sectionIndex.slice(r,l)}substring(r,l){const f=new bd;return f.text=this.text.substring(r,l),f.sectionIndex=this.sectionIndex.slice(r,l),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,l)=>Math.max(r,this.sections[l].scale),0)}addTextSection(r,l){this.text+=r.text,this.sections.push(cp.forText(r.scale,r.fontStack||l));const f=this.sections.length-1;for(let m=0;m<r.text.length;++m)this.sectionIndex.push(f)}addImageSection(r){const l=r.image?r.image.name:"";if(l.length===0)return void qe("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(cp.forImage(l)),this.sectionIndex.push(this.sections.length-1)):qe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function T0(s,r,l,f,m,y,x,I,C,D,z,F,O,q,G,$){const ae=bd.fromFeature(s,m);let he;F===h.ah.vertical&&ae.verticalizePunctuation();const{processBidirectionalText:ke,processStyledBidirectionalText:ge}=al;if(ke&&ae.sections.length===1){he=[];const et=ke(ae.toString(),ly(ae,D,y,r,f,q,G));for(const kt of et){const Wt=new bd;Wt.text=kt,Wt.sections=ae.sections;for(let It=0;It<kt.length;It++)Wt.sectionIndex.push(0);he.push(Wt)}}else if(ge){he=[];const et=ge(ae.text,ae.sectionIndex,ly(ae,D,y,r,f,q,G));for(const kt of et){const Wt=new bd;Wt.text=kt[0],Wt.sectionIndex=kt[1],Wt.sections=ae.sections,he.push(Wt)}}else he=function(et,kt){const Wt=[],It=et.text;let vt=0;for(const Ot of kt)Wt.push(et.substring(vt,Ot)),vt=Ot;return vt<It.length&&Wt.push(et.substring(vt,It.length)),Wt}(ae,ly(ae,D,y,r,f,q,G));const Ie=[],Ze={positionedLines:Ie,text:ae.toString(),top:z[1],bottom:z[1],left:z[0],right:z[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(et,kt,Wt,It,vt,Ot,Yt,Tt,nt,Ht,Vt,yn){let ui=0,hi=lp,ur=0,Ms=0;const ga=Tt==="right"?1:Tt==="left"?0:.5;let Er=0;for(const hr of vt){hr.trim();const Br=hr.getMaxScale(),Pa=(Br-1)*kr,Ha={positionedGlyphs:[],lineOffset:0};et.positionedLines[Er]=Ha;const oa=Ha.positionedGlyphs;let Wa=0;if(!hr.length()){hi+=Ot,++Er;continue}for(let $i=0;$i<hr.length();$i++){const Mn=hr.getSection($i),dr=hr.getSectionIndex($i),la=hr.getCharCode($i);let Dr=0,Zs=null,Ao=null,Co=null,nc=kr;const Gs=!(nt===h.ah.horizontal||!Vt&&!Hf(la)||Vt&&(M0[la]||(Gr=la,Ct.Arabic(Gr)||Ct["Arabic Supplement"](Gr)||Ct["Arabic Extended-A"](Gr)||Ct["Arabic Presentation Forms-A"](Gr)||Ct["Arabic Presentation Forms-B"](Gr))));if(Mn.imageName){const Cs=It[Mn.imageName];if(!Cs)continue;Co=Mn.imageName,et.iconsInText=et.iconsInText||!0,Ao=Cs.paddedRect;const Za=Cs.displaySize;Mn.scale=Mn.scale*kr/yn,Zs={width:Za[0],height:Za[1],left:qa,top:-ew,advance:Gs?Za[1]:Za[0]},Dr=Pa+(kr-Za[1]*Mn.scale),nc=Zs.advance;const ic=Gs?Za[0]*Mn.scale-kr*Br:Za[1]*Mn.scale-kr*Br;ic>0&&ic>Wa&&(Wa=ic)}else{const Cs=Wt[Mn.fontStack],Za=Cs&&Cs[la];if(Za&&Za.rect)Ao=Za.rect,Zs=Za.metrics;else{const ic=kt[Mn.fontStack],pp=ic&&ic[la];if(!pp)continue;Zs=pp.metrics}Dr=(Br-Mn.scale)*kr}Gs?(et.verticalizable=!0,oa.push({glyph:la,imageName:Co,x:ui,y:hi+Dr,vertical:Gs,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:dr,metrics:Zs,rect:Ao}),ui+=nc*Mn.scale+Ht):(oa.push({glyph:la,imageName:Co,x:ui,y:hi+Dr,vertical:Gs,scale:Mn.scale,fontStack:Mn.fontStack,sectionIndex:dr,metrics:Zs,rect:Ao}),ui+=Zs.advance*Mn.scale+Ht)}oa.length!==0&&(ur=Math.max(ui-Ht,ur),F7(oa,0,oa.length-1,ga,Wa)),ui=0;const As=Ot*Br+Wa;Ha.lineOffset=Math.max(Wa,Pa),hi+=As,Ms=Math.max(As,Ms),++Er}var Gr;const ya=hi-lp,{horizontalAlign:Da,verticalAlign:ba}=cy(Yt);(function(hr,Br,Pa,Ha,oa,Wa,As,$i,Mn){const dr=(Br-Pa)*oa;let la=0;la=Wa!==As?-$i*Ha-lp:(-Ha*Mn+.5)*As;for(const Dr of hr)for(const Zs of Dr.positionedGlyphs)Zs.x+=dr,Zs.y+=la})(et.positionedLines,ga,Da,ba,ur,Ms,Ot,ya,vt.length),et.top+=-ba*ya,et.bottom=et.top+ya,et.left+=-Da*ur,et.right=et.left+ur}(Ze,r,l,f,he,x,I,C,F,D,O,$),!function(et){for(const kt of et)if(kt.positionedGlyphs.length!==0)return!1;return!0}(Ie)&&Ze}const M0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},z7={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function iw(s,r,l,f,m,y){if(r.imageName){const x=f[r.imageName];return x?x.displaySize[0]*r.scale*kr/y+m:0}{const x=l[r.fontStack],I=x&&x[s];return I?I.metrics.advance*r.scale+m:0}}function rw(s,r,l,f){const m=Math.pow(s-r,2);return f?s<r?m/2:2*m:m+Math.abs(l)*l}function B7(s,r,l){let f=0;return s===10&&(f-=1e4),l&&(f+=150),s!==40&&s!==65288||(f+=50),r!==41&&r!==65289||(f+=50),f}function aw(s,r,l,f,m,y){let x=null,I=rw(r,l,m,y);for(const C of f){const D=rw(r-C.x,l,m,y)+C.badness;D<=I&&(x=C,I=D)}return{index:s,x:r,priorBreak:x,badness:I}}function sw(s){return s?sw(s.priorBreak).concat(s.index):[]}function ly(s,r,l,f,m,y,x){if(y!=="point")return[];if(!s)return[];const I=[],C=function(O,q,G,$,ae,he){let ke=0;for(let ge=0;ge<O.length();ge++){const Ie=O.getSection(ge);ke+=iw(O.getCharCode(ge),Ie,$,ae,q,he)}return ke/Math.max(1,Math.ceil(ke/G))}(s,r,l,f,m,x),D=s.text.indexOf("​")>=0;let z=0;for(let O=0;O<s.length();O++){const q=s.getSection(O),G=s.getCharCode(O);if(M0[G]||(z+=iw(G,q,f,m,r,x)),O<s.length()-1){const $=!((F=G)<11904||!(Ct["Bopomofo Extended"](F)||Ct.Bopomofo(F)||Ct["CJK Compatibility Forms"](F)||Ct["CJK Compatibility Ideographs"](F)||Ct["CJK Compatibility"](F)||Ct["CJK Radicals Supplement"](F)||Ct["CJK Strokes"](F)||Ct["CJK Symbols and Punctuation"](F)||Ct["CJK Unified Ideographs Extension A"](F)||Ct["CJK Unified Ideographs"](F)||Ct["Enclosed CJK Letters and Months"](F)||Ct["Halfwidth and Fullwidth Forms"](F)||Ct.Hiragana(F)||Ct["Ideographic Description Characters"](F)||Ct["Kangxi Radicals"](F)||Ct["Katakana Phonetic Extensions"](F)||Ct.Katakana(F)||Ct["Vertical Forms"](F)||Ct["Yi Radicals"](F)||Ct["Yi Syllables"](F)));(z7[G]||$||q.imageName)&&I.push(aw(O+1,z,C,I,B7(G,s.getCharCode(O+1),$&&D),!1))}}var F;return sw(aw(s.length(),z,C,I,0,!0))}function cy(s){let r=.5,l=.5;switch(s){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:r,verticalAlign:l}}function F7(s,r,l,f,m){if(!f&&!m)return;const y=s[l],x=(s[l].x+y.metrics.advance*y.scale)*f;for(let I=r;I<=l;I++)s[I].x-=x,s[I].y+=m}function N7(s,r,l){const{horizontalAlign:f,verticalAlign:m}=cy(l),y=r[0]-s.displaySize[0]*f,x=r[1]-s.displaySize[1]*m;return{image:s,top:x,bottom:x+s.displaySize[1],left:y,right:y+s.displaySize[0]}}function ow(s){var r,l;let f=s.left,m=s.top,y=s.right-f,x=s.bottom-m;const I=(r=s.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",C=(l=s.image.textFitHeight)!==null&&l!==void 0?l:"stretchOrShrink",D=(s.image.content[2]-s.image.content[0])/(s.image.content[3]-s.image.content[1]);if(C==="proportional"){if(I==="stretchOnly"&&y/x<D||I==="proportional"){const z=Math.ceil(x*D);f*=z/y,y=z}}else if(I==="proportional"&&C==="stretchOnly"&&D!==0&&y/x>D){const z=Math.ceil(y/D);m*=z/x,x=z}return{x1:f,y1:m,x2:f+y,y2:m+x}}function lw(s,r,l,f,m,y){const x=s.image;let I;if(x.content){const ae=x.content,he=x.pixelRatio||1;I=[ae[0]/he,ae[1]/he,x.displaySize[0]-ae[2]/he,x.displaySize[1]-ae[3]/he]}const C=r.left*y,D=r.right*y;let z,F,O,q;l==="width"||l==="both"?(q=m[0]+C-f[3],F=m[0]+D+f[1]):(q=m[0]+(C+D-x.displaySize[0])/2,F=q+x.displaySize[0]);const G=r.top*y,$=r.bottom*y;return l==="height"||l==="both"?(z=m[1]+G-f[0],O=m[1]+$+f[2]):(z=m[1]+(G+$-x.displaySize[1])/2,O=z+x.displaySize[1]),{image:x,top:z,right:F,bottom:O,left:q,collisionPadding:I}}const up=255,ll=128,ru=up*ll;function cw(s,r){const{expression:l}=r;if(l.kind==="constant")return{kind:"constant",layoutSize:l.evaluate(new wi(s+1))};if(l.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:m}=l;let y=0;for(;y<f.length&&f[y]<=s;)y++;y=Math.max(0,y-1);let x=y;for(;x<f.length&&f[x]<s+1;)x++;x=Math.min(f.length-1,x);const I=f[y],C=f[x];return l.kind==="composite"?{kind:"composite",minZoom:I,maxZoom:C,interpolationType:m}:{kind:"camera",minZoom:I,maxZoom:C,minSize:l.evaluate(new wi(I)),maxSize:l.evaluate(new wi(C)),interpolationType:m}}}function uy(s,r,l){let f="never";const m=s.get(r);return m?f=m:s.get(l)&&(f="always"),f}const R7=nu.VectorTileFeature.types,O7=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function A0(s,r,l,f,m,y,x,I,C,D,z,F,O){const q=I?Math.min(ru,Math.round(I[0])):0,G=I?Math.min(ru,Math.round(I[1])):0;s.emplaceBack(r,l,Math.round(32*f),Math.round(32*m),y,x,(q<<1)+(C?1:0),G,16*D,16*z,256*F,256*O)}function hy(s,r,l){s.emplaceBack(r.x,r.y,l),s.emplaceBack(r.x,r.y,l),s.emplaceBack(r.x,r.y,l),s.emplaceBack(r.x,r.y,l)}function U7(s){for(const r of s.sections)if(Wf(r.text))return!0;return!1}class dy{constructor(r){this.layoutVertexArray=new Ss,this.indexArray=new zr,this.programConfigurations=r,this.segments=new Cr,this.dynamicLayoutVertexArray=new sl,this.opacityVertexArray=new Qc,this.hasVisibleVertices=!1,this.placedSymbolArray=new Di}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,l,f,m){this.isEmpty()||(f&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,g7.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,y7.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,O7,!0),this.opacityVertexBuffer.itemSize=1),(f||m)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Rt("SymbolBuffers",dy);class fy{constructor(r,l,f){this.layoutVertexArray=new r,this.layoutAttributes=l,this.indexArray=new f,this.segments=new Cr,this.collisionVertexArray=new aa}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,b7.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Rt("CollisionBuffers",fy);class vd{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(x=>x.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Wg([]),this.placementViewportMatrix=Wg([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=cw(this.zoom,l["text-size"]),this.iconSizeData=cw(this.zoom,l["icon-size"]);const f=this.layers[0].layout,m=f.get("symbol-sort-key"),y=f.get("symbol-z-order");this.canOverlap=uy(f,"text-overlap","text-allow-overlap")!=="never"||uy(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(x=>h.ah[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=r.sourceID}createArrays(){this.text=new dy(new ih(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new dy(new ih(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new Pi,this.lineVertexArray=new ka,this.symbolInstances=new xs,this.textAnchorOffsets=new na}calculateGlyphDependencies(r,l,f,m,y){for(let x=0;x<r.length;x++)if(l[r.charCodeAt(x)]=!0,(f||m)&&y){const I=op[r.charAt(x)];I&&(l[I.charCodeAt(0)]=!0)}}populate(r,l,f){const m=this.layers[0],y=m.layout,x=y.get("text-font"),I=y.get("text-field"),C=y.get("icon-image"),D=(I.value.kind!=="constant"||I.value.value instanceof _i&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),z=C.value.kind!=="constant"||!!C.value.value||Object.keys(C.parameters).length>0,F=y.get("symbol-sort-key");if(this.features=[],!D&&!z)return;const O=l.iconDependencies,q=l.glyphDependencies,G=l.availableImages,$=new wi(this.zoom);for(const{feature:ae,id:he,index:ke,sourceLayerIndex:ge}of r){const Ie=m._featureFilter.needGeometry,Ze=ah(ae,Ie);if(!m._featureFilter.filter($,Ze,f))continue;let et,kt;if(Ie||(Ze.geometry=rh(ae)),D){const It=m.getValueAndResolveTokens("text-field",Ze,f,G),vt=_i.factory(It),Ot=this.hasRTLText=this.hasRTLText||U7(vt);(!Ot||al.getRTLTextPluginStatus()==="unavailable"||Ot&&al.isParsed())&&(et=x7(vt,m,Ze))}if(z){const It=m.getValueAndResolveTokens("icon-image",Ze,f,G);kt=It instanceof or?It:or.fromString(It)}if(!et&&!kt)continue;const Wt=this.sortFeaturesByKey?F.evaluate(Ze,{},f):void 0;if(this.features.push({id:he,text:et,icon:kt,index:ke,sourceLayerIndex:ge,geometry:Ze.geometry,properties:ae.properties,type:R7[ae.type],sortKey:Wt}),kt&&(O[kt.name]=!0),et){const It=x.evaluate(Ze,{},f).join(","),vt=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(h.ah.vertical)>=0;for(const Ot of et.sections)if(Ot.image)O[Ot.image.name]=!0;else{const Yt=qf(et.toString()),Tt=Ot.fontStack||It,nt=q[Tt]=q[Tt]||{};this.calculateGlyphDependencies(Ot.text,nt,vt,this.allowVerticalPlacement,Yt)}}}y.get("symbol-placement")==="line"&&(this.features=function(ae){const he={},ke={},ge=[];let Ie=0;function Ze(It){ge.push(ae[It]),Ie++}function et(It,vt,Ot){const Yt=ke[It];return delete ke[It],ke[vt]=Yt,ge[Yt].geometry[0].pop(),ge[Yt].geometry[0]=ge[Yt].geometry[0].concat(Ot[0]),Yt}function kt(It,vt,Ot){const Yt=he[vt];return delete he[vt],he[It]=Yt,ge[Yt].geometry[0].shift(),ge[Yt].geometry[0]=Ot[0].concat(ge[Yt].geometry[0]),Yt}function Wt(It,vt,Ot){const Yt=Ot?vt[0][vt[0].length-1]:vt[0][0];return`${It}:${Yt.x}:${Yt.y}`}for(let It=0;It<ae.length;It++){const vt=ae[It],Ot=vt.geometry,Yt=vt.text?vt.text.toString():null;if(!Yt){Ze(It);continue}const Tt=Wt(Yt,Ot),nt=Wt(Yt,Ot,!0);if(Tt in ke&&nt in he&&ke[Tt]!==he[nt]){const Ht=kt(Tt,nt,Ot),Vt=et(Tt,nt,ge[Ht].geometry);delete he[Tt],delete ke[nt],ke[Wt(Yt,ge[Vt].geometry,!0)]=Vt,ge[Ht].geometry=null}else Tt in ke?et(Tt,nt,Ot):nt in he?kt(Tt,nt,Ot):(Ze(It),he[Tt]=Ie-1,ke[nt]=Ie-1)}return ge.filter(It=>It.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ae,he)=>ae.sortKey-he.sortKey)}update(r,l,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,l,this.layers,f),this.icon.programConfigurations.updatePaintArrays(r,l,this.layers,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,l){const f=this.lineVertexArray.length;if(r.segment!==void 0){let m=r.dist(l[r.segment+1]),y=r.dist(l[r.segment]);const x={};for(let I=r.segment+1;I<l.length;I++)x[I]={x:l[I].x,y:l[I].y,tileUnitDistanceFromAnchor:m},I<l.length-1&&(m+=l[I+1].dist(l[I]));for(let I=r.segment||0;I>=0;I--)x[I]={x:l[I].x,y:l[I].y,tileUnitDistanceFromAnchor:y},I>0&&(y+=l[I-1].dist(l[I]));for(let I=0;I<l.length;I++){const C=x[I];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(r,l,f,m,y,x,I,C,D,z,F,O){const q=r.indexArray,G=r.layoutVertexArray,$=r.segments.prepareSegment(4*l.length,G,q,this.canOverlap?x.sortKey:void 0),ae=this.glyphOffsetArray.length,he=$.vertexLength,ke=this.allowVerticalPlacement&&I===h.ah.vertical?Math.PI/2:0,ge=x.text&&x.text.sections;for(let Ie=0;Ie<l.length;Ie++){const{tl:Ze,tr:et,bl:kt,br:Wt,tex:It,pixelOffsetTL:vt,pixelOffsetBR:Ot,minFontScaleX:Yt,minFontScaleY:Tt,glyphOffset:nt,isSDF:Ht,sectionIndex:Vt}=l[Ie],yn=$.vertexLength,ui=nt[1];A0(G,C.x,C.y,Ze.x,ui+Ze.y,It.x,It.y,f,Ht,vt.x,vt.y,Yt,Tt),A0(G,C.x,C.y,et.x,ui+et.y,It.x+It.w,It.y,f,Ht,Ot.x,vt.y,Yt,Tt),A0(G,C.x,C.y,kt.x,ui+kt.y,It.x,It.y+It.h,f,Ht,vt.x,Ot.y,Yt,Tt),A0(G,C.x,C.y,Wt.x,ui+Wt.y,It.x+It.w,It.y+It.h,f,Ht,Ot.x,Ot.y,Yt,Tt),hy(r.dynamicLayoutVertexArray,C,ke),q.emplaceBack(yn,yn+1,yn+2),q.emplaceBack(yn+1,yn+2,yn+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(nt[0]),Ie!==l.length-1&&Vt===l[Ie+1].sectionIndex||r.programConfigurations.populatePaintArrays(G.length,x,x.index,{},O,ge&&ge[Vt])}r.placedSymbolArray.emplaceBack(C.x,C.y,ae,this.glyphOffsetArray.length-ae,he,D,z,C.segment,f?f[0]:0,f?f[1]:0,m[0],m[1],I,0,!1,0,F)}_addCollisionDebugVertex(r,l,f,m,y,x){return l.emplaceBack(0,0),r.emplaceBack(f.x,f.y,m,y,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,l,f,m,y,x,I){const C=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),D=C.vertexLength,z=y.layoutVertexArray,F=y.collisionVertexArray,O=I.anchorX,q=I.anchorY;this._addCollisionDebugVertex(z,F,x,O,q,new M(r,l)),this._addCollisionDebugVertex(z,F,x,O,q,new M(f,l)),this._addCollisionDebugVertex(z,F,x,O,q,new M(f,m)),this._addCollisionDebugVertex(z,F,x,O,q,new M(r,m)),C.vertexLength+=4;const G=y.indexArray;G.emplaceBack(D,D+1),G.emplaceBack(D+1,D+2),G.emplaceBack(D+2,D+3),G.emplaceBack(D+3,D),C.primitiveLength+=4}addDebugCollisionBoxes(r,l,f,m){for(let y=r;y<l;y++){const x=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,m?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fy(ra,Zx.members,Ui),this.iconCollisionBox=new fy(ra,Zx.members,Ui);for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.addDebugCollisionBoxes(l.textBoxStartIndex,l.textBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l,!0),this.addDebugCollisionBoxes(l.iconBoxStartIndex,l.iconBoxEndIndex,l,!1),this.addDebugCollisionBoxes(l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex,l,!1)}}_deserializeCollisionBoxesForSymbol(r,l,f,m,y,x,I,C,D){const z={};for(let F=l;F<f;F++){const O=r.get(F);z.textBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},z.textFeatureIndex=O.featureIndex;break}for(let F=m;F<y;F++){const O=r.get(F);z.verticalTextBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},z.verticalTextFeatureIndex=O.featureIndex;break}for(let F=x;F<I;F++){const O=r.get(F);z.iconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},z.iconFeatureIndex=O.featureIndex;break}for(let F=C;F<D;F++){const O=r.get(F);z.verticalIconBox={x1:O.x1,y1:O.y1,x2:O.x2,y2:O.y2,anchorPointX:O.anchorPointX,anchorPointY:O.anchorPointY},z.verticalIconFeatureIndex=O.featureIndex;break}return z}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const f=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,l){const f=r.placedSymbolArray.get(l),m=f.vertexStartIndex+4*f.numGlyphs;for(let y=f.vertexStartIndex;y<m;y+=4)r.indexArray.emplaceBack(y,y+1,y+2),r.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(r),f=Math.cos(r),m=[],y=[],x=[];for(let I=0;I<this.symbolInstances.length;++I){x.push(I);const C=this.symbolInstances.get(I);m.push(0|Math.round(l*C.anchorX+f*C.anchorY)),y.push(C.featureIndex)}return x.sort((I,C)=>m[I]-m[C]||y[C]-y[I]),x}addToSortKeyRanges(r,l){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===l?f.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const f=this.symbolInstances.get(l);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((m,y,x)=>{m>=0&&x.indexOf(m)===y&&this.addIndicesForPlacedSymbol(this.text,m)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let uw,hw;Rt("SymbolBucket",vd,{omit:["layers","collisionBoxArray","features","compareText"]}),vd.MAX_GLYPHS=65535,vd.addDynamicAttributes=hy;var py={get paint(){return hw=hw||new p({"icon-opacity":new Xt(De.paint_symbol["icon-opacity"]),"icon-color":new Xt(De.paint_symbol["icon-color"]),"icon-halo-color":new Xt(De.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xt(De.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xt(De.paint_symbol["icon-halo-blur"]),"icon-translate":new Gt(De.paint_symbol["icon-translate"]),"icon-translate-anchor":new Gt(De.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xt(De.paint_symbol["text-opacity"]),"text-color":new Xt(De.paint_symbol["text-color"],{runtimeType:ti,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Xt(De.paint_symbol["text-halo-color"]),"text-halo-width":new Xt(De.paint_symbol["text-halo-width"]),"text-halo-blur":new Xt(De.paint_symbol["text-halo-blur"]),"text-translate":new Gt(De.paint_symbol["text-translate"]),"text-translate-anchor":new Gt(De.paint_symbol["text-translate-anchor"])})},get layout(){return uw=uw||new p({"symbol-placement":new Gt(De.layout_symbol["symbol-placement"]),"symbol-spacing":new Gt(De.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Gt(De.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xt(De.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Gt(De.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Gt(De.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Gt(De.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Gt(De.layout_symbol["icon-ignore-placement"]),"icon-optional":new Gt(De.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Gt(De.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xt(De.layout_symbol["icon-size"]),"icon-text-fit":new Gt(De.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Gt(De.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xt(De.layout_symbol["icon-image"]),"icon-rotate":new Xt(De.layout_symbol["icon-rotate"]),"icon-padding":new Xt(De.layout_symbol["icon-padding"]),"icon-keep-upright":new Gt(De.layout_symbol["icon-keep-upright"]),"icon-offset":new Xt(De.layout_symbol["icon-offset"]),"icon-anchor":new Xt(De.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Gt(De.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Gt(De.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Gt(De.layout_symbol["text-rotation-alignment"]),"text-field":new Xt(De.layout_symbol["text-field"]),"text-font":new Xt(De.layout_symbol["text-font"]),"text-size":new Xt(De.layout_symbol["text-size"]),"text-max-width":new Xt(De.layout_symbol["text-max-width"]),"text-line-height":new Gt(De.layout_symbol["text-line-height"]),"text-letter-spacing":new Xt(De.layout_symbol["text-letter-spacing"]),"text-justify":new Xt(De.layout_symbol["text-justify"]),"text-radial-offset":new Xt(De.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Gt(De.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Xt(De.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Xt(De.layout_symbol["text-anchor"]),"text-max-angle":new Gt(De.layout_symbol["text-max-angle"]),"text-writing-mode":new Gt(De.layout_symbol["text-writing-mode"]),"text-rotate":new Xt(De.layout_symbol["text-rotate"]),"text-padding":new Gt(De.layout_symbol["text-padding"]),"text-keep-upright":new Gt(De.layout_symbol["text-keep-upright"]),"text-transform":new Xt(De.layout_symbol["text-transform"]),"text-offset":new Xt(De.layout_symbol["text-offset"]),"text-allow-overlap":new Gt(De.layout_symbol["text-allow-overlap"]),"text-overlap":new Gt(De.layout_symbol["text-overlap"]),"text-ignore-placement":new Gt(De.layout_symbol["text-ignore-placement"]),"text-optional":new Gt(De.layout_symbol["text-optional"])})}};class dw{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:Bn,this.defaultValue=r}evaluate(r){if(r.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(r.formattedSection))return l.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rt("FormatSectionOverride",dw,{omit:["defaultValue"]});class C0 extends v{constructor(r){super(r,py)}recalculate(r,l){if(super.recalculate(r,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const m=[];for(const y of f)m.indexOf(y)<0&&m.push(y);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,l,f,m){const y=this.layout.get(r).evaluate(l,{},f,m),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||Kh(x.value)||!y?y:function(I,C){return C.replace(/{([^{}]+)}/g,(D,z)=>I&&z in I?String(I[z]):"")}(l.properties,y)}createBucket(r){return new vd(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of py.paint.overridableProperties){if(!C0.hasPaintOverride(this.layout,r))continue;const l=this.paint.get(r),f=new dw(l),m=new kf(f,l.property.specification);let y=null;y=l.value.kind==="constant"||l.value.kind==="source"?new Ef("source",m):new Df("composite",m,l.value.zoomStops),this.paint._values[r]=new Ws(l.property,y,l.parameters)}}_handleOverridablePaintPropertyUpdate(r,l,f){return!(!this.layout||l.isDataDriven()||f.isDataDriven())&&C0.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,l){const f=r.get("text-field"),m=py.paint.properties[l];let y=!1;const x=I=>{for(const C of I)if(m.overrides&&m.overrides.hasOverride(C))return void(y=!0)};if(f.value.kind==="constant"&&f.value.value instanceof _i)x(f.value.value.sections);else if(f.value.kind==="source"){const I=D=>{y||(D instanceof Na&&Ci(D.value)===ar?x(D.value.sections):D instanceof Vl?x(D.sections):D.eachChild(I))},C=f.value;C._styleExpression&&I(C._styleExpression.expression)}return y}}let fw;var V7={get paint(){return fw=fw||new p({"background-color":new Gt(De.paint_background["background-color"]),"background-pattern":new a(De.paint_background["background-pattern"]),"background-opacity":new Gt(De.paint_background["background-opacity"])})}};class j7 extends v{constructor(r){super(r,V7)}}let pw;var q7={get paint(){return pw=pw||new p({"raster-opacity":new Gt(De.paint_raster["raster-opacity"]),"raster-hue-rotate":new Gt(De.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Gt(De.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Gt(De.paint_raster["raster-brightness-max"]),"raster-saturation":new Gt(De.paint_raster["raster-saturation"]),"raster-contrast":new Gt(De.paint_raster["raster-contrast"]),"raster-resampling":new Gt(De.paint_raster["raster-resampling"]),"raster-fade-duration":new Gt(De.paint_raster["raster-fade-duration"])})}};class H7 extends v{constructor(r){super(r,q7)}}class W7 extends v{constructor(r){super(r,{}),this.onAdd=l=>{this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)},this.onRemove=l=>{this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Z7{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const my=63710088e-1;class au{constructor(r,l){if(isNaN(r)||isNaN(l))throw new Error(`Invalid LngLat object: (${r}, ${l})`);if(this.lng=+r,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new au(Z(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const l=Math.PI/180,f=this.lat*l,m=r.lat*l,y=Math.sin(f)*Math.sin(m)+Math.cos(f)*Math.cos(m)*Math.cos((r.lng-this.lng)*l);return my*Math.acos(Math.min(y,1))}static convert(r){if(r instanceof au)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new au(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new au(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const mw=2*Math.PI*my;function _w(s){return mw*Math.cos(s*Math.PI/180)}function gw(s){return(180+s)/360}function yw(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function bw(s,r){return s/_w(r)}function _y(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}class k0{constructor(r,l,f=0){this.x=+r,this.y=+l,this.z=+f}static fromLngLat(r,l=0){const f=au.convert(r);return new k0(gw(f.lng),yw(f.lat),bw(l,f.lat))}toLngLat(){return new au(360*this.x-180,_y(this.y))}toAltitude(){return this.z*_w(_y(this.y))}meterInMercatorCoordinateUnits(){return 1/mw*(r=_y(this.y),1/Math.cos(r*Math.PI/180));var r}}function vw(s,r,l){var f=2*Math.PI*6378137/256/Math.pow(2,l);return[s*f-2*Math.PI*6378137/2,r*f-2*Math.PI*6378137/2]}class gy{constructor(r,l,f){if(r<0||r>25||f<0||f>=Math.pow(2,r)||l<0||l>=Math.pow(2,r))throw new Error(`x=${l}, y=${f}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=l,this.y=f,this.key=hp(0,r,r,l,f)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,l,f){const m=(x=this.y,I=this.z,C=vw(256*(y=this.x),256*(x=Math.pow(2,I)-x-1),I),D=vw(256*(y+1),256*(x+1),I),C[0]+","+C[1]+","+D[0]+","+D[1]);var y,x,I,C,D;const z=function(F,O,q){let G,$="";for(let ae=F;ae>0;ae--)G=1<<ae-1,$+=(O&G?1:0)+(q&G?2:0);return $}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,l>1?"@2x":"").replace(/{quadkey}/g,z).replace(/{bbox-epsg-3857}/g,m)}isChildOf(r){const l=this.z-r.z;return l>0&&r.x===this.x>>l&&r.y===this.y>>l}getTilePoint(r){const l=Math.pow(2,this.z);return new M((r.x*l-this.x)*cr,(r.y*l-this.y)*cr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xw{constructor(r,l){this.wrap=r,this.canonical=l,this.key=hp(r,l.z,l.z,l.x,l.y)}}class Ts{constructor(r,l,f,m,y){if(r<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${f}`);this.overscaledZ=r,this.wrap=l,this.canonical=new gy(f,+m,+y),this.key=hp(l,r,f,m,y)}clone(){return new Ts(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-r;return r>this.canonical.z?new Ts(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ts(r,this.wrap,r,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(r,l){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-r;return r>this.canonical.z?hp(this.wrap*+l,r,this.canonical.z,this.canonical.x,this.canonical.y):hp(this.wrap*+l,r,r,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const l=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>l&&r.canonical.y===this.canonical.y>>l}children(r){if(this.overscaledZ>=r)return[new Ts(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,f=2*this.canonical.x,m=2*this.canonical.y;return[new Ts(l,this.wrap,l,f,m),new Ts(l,this.wrap,l,f+1,m),new Ts(l,this.wrap,l,f,m+1),new Ts(l,this.wrap,l,f+1,m+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ts(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ts(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new k0(r.x-this.wrap,r.y))}}function hp(s,r,l,f,m){(s*=2)<0&&(s=-1*s-1);const y=1<<l;return(y*y*s+y*m+f).toString(36)+l.toString(36)+r.toString(36)}Rt("CanonicalTileID",gy),Rt("OverscaledTileID",Ts,{omit:["posMatrix"]});class ww{constructor(r,l,f,m=1,y=1,x=1,I=0){if(this.uid=r,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void qe(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=l.height;const C=this.dim=l.height-2;switch(this.data=new Uint32Array(l.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=y,this.blueFactor=x,this.baseShift=I;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let D=0;D<C;D++)this.data[this._idx(-1,D)]=this.data[this._idx(0,D)],this.data[this._idx(C,D)]=this.data[this._idx(C-1,D)],this.data[this._idx(D,-1)]=this.data[this._idx(D,0)],this.data[this._idx(D,C)]=this.data[this._idx(D,C-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(C,-1)]=this.data[this._idx(C-1,0)],this.data[this._idx(-1,C)]=this.data[this._idx(0,C-1)],this.data[this._idx(C,C)]=this.data[this._idx(C-1,C-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let D=0;D<C;D++)for(let z=0;z<C;z++){const F=this.get(D,z);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(r,l){const f=new Uint8Array(this.data.buffer),m=4*this._idx(r,l);return this.unpack(f[m],f[m+1],f[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,l){if(r<-1||r>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(r+1)}unpack(r,l,f){return r*this.redFactor+l*this.greenFactor+f*this.blueFactor-this.baseShift}getPixels(){return new Is({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,l,f){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let m=l*this.dim,y=l*this.dim+this.dim,x=f*this.dim,I=f*this.dim+this.dim;switch(l){case-1:m=y-1;break;case 1:y=m+1}switch(f){case-1:x=I-1;break;case 1:I=x+1}const C=-l*this.dim,D=-f*this.dim;for(let z=x;z<I;z++)for(let F=m;F<y;F++)this.data[this._idx(F,z)]=r.data[this._idx(F+C,z+D)]}}Rt("DEMData",ww);class Sw{constructor(r){this._stringToNumber={},this._numberToString=[];for(let l=0;l<r.length;l++){const f=r[l];this._stringToNumber[f]=l,this._numberToString[l]=f}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class Iw{constructor(r,l,f,m,y){this.type="Feature",this._vectorTileFeature=r,r._z=l,r._x=f,r._y=m,this.properties=r.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const l in this)l!=="_geometry"&&l!=="_vectorTileFeature"&&(r[l]=this[l]);return r}}class Tw{constructor(r,l){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new $u(cr,16,0),this.grid3D=new $u(cr,16,0),this.featureIndexArray=new ws,this.promoteId=l}insert(r,l,f,m,y,x){const I=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,m,y);const C=x?this.grid3D:this.grid;for(let D=0;D<l.length;D++){const z=l[D],F=[1/0,1/0,-1/0,-1/0];for(let O=0;O<z.length;O++){const q=z[O];F[0]=Math.min(F[0],q.x),F[1]=Math.min(F[1],q.y),F[2]=Math.max(F[2],q.x),F[3]=Math.max(F[3],q.y)}F[0]<cr&&F[1]<cr&&F[2]>=0&&F[3]>=0&&C.insert(I,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new nu.VectorTile(new ay(this.rawTileData)).layers,this.sourceLayerCoder=new Sw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,l,f,m){this.loadVTLayers();const y=r.params||{},x=cr/r.tileSize/r.scale,I=Pf(y.filter),C=r.queryGeometry,D=r.queryPadding*x,z=Aw(C),F=this.grid.query(z.minX-D,z.minY-D,z.maxX+D,z.maxY+D),O=Aw(r.cameraQueryGeometry),q=this.grid3D.query(O.minX-D,O.minY-D,O.maxX+D,O.maxY+D,(ae,he,ke,ge)=>function(Ie,Ze,et,kt,Wt){for(const vt of Ie)if(Ze<=vt.x&&et<=vt.y&&kt>=vt.x&&Wt>=vt.y)return!0;const It=[new M(Ze,et),new M(Ze,Wt),new M(kt,Wt),new M(kt,et)];if(Ie.length>2){for(const vt of It)if(fd(Ie,vt))return!0}for(let vt=0;vt<Ie.length-1;vt++)if(AC(Ie[vt],Ie[vt+1],It))return!0;return!1}(r.cameraQueryGeometry,ae-D,he-D,ke+D,ge+D));for(const ae of q)F.push(ae);F.sort(G7);const G={};let $;for(let ae=0;ae<F.length;ae++){const he=F[ae];if(he===$)continue;$=he;const ke=this.featureIndexArray.get(he);let ge=null;this.loadMatchingFeature(G,ke.bucketIndex,ke.sourceLayerIndex,ke.featureIndex,I,y.layers,y.availableImages,l,f,m,(Ie,Ze,et)=>(ge||(ge=rh(Ie)),Ze.queryIntersectsFeature(C,Ie,et,ge,this.z,r.transform,x,r.pixelPosMatrix)))}return G}loadMatchingFeature(r,l,f,m,y,x,I,C,D,z,F){const O=this.bucketLayerIDs[l];if(x&&!function(ae,he){for(let ke=0;ke<ae.length;ke++)if(he.indexOf(ae[ke])>=0)return!0;return!1}(x,O))return;const q=this.sourceLayerCoder.decode(f),G=this.vtLayers[q].feature(m);if(y.needGeometry){const ae=ah(G,!0);if(!y.filter(new wi(this.tileID.overscaledZ),ae,this.tileID.canonical))return}else if(!y.filter(new wi(this.tileID.overscaledZ),G))return;const $=this.getId(G,q);for(let ae=0;ae<O.length;ae++){const he=O[ae];if(x&&x.indexOf(he)<0)continue;const ke=C[he];if(!ke)continue;let ge={};$&&z&&(ge=z.getState(ke.sourceLayer||"_geojsonTileLayer",$));const Ie=ne({},D[he]);Ie.paint=Mw(Ie.paint,ke.paint,G,ge,I),Ie.layout=Mw(Ie.layout,ke.layout,G,ge,I);const Ze=!F||F(G,ke,ge);if(!Ze)continue;const et=new Iw(G,this.z,this.x,this.y,$);et.layer=Ie;let kt=r[he];kt===void 0&&(kt=r[he]=[]),kt.push({featureIndex:m,feature:et,intersectionZ:Ze})}}lookupSymbolFeatures(r,l,f,m,y,x,I,C){const D={};this.loadVTLayers();const z=Pf(y);for(const F of r)this.loadMatchingFeature(D,f,m,F,z,x,I,C,l);return D}hasLayer(r){for(const l of this.bucketLayerIDs)for(const f of l)if(r===f)return!0;return!1}getId(r,l){let f=r.id;return this.promoteId&&(f=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[l]],typeof f=="boolean"&&(f=Number(f))),f}}function Mw(s,r,l,f,m){return me(s,(y,x)=>{const I=r instanceof sd?r.get(x):null;return I&&I.evaluate?I.evaluate(l,f,m):I})}function Aw(s){let r=1/0,l=1/0,f=-1/0,m=-1/0;for(const y of s)r=Math.min(r,y.x),l=Math.min(l,y.y),f=Math.max(f,y.x),m=Math.max(m,y.y);return{minX:r,minY:l,maxX:f,maxY:m}}function G7(s,r){return r-s}function Cw(s,r,l,f,m){const y=[];for(let x=0;x<s.length;x++){const I=s[x];let C;for(let D=0;D<I.length-1;D++){let z=I[D],F=I[D+1];z.x<r&&F.x<r||(z.x<r?z=new M(r,z.y+(r-z.x)/(F.x-z.x)*(F.y-z.y))._round():F.x<r&&(F=new M(r,z.y+(r-z.x)/(F.x-z.x)*(F.y-z.y))._round()),z.y<l&&F.y<l||(z.y<l?z=new M(z.x+(l-z.y)/(F.y-z.y)*(F.x-z.x),l)._round():F.y<l&&(F=new M(z.x+(l-z.y)/(F.y-z.y)*(F.x-z.x),l)._round()),z.x>=f&&F.x>=f||(z.x>=f?z=new M(f,z.y+(f-z.x)/(F.x-z.x)*(F.y-z.y))._round():F.x>=f&&(F=new M(f,z.y+(f-z.x)/(F.x-z.x)*(F.y-z.y))._round()),z.y>=m&&F.y>=m||(z.y>=m?z=new M(z.x+(m-z.y)/(F.y-z.y)*(F.x-z.x),m)._round():F.y>=m&&(F=new M(z.x+(m-z.y)/(F.y-z.y)*(F.x-z.x),m)._round()),C&&z.equals(C[C.length-1])||(C=[z],y.push(C)),C.push(F)))))}}return y}Rt("FeatureIndex",Tw,{omit:["rawTileData","sourceLayerCoder"]});class su extends M{constructor(r,l,f,m){super(r,l),this.angle=f,m!==void 0&&(this.segment=m)}clone(){return new su(this.x,this.y,this.angle,this.segment)}}function kw(s,r,l,f,m){if(r.segment===void 0||l===0)return!0;let y=r,x=r.segment+1,I=0;for(;I>-l/2;){if(x--,x<0)return!1;I-=s[x].dist(y),y=s[x]}I+=s[x].dist(s[x+1]),x++;const C=[];let D=0;for(;I<l/2;){const z=s[x],F=s[x+1];if(!F)return!1;let O=s[x-1].angleTo(z)-z.angleTo(F);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:I,angleDelta:O}),D+=O;I-C[0].distance>f;)D-=C.shift().angleDelta;if(D>m)return!1;x++,I+=z.dist(F)}return!0}function Ew(s){let r=0;for(let l=0;l<s.length-1;l++)r+=s[l].dist(s[l+1]);return r}function Dw(s,r,l){return s?.6*r*l:0}function Pw(s,r){return Math.max(s?s.right-s.left:0,r?r.right-r.left:0)}function Y7(s,r,l,f,m,y){const x=Dw(l,m,y),I=Pw(l,f)*y;let C=0;const D=Ew(s)/2;for(let z=0;z<s.length-1;z++){const F=s[z],O=s[z+1],q=F.dist(O);if(C+q>D){const G=(D-C)/q,$=Ir.number(F.x,O.x,G),ae=Ir.number(F.y,O.y,G),he=new su($,ae,O.angleTo(F),z);return he._round(),!x||kw(s,he,I,x,r)?he:void 0}C+=q}}function J7(s,r,l,f,m,y,x,I,C){const D=Dw(f,y,x),z=Pw(f,m),F=z*x,O=s[0].x===0||s[0].x===C||s[0].y===0||s[0].y===C;return r-F<r/4&&(r=F+r/4),Lw(s,O?r/2*I%r:(z/2+2*y)*x*I%r,r,D,l,F,O,!1,C)}function Lw(s,r,l,f,m,y,x,I,C){const D=y/2,z=Ew(s);let F=0,O=r-l,q=[];for(let G=0;G<s.length-1;G++){const $=s[G],ae=s[G+1],he=$.dist(ae),ke=ae.angleTo($);for(;O+l<F+he;){O+=l;const ge=(O-F)/he,Ie=Ir.number($.x,ae.x,ge),Ze=Ir.number($.y,ae.y,ge);if(Ie>=0&&Ie<C&&Ze>=0&&Ze<C&&O-D>=0&&O+D<=z){const et=new su(Ie,Ze,ke,G);et._round(),f&&!kw(s,et,y,f,m)||q.push(et)}}F+=he}return I||q.length||x||(q=Lw(s,F/2,l,f,m,y,x,!0,C)),q}Rt("Anchor",su);const xd=qa;function zw(s,r,l,f){const m=[],y=s.image,x=y.pixelRatio,I=y.paddedRect.w-2*xd,C=y.paddedRect.h-2*xd;let D={x1:s.left,y1:s.top,x2:s.right,y2:s.bottom};const z=y.stretchX||[[0,I]],F=y.stretchY||[[0,C]],O=(nt,Ht)=>nt+Ht[1]-Ht[0],q=z.reduce(O,0),G=F.reduce(O,0),$=I-q,ae=C-G;let he=0,ke=q,ge=0,Ie=G,Ze=0,et=$,kt=0,Wt=ae;if(y.content&&f){const nt=y.content,Ht=nt[2]-nt[0],Vt=nt[3]-nt[1];(y.textFitWidth||y.textFitHeight)&&(D=ow(s)),he=E0(z,0,nt[0]),ge=E0(F,0,nt[1]),ke=E0(z,nt[0],nt[2]),Ie=E0(F,nt[1],nt[3]),Ze=nt[0]-he,kt=nt[1]-ge,et=Ht-ke,Wt=Vt-Ie}const It=D.x1,vt=D.y1,Ot=D.x2-It,Yt=D.y2-vt,Tt=(nt,Ht,Vt,yn)=>{const ui=D0(nt.stretch-he,ke,Ot,It),hi=P0(nt.fixed-Ze,et,nt.stretch,q),ur=D0(Ht.stretch-ge,Ie,Yt,vt),Ms=P0(Ht.fixed-kt,Wt,Ht.stretch,G),ga=D0(Vt.stretch-he,ke,Ot,It),Er=P0(Vt.fixed-Ze,et,Vt.stretch,q),Gr=D0(yn.stretch-ge,Ie,Yt,vt),ya=P0(yn.fixed-kt,Wt,yn.stretch,G),Da=new M(ui,ur),ba=new M(ga,ur),hr=new M(ga,Gr),Br=new M(ui,Gr),Pa=new M(hi/x,Ms/x),Ha=new M(Er/x,ya/x),oa=r*Math.PI/180;if(oa){const $i=Math.sin(oa),Mn=Math.cos(oa),dr=[Mn,-$i,$i,Mn];Da._matMult(dr),ba._matMult(dr),Br._matMult(dr),hr._matMult(dr)}const Wa=nt.stretch+nt.fixed,As=Ht.stretch+Ht.fixed;return{tl:Da,tr:ba,bl:Br,br:hr,tex:{x:y.paddedRect.x+xd+Wa,y:y.paddedRect.y+xd+As,w:Vt.stretch+Vt.fixed-Wa,h:yn.stretch+yn.fixed-As},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pa,pixelOffsetBR:Ha,minFontScaleX:et/x/Ot,minFontScaleY:Wt/x/Yt,isSDF:l}};if(f&&(y.stretchX||y.stretchY)){const nt=Bw(z,$,q),Ht=Bw(F,ae,G);for(let Vt=0;Vt<nt.length-1;Vt++){const yn=nt[Vt],ui=nt[Vt+1];for(let hi=0;hi<Ht.length-1;hi++)m.push(Tt(yn,Ht[hi],ui,Ht[hi+1]))}}else m.push(Tt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:I+1},{fixed:0,stretch:C+1}));return m}function E0(s,r,l){let f=0;for(const m of s)f+=Math.max(r,Math.min(l,m[1]))-Math.max(r,Math.min(l,m[0]));return f}function Bw(s,r,l){const f=[{fixed:-xd,stretch:0}];for(const[m,y]of s){const x=f[f.length-1];f.push({fixed:m-x.stretch,stretch:x.stretch}),f.push({fixed:m-x.stretch,stretch:x.stretch+(y-m)})}return f.push({fixed:r+xd,stretch:l}),f}function D0(s,r,l,f){return s/r*l+f}function P0(s,r,l,f){return s-r*l/f}class L0{constructor(r,l,f,m,y,x,I,C,D,z){var F;if(this.boxStartIndex=r.length,D){let O=x.top,q=x.bottom;const G=x.collisionPadding;G&&(O-=G[1],q+=G[3]);let $=q-O;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{const O=!((F=x.image)===null||F===void 0)&&F.content&&(x.image.textFitWidth||x.image.textFitHeight)?ow(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};O.y1=O.y1*I-C[0],O.y2=O.y2*I+C[2],O.x1=O.x1*I-C[3],O.x2=O.x2*I+C[1];const q=x.collisionPadding;if(q&&(O.x1-=q[0]*I,O.y1-=q[1]*I,O.x2+=q[2]*I,O.y2+=q[3]*I),z){const G=new M(O.x1,O.y1),$=new M(O.x2,O.y1),ae=new M(O.x1,O.y2),he=new M(O.x2,O.y2),ke=z*Math.PI/180;G._rotate(ke),$._rotate(ke),ae._rotate(ke),he._rotate(ke),O.x1=Math.min(G.x,$.x,ae.x,he.x),O.x2=Math.max(G.x,$.x,ae.x,he.x),O.y1=Math.min(G.y,$.y,ae.y,he.y),O.y2=Math.max(G.y,$.y,ae.y,he.y)}r.emplaceBack(l.x,l.y,O.x1,O.y1,O.x2,O.y2,f,m,y)}this.boxEndIndex=r.length}}class K7{constructor(r=[],l=X7){if(this.data=r,this.length=this.data.length,this.compare=l,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:l,compare:f}=this,m=l[r];for(;r>0;){const y=r-1>>1,x=l[y];if(f(m,x)>=0)break;l[r]=x,r=y}l[r]=m}_down(r){const{data:l,compare:f}=this,m=this.length>>1,y=l[r];for(;r<m;){let x=1+(r<<1),I=l[x];const C=x+1;if(C<this.length&&f(l[C],I)<0&&(x=C,I=l[C]),f(I,y)>=0)break;l[r]=I,r=x}l[r]=y}}function X7(s,r){return s<r?-1:s>r?1:0}function Q7(s,r=1,l=!1){let f=1/0,m=1/0,y=-1/0,x=-1/0;const I=s[0];for(let q=0;q<I.length;q++){const G=I[q];(!q||G.x<f)&&(f=G.x),(!q||G.y<m)&&(m=G.y),(!q||G.x>y)&&(y=G.x),(!q||G.y>x)&&(x=G.y)}const C=Math.min(y-f,x-m);let D=C/2;const z=new K7([],$7);if(C===0)return new M(f,m);for(let q=f;q<y;q+=C)for(let G=m;G<x;G+=C)z.push(new wd(q+D,G+D,D,s));let F=function(q){let G=0,$=0,ae=0;const he=q[0];for(let ke=0,ge=he.length,Ie=ge-1;ke<ge;Ie=ke++){const Ze=he[ke],et=he[Ie],kt=Ze.x*et.y-et.x*Ze.y;$+=(Ze.x+et.x)*kt,ae+=(Ze.y+et.y)*kt,G+=3*kt}return new wd($/G,ae/G,0,q)}(s),O=z.length;for(;z.length;){const q=z.pop();(q.d>F.d||!F.d)&&(F=q,l&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,O)),q.max-F.d<=r||(D=q.h/2,z.push(new wd(q.p.x-D,q.p.y-D,D,s)),z.push(new wd(q.p.x+D,q.p.y-D,D,s)),z.push(new wd(q.p.x-D,q.p.y+D,D,s)),z.push(new wd(q.p.x+D,q.p.y+D,D,s)),O+=4)}return l&&(console.log(`num probes: ${O}`),console.log(`best distance: ${F.d}`)),F.p}function $7(s,r){return r.max-s.max}function wd(s,r,l,f){this.p=new M(s,r),this.h=l,this.d=function(m,y){let x=!1,I=1/0;for(let C=0;C<y.length;C++){const D=y[C];for(let z=0,F=D.length,O=F-1;z<F;O=z++){const q=D[z],G=D[O];q.y>m.y!=G.y>m.y&&m.x<(G.x-q.x)*(m.y-q.y)/(G.y-q.y)+q.x&&(x=!x),I=Math.min(I,yx(m,q,G))}}return(x?1:-1)*Math.sqrt(I)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var sa;h.aq=void 0,(sa=h.aq||(h.aq={}))[sa.center=1]="center",sa[sa.left=2]="left",sa[sa.right=3]="right",sa[sa.top=4]="top",sa[sa.bottom=5]="bottom",sa[sa["top-left"]=6]="top-left",sa[sa["top-right"]=7]="top-right",sa[sa["bottom-left"]=8]="bottom-left",sa[sa["bottom-right"]=9]="bottom-right";const ou=7,yy=Number.POSITIVE_INFINITY;function Fw(s,r){return r[1]!==yy?function(l,f,m){let y=0,x=0;switch(f=Math.abs(f),m=Math.abs(m),l){case"top-right":case"top-left":case"top":x=m-ou;break;case"bottom-right":case"bottom-left":case"bottom":x=-m+ou}switch(l){case"top-right":case"bottom-right":case"right":y=-f;break;case"top-left":case"bottom-left":case"left":y=f}return[y,x]}(s,r[0],r[1]):function(l,f){let m=0,y=0;f<0&&(f=0);const x=f/Math.SQRT2;switch(l){case"top-right":case"top-left":y=x-ou;break;case"bottom-right":case"bottom-left":y=-x+ou;break;case"bottom":y=-f+ou;break;case"top":y=f-ou}switch(l){case"top-right":case"bottom-right":m=-x;break;case"top-left":case"bottom-left":m=x;break;case"left":m=f;break;case"right":m=-f}return[m,y]}(s,r[0])}function Nw(s,r,l){var f;const m=s.layout,y=(f=m.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(r,{},l);if(y){const I=y.values,C=[];for(let D=0;D<I.length;D+=2){const z=C[D]=I[D],F=I[D+1].map(O=>O*kr);z.startsWith("top")?F[1]-=ou:z.startsWith("bottom")&&(F[1]+=ou),C[D+1]=F}return new wr(C)}const x=m.get("text-variable-anchor");if(x){let I;I=s._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[m.get("text-radial-offset").evaluate(r,{},l)*kr,yy]:m.get("text-offset").evaluate(r,{},l).map(D=>D*kr);const C=[];for(const D of x)C.push(D,Fw(D,I));return new wr(C)}return null}function by(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ek(s,r,l,f,m,y,x,I,C,D,z){let F=y.textMaxSize.evaluate(r,{});F===void 0&&(F=x);const O=s.layers[0].layout,q=O.get("icon-offset").evaluate(r,{},z),G=Ow(l.horizontal),$=x/24,ae=s.tilePixelRatio*$,he=s.tilePixelRatio*F/24,ke=s.tilePixelRatio*I,ge=s.tilePixelRatio*O.get("symbol-spacing"),Ie=O.get("text-padding")*s.tilePixelRatio,Ze=function(nt,Ht,Vt,yn=1){const ui=nt.get("icon-padding").evaluate(Ht,{},Vt),hi=ui&&ui.values;return[hi[0]*yn,hi[1]*yn,hi[2]*yn,hi[3]*yn]}(O,r,z,s.tilePixelRatio),et=O.get("text-max-angle")/180*Math.PI,kt=O.get("text-rotation-alignment")!=="viewport"&&O.get("symbol-placement")!=="point",Wt=O.get("icon-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",It=O.get("symbol-placement"),vt=ge/2,Ot=O.get("icon-text-fit");let Yt;f&&Ot!=="none"&&(s.allowVerticalPlacement&&l.vertical&&(Yt=lw(f,l.vertical,Ot,O.get("icon-text-fit-padding"),q,$)),G&&(f=lw(f,G,Ot,O.get("icon-text-fit-padding"),q,$)));const Tt=(nt,Ht)=>{Ht.x<0||Ht.x>=cr||Ht.y<0||Ht.y>=cr||function(Vt,yn,ui,hi,ur,Ms,ga,Er,Gr,ya,Da,ba,hr,Br,Pa,Ha,oa,Wa,As,$i,Mn,dr,la,Dr,Zs){const Ao=Vt.addToLineVertexArray(yn,ui);let Co,nc,Gs,Cs,Za=0,ic=0,pp=0,qw=0,Ay=-1,Cy=-1;const rc={};let Hw=hd("");if(Vt.allowVerticalPlacement&&hi.vertical){const va=Er.layout.get("text-rotate").evaluate(Mn,{},Dr)+90;Gs=new L0(Gr,yn,ya,Da,ba,hi.vertical,hr,Br,Pa,va),ga&&(Cs=new L0(Gr,yn,ya,Da,ba,ga,oa,Wa,Pa,va))}if(ur){const va=Er.layout.get("icon-rotate").evaluate(Mn,{}),ks=Er.layout.get("icon-text-fit")!=="none",oh=zw(ur,va,la,ks),Eo=ga?zw(ga,va,la,ks):void 0;nc=new L0(Gr,yn,ya,Da,ba,ur,oa,Wa,!1,va),Za=4*oh.length;const lh=Vt.iconSizeData;let cl=null;lh.kind==="source"?(cl=[ll*Er.layout.get("icon-size").evaluate(Mn,{})],cl[0]>ru&&qe(`${Vt.layerIds[0]}: Value for "icon-size" is >= ${up}. Reduce your "icon-size".`)):lh.kind==="composite"&&(cl=[ll*dr.compositeIconSizes[0].evaluate(Mn,{},Dr),ll*dr.compositeIconSizes[1].evaluate(Mn,{},Dr)],(cl[0]>ru||cl[1]>ru)&&qe(`${Vt.layerIds[0]}: Value for "icon-size" is >= ${up}. Reduce your "icon-size".`)),Vt.addSymbols(Vt.icon,oh,cl,$i,As,Mn,h.ah.none,yn,Ao.lineStartIndex,Ao.lineLength,-1,Dr),Ay=Vt.icon.placedSymbolArray.length-1,Eo&&(ic=4*Eo.length,Vt.addSymbols(Vt.icon,Eo,cl,$i,As,Mn,h.ah.vertical,yn,Ao.lineStartIndex,Ao.lineLength,-1,Dr),Cy=Vt.icon.placedSymbolArray.length-1)}const Ww=Object.keys(hi.horizontal);for(const va of Ww){const ks=hi.horizontal[va];if(!Co){Hw=hd(ks.text);const Eo=Er.layout.get("text-rotate").evaluate(Mn,{},Dr);Co=new L0(Gr,yn,ya,Da,ba,ks,hr,Br,Pa,Eo)}const oh=ks.positionedLines.length===1;if(pp+=Rw(Vt,yn,ks,Ms,Er,Pa,Mn,Ha,Ao,hi.vertical?h.ah.horizontal:h.ah.horizontalOnly,oh?Ww:[va],rc,Ay,dr,Dr),oh)break}hi.vertical&&(qw+=Rw(Vt,yn,hi.vertical,Ms,Er,Pa,Mn,Ha,Ao,h.ah.vertical,["vertical"],rc,Cy,dr,Dr));const ik=Co?Co.boxStartIndex:Vt.collisionBoxArray.length,rk=Co?Co.boxEndIndex:Vt.collisionBoxArray.length,ak=Gs?Gs.boxStartIndex:Vt.collisionBoxArray.length,sk=Gs?Gs.boxEndIndex:Vt.collisionBoxArray.length,ok=nc?nc.boxStartIndex:Vt.collisionBoxArray.length,lk=nc?nc.boxEndIndex:Vt.collisionBoxArray.length,ck=Cs?Cs.boxStartIndex:Vt.collisionBoxArray.length,uk=Cs?Cs.boxEndIndex:Vt.collisionBoxArray.length;let ko=-1;const B0=(va,ks)=>va&&va.circleDiameter?Math.max(va.circleDiameter,ks):ks;ko=B0(Co,ko),ko=B0(Gs,ko),ko=B0(nc,ko),ko=B0(Cs,ko);const Zw=ko>-1?1:0;Zw&&(ko*=Zs/kr),Vt.glyphOffsetArray.length>=vd.MAX_GLYPHS&&qe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mn.sortKey!==void 0&&Vt.addToSortKeyRanges(Vt.symbolInstances.length,Mn.sortKey);const hk=Nw(Er,Mn,Dr),[dk,fk]=function(va,ks){const oh=va.length,Eo=ks==null?void 0:ks.values;if((Eo==null?void 0:Eo.length)>0)for(let lh=0;lh<Eo.length;lh+=2){const cl=Eo[lh+1];va.emplaceBack(h.aq[Eo[lh]],cl[0],cl[1])}return[oh,va.length]}(Vt.textAnchorOffsets,hk);Vt.symbolInstances.emplaceBack(yn.x,yn.y,rc.right>=0?rc.right:-1,rc.center>=0?rc.center:-1,rc.left>=0?rc.left:-1,rc.vertical||-1,Ay,Cy,Hw,ik,rk,ak,sk,ok,lk,ck,uk,ya,pp,qw,Za,ic,Zw,0,hr,ko,dk,fk)}(s,Ht,nt,l,f,m,Yt,s.layers[0],s.collisionBoxArray,r.index,r.sourceLayerIndex,s.index,ae,[Ie,Ie,Ie,Ie],kt,C,ke,Ze,Wt,q,r,y,D,z,x)};if(It==="line")for(const nt of Cw(r.geometry,0,0,cr,cr)){const Ht=J7(nt,ge,et,l.vertical||G,f,24,he,s.overscaling,cr);for(const Vt of Ht)G&&tk(s,G.text,vt,Vt)||Tt(nt,Vt)}else if(It==="line-center"){for(const nt of r.geometry)if(nt.length>1){const Ht=Y7(nt,et,l.vertical||G,f,24,he);Ht&&Tt(nt,Ht)}}else if(r.type==="Polygon")for(const nt of go(r.geometry,0)){const Ht=Q7(nt,16);Tt(nt[0],new su(Ht.x,Ht.y,0))}else if(r.type==="LineString")for(const nt of r.geometry)Tt(nt,new su(nt[0].x,nt[0].y,0));else if(r.type==="Point")for(const nt of r.geometry)for(const Ht of nt)Tt([Ht],new su(Ht.x,Ht.y,0))}function Rw(s,r,l,f,m,y,x,I,C,D,z,F,O,q,G){const $=function(ke,ge,Ie,Ze,et,kt,Wt,It){const vt=Ze.layout.get("text-rotate").evaluate(kt,{})*Math.PI/180,Ot=[];for(const Yt of ge.positionedLines)for(const Tt of Yt.positionedGlyphs){if(!Tt.rect)continue;const nt=Tt.rect||{};let Ht=ew+1,Vt=!0,yn=1,ui=0;const hi=(et||It)&&Tt.vertical,ur=Tt.metrics.advance*Tt.scale/2;if(It&&ge.verticalizable&&(ui=Yt.lineOffset/2-(Tt.imageName?-(kr-Tt.metrics.width*Tt.scale)/2:(Tt.scale-1)*kr)),Tt.imageName){const $i=Wt[Tt.imageName];Vt=$i.sdf,yn=$i.pixelRatio,Ht=qa/yn}const Ms=et?[Tt.x+ur,Tt.y]:[0,0];let ga=et?[0,0]:[Tt.x+ur+Ie[0],Tt.y+Ie[1]-ui],Er=[0,0];hi&&(Er=ga,ga=[0,0]);const Gr=Tt.metrics.isDoubleResolution?2:1,ya=(Tt.metrics.left-Ht)*Tt.scale-ur+ga[0],Da=(-Tt.metrics.top-Ht)*Tt.scale+ga[1],ba=ya+nt.w/Gr*Tt.scale/yn,hr=Da+nt.h/Gr*Tt.scale/yn,Br=new M(ya,Da),Pa=new M(ba,Da),Ha=new M(ya,hr),oa=new M(ba,hr);if(hi){const $i=new M(-ur,ur-lp),Mn=-Math.PI/2,dr=kr/2-ur,la=new M(5-lp-dr,-(Tt.imageName?dr:0)),Dr=new M(...Er);Br._rotateAround(Mn,$i)._add(la)._add(Dr),Pa._rotateAround(Mn,$i)._add(la)._add(Dr),Ha._rotateAround(Mn,$i)._add(la)._add(Dr),oa._rotateAround(Mn,$i)._add(la)._add(Dr)}if(vt){const $i=Math.sin(vt),Mn=Math.cos(vt),dr=[Mn,-$i,$i,Mn];Br._matMult(dr),Pa._matMult(dr),Ha._matMult(dr),oa._matMult(dr)}const Wa=new M(0,0),As=new M(0,0);Ot.push({tl:Br,tr:Pa,bl:Ha,br:oa,tex:nt,writingMode:ge.writingMode,glyphOffset:Ms,sectionIndex:Tt.sectionIndex,isSDF:Vt,pixelOffsetTL:Wa,pixelOffsetBR:As,minFontScaleX:0,minFontScaleY:0})}return Ot}(0,l,I,m,y,x,f,s.allowVerticalPlacement),ae=s.textSizeData;let he=null;ae.kind==="source"?(he=[ll*m.layout.get("text-size").evaluate(x,{})],he[0]>ru&&qe(`${s.layerIds[0]}: Value for "text-size" is >= ${up}. Reduce your "text-size".`)):ae.kind==="composite"&&(he=[ll*q.compositeTextSizes[0].evaluate(x,{},G),ll*q.compositeTextSizes[1].evaluate(x,{},G)],(he[0]>ru||he[1]>ru)&&qe(`${s.layerIds[0]}: Value for "text-size" is >= ${up}. Reduce your "text-size".`)),s.addSymbols(s.text,$,he,I,y,x,D,r,C.lineStartIndex,C.lineLength,O,G);for(const ke of z)F[ke]=s.text.placedSymbolArray.length-1;return 4*$.length}function Ow(s){for(const r in s)return s[r];return null}function tk(s,r,l,f){const m=s.compareText;if(r in m){const y=m[r];for(let x=y.length-1;x>=0;x--)if(f.dist(y[x])<l)return!0}else m[r]=[];return m[r].push(f),!1}const Uw=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class vy{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,f]=new Uint8Array(r,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=f>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const y=Uw[15&f];if(!y)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[I]=new Uint32Array(r,4,1);return new vy(I,x,y,r)}constructor(r,l=64,f=Float64Array,m){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=f,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const y=Uw.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,I=r*this.IndexArrayType.BYTES_PER_ELEMENT,C=(8-I%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${f}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+I+C,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+I+C),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+I+C,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=r)}add(r,l){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=r,this.coords[this._pos++]=l,f}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return xy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,l,f,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:x,nodeSize:I}=this,C=[0,y.length-1,0],D=[];for(;C.length;){const z=C.pop()||0,F=C.pop()||0,O=C.pop()||0;if(F-O<=I){for(let ae=O;ae<=F;ae++){const he=x[2*ae],ke=x[2*ae+1];he>=r&&he<=f&&ke>=l&&ke<=m&&D.push(y[ae])}continue}const q=O+F>>1,G=x[2*q],$=x[2*q+1];G>=r&&G<=f&&$>=l&&$<=m&&D.push(y[q]),(z===0?r<=G:l<=$)&&(C.push(O),C.push(q-1),C.push(1-z)),(z===0?f>=G:m>=$)&&(C.push(q+1),C.push(F),C.push(1-z))}return D}within(r,l,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:x}=this,I=[0,m.length-1,0],C=[],D=f*f;for(;I.length;){const z=I.pop()||0,F=I.pop()||0,O=I.pop()||0;if(F-O<=x){for(let ae=O;ae<=F;ae++)jw(y[2*ae],y[2*ae+1],r,l)<=D&&C.push(m[ae]);continue}const q=O+F>>1,G=y[2*q],$=y[2*q+1];jw(G,$,r,l)<=D&&C.push(m[q]),(z===0?r-f<=G:l-f<=$)&&(I.push(O),I.push(q-1),I.push(1-z)),(z===0?r+f>=G:l+f>=$)&&(I.push(q+1),I.push(F),I.push(1-z))}return C}}function xy(s,r,l,f,m,y){if(m-f<=l)return;const x=f+m>>1;Vw(s,r,x,f,m,y),xy(s,r,l,f,x-1,1-y),xy(s,r,l,x+1,m,1-y)}function Vw(s,r,l,f,m,y){for(;m>f;){if(m-f>600){const D=m-f+1,z=l-f+1,F=Math.log(D),O=.5*Math.exp(2*F/3),q=.5*Math.sqrt(F*O*(D-O)/D)*(z-D/2<0?-1:1);Vw(s,r,l,Math.max(f,Math.floor(l-z*O/D+q)),Math.min(m,Math.floor(l+(D-z)*O/D+q)),y)}const x=r[2*l+y];let I=f,C=m;for(dp(s,r,f,l),r[2*m+y]>x&&dp(s,r,f,m);I<C;){for(dp(s,r,I,C),I++,C--;r[2*I+y]<x;)I++;for(;r[2*C+y]>x;)C--}r[2*f+y]===x?dp(s,r,f,C):(C++,dp(s,r,C,m)),C<=l&&(f=C+1),l<=C&&(m=C-1)}}function dp(s,r,l,f){wy(s,l,f),wy(r,2*l,2*f),wy(r,2*l+1,2*f+1)}function wy(s,r,l){const f=s[r];s[r]=s[l],s[l]=f}function jw(s,r,l,f){const m=s-l,y=r-f;return m*m+y*y}var Sy;h.be=void 0,(Sy=h.be||(h.be={})).create="create",Sy.load="load",Sy.fullLoad="fullLoad";let z0=null,fp=[];const Iy=1e3/60,Ty="loadTime",My="fullLoadTime",nk={mark(s){performance.mark(s)},frame(s){const r=s;z0!=null&&fp.push(r-z0),z0=r},clearMetrics(){z0=null,fp=[],performance.clearMeasures(Ty),performance.clearMeasures(My);for(const s in h.be)performance.clearMarks(h.be[s])},getPerformanceMetrics(){performance.measure(Ty,h.be.create,h.be.load),performance.measure(My,h.be.create,h.be.fullLoad);const s=performance.getEntriesByName(Ty)[0].duration,r=performance.getEntriesByName(My)[0].duration,l=fp.length,f=1/(fp.reduce((y,x)=>y+x,0)/l/1e3),m=fp.filter(y=>y>Iy).reduce((y,x)=>y+(x-Iy)/Iy,0);return{loadTime:s,fullLoadTime:r,fps:f,percentDroppedFrames:m/(l+m)*100,totalFrames:l}}};h.$=Cr,h.A=pd,h.B=function(s){if(lt==null){const r=s.navigator?s.navigator.userAgent:null;lt=!!s.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return lt},h.C=class{constructor(s,r){this.target=s,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Z7(()=>this.process()),this.subscription=function(l,f,m,y){return l.addEventListener(f,m,!1),{unsubscribe:()=>{l.removeEventListener(f,m,!1)}}}(this.target,"message",l=>this.receive(l)),this.globalScope=Be(self)?s:window}registerMessageHandler(s,r){this.messageHandlers[s]=r}sendAsync(s,r){return new Promise((l,f)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[m]={resolve:l,reject:f},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[m];const I={id:m,type:"<cancel>",origin:location.origin,targetMapId:s.targetMapId,sourceMapId:this.mapId};this.target.postMessage(I)},{once:!0});const y=[],x=Object.assign(Object.assign({},s),{id:m,sourceMapId:this.mapId,origin:location.origin,data:eh(s.data,y)});this.target.postMessage(x,{transfer:y})})}receive(s){const r=s.data,l=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[l];const f=this.abortControllers[l];return delete this.abortControllers[l],void(f&&f.abort())}if(Be(self)||r.mustQueue)return this.tasks[l]=r,this.taskQueue.push(l),void this.invoker.trigger();this.processTask(l,r)}}process(){if(this.taskQueue.length===0)return;const s=this.taskQueue.shift(),r=this.tasks[s];delete this.tasks[s],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(s,r)}processTask(s,r){return c(this,void 0,void 0,function*(){if(r.type==="<response>"){const m=this.resolveRejects[s];return delete this.resolveRejects[s],m?void(r.error?m.reject(Hs(r.error)):m.resolve(Hs(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(s,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const l=Hs(r.data),f=new AbortController;this.abortControllers[s]=f;try{const m=yield this.messageHandlers[r.type](r.sourceMapId,l,f);this.completeTask(s,null,m)}catch(m){this.completeTask(s,m)}})}completeTask(s,r,l){const f=[];delete this.abortControllers[s];const m={id:s,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?eh(r):null,data:eh(l,f)};this.target.postMessage(m,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},h.D=Gt,h.E=wt,h.F=function(){var s=new pd(16);return pd!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},h.G=Lt,h.H=function(s,r,l){var f,m,y,x,I,C,D,z,F,O,q,G,$=l[0],ae=l[1],he=l[2];return r===s?(s[12]=r[0]*$+r[4]*ae+r[8]*he+r[12],s[13]=r[1]*$+r[5]*ae+r[9]*he+r[13],s[14]=r[2]*$+r[6]*ae+r[10]*he+r[14],s[15]=r[3]*$+r[7]*ae+r[11]*he+r[15]):(m=r[1],y=r[2],x=r[3],I=r[4],C=r[5],D=r[6],z=r[7],F=r[8],O=r[9],q=r[10],G=r[11],s[0]=f=r[0],s[1]=m,s[2]=y,s[3]=x,s[4]=I,s[5]=C,s[6]=D,s[7]=z,s[8]=F,s[9]=O,s[10]=q,s[11]=G,s[12]=f*$+I*ae+F*he+r[12],s[13]=m*$+C*ae+O*he+r[13],s[14]=y*$+D*ae+q*he+r[14],s[15]=x*$+z*ae+G*he+r[15]),s},h.I=oy,h.J=function(s,r,l){var f=l[0],m=l[1],y=l[2];return s[0]=r[0]*f,s[1]=r[1]*f,s[2]=r[2]*f,s[3]=r[3]*f,s[4]=r[4]*m,s[5]=r[5]*m,s[6]=r[6]*m,s[7]=r[7]*m,s[8]=r[8]*y,s[9]=r[9]*y,s[10]=r[10]*y,s[11]=r[11]*y,s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},h.K=wx,h.L=function(s,r){const l={};for(let f=0;f<r.length;f++){const m=r[f];m in s&&(l[m]=s[m])}return l},h.M=au,h.N=gw,h.O=yw,h.P=M,h.Q=Ts,h.R=Is,h.S=Q,h.T=Kc,h.U=K,h.V=je,h.W=cr,h.X=L,h.Y=k0,h.Z=class extends X{},h._=c,h.a=Pt,h.a$=function(s,r){return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[4]=r[4],s[5]=r[5],s[6]=r[6],s[7]=r[7],s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15],s},h.a0=gy,h.a1=dt,h.a2=s=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(l=>{r.onloadstart=()=>{l(r)};for(const f of s){const m=window.document.createElement("source");Le(f)||(r.crossOrigin="Anonymous"),m.src=f,r.appendChild(m)}})},h.a3=function(){return be++},h.a4=xn,h.a5=vd,h.a6=Pf,h.a7=ah,h.a8=wi,h.a9=Iw,h.aA=function(s){if(s.type==="custom")return new W7(s);switch(s.type){case"background":return new j7(s);case"circle":return new EC(s);case"fill":return new GC(s);case"fill-extrusion":return new l7(s);case"heatmap":return new PC(s);case"hillshade":return new zC(s);case"line":return new _7(s);case"raster":return new H7(s);case"symbol":return new C0(s)}},h.aB=Y,h.aC=function(s,r){if(!s)return[{command:"setStyle",args:[r]}];let l=[];try{if(!on(s.version,r.version))return[{command:"setStyle",args:[r]}];on(s.center,r.center)||l.push({command:"setCenter",args:[r.center]}),on(s.zoom,r.zoom)||l.push({command:"setZoom",args:[r.zoom]}),on(s.bearing,r.bearing)||l.push({command:"setBearing",args:[r.bearing]}),on(s.pitch,r.pitch)||l.push({command:"setPitch",args:[r.pitch]}),on(s.sprite,r.sprite)||l.push({command:"setSprite",args:[r.sprite]}),on(s.glyphs,r.glyphs)||l.push({command:"setGlyphs",args:[r.glyphs]}),on(s.transition,r.transition)||l.push({command:"setTransition",args:[r.transition]}),on(s.light,r.light)||l.push({command:"setLight",args:[r.light]}),on(s.terrain,r.terrain)||l.push({command:"setTerrain",args:[r.terrain]}),on(s.sky,r.sky)||l.push({command:"setSky",args:[r.sky]});const f={},m=[];(function(x,I,C,D){let z;for(z in I=I||{},x=x||{})Object.prototype.hasOwnProperty.call(x,z)&&(Object.prototype.hasOwnProperty.call(I,z)||br(z,C,D));for(z in I)Object.prototype.hasOwnProperty.call(I,z)&&(Object.prototype.hasOwnProperty.call(x,z)?on(x[z],I[z])||(x[z].type==="geojson"&&I[z].type==="geojson"&&Tn(x,I,z)?An(C,{command:"setGeoJSONSourceData",args:[z,I[z].data]}):Zn(z,I,C,D)):yr(z,I,C))})(s.sources,r.sources,m,f);const y=[];s.layers&&s.layers.forEach(x=>{"source"in x&&f[x.source]?l.push({command:"removeLayer",args:[x.id]}):y.push(x)}),l=l.concat(m),function(x,I,C){I=I||[];const D=(x=x||[]).map(vr),z=I.map(vr),F=x.reduce(Jn,{}),O=I.reduce(Jn,{}),q=D.slice(),G=Object.create(null);let $,ae,he,ke,ge;for(let Ie=0,Ze=0;Ie<D.length;Ie++)$=D[Ie],Object.prototype.hasOwnProperty.call(O,$)?Ze++:(An(C,{command:"removeLayer",args:[$]}),q.splice(q.indexOf($,Ze),1));for(let Ie=0,Ze=0;Ie<z.length;Ie++)$=z[z.length-1-Ie],q[q.length-1-Ie]!==$&&(Object.prototype.hasOwnProperty.call(F,$)?(An(C,{command:"removeLayer",args:[$]}),q.splice(q.lastIndexOf($,q.length-Ze),1)):Ze++,ke=q[q.length-Ie],An(C,{command:"addLayer",args:[O[$],ke]}),q.splice(q.length-Ie,0,$),G[$]=!0);for(let Ie=0;Ie<z.length;Ie++)if($=z[Ie],ae=F[$],he=O[$],!G[$]&&!on(ae,he))if(on(ae.source,he.source)&&on(ae["source-layer"],he["source-layer"])&&on(ae.type,he.type)){for(ge in pi(ae.layout,he.layout,C,$,null,"setLayoutProperty"),pi(ae.paint,he.paint,C,$,null,"setPaintProperty"),on(ae.filter,he.filter)||An(C,{command:"setFilter",args:[$,he.filter]}),on(ae.minzoom,he.minzoom)&&on(ae.maxzoom,he.maxzoom)||An(C,{command:"setLayerZoomRange",args:[$,he.minzoom,he.maxzoom]}),ae)Object.prototype.hasOwnProperty.call(ae,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?pi(ae[ge],he[ge],C,$,ge.slice(6),"setPaintProperty"):on(ae[ge],he[ge])||An(C,{command:"setLayerProperty",args:[$,ge,he[ge]]}));for(ge in he)Object.prototype.hasOwnProperty.call(he,ge)&&!Object.prototype.hasOwnProperty.call(ae,ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?pi(ae[ge],he[ge],C,$,ge.slice(6),"setPaintProperty"):on(ae[ge],he[ge])||An(C,{command:"setLayerProperty",args:[$,ge,he[ge]]}))}else An(C,{command:"removeLayer",args:[$]}),ke=q[q.lastIndexOf($)+1],An(C,{command:"addLayer",args:[he,ke]})}(y,r.layers,l)}catch(f){console.warn("Unable to compute style diff:",f),l=[{command:"setStyle",args:[r]}]}return l},h.aD=function(s){const r=[],l=s.id;return l===void 0&&r.push({message:`layers.${l}: missing required property "id"`}),s.render===void 0&&r.push({message:`layers.${l}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&r.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),r},h.aE=function s(r,l){if(Array.isArray(r)){if(!Array.isArray(l)||r.length!==l.length)return!1;for(let f=0;f<r.length;f++)if(!s(r[f],l[f]))return!1;return!0}if(typeof r=="object"&&r!==null&&l!==null){if(typeof l!="object"||Object.keys(r).length!==Object.keys(l).length)return!1;for(const f in r)if(!s(r[f],l[f]))return!1;return!0}return r===l},h.aF=me,h.aG=Te,h.aH=class extends nh{constructor(s,r){super(s,r),this.current=0}set(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},h.aI=p0,h.aJ=class extends nh{constructor(s,r){super(s,r),this.current=wC}set(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let r=1;r<16;r++)if(s[r]!==this.current[r]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}},h.aK=hx,h.aL=class extends nh{constructor(s,r){super(s,r),this.current=[0,0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))}},h.aM=class extends nh{constructor(s,r){super(s,r),this.current=[0,0]}set(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))}},h.aN=dx,h.aO=function(s,r,l,f,m,y,x){var I=1/(r-l),C=1/(f-m),D=1/(y-x);return s[0]=-2*I,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*C,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*D,s[11]=0,s[12]=(r+l)*I,s[13]=(m+f)*C,s[14]=(x+y)*D,s[15]=1,s},h.aP=Vn,h.aQ=kC,h.aR=class extends Qe{},h.aS=v7,h.aT=class extends Et{},h.aU=function(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))},h.aV=Ax,h.aW=Ql,h.aX=class extends St{},h.aY=zr,h.aZ=function(s,r){return s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]&&s[3]===r[3]&&s[4]===r[4]&&s[5]===r[5]&&s[6]===r[6]&&s[7]===r[7]&&s[8]===r[8]&&s[9]===r[9]&&s[10]===r[10]&&s[11]===r[11]&&s[12]===r[12]&&s[13]===r[13]&&s[14]===r[14]&&s[15]===r[15]},h.a_=function(s,r){var l=s[0],f=s[1],m=s[2],y=s[3],x=s[4],I=s[5],C=s[6],D=s[7],z=s[8],F=s[9],O=s[10],q=s[11],G=s[12],$=s[13],ae=s[14],he=s[15],ke=r[0],ge=r[1],Ie=r[2],Ze=r[3],et=r[4],kt=r[5],Wt=r[6],It=r[7],vt=r[8],Ot=r[9],Yt=r[10],Tt=r[11],nt=r[12],Ht=r[13],Vt=r[14],yn=r[15];return Math.abs(l-ke)<=Ea*Math.max(1,Math.abs(l),Math.abs(ke))&&Math.abs(f-ge)<=Ea*Math.max(1,Math.abs(f),Math.abs(ge))&&Math.abs(m-Ie)<=Ea*Math.max(1,Math.abs(m),Math.abs(Ie))&&Math.abs(y-Ze)<=Ea*Math.max(1,Math.abs(y),Math.abs(Ze))&&Math.abs(x-et)<=Ea*Math.max(1,Math.abs(x),Math.abs(et))&&Math.abs(I-kt)<=Ea*Math.max(1,Math.abs(I),Math.abs(kt))&&Math.abs(C-Wt)<=Ea*Math.max(1,Math.abs(C),Math.abs(Wt))&&Math.abs(D-It)<=Ea*Math.max(1,Math.abs(D),Math.abs(It))&&Math.abs(z-vt)<=Ea*Math.max(1,Math.abs(z),Math.abs(vt))&&Math.abs(F-Ot)<=Ea*Math.max(1,Math.abs(F),Math.abs(Ot))&&Math.abs(O-Yt)<=Ea*Math.max(1,Math.abs(O),Math.abs(Yt))&&Math.abs(q-Tt)<=Ea*Math.max(1,Math.abs(q),Math.abs(Tt))&&Math.abs(G-nt)<=Ea*Math.max(1,Math.abs(G),Math.abs(nt))&&Math.abs($-Ht)<=Ea*Math.max(1,Math.abs($),Math.abs(Ht))&&Math.abs(ae-Vt)<=Ea*Math.max(1,Math.abs(ae),Math.abs(Vt))&&Math.abs(he-yn)<=Ea*Math.max(1,Math.abs(he),Math.abs(yn))},h.aa=function(s){const r={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,f,m,y)=>{const x=m||y;return r[f]=!x||x.toLowerCase(),""}),r["max-age"]){const l=parseInt(r["max-age"],10);isNaN(l)?delete r["max-age"]:r["max-age"]=l}return r},h.ab=function(s,r){const l=[];for(const f in s)f in r||l.push(f);return l},h.ac=oe,h.ad=function(s,r,l){var f=Math.sin(l),m=Math.cos(l),y=r[0],x=r[1],I=r[2],C=r[3],D=r[4],z=r[5],F=r[6],O=r[7];return r!==s&&(s[8]=r[8],s[9]=r[9],s[10]=r[10],s[11]=r[11],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[0]=y*m+D*f,s[1]=x*m+z*f,s[2]=I*m+F*f,s[3]=C*m+O*f,s[4]=D*m-y*f,s[5]=z*m-x*f,s[6]=F*m-I*f,s[7]=O*m-C*f,s},h.ae=function(s){var r=new pd(16);return r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3],r[4]=s[4],r[5]=s[5],r[6]=s[6],r[7]=s[7],r[8]=s[8],r[9]=s[9],r[10]=s[10],r[11]=s[11],r[12]=s[12],r[13]=s[13],r[14]=s[14],r[15]=s[15],r},h.af=y0,h.ag=function(s,r){let l=0,f=0;if(s.kind==="constant")f=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:m,minZoom:y,maxZoom:x}=s,I=m?oe(Fi.interpolationFactor(m,r,y,x),0,1):0;s.kind==="camera"?f=Ir.number(s.minSize,s.maxSize,I):l=I}return{uSizeT:l,uSize:f}},h.ai=function(s,{uSize:r,uSizeT:l},{lowerSize:f,upperSize:m}){return s.kind==="source"?f/ll:s.kind==="composite"?Ir.number(f/ll,m/ll,l):r},h.aj=hy,h.ak=function(s,r,l,f){const m=r.y-s.y,y=r.x-s.x,x=f.y-l.y,I=f.x-l.x,C=x*y-I*m;if(C===0)return null;const D=(I*(s.y-l.y)-x*(s.x-l.x))/C;return new M(s.x+D*y,s.y+D*m)},h.al=Cw,h.am=_x,h.an=Wg,h.ao=function(s){let r=1/0,l=1/0,f=-1/0,m=-1/0;for(const y of s)r=Math.min(r,y.x),l=Math.min(l,y.y),f=Math.max(f,y.x),m=Math.max(m,y.y);return[r,l,f,m]},h.ap=kr,h.ar=uy,h.as=function(s,r){var l=r[0],f=r[1],m=r[2],y=r[3],x=r[4],I=r[5],C=r[6],D=r[7],z=r[8],F=r[9],O=r[10],q=r[11],G=r[12],$=r[13],ae=r[14],he=r[15],ke=l*I-f*x,ge=l*C-m*x,Ie=l*D-y*x,Ze=f*C-m*I,et=f*D-y*I,kt=m*D-y*C,Wt=z*$-F*G,It=z*ae-O*G,vt=z*he-q*G,Ot=F*ae-O*$,Yt=F*he-q*$,Tt=O*he-q*ae,nt=ke*Tt-ge*Yt+Ie*Ot+Ze*vt-et*It+kt*Wt;return nt?(s[0]=(I*Tt-C*Yt+D*Ot)*(nt=1/nt),s[1]=(m*Yt-f*Tt-y*Ot)*nt,s[2]=($*kt-ae*et+he*Ze)*nt,s[3]=(O*et-F*kt-q*Ze)*nt,s[4]=(C*vt-x*Tt-D*It)*nt,s[5]=(l*Tt-m*vt+y*It)*nt,s[6]=(ae*Ie-G*kt-he*ge)*nt,s[7]=(z*kt-O*Ie+q*ge)*nt,s[8]=(x*Yt-I*vt+D*Wt)*nt,s[9]=(f*vt-l*Yt-y*Wt)*nt,s[10]=(G*et-$*Ie+he*ke)*nt,s[11]=(F*Ie-z*et-q*ke)*nt,s[12]=(I*It-x*Ot-C*Wt)*nt,s[13]=(l*Ot-f*It+m*Wt)*nt,s[14]=($*ge-G*Ze-ae*ke)*nt,s[15]=(z*Ze-F*ge+O*ke)*nt,s):null},h.at=by,h.au=cy,h.av=vy,h.aw=function(){const s={},r=De.$version;for(const l in De.$root){const f=De.$root[l];if(f.required){let m=null;m=l==="version"?r:f.type==="array"?[]:{},m!=null&&(s[l]=m)}}return s},h.ax=s0,h.ay=Bt,h.az=function(s){s=s.slice();const r=Object.create(null);for(let l=0;l<s.length;l++)r[s[l].id]=s[l];for(let l=0;l<s.length;l++)"ref"in s[l]&&(s[l]=Wn(s[l],r[s[l].ref]));return s},h.b=Ge,h.b0=function(s,r,l){return s[0]=r[0]*l[0],s[1]=r[1]*l[1],s[2]=r[2]*l[2],s[3]=r[3]*l[3],s},h.b1=function(s,r){return s[0]*r[0]+s[1]*r[1]+s[2]*r[2]+s[3]*r[3]},h.b2=Z,h.b3=xw,h.b4=bw,h.b5=function(s,r,l,f,m){var y,x=1/Math.tan(r/2);return s[0]=x/l,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=x,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,m!=null&&m!==1/0?(s[10]=(m+f)*(y=1/(f-m)),s[14]=2*m*f*y):(s[10]=-1,s[14]=-2*f),s},h.b6=function(s,r,l){var f=Math.sin(l),m=Math.cos(l),y=r[4],x=r[5],I=r[6],C=r[7],D=r[8],z=r[9],F=r[10],O=r[11];return r!==s&&(s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=r[3],s[12]=r[12],s[13]=r[13],s[14]=r[14],s[15]=r[15]),s[4]=y*m+D*f,s[5]=x*m+z*f,s[6]=I*m+F*f,s[7]=C*m+O*f,s[8]=D*m-y*f,s[9]=z*m-x*f,s[10]=F*m-I*f,s[11]=O*m-C*f,s},h.b7=le,h.b8=ee,h.b9=function(s){return s*Math.PI/180},h.bA=Xh,h.bB=al,h.ba=function(s,r){return s[0]=r[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=r[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=r[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},h.bb=class extends W{},h.bc=my,h.bd=nk,h.bf=gt,h.bg=function(s,r){Pt.REGISTERED_PROTOCOLS[s]=r},h.bh=function(s){delete Pt.REGISTERED_PROTOCOLS[s]},h.bi=function(s,r){const l={};for(let m=0;m<s.length;m++){const y=r&&r[s[m].id]||Fg(s[m]);r&&(r[s[m].id]=y);let x=l[y];x||(x=l[y]=[]),x.push(s[m])}const f=[];for(const m in l)f.push(l[m]);return f},h.bj=Rt,h.bk=Sw,h.bl=Tw,h.bm=nw,h.bn=function(s){s.bucket.createArrays(),s.bucket.tilePixelRatio=cr/(512*s.bucket.overscaling),s.bucket.compareText={},s.bucket.iconsNeedLinear=!1;const r=s.bucket.layers[0],l=r.layout,f=r._unevaluatedLayout._values,m={layoutIconSize:f["icon-size"].possiblyEvaluate(new wi(s.bucket.zoom+1),s.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new wi(s.bucket.zoom+1),s.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new wi(18))};if(s.bucket.textSizeData.kind==="composite"){const{minZoom:D,maxZoom:z}=s.bucket.textSizeData;m.compositeTextSizes=[f["text-size"].possiblyEvaluate(new wi(D),s.canonical),f["text-size"].possiblyEvaluate(new wi(z),s.canonical)]}if(s.bucket.iconSizeData.kind==="composite"){const{minZoom:D,maxZoom:z}=s.bucket.iconSizeData;m.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new wi(D),s.canonical),f["icon-size"].possiblyEvaluate(new wi(z),s.canonical)]}const y=l.get("text-line-height")*kr,x=l.get("text-rotation-alignment")!=="viewport"&&l.get("symbol-placement")!=="point",I=l.get("text-keep-upright"),C=l.get("text-size");for(const D of s.bucket.features){const z=l.get("text-font").evaluate(D,{},s.canonical).join(","),F=C.evaluate(D,{},s.canonical),O=m.layoutTextSize.evaluate(D,{},s.canonical),q=m.layoutIconSize.evaluate(D,{},s.canonical),G={horizontal:{},vertical:void 0},$=D.text;let ae,he=[0,0];if($){const Ie=$.toString(),Ze=l.get("text-letter-spacing").evaluate(D,{},s.canonical)*kr,et=Rg(Ie)?Ze:0,kt=l.get("text-anchor").evaluate(D,{},s.canonical),Wt=Nw(r,D,s.canonical);if(!Wt){const Tt=l.get("text-radial-offset").evaluate(D,{},s.canonical);he=Tt?Fw(kt,[Tt*kr,yy]):l.get("text-offset").evaluate(D,{},s.canonical).map(nt=>nt*kr)}let It=x?"center":l.get("text-justify").evaluate(D,{},s.canonical);const vt=l.get("symbol-placement"),Ot=vt==="point"?l.get("text-max-width").evaluate(D,{},s.canonical)*kr:0,Yt=()=>{s.bucket.allowVerticalPlacement&&qf(Ie)&&(G.vertical=T0($,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ot,y,kt,"left",et,he,h.ah.vertical,!0,vt,O,F))};if(!x&&Wt){const Tt=new Set;if(It==="auto")for(let Ht=0;Ht<Wt.values.length;Ht+=2)Tt.add(by(Wt.values[Ht]));else Tt.add(It);let nt=!1;for(const Ht of Tt)if(!G.horizontal[Ht])if(nt)G.horizontal[Ht]=G.horizontal[0];else{const Vt=T0($,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ot,y,"center",Ht,et,he,h.ah.horizontal,!1,vt,O,F);Vt&&(G.horizontal[Ht]=Vt,nt=Vt.positionedLines.length===1)}Yt()}else{It==="auto"&&(It=by(kt));const Tt=T0($,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ot,y,kt,It,et,he,h.ah.horizontal,!1,vt,O,F);Tt&&(G.horizontal[It]=Tt),Yt(),qf(Ie)&&x&&I&&(G.vertical=T0($,s.glyphMap,s.glyphPositions,s.imagePositions,z,Ot,y,kt,It,et,he,h.ah.vertical,!1,vt,O,F))}}let ke=!1;if(D.icon&&D.icon.name){const Ie=s.imageMap[D.icon.name];Ie&&(ae=N7(s.imagePositions[D.icon.name],l.get("icon-offset").evaluate(D,{},s.canonical),l.get("icon-anchor").evaluate(D,{},s.canonical)),ke=!!Ie.sdf,s.bucket.sdfIcons===void 0?s.bucket.sdfIcons=ke:s.bucket.sdfIcons!==ke&&qe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ie.pixelRatio!==s.bucket.pixelRatio||l.get("icon-rotate").constantOr(1)!==0)&&(s.bucket.iconsNeedLinear=!0))}const ge=Ow(G.horizontal)||G.vertical;s.bucket.iconsInText=!!ge&&ge.iconsInText,(ge||ae)&&ek(s.bucket,D,G,ae,s.imageMap,m,O,q,he,ke,s.canonical)}s.showCollisionBoxes&&s.bucket.generateCollisionDebugBuffers()},h.bo=iy,h.bp=ey,h.bq=ny,h.br=nu,h.bs=ay,h.bt=class{constructor(s){this._marks={start:[s.url,"start"].join("#"),end:[s.url,"end"].join("#"),measure:s.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let s=performance.getEntriesByName(this._marks.measure);return s.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),s=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),s}},h.bu=function(s,r,l,f,m){return c(this,void 0,void 0,function*(){if(K())try{return yield je(s,r,l,f,m)}catch{}return function(y,x,I,C,D){const z=y.width,F=y.height;Ve&&$e||(Ve=new OffscreenCanvas(z,F),$e=Ve.getContext("2d",{willReadFrequently:!0})),Ve.width=z,Ve.height=F,$e.drawImage(y,0,0,z,F);const O=$e.getImageData(x,I,C,D);return $e.clearRect(0,0,z,F),O.data}(s,r,l,f,m)})},h.bv=ww,h.bw=b,h.bx=w,h.by=Gx,h.bz=function(s){return s.message===st},h.c=ct,h.d=s=>c(void 0,void 0,void 0,function*(){if(s.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(s)],{type:"image/png"});try{return createImageBitmap(r)}catch(l){throw new Error(`Could not load image because of ${l.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),h.e=ne,h.f=s=>new Promise((r,l)=>{const f=new Image;f.onload=()=>{r(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=ot})},f.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(s)],{type:"image/png"});f.src=s.byteLength?URL.createObjectURL(m):ot}),h.g=Ut,h.h=(s,r)=>tt(ne(s,{type:"json"}),r),h.i=Be,h.j=Ee,h.k=Ke,h.l=(s,r)=>tt(ne(s,{type:"arrayBuffer"}),r),h.m=tt,h.n=function(s){return new ay(s).readFields(D7,[])},h.o=tp,h.p=tw,h.q=p,h.r=Ng,h.s=Le,h.t=jf,h.u=Ct,h.v=De,h.w=qe,h.x=Qu,h.y=function([s,r,l]){return r+=90,r*=Math.PI/180,l*=Math.PI/180,{x:s*Math.cos(r)*Math.sin(l),y:s*Math.sin(r)*Math.sin(l),z:s*Math.cos(l)}},h.z=Ir}),o("worker",["./shared"],function(h){class c{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,j){for(const se of V){this._layerConfigs[se.id]=se;const _e=this._layers[se.id]=h.aA(se);_e._featureFilter=h.a6(_e.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(const se of j)delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se];this.familiesBySource={};const H=h.bi(Object.values(this._layerConfigs),this.keyCache);for(const se of H){const _e=se.map(We=>this._layers[We.id]),xe=_e[0];if(xe.visibility==="none")continue;const we=xe.source||"";let de=this.familiesBySource[we];de||(de=this.familiesBySource[we]={});const Pe=xe.sourceLayer||"_geojsonTileLayer";let Xe=de[Pe];Xe||(Xe=de[Pe]=[]),Xe.push(_e)}}}class b{constructor(V){const j={},H=[];for(const we in V){const de=V[we],Pe=j[we]={};for(const Xe in de){const We=de[+Xe];if(!We||We.bitmap.width===0||We.bitmap.height===0)continue;const Ue={x:0,y:0,w:We.bitmap.width+2,h:We.bitmap.height+2};H.push(Ue),Pe[Xe]={rect:Ue,metrics:We.metrics}}}const{w:se,h:_e}=h.p(H),xe=new h.o({width:se||1,height:_e||1});for(const we in V){const de=V[we];for(const Pe in de){const Xe=de[+Pe];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const We=j[we][Pe].rect;h.o.copy(Xe.bitmap,xe,{x:0,y:0},{x:We.x+1,y:We.y+1},Xe.bitmap)}}this.image=xe,this.positions=j}}h.bj("GlyphAtlas",b);class w{constructor(V){this.tileID=new h.Q(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId,this.inFlightDependencies=[]}parse(V,j,H,se){return h._(this,void 0,void 0,function*(){this.status="parsing",this.data=V,this.collisionBoxArray=new h.a4;const _e=new h.bk(Object.keys(V.layers).sort()),xe=new h.bl(this.tileID,this.promoteId);xe.bucketLayerIDs=[];const we={},de={featureIndex:xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:H},Pe=j.familiesBySource[this.source];for(const nn in Pe){const Fn=V.layers[nn];if(!Fn)continue;Fn.version===1&&h.w(`Vector tile source "${this.source}" layer "${nn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const $n=_e.encode(nn),Ai=[];for(let xr=0;xr<Fn.length;xr++){const mi=Fn.feature(xr),sr=xe.getId(mi,nn);Ai.push({feature:mi,id:sr,index:xr,sourceLayerIndex:$n})}for(const xr of Pe[nn]){const mi=xr[0];mi.source!==this.source&&h.w(`layer.source = ${mi.source} does not equal this.source = ${this.source}`),mi.minzoom&&this.zoom<Math.floor(mi.minzoom)||mi.maxzoom&&this.zoom>=mi.maxzoom||mi.visibility!=="none"&&(S(xr,this.zoom,H),(we[mi.id]=mi.createBucket({index:xe.bucketLayerIDs.length,layers:xr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:$n,sourceID:this.source})).populate(Ai,de,this.tileID.canonical),xe.bucketLayerIDs.push(xr.map(sr=>sr.id)))}}const Xe=h.aF(de.glyphDependencies,nn=>Object.keys(nn).map(Number));this.inFlightDependencies.forEach(nn=>nn==null?void 0:nn.abort()),this.inFlightDependencies=[];let We=Promise.resolve({});if(Object.keys(Xe).length){const nn=new AbortController;this.inFlightDependencies.push(nn),We=se.sendAsync({type:"GG",data:{stacks:Xe,source:this.source,tileID:this.tileID,type:"glyphs"}},nn)}const Ue=Object.keys(de.iconDependencies);let Ft=Promise.resolve({});if(Ue.length){const nn=new AbortController;this.inFlightDependencies.push(nn),Ft=se.sendAsync({type:"GI",data:{icons:Ue,source:this.source,tileID:this.tileID,type:"icons"}},nn)}const Nt=Object.keys(de.patternDependencies);let gn=Promise.resolve({});if(Nt.length){const nn=new AbortController;this.inFlightDependencies.push(nn),gn=se.sendAsync({type:"GI",data:{icons:Nt,source:this.source,tileID:this.tileID,type:"patterns"}},nn)}const[Kt,tn,en]=yield Promise.all([We,Ft,gn]),Kn=new b(Kt),ni=new h.bm(tn,en);for(const nn in we){const Fn=we[nn];Fn instanceof h.a5?(S(Fn.layers,this.zoom,H),h.bn({bucket:Fn,glyphMap:Kt,glyphPositions:Kn.positions,imageMap:tn,imagePositions:ni.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Fn.hasPattern&&(Fn instanceof h.bo||Fn instanceof h.bp||Fn instanceof h.bq)&&(S(Fn.layers,this.zoom,H),Fn.addFeatures(de,this.tileID.canonical,ni.patternPositions))}return this.status="done",{buckets:Object.values(we).filter(nn=>!nn.isEmpty()),featureIndex:xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Kn.image,imageAtlas:ni,glyphMap:this.returnDependencies?Kt:null,iconMap:this.returnDependencies?tn:null,glyphPositions:this.returnDependencies?Kn.positions:null}})}}function S(ie,V,j){const H=new h.a8(V);for(const se of ie)se.recalculate(H,j)}class M{constructor(V,j,H){this.actor=V,this.layerIndex=j,this.availableImages=H,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(V,j){return h._(this,void 0,void 0,function*(){const H=yield h.l(V.request,j);try{return{vectorTile:new h.br.VectorTile(new h.bs(H.data)),rawData:H.data,cacheControl:H.cacheControl,expires:H.expires}}catch(se){const _e=new Uint8Array(H.data);let xe=`Unable to parse the tile at ${V.request.url}, `;throw xe+=_e[0]===31&&_e[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${se.messge}`,new Error(xe)}})}loadTile(V){return h._(this,void 0,void 0,function*(){const j=V.uid,H=!!(V&&V.request&&V.request.collectResourceTiming)&&new h.bt(V.request),se=new w(V);this.loading[j]=se;const _e=new AbortController;se.abort=_e;try{const xe=yield this.loadVectorTile(V,_e);if(delete this.loading[j],!xe)return null;const we=xe.rawData,de={};xe.expires&&(de.expires=xe.expires),xe.cacheControl&&(de.cacheControl=xe.cacheControl);const Pe={};if(H){const We=H.finish();We&&(Pe.resourceTiming=JSON.parse(JSON.stringify(We)))}se.vectorTile=xe.vectorTile;const Xe=se.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[j]=se,this.fetching[j]={rawTileData:we,cacheControl:de,resourceTiming:Pe};try{const We=yield Xe;return h.e({rawTileData:we.slice(0)},We,de,Pe)}finally{delete this.fetching[j]}}catch(xe){throw delete this.loading[j],se.status="done",this.loaded[j]=se,xe}})}reloadTile(V){return h._(this,void 0,void 0,function*(){const j=V.uid;if(!this.loaded||!this.loaded[j])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const H=this.loaded[j];if(H.showCollisionBoxes=V.showCollisionBoxes,H.status==="parsing"){const se=yield H.parse(H.vectorTile,this.layerIndex,this.availableImages,this.actor);let _e;if(this.fetching[j]){const{rawTileData:xe,cacheControl:we,resourceTiming:de}=this.fetching[j];delete this.fetching[j],_e=h.e({rawTileData:xe.slice(0)},se,we,de)}else _e=se;return _e}if(H.status==="done"&&H.vectorTile)return H.parse(H.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(V){return h._(this,void 0,void 0,function*(){const j=this.loading,H=V.uid;j&&j[H]&&j[H].abort&&(j[H].abort.abort(),delete j[H])})}removeTile(V){return h._(this,void 0,void 0,function*(){this.loaded&&this.loaded[V.uid]&&delete this.loaded[V.uid]})}}class A{constructor(){this.loaded={}}loadTile(V){return h._(this,void 0,void 0,function*(){const{uid:j,encoding:H,rawImageData:se,redFactor:_e,greenFactor:xe,blueFactor:we,baseShift:de}=V,Pe=se.width+2,Xe=se.height+2,We=h.b(se)?new h.R({width:Pe,height:Xe},yield h.bu(se,-1,-1,Pe,Xe)):se,Ue=new h.bv(j,We,H,_e,xe,we,de);return this.loaded=this.loaded||{},this.loaded[j]=Ue,Ue})}removeTile(V){const j=this.loaded,H=V.uid;j&&j[H]&&delete j[H]}}function P(ie,V){if(ie.length!==0){B(ie[0],V);for(var j=1;j<ie.length;j++)B(ie[j],!V)}}function B(ie,V){for(var j=0,H=0,se=0,_e=ie.length,xe=_e-1;se<_e;xe=se++){var we=(ie[se][0]-ie[xe][0])*(ie[xe][1]+ie[se][1]),de=j+we;H+=Math.abs(j)>=Math.abs(we)?j-de+we:we-de+j,j=de}j+H>=0!=!!V&&ie.reverse()}var U=h.bw(function ie(V,j){var H,se=V&&V.type;if(se==="FeatureCollection")for(H=0;H<V.features.length;H++)ie(V.features[H],j);else if(se==="GeometryCollection")for(H=0;H<V.geometries.length;H++)ie(V.geometries[H],j);else if(se==="Feature")ie(V.geometry,j);else if(se==="Polygon")P(V.coordinates,j);else if(se==="MultiPolygon")for(H=0;H<V.coordinates.length;H++)P(V.coordinates[H],j);return V});const J=h.br.VectorTileFeature.prototype.toGeoJSON;var Q={exports:{}},K=h.bx,le=h.br.VectorTileFeature,ee=oe;function oe(ie,V){this.options=V||{},this.features=ie,this.length=ie.length}function Z(ie,V){this.id=typeof ie.id=="number"?ie.id:void 0,this.type=ie.type,this.rawGeometry=ie.type===1?[ie.geometry]:ie.geometry,this.properties=ie.tags,this.extent=V||4096}oe.prototype.feature=function(ie){return new Z(this.features[ie],this.options.extent)},Z.prototype.loadGeometry=function(){var ie=this.rawGeometry;this.geometry=[];for(var V=0;V<ie.length;V++){for(var j=ie[V],H=[],se=0;se<j.length;se++)H.push(new K(j[se][0],j[se][1]));this.geometry.push(H)}return this.geometry},Z.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ie=this.geometry,V=1/0,j=-1/0,H=1/0,se=-1/0,_e=0;_e<ie.length;_e++)for(var xe=ie[_e],we=0;we<xe.length;we++){var de=xe[we];V=Math.min(V,de.x),j=Math.max(j,de.x),H=Math.min(H,de.y),se=Math.max(se,de.y)}return[V,H,j,se]},Z.prototype.toGeoJSON=le.prototype.toGeoJSON;var ne=h.by,be=ee;function me(ie){var V=new ne;return function(j,H){for(var se in j.layers)H.writeMessage(3,Te,j.layers[se])}(ie,V),V.finish()}function Te(ie,V){var j;V.writeVarintField(15,ie.version||1),V.writeStringField(1,ie.name||""),V.writeVarintField(5,ie.extent||4096);var H={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<ie.length;j++)H.feature=ie.feature(j),V.writeMessage(2,Y,H);var se=H.keys;for(j=0;j<se.length;j++)V.writeStringField(3,se[j]);var _e=H.values;for(j=0;j<_e.length;j++)V.writeMessage(4,lt,_e[j])}function Y(ie,V){var j=ie.feature;j.id!==void 0&&V.writeVarintField(1,j.id),V.writeMessage(2,ye,ie),V.writeVarintField(3,j.type),V.writeMessage(4,Be,j)}function ye(ie,V){var j=ie.feature,H=ie.keys,se=ie.values,_e=ie.keycache,xe=ie.valuecache;for(var we in j.properties){var de=j.properties[we],Pe=_e[we];if(de!==null){Pe===void 0&&(H.push(we),_e[we]=Pe=H.length-1),V.writeVarint(Pe);var Xe=typeof de;Xe!=="string"&&Xe!=="boolean"&&Xe!=="number"&&(de=JSON.stringify(de));var We=Xe+":"+de,Ue=xe[We];Ue===void 0&&(se.push(de),xe[We]=Ue=se.length-1),V.writeVarint(Ue)}}}function qe(ie,V){return(V<<3)+(7&ie)}function He(ie){return ie<<1^ie>>31}function Be(ie,V){for(var j=ie.loadGeometry(),H=ie.type,se=0,_e=0,xe=j.length,we=0;we<xe;we++){var de=j[we],Pe=1;H===1&&(Pe=de.length),V.writeVarint(qe(1,Pe));for(var Xe=H===3?de.length-1:de.length,We=0;We<Xe;We++){We===1&&H!==1&&V.writeVarint(qe(2,Xe-1));var Ue=de[We].x-se,Ft=de[We].y-_e;V.writeVarint(He(Ue)),V.writeVarint(He(Ft)),se+=Ue,_e+=Ft}H===3&&V.writeVarint(qe(7,1))}}function lt(ie,V){var j=typeof ie;j==="string"?V.writeStringField(1,ie):j==="boolean"?V.writeBooleanField(7,ie):j==="number"&&(ie%1!=0?V.writeDoubleField(3,ie):ie<0?V.writeSVarintField(6,ie):V.writeVarintField(5,ie))}Q.exports=me,Q.exports.fromVectorTileJs=me,Q.exports.fromGeojsonVt=function(ie,V){V=V||{};var j={};for(var H in ie)j[H]=new be(ie[H].features,V),j[H].name=H,j[H].version=V.version,j[H].extent=V.extent;return me({layers:j})},Q.exports.GeoJSONWrapper=be;var Ge=h.bw(Q.exports);const ot={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ie=>ie},je=Math.fround||(Ve=new Float32Array(1),ie=>(Ve[0]=+ie,Ve[0]));var Ve;const $e=3,st=5,ct=6;class Pt{constructor(V){this.options=Object.assign(Object.create(ot),V),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(V){const{log:j,minZoom:H,maxZoom:se}=this.options;j&&console.time("total time");const _e=`prepare ${V.length} points`;j&&console.time(_e),this.points=V;const xe=[];for(let de=0;de<V.length;de++){const Pe=V[de];if(!Pe.geometry)continue;const[Xe,We]=Pe.geometry.coordinates,Ue=je(gt(Xe)),Ft=je(Bt(We));xe.push(Ue,Ft,1/0,de,-1,1),this.options.reduce&&xe.push(0)}let we=this.trees[se+1]=this._createTree(xe);j&&console.timeEnd(_e);for(let de=se;de>=H;de--){const Pe=+Date.now();we=this.trees[de]=this._createTree(this._cluster(we,de)),j&&console.log("z%d: %d clusters in %dms",de,we.numItems,+Date.now()-Pe)}return j&&console.timeEnd("total time"),this}getClusters(V,j){let H=((V[0]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,V[1]));let _e=V[2]===180?180:((V[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)H=-180,_e=180;else if(H>_e){const We=this.getClusters([H,se,180,xe],j),Ue=this.getClusters([-180,se,_e,xe],j);return We.concat(Ue)}const we=this.trees[this._limitZoom(j)],de=we.range(gt(H),Bt(xe),gt(_e),Bt(se)),Pe=we.data,Xe=[];for(const We of de){const Ue=this.stride*We;Xe.push(Pe[Ue+st]>1?Ut(Pe,Ue,this.clusterProps):this.points[Pe[Ue+$e]])}return Xe}getChildren(V){const j=this._getOriginId(V),H=this._getOriginZoom(V),se="No cluster with the specified id.",_e=this.trees[H];if(!_e)throw new Error(se);const xe=_e.data;if(j*this.stride>=xe.length)throw new Error(se);const we=this.options.radius/(this.options.extent*Math.pow(2,H-1)),de=_e.within(xe[j*this.stride],xe[j*this.stride+1],we),Pe=[];for(const Xe of de){const We=Xe*this.stride;xe[We+4]===V&&Pe.push(xe[We+st]>1?Ut(xe,We,this.clusterProps):this.points[xe[We+$e]])}if(Pe.length===0)throw new Error(se);return Pe}getLeaves(V,j,H){const se=[];return this._appendLeaves(se,V,j=j||10,H=H||0,0),se}getTile(V,j,H){const se=this.trees[this._limitZoom(V)],_e=Math.pow(2,V),{extent:xe,radius:we}=this.options,de=we/xe,Pe=(H-de)/_e,Xe=(H+1+de)/_e,We={features:[]};return this._addTileFeatures(se.range((j-de)/_e,Pe,(j+1+de)/_e,Xe),se.data,j,H,_e,We),j===0&&this._addTileFeatures(se.range(1-de/_e,Pe,1,Xe),se.data,_e,H,_e,We),j===_e-1&&this._addTileFeatures(se.range(0,Pe,de/_e,Xe),se.data,-1,H,_e,We),We.features.length?We:null}getClusterExpansionZoom(V){let j=this._getOriginZoom(V)-1;for(;j<=this.options.maxZoom;){const H=this.getChildren(V);if(j++,H.length!==1)break;V=H[0].properties.cluster_id}return j}_appendLeaves(V,j,H,se,_e){const xe=this.getChildren(j);for(const we of xe){const de=we.properties;if(de&&de.cluster?_e+de.point_count<=se?_e+=de.point_count:_e=this._appendLeaves(V,de.cluster_id,H,se,_e):_e<se?_e++:V.push(we),V.length===H)break}return _e}_createTree(V){const j=new h.av(V.length/this.stride|0,this.options.nodeSize,Float32Array);for(let H=0;H<V.length;H+=this.stride)j.add(V[H],V[H+1]);return j.finish(),j.data=V,j}_addTileFeatures(V,j,H,se,_e,xe){for(const we of V){const de=we*this.stride,Pe=j[de+st]>1;let Xe,We,Ue;if(Pe)Xe=Lt(j,de,this.clusterProps),We=j[de],Ue=j[de+1];else{const gn=this.points[j[de+$e]];Xe=gn.properties;const[Kt,tn]=gn.geometry.coordinates;We=gt(Kt),Ue=Bt(tn)}const Ft={type:1,geometry:[[Math.round(this.options.extent*(We*_e-H)),Math.round(this.options.extent*(Ue*_e-se))]],tags:Xe};let Nt;Nt=Pe||this.options.generateId?j[de+$e]:this.points[j[de+$e]].id,Nt!==void 0&&(Ft.id=Nt),xe.features.push(Ft)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,j){const{radius:H,extent:se,reduce:_e,minPoints:xe}=this.options,we=H/(se*Math.pow(2,j)),de=V.data,Pe=[],Xe=this.stride;for(let We=0;We<de.length;We+=Xe){if(de[We+2]<=j)continue;de[We+2]=j;const Ue=de[We],Ft=de[We+1],Nt=V.within(de[We],de[We+1],we),gn=de[We+st];let Kt=gn;for(const tn of Nt){const en=tn*Xe;de[en+2]>j&&(Kt+=de[en+st])}if(Kt>gn&&Kt>=xe){let tn,en=Ue*gn,Kn=Ft*gn,ni=-1;const nn=((We/Xe|0)<<5)+(j+1)+this.points.length;for(const Fn of Nt){const $n=Fn*Xe;if(de[$n+2]<=j)continue;de[$n+2]=j;const Ai=de[$n+st];en+=de[$n]*Ai,Kn+=de[$n+1]*Ai,de[$n+4]=nn,_e&&(tn||(tn=this._map(de,We,!0),ni=this.clusterProps.length,this.clusterProps.push(tn)),_e(tn,this._map(de,$n)))}de[We+4]=nn,Pe.push(en/Kt,Kn/Kt,1/0,nn,-1,Kt),_e&&Pe.push(ni)}else{for(let tn=0;tn<Xe;tn++)Pe.push(de[We+tn]);if(Kt>1)for(const tn of Nt){const en=tn*Xe;if(!(de[en+2]<=j)){de[en+2]=j;for(let Kn=0;Kn<Xe;Kn++)Pe.push(de[en+Kn])}}}}return Pe}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,j,H){if(V[j+st]>1){const xe=this.clusterProps[V[j+ct]];return H?Object.assign({},xe):xe}const se=this.points[V[j+$e]].properties,_e=this.options.map(se);return H&&_e===se?Object.assign({},_e):_e}}function Ut(ie,V,j){return{type:"Feature",id:ie[V+$e],properties:Lt(ie,V,j),geometry:{type:"Point",coordinates:[(H=ie[V],360*(H-.5)),tt(ie[V+1])]}};var H}function Lt(ie,V,j){const H=ie[V+st],se=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H,_e=ie[V+ct],xe=_e===-1?{}:Object.assign({},j[_e]);return Object.assign(xe,{cluster:!0,cluster_id:ie[V+$e],point_count:H,point_count_abbreviated:se})}function gt(ie){return ie/360+.5}function Bt(ie){const V=Math.sin(ie*Math.PI/180),j=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return j<0?0:j>1?1:j}function tt(ie){const V=(180-360*ie)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function Le(ie,V,j,H){for(var se,_e=H,xe=j-V>>1,we=j-V,de=ie[V],Pe=ie[V+1],Xe=ie[j],We=ie[j+1],Ue=V+3;Ue<j;Ue+=3){var Ft=ut(ie[Ue],ie[Ue+1],de,Pe,Xe,We);if(Ft>_e)se=Ue,_e=Ft;else if(Ft===_e){var Nt=Math.abs(Ue-xe);Nt<we&&(se=Ue,we=Nt)}}_e>H&&(se-V>3&&Le(ie,V,se,H),ie[se+2]=_e,j-se>3&&Le(ie,se,j,H))}function ut(ie,V,j,H,se,_e){var xe=se-j,we=_e-H;if(xe!==0||we!==0){var de=((ie-j)*xe+(V-H)*we)/(xe*xe+we*we);de>1?(j=se,H=_e):de>0&&(j+=xe*de,H+=we*de)}return(xe=ie-j)*xe+(we=V-H)*we}function Re(ie,V,j,H){var se={id:ie===void 0?null:ie,type:V,geometry:j,tags:H,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(_e){var xe=_e.geometry,we=_e.type;if(we==="Point"||we==="MultiPoint"||we==="LineString")Ke(_e,xe);else if(we==="Polygon"||we==="MultiLineString")for(var de=0;de<xe.length;de++)Ke(_e,xe[de]);else if(we==="MultiPolygon")for(de=0;de<xe.length;de++)for(var Pe=0;Pe<xe[de].length;Pe++)Ke(_e,xe[de][Pe])}(se),se}function Ke(ie,V){for(var j=0;j<V.length;j+=3)ie.minX=Math.min(ie.minX,V[j]),ie.minY=Math.min(ie.minY,V[j+1]),ie.maxX=Math.max(ie.maxX,V[j]),ie.maxY=Math.max(ie.maxY,V[j+1])}function Ee(ie,V,j,H){if(V.geometry){var se=V.geometry.coordinates,_e=V.geometry.type,xe=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2),we=[],de=V.id;if(j.promoteId?de=V.properties[j.promoteId]:j.generateId&&(de=H||0),_e==="Point")wt(se,we);else if(_e==="MultiPoint")for(var Pe=0;Pe<se.length;Pe++)wt(se[Pe],we);else if(_e==="LineString")De(se,we,xe,!1);else if(_e==="MultiLineString"){if(j.lineMetrics){for(Pe=0;Pe<se.length;Pe++)De(se[Pe],we=[],xe,!1),ie.push(Re(de,"LineString",we,V.properties));return}wn(se,we,xe,!1)}else if(_e==="Polygon")wn(se,we,xe,!0);else{if(_e!=="MultiPolygon"){if(_e==="GeometryCollection"){for(Pe=0;Pe<V.geometry.geometries.length;Pe++)Ee(ie,{id:de,geometry:V.geometry.geometries[Pe],properties:V.properties},j,H);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Pe=0;Pe<se.length;Pe++){var Xe=[];wn(se[Pe],Xe,xe,!0),we.push(Xe)}}ie.push(Re(de,_e,we,V.properties))}}function wt(ie,V){V.push(Wn(ie[0])),V.push(on(ie[1])),V.push(0)}function De(ie,V,j,H){for(var se,_e,xe=0,we=0;we<ie.length;we++){var de=Wn(ie[we][0]),Pe=on(ie[we][1]);V.push(de),V.push(Pe),V.push(0),we>0&&(xe+=H?(se*Pe-de*_e)/2:Math.sqrt(Math.pow(de-se,2)+Math.pow(Pe-_e,2))),se=de,_e=Pe}var Xe=V.length-3;V[2]=1,Le(V,0,Xe,j),V[Xe+2]=1,V.size=Math.abs(xe),V.start=0,V.end=V.size}function wn(ie,V,j,H){for(var se=0;se<ie.length;se++){var _e=[];De(ie[se],_e,j,H),V.push(_e)}}function Wn(ie){return ie/360+.5}function on(ie){var V=Math.sin(ie*Math.PI/180),j=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return j<0?0:j>1?1:j}function An(ie,V,j,H,se,_e,xe,we){if(H/=V,_e>=(j/=V)&&xe<H)return ie;if(xe<j||_e>=H)return null;for(var de=[],Pe=0;Pe<ie.length;Pe++){var Xe=ie[Pe],We=Xe.geometry,Ue=Xe.type,Ft=se===0?Xe.minX:Xe.minY,Nt=se===0?Xe.maxX:Xe.maxY;if(Ft>=j&&Nt<H)de.push(Xe);else if(!(Nt<j||Ft>=H)){var gn=[];if(Ue==="Point"||Ue==="MultiPoint")yr(We,gn,j,H,se);else if(Ue==="LineString")br(We,gn,j,H,se,!1,we.lineMetrics);else if(Ue==="MultiLineString")Tn(We,gn,j,H,se,!1);else if(Ue==="Polygon")Tn(We,gn,j,H,se,!0);else if(Ue==="MultiPolygon")for(var Kt=0;Kt<We.length;Kt++){var tn=[];Tn(We[Kt],tn,j,H,se,!0),tn.length&&gn.push(tn)}if(gn.length){if(we.lineMetrics&&Ue==="LineString"){for(Kt=0;Kt<gn.length;Kt++)de.push(Re(Xe.id,Ue,gn[Kt],Xe.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(gn.length===1?(Ue="LineString",gn=gn[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=gn.length===3?"Point":"MultiPoint"),de.push(Re(Xe.id,Ue,gn,Xe.tags))}}}return de.length?de:null}function yr(ie,V,j,H,se){for(var _e=0;_e<ie.length;_e+=3){var xe=ie[_e+se];xe>=j&&xe<=H&&(V.push(ie[_e]),V.push(ie[_e+1]),V.push(ie[_e+2]))}}function br(ie,V,j,H,se,_e,xe){for(var we,de,Pe=Zn(ie),Xe=se===0?vr:Jn,We=ie.start,Ue=0;Ue<ie.length-3;Ue+=3){var Ft=ie[Ue],Nt=ie[Ue+1],gn=ie[Ue+2],Kt=ie[Ue+3],tn=ie[Ue+4],en=se===0?Ft:Nt,Kn=se===0?Kt:tn,ni=!1;xe&&(we=Math.sqrt(Math.pow(Ft-Kt,2)+Math.pow(Nt-tn,2))),en<j?Kn>j&&(de=Xe(Pe,Ft,Nt,Kt,tn,j),xe&&(Pe.start=We+we*de)):en>H?Kn<H&&(de=Xe(Pe,Ft,Nt,Kt,tn,H),xe&&(Pe.start=We+we*de)):pi(Pe,Ft,Nt,gn),Kn<j&&en>=j&&(de=Xe(Pe,Ft,Nt,Kt,tn,j),ni=!0),Kn>H&&en<=H&&(de=Xe(Pe,Ft,Nt,Kt,tn,H),ni=!0),!_e&&ni&&(xe&&(Pe.end=We+we*de),V.push(Pe),Pe=Zn(ie)),xe&&(We+=we)}var nn=ie.length-3;Ft=ie[nn],Nt=ie[nn+1],gn=ie[nn+2],(en=se===0?Ft:Nt)>=j&&en<=H&&pi(Pe,Ft,Nt,gn),nn=Pe.length-3,_e&&nn>=3&&(Pe[nn]!==Pe[0]||Pe[nn+1]!==Pe[1])&&pi(Pe,Pe[0],Pe[1],Pe[2]),Pe.length&&V.push(Pe)}function Zn(ie){var V=[];return V.size=ie.size,V.start=ie.start,V.end=ie.end,V}function Tn(ie,V,j,H,se,_e){for(var xe=0;xe<ie.length;xe++)br(ie[xe],V,j,H,se,_e,!1)}function pi(ie,V,j,H){ie.push(V),ie.push(j),ie.push(H)}function vr(ie,V,j,H,se,_e){var xe=(_e-V)/(H-V);return ie.push(_e),ie.push(j+(se-j)*xe),ie.push(1),xe}function Jn(ie,V,j,H,se,_e){var xe=(_e-j)/(se-j);return ie.push(V+(H-V)*xe),ie.push(_e),ie.push(1),xe}function dt(ie,V){for(var j=[],H=0;H<ie.length;H++){var se,_e=ie[H],xe=_e.type;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")se=at(_e.geometry,V);else if(xe==="MultiLineString"||xe==="Polygon"){se=[];for(var we=0;we<_e.geometry.length;we++)se.push(at(_e.geometry[we],V))}else if(xe==="MultiPolygon")for(se=[],we=0;we<_e.geometry.length;we++){for(var de=[],Pe=0;Pe<_e.geometry[we].length;Pe++)de.push(at(_e.geometry[we][Pe],V));se.push(de)}j.push(Re(_e.id,xe,se,_e.tags))}return j}function at(ie,V){var j=[];j.size=ie.size,ie.start!==void 0&&(j.start=ie.start,j.end=ie.end);for(var H=0;H<ie.length;H+=3)j.push(ie[H]+V,ie[H+1],ie[H+2]);return j}function Un(ie,V){if(ie.transformed)return ie;var j,H,se,_e=1<<ie.z,xe=ie.x,we=ie.y;for(j=0;j<ie.features.length;j++){var de=ie.features[j],Pe=de.geometry,Xe=de.type;if(de.geometry=[],Xe===1)for(H=0;H<Pe.length;H+=2)de.geometry.push(ji(Pe[H],Pe[H+1],V,_e,xe,we));else for(H=0;H<Pe.length;H++){var We=[];for(se=0;se<Pe[H].length;se+=2)We.push(ji(Pe[H][se],Pe[H][se+1],V,_e,xe,we));de.geometry.push(We)}}return ie.transformed=!0,ie}function ji(ie,V,j,H,se,_e){return[Math.round(j*(ie*H-se)),Math.round(j*(V*H-_e))]}function Bn(ie,V,j,H,se){for(var _e=V===se.maxZoom?0:se.tolerance/((1<<V)*se.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:H,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},we=0;we<ie.length;we++){xe.numFeatures++,Ne(xe,ie[we],_e,se);var de=ie[we].minX,Pe=ie[we].minY,Xe=ie[we].maxX,We=ie[we].maxY;de<xe.minX&&(xe.minX=de),Pe<xe.minY&&(xe.minY=Pe),Xe>xe.maxX&&(xe.maxX=Xe),We>xe.maxY&&(xe.maxY=We)}return xe}function Ne(ie,V,j,H){var se=V.geometry,_e=V.type,xe=[];if(_e==="Point"||_e==="MultiPoint")for(var we=0;we<se.length;we+=3)xe.push(se[we]),xe.push(se[we+1]),ie.numPoints++,ie.numSimplified++;else if(_e==="LineString")yt(xe,se,ie,j,!1,!1);else if(_e==="MultiLineString"||_e==="Polygon")for(we=0;we<se.length;we++)yt(xe,se[we],ie,j,_e==="Polygon",we===0);else if(_e==="MultiPolygon")for(var de=0;de<se.length;de++){var Pe=se[de];for(we=0;we<Pe.length;we++)yt(xe,Pe[we],ie,j,!0,we===0)}if(xe.length){var Xe=V.tags||null;if(_e==="LineString"&&H.lineMetrics){for(var We in Xe={},V.tags)Xe[We]=V.tags[We];Xe.mapbox_clip_start=se.start/se.size,Xe.mapbox_clip_end=se.end/se.size}var Ue={geometry:xe,type:_e==="Polygon"||_e==="MultiPolygon"?3:_e==="LineString"||_e==="MultiLineString"?2:1,tags:Xe};V.id!==null&&(Ue.id=V.id),ie.features.push(Ue)}}function yt(ie,V,j,H,se,_e){var xe=H*H;if(H>0&&V.size<(se?xe:H))j.numPoints+=V.length/3;else{for(var we=[],de=0;de<V.length;de+=3)(H===0||V[de+2]>xe)&&(j.numSimplified++,we.push(V[de]),we.push(V[de+1])),j.numPoints++;se&&function(Pe,Xe){for(var We=0,Ue=0,Ft=Pe.length,Nt=Ft-2;Ue<Ft;Nt=Ue,Ue+=2)We+=(Pe[Ue]-Pe[Nt])*(Pe[Ue+1]+Pe[Nt+1]);if(We>0===Xe)for(Ue=0,Ft=Pe.length;Ue<Ft/2;Ue+=2){var gn=Pe[Ue],Kt=Pe[Ue+1];Pe[Ue]=Pe[Ft-2-Ue],Pe[Ue+1]=Pe[Ft-1-Ue],Pe[Ft-2-Ue]=gn,Pe[Ft-1-Ue]=Kt}}(we,_e),ie.push(we)}}function Zt(ie,V){var j=(V=this.options=function(se,_e){for(var xe in _e)se[xe]=_e[xe];return se}(Object.create(this.options),V)).debug;if(j&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");var H=function(se,_e){var xe=[];if(se.type==="FeatureCollection")for(var we=0;we<se.features.length;we++)Ee(xe,se.features[we],_e,we);else Ee(xe,se.type==="Feature"?se:{geometry:se},_e);return xe}(ie,V);this.tiles={},this.tileCoords=[],j&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),H=function(se,_e){var xe=_e.buffer/_e.extent,we=se,de=An(se,1,-1-xe,xe,0,-1,2,_e),Pe=An(se,1,1-xe,2+xe,0,-1,2,_e);return(de||Pe)&&(we=An(se,1,-xe,1+xe,0,-1,2,_e)||[],de&&(we=dt(de,1).concat(we)),Pe&&(we=we.concat(dt(Pe,-1)))),we}(H,V),H.length&&this.splitTile(H,0,0,0),j&&(H.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ti(ie,V,j){return 32*((1<<ie)*j+V)+ie}function Gn(ie,V){return V?ie.properties[V]:ie.id}function Qt(ie,V){if(ie==null)return!0;if(ie.type==="Feature")return Gn(ie,V)!=null;if(ie.type==="FeatureCollection"){const j=new Set;for(const H of ie.features){const se=Gn(H,V);if(se==null||j.has(se))return!1;j.add(se)}return!0}return!1}function qi(ie,V){const j=new Map;if(ie!=null)if(ie.type==="Feature")j.set(Gn(ie,V),ie);else for(const H of ie.features)j.set(Gn(H,V),H);return j}Zt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zt.prototype.splitTile=function(ie,V,j,H,se,_e,xe){for(var we=[ie,V,j,H],de=this.options,Pe=de.debug;we.length;){H=we.pop(),j=we.pop(),V=we.pop(),ie=we.pop();var Xe=1<<V,We=ti(V,j,H),Ue=this.tiles[We];if(!Ue&&(Pe>1&&console.time("creation"),Ue=this.tiles[We]=Bn(ie,V,j,H,de),this.tileCoords.push({z:V,x:j,y:H}),Pe)){Pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,j,H,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var Ft="z"+V;this.stats[Ft]=(this.stats[Ft]||0)+1,this.total++}if(Ue.source=ie,se){if(V===de.maxZoom||V===se)continue;var Nt=1<<se-V;if(j!==Math.floor(_e/Nt)||H!==Math.floor(xe/Nt))continue}else if(V===de.indexMaxZoom||Ue.numPoints<=de.indexMaxPoints)continue;if(Ue.source=null,ie.length!==0){Pe>1&&console.time("clipping");var gn,Kt,tn,en,Kn,ni,nn=.5*de.buffer/de.extent,Fn=.5-nn,$n=.5+nn,Ai=1+nn;gn=Kt=tn=en=null,Kn=An(ie,Xe,j-nn,j+$n,0,Ue.minX,Ue.maxX,de),ni=An(ie,Xe,j+Fn,j+Ai,0,Ue.minX,Ue.maxX,de),ie=null,Kn&&(gn=An(Kn,Xe,H-nn,H+$n,1,Ue.minY,Ue.maxY,de),Kt=An(Kn,Xe,H+Fn,H+Ai,1,Ue.minY,Ue.maxY,de),Kn=null),ni&&(tn=An(ni,Xe,H-nn,H+$n,1,Ue.minY,Ue.maxY,de),en=An(ni,Xe,H+Fn,H+Ai,1,Ue.minY,Ue.maxY,de),ni=null),Pe>1&&console.timeEnd("clipping"),we.push(gn||[],V+1,2*j,2*H),we.push(Kt||[],V+1,2*j,2*H+1),we.push(tn||[],V+1,2*j+1,2*H),we.push(en||[],V+1,2*j+1,2*H+1)}}},Zt.prototype.getTile=function(ie,V,j){var H=this.options,se=H.extent,_e=H.debug;if(ie<0||ie>24)return null;var xe=1<<ie,we=ti(ie,V=(V%xe+xe)%xe,j);if(this.tiles[we])return Un(this.tiles[we],se);_e>1&&console.log("drilling down to z%d-%d-%d",ie,V,j);for(var de,Pe=ie,Xe=V,We=j;!de&&Pe>0;)Pe--,Xe=Math.floor(Xe/2),We=Math.floor(We/2),de=this.tiles[ti(Pe,Xe,We)];return de&&de.source?(_e>1&&console.log("found parent tile z%d-%d-%d",Pe,Xe,We),_e>1&&console.time("drilling down"),this.splitTile(de.source,Pe,Xe,We,ie,V,j),_e>1&&console.timeEnd("drilling down"),this.tiles[we]?Un(this.tiles[we],se):null):null};class ar extends M{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(V,j){return h._(this,void 0,void 0,function*(){const H=V.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const se=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!se)return null;const _e=new class{constructor(we){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.W,this.length=we.length,this._features=we}feature(we){return new class{constructor(de){this._feature=de,this.extent=h.W,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const Pe of this._feature.geometry)de.push([new h.P(Pe[0],Pe[1])]);return de}{const de=[];for(const Pe of this._feature.geometry){const Xe=[];for(const We of Pe)Xe.push(new h.P(We[0],We[1]));de.push(Xe)}return de}}toGeoJSON(de,Pe,Xe){return J.call(this,de,Pe,Xe)}}(this._features[we])}}(se.features);let xe=Ge(_e);return xe.byteOffset===0&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),{vectorTile:_e,rawData:xe.buffer}})}loadData(V){return h._(this,void 0,void 0,function*(){var j;(j=this._pendingRequest)===null||j===void 0||j.abort();const H=!!(V&&V.request&&V.request.collectResourceTiming)&&new h.bt(V.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(V,this._pendingRequest),this._geoJSONIndex=V.cluster?new Pt(function({superclusterOptions:_e,clusterProperties:xe}){if(!xe||!_e)return _e;const we={},de={},Pe={accumulated:null,zoom:0},Xe={properties:null},We=Object.keys(xe);for(const Ue of We){const[Ft,Nt]=xe[Ue],gn=h.bA(Nt),Kt=h.bA(typeof Ft=="string"?[Ft,["accumulated"],["get",Ue]]:Ft);we[Ue]=gn.value,de[Ue]=Kt.value}return _e.map=Ue=>{Xe.properties=Ue;const Ft={};for(const Nt of We)Ft[Nt]=we[Nt].evaluate(Pe,Xe);return Ft},_e.reduce=(Ue,Ft)=>{Xe.properties=Ft;for(const Nt of We)Pe.accumulated=Ue[Nt],Ue[Nt]=de[Nt].evaluate(Pe,Xe)},_e}(V)).load((yield this._pendingData).features):new Zt(yield this._pendingData,V.geojsonVtOptions),this.loaded={};const se={};if(H){const _e=H.finish();_e&&(se.resourceTiming={},se.resourceTiming[V.source]=JSON.parse(JSON.stringify(_e)))}return se}catch(se){if(delete this._pendingRequest,h.bz(se))return{abandoned:!0};throw se}})}getData(){return h._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(V){const j=this.loaded;return j&&j[V.uid]?super.reloadTile(V):this.loadTile(V)}loadAndProcessGeoJSON(V,j){return h._(this,void 0,void 0,function*(){let H=yield this.loadGeoJSON(V,j);if(delete this._pendingRequest,typeof H!="object")throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(U(H,!0),V.filter){const se=h.bA(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(se.result==="error")throw new Error(se.value.map(xe=>`${xe.key}: ${xe.message}`).join(", "));H={type:"FeatureCollection",features:H.features.filter(xe=>se.value.evaluate({zoom:0},xe))}}return H})}loadGeoJSON(V,j){return h._(this,void 0,void 0,function*(){const{promoteId:H}=V;if(V.request){const se=yield h.h(V.request,j);return this._dataUpdateable=Qt(se.data,H)?qi(se.data,H):void 0,se.data}if(typeof V.data=="string")try{const se=JSON.parse(V.data);return this._dataUpdateable=Qt(se,H)?qi(se,H):void 0,se}catch{throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`)}if(!V.dataDiff)throw new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${V.source}`);return function(se,_e,xe){var we,de,Pe,Xe;if(_e.removeAll&&se.clear(),_e.remove)for(const We of _e.remove)se.delete(We);if(_e.add)for(const We of _e.add){const Ue=Gn(We,xe);Ue!=null&&se.set(Ue,We)}if(_e.update)for(const We of _e.update){let Ue=se.get(We.id);if(Ue==null)continue;const Ft=!We.removeAllProperties&&(((we=We.removeProperties)===null||we===void 0?void 0:we.length)>0||((de=We.addOrUpdateProperties)===null||de===void 0?void 0:de.length)>0);if((We.newGeometry||We.removeAllProperties||Ft)&&(Ue=Object.assign({},Ue),se.set(We.id,Ue),Ft&&(Ue.properties=Object.assign({},Ue.properties))),We.newGeometry&&(Ue.geometry=We.newGeometry),We.removeAllProperties)Ue.properties={};else if(((Pe=We.removeProperties)===null||Pe===void 0?void 0:Pe.length)>0)for(const Nt of We.removeProperties)Object.prototype.hasOwnProperty.call(Ue.properties,Nt)&&delete Ue.properties[Nt];if(((Xe=We.addOrUpdateProperties)===null||Xe===void 0?void 0:Xe.length)>0)for(const{key:Nt,value:gn}of We.addOrUpdateProperties)Ue.properties[Nt]=gn}}(this._dataUpdateable,V.dataDiff,H),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(V){return h._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(V){return this._geoJSONIndex.getClusterExpansionZoom(V.clusterId)}getClusterChildren(V){return this._geoJSONIndex.getChildren(V.clusterId)}getClusterLeaves(V){return this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset)}}class Oi{constructor(V){this.self=V,this.actor=new h.C(V),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(j,H)=>{if(this.externalWorkerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.externalWorkerSourceTypes[j]=H},this.self.addProtocol=h.bg,this.self.removeProtocol=h.bh,this.self.registerRTLTextPlugin=j=>{if(h.bB.isParsed())throw new Error("RTL text plugin already registered.");h.bB.setMethods(j)},this.actor.registerMessageHandler("LDT",(j,H)=>this._getDEMWorkerSource(j,H.source).loadTile(H)),this.actor.registerMessageHandler("RDT",(j,H)=>h._(this,void 0,void 0,function*(){this._getDEMWorkerSource(j,H.source).removeTile(H)})),this.actor.registerMessageHandler("GCEZ",(j,H)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(j,H.type,H.source).getClusterExpansionZoom(H)})),this.actor.registerMessageHandler("GCC",(j,H)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(j,H.type,H.source).getClusterChildren(H)})),this.actor.registerMessageHandler("GCL",(j,H)=>h._(this,void 0,void 0,function*(){return this._getWorkerSource(j,H.type,H.source).getClusterLeaves(H)})),this.actor.registerMessageHandler("LD",(j,H)=>this._getWorkerSource(j,H.type,H.source).loadData(H)),this.actor.registerMessageHandler("GD",(j,H)=>this._getWorkerSource(j,H.type,H.source).getData()),this.actor.registerMessageHandler("LT",(j,H)=>this._getWorkerSource(j,H.type,H.source).loadTile(H)),this.actor.registerMessageHandler("RT",(j,H)=>this._getWorkerSource(j,H.type,H.source).reloadTile(H)),this.actor.registerMessageHandler("AT",(j,H)=>this._getWorkerSource(j,H.type,H.source).abortTile(H)),this.actor.registerMessageHandler("RMT",(j,H)=>this._getWorkerSource(j,H.type,H.source).removeTile(H)),this.actor.registerMessageHandler("RS",(j,H)=>h._(this,void 0,void 0,function*(){if(!this.workerSources[j]||!this.workerSources[j][H.type]||!this.workerSources[j][H.type][H.source])return;const se=this.workerSources[j][H.type][H.source];delete this.workerSources[j][H.type][H.source],se.removeSource!==void 0&&se.removeSource(H)})),this.actor.registerMessageHandler("RM",j=>h._(this,void 0,void 0,function*(){delete this.layerIndexes[j],delete this.availableImages[j],delete this.workerSources[j],delete this.demWorkerSources[j]})),this.actor.registerMessageHandler("SR",(j,H)=>h._(this,void 0,void 0,function*(){this.referrer=H})),this.actor.registerMessageHandler("SRPS",(j,H)=>this._syncRTLPluginState(j,H)),this.actor.registerMessageHandler("IS",(j,H)=>h._(this,void 0,void 0,function*(){this.self.importScripts(H)})),this.actor.registerMessageHandler("SI",(j,H)=>this._setImages(j,H)),this.actor.registerMessageHandler("UL",(j,H)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(j).update(H.layers,H.removedIds)})),this.actor.registerMessageHandler("SL",(j,H)=>h._(this,void 0,void 0,function*(){this._getLayerIndex(j).replace(H)}))}_setImages(V,j){return h._(this,void 0,void 0,function*(){this.availableImages[V]=j;for(const H in this.workerSources[V]){const se=this.workerSources[V][H];for(const _e in se)se[_e].availableImages=j}})}_syncRTLPluginState(V,j){return h._(this,void 0,void 0,function*(){if(h.bB.isParsed())return h.bB.getState();if(j.pluginStatus!=="loading")return h.bB.setState(j),j;const H=j.pluginURL;if(this.self.importScripts(H),h.bB.isParsed()){const se={pluginStatus:"loaded",pluginURL:H};return h.bB.setState(se),se}throw h.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${H}`)})}_getAvailableImages(V){let j=this.availableImages[V];return j||(j=[]),j}_getLayerIndex(V){let j=this.layerIndexes[V];return j||(j=this.layerIndexes[V]=new c),j}_getWorkerSource(V,j,H){if(this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][j]||(this.workerSources[V][j]={}),!this.workerSources[V][j][H]){const se={sendAsync:(_e,xe)=>(_e.targetMapId=V,this.actor.sendAsync(_e,xe))};switch(j){case"vector":this.workerSources[V][j][H]=new M(se,this._getLayerIndex(V),this._getAvailableImages(V));break;case"geojson":this.workerSources[V][j][H]=new ar(se,this._getLayerIndex(V),this._getAvailableImages(V));break;default:this.workerSources[V][j][H]=new this.externalWorkerSourceTypes[j](se,this._getLayerIndex(V),this._getAvailableImages(V))}}return this.workerSources[V][j][H]}_getDEMWorkerSource(V,j){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][j]||(this.demWorkerSources[V][j]=new A),this.demWorkerSources[V][j]}}return h.i(self)&&(self.worker=new Oi(self)),Oi}),o("index",["exports","./shared"],function(h,c){var b="4.3.2";let w,S;const M={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((a,d)=>{const p=requestAnimationFrame(a);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(p),d(c.c())})}),getImageData(g,a=0){return this.getImageCanvasContext(g).getImageData(-a,-a,g.width+2*a,g.height+2*a)},getImageCanvasContext(g){const a=window.document.createElement("canvas"),d=a.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return a.width=g.width,a.height=g.height,d.drawImage(g,0,0,g.width,g.height),d},resolveURL:g=>(w||(w=document.createElement("a")),w.href=g,w.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(S==null&&(S=matchMedia("(prefers-reduced-motion: reduce)")),S.matches)}};class A{static testProp(a){if(!A.docStyle)return a[0];for(let d=0;d<a.length;d++)if(a[d]in A.docStyle)return a[d];return a[0]}static create(a,d,p){const _=window.document.createElement(a);return d!==void 0&&(_.className=d),p&&p.appendChild(_),_}static createNS(a,d){return window.document.createElementNS(a,d)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(a,d){a.style[A.transformProp]=d}static addEventListener(a,d,p,_={}){a.addEventListener(d,p,"passive"in _?_:_.capture)}static removeEventListener(a,d,p,_={}){a.removeEventListener(d,p,"passive"in _?_:_.capture)}static suppressClickInternal(a){a.preventDefault(),a.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(a){const d=a.getBoundingClientRect();return{x:d.width/a.offsetWidth||1,y:d.height/a.offsetHeight||1,boundingClientRect:d}}static getPoint(a,d,p){const _=d.boundingClientRect;return new c.P((p.clientX-_.left)/d.x-a.clientLeft,(p.clientY-_.top)/d.y-a.clientTop)}static mousePos(a,d){const p=A.getScale(a);return A.getPoint(a,p,d)}static touchPos(a,d){const p=[],_=A.getScale(a);for(let v=0;v<d.length;v++)p.push(A.getPoint(a,_,d[v]));return p}static mouseButton(a){return a.button}static remove(a){a.parentNode&&a.parentNode.removeChild(a)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const P={supported:!1,testSupport:function(g){!J&&U&&(Q?K(g):B=g)}};let B,U,J=!1,Q=!1;function K(g){const a=g.createTexture();g.bindTexture(g.TEXTURE_2D,a);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,U),g.isContextLost())return;P.supported=!0}catch{}g.deleteTexture(a),J=!0}var le;typeof document<"u"&&(U=document.createElement("img"),U.onload=()=>{B&&K(B),B=null,Q=!0},U.onerror=()=>{J=!0,B=null},U.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let a,d,p,_;g.resetRequestQueue=()=>{a=[],d=0,p=0,_={}},g.addThrottleControl=E=>{const L=p++;return _[L]=E,L},g.removeThrottleControl=E=>{delete _[E],T()},g.getImage=(E,L,R=!0)=>new Promise((N,W)=>{P.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),c.e(E,{type:"image"}),a.push({abortController:L,requestParameters:E,supportImageRefresh:R,state:"queued",onError:X=>{W(X)},onSuccess:X=>{N(X)}}),T()});const v=E=>c._(this,void 0,void 0,function*(){E.state="running";const{requestParameters:L,supportImageRefresh:R,onError:N,onSuccess:W,abortController:X}=E,te=R===!1&&!c.i(self)&&!c.g(L.url)&&(!L.headers||Object.keys(L.headers).reduce((pe,ve)=>pe&&ve==="accept",!0));d++;const ue=te?k(L,X):c.m(L,X);try{const pe=yield ue;delete E.abortController,E.state="completed",pe.data instanceof HTMLImageElement||c.b(pe.data)?W(pe):pe.data&&W({data:yield(re=pe.data,typeof createImageBitmap=="function"?c.d(re):c.f(re)),cacheControl:pe.cacheControl,expires:pe.expires})}catch(pe){delete E.abortController,N(pe)}finally{d--,T()}var re}),T=()=>{const E=(()=>{for(const L of Object.keys(_))if(_[L]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let L=d;L<E&&a.length>0;L++){const R=a.shift();R.abortController.signal.aborted?L--:v(R)}},k=(E,L)=>new Promise((R,N)=>{const W=new Image,X=E.url,te=E.credentials;te&&te==="include"?W.crossOrigin="use-credentials":(te&&te==="same-origin"||!c.s(X))&&(W.crossOrigin="anonymous"),L.signal.addEventListener("abort",()=>{W.src="",N(c.c())}),W.fetchPriority="high",W.onload=()=>{W.onerror=W.onload=null,R({data:W})},W.onerror=()=>{W.onerror=W.onload=null,L.signal.aborted||N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},W.src=X})}(le||(le={})),le.resetRequestQueue();class ee{constructor(a){this._transformRequestFn=a}transformRequest(a,d){return this._transformRequestFn&&this._transformRequestFn(a,d)||{url:a}}setTransformRequest(a){this._transformRequestFn=a}}function oe(g){var a=new c.A(3);return a[0]=g[0],a[1]=g[1],a[2]=g[2],a}var Z,ne=function(g,a,d){return g[0]=a[0]-d[0],g[1]=a[1]-d[1],g[2]=a[2]-d[2],g};Z=new c.A(3),c.A!=Float32Array&&(Z[0]=0,Z[1]=0,Z[2]=0);var be=function(g){var a=g[0],d=g[1];return a*a+d*d};function me(g){const a=[];if(typeof g=="string")a.push({id:"default",url:g});else if(g&&g.length>0){const d=[];for(const{id:p,url:_}of g){const v=`${p}${_}`;d.indexOf(v)===-1&&(d.push(v),a.push({id:p,url:_}))}}return a}function Te(g,a,d){const p=g.split("?");return p[0]+=`${a}${d}`,p.join("?")}(function(){var g=new c.A(2);c.A!=Float32Array&&(g[0]=0,g[1]=0)})();class Y{constructor(a,d,p,_){this.context=a,this.format=p,this.texture=a.gl.createTexture(),this.update(d,_)}update(a,d,p){const{width:_,height:v}=a,T=!(this.size&&this.size[0]===_&&this.size[1]===v||p),{context:k}=this,{gl:E}=k;if(this.useMipmap=!!(d&&d.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),k.pixelStoreUnpackFlipY.set(!1),k.pixelStoreUnpack.set(1),k.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!d||d.premultiply!==!1)),T)this.size=[_,v],a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||c.b(a)?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,a):E.texImage2D(E.TEXTURE_2D,0,this.format,_,v,0,this.format,E.UNSIGNED_BYTE,a.data);else{const{x:L,y:R}=p||{x:0,y:0};a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement||a instanceof ImageData||c.b(a)?E.texSubImage2D(E.TEXTURE_2D,0,L,R,E.RGBA,E.UNSIGNED_BYTE,a):E.texSubImage2D(E.TEXTURE_2D,0,L,R,_,v,E.RGBA,E.UNSIGNED_BYTE,a.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)}bind(a,d,p){const{context:_}=this,{gl:v}=_;v.bindTexture(v.TEXTURE_2D,this.texture),p!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(p=v.LINEAR),a!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,a),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,p||a),this.filter=a),d!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,d),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}function ye(g){const{userImage:a}=g;return!!(a&&a.render&&a.render())&&(g.data.replace(new Uint8Array(a.data.buffer)),!0)}class qe extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:d,promiseResolve:p}of this.requestors)p(this._getImagesForIds(d));this.requestors=[]}}getImage(a){const d=this.images[a];if(d&&!d.data&&d.spriteData){const p=d.spriteData;d.data=new c.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),d.spriteData=null}return d}addImage(a,d){if(this.images[a])throw new Error(`Image id ${a} already exist, use updateImage instead`);this._validate(a,d)&&(this.images[a]=d)}_validate(a,d){let p=!0;const _=d.data||d.spriteData;return this._validateStretch(d.stretchX,_&&_.width)||(this.fire(new c.j(new Error(`Image "${a}" has invalid "stretchX" value`))),p=!1),this._validateStretch(d.stretchY,_&&_.height)||(this.fire(new c.j(new Error(`Image "${a}" has invalid "stretchY" value`))),p=!1),this._validateContent(d.content,d)||(this.fire(new c.j(new Error(`Image "${a}" has invalid "content" value`))),p=!1),p}_validateStretch(a,d){if(!a)return!0;let p=0;for(const _ of a){if(_[0]<p||_[1]<_[0]||d<_[1])return!1;p=_[1]}return!0}_validateContent(a,d){if(!a)return!0;if(a.length!==4)return!1;const p=d.spriteData,_=p&&p.width||d.data.width,v=p&&p.height||d.data.height;return!(a[0]<0||_<a[0]||a[1]<0||v<a[1]||a[2]<0||_<a[2]||a[3]<0||v<a[3]||a[2]<a[0]||a[3]<a[1])}updateImage(a,d,p=!0){const _=this.getImage(a);if(p&&(_.data.width!==d.data.width||_.data.height!==d.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=_.version+1,this.images[a]=d,this.updatedImages[a]=!0}removeImage(a){const d=this.images[a];delete this.images[a],delete this.patterns[a],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a){return new Promise((d,p)=>{let _=!0;if(!this.isLoaded())for(const v of a)this.images[v]||(_=!1);this.isLoaded()||_?d(this._getImagesForIds(a)):this.requestors.push({ids:a,promiseResolve:d})})}_getImagesForIds(a){const d={};for(const p of a){let _=this.getImage(p);_||(this.fire(new c.k("styleimagemissing",{id:p})),_=this.getImage(p)),_?d[p]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:c.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:a,height:d}=this.atlasImage;return{width:a,height:d}}getPattern(a){const d=this.patterns[a],p=this.getImage(a);if(!p)return null;if(d&&d.position.version===p.version)return d.position;if(d)d.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},v=new c.I(_,p);this.patterns[a]={bin:_,position:v}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const d=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Y(a,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const v in this.patterns)a.push(this.patterns[v].bin);const{w:d,h:p}=c.p(a),_=this.atlasImage;_.resize({width:d||1,height:p||1});for(const v in this.patterns){const{bin:T}=this.patterns[v],k=T.x+1,E=T.y+1,L=this.getImage(v).data,R=L.width,N=L.height;c.R.copy(L,_,{x:0,y:0},{x:k,y:E},{width:R,height:N}),c.R.copy(L,_,{x:0,y:N-1},{x:k,y:E-1},{width:R,height:1}),c.R.copy(L,_,{x:0,y:0},{x:k,y:E+N},{width:R,height:1}),c.R.copy(L,_,{x:R-1,y:0},{x:k-1,y:E},{width:1,height:N}),c.R.copy(L,_,{x:0,y:0},{x:k+R,y:E},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const d of a){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const p=this.getImage(d);p||c.w(`Image with ID: "${d}" was not found`),ye(p)&&this.updateImage(d,p)}}}const He=1e20;function Be(g,a,d,p,_,v,T,k,E){for(let L=a;L<a+p;L++)lt(g,d*v+L,v,_,T,k,E);for(let L=d;L<d+_;L++)lt(g,L*v+a,1,p,T,k,E)}function lt(g,a,d,p,_,v,T){v[0]=0,T[0]=-He,T[1]=He,_[0]=g[a];for(let k=1,E=0,L=0;k<p;k++){_[k]=g[a+k*d];const R=k*k;do{const N=v[E];L=(_[k]-_[N]+R-N*N)/(k-N)/2}while(L<=T[E]&&--E>-1);E++,v[E]=k,T[E]=L,T[E+1]=He}for(let k=0,E=0;k<p;k++){for(;T[E+1]<k;)E++;const L=v[E],R=k-L;g[a+k*d]=_[L]+R*R}}class Ge{constructor(a,d){this.requestManager=a,this.localIdeographFontFamily=d,this.entries={}}setURL(a){this.url=a}getGlyphs(a){return c._(this,void 0,void 0,function*(){const d=[];for(const v in a)for(const T of a[v])d.push(this._getAndCacheGlyphsPromise(v,T));const p=yield Promise.all(d),_={};for(const{stack:v,id:T,glyph:k}of p)_[v]||(_[v]={}),_[v][T]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics};return _})}_getAndCacheGlyphsPromise(a,d){return c._(this,void 0,void 0,function*(){let p=this.entries[a];p||(p=this.entries[a]={glyphs:{},requests:{},ranges:{}});let _=p.glyphs[d];if(_!==void 0)return{stack:a,id:d,glyph:_};if(_=this._tinySDF(p,a,d),_)return p.glyphs[d]=_,{stack:a,id:d,glyph:_};const v=Math.floor(d/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[v])return{stack:a,id:d,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[v]){const k=Ge.loadGlyphRange(a,v,this.url,this.requestManager);p.requests[v]=k}const T=yield p.requests[v];for(const k in T)this._doesCharSupportLocalGlyph(+k)||(p.glyphs[+k]=T[+k]);return p.ranges[v]=!0,{stack:a,id:d,glyph:T[d]||null}})}_doesCharSupportLocalGlyph(a){return!!this.localIdeographFontFamily&&(c.u["CJK Unified Ideographs"](a)||c.u["Hangul Syllables"](a)||c.u.Hiragana(a)||c.u.Katakana(a))}_tinySDF(a,d,p){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let v=a.tinySDF;if(!v){let k="400";/bold/i.test(d)?k="900":/medium/i.test(d)?k="500":/light/i.test(d)&&(k="200"),v=a.tinySDF=new Ge.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:k})}const T=v.draw(String.fromCharCode(p));return{id:p,bitmap:new c.o({width:T.width||60,height:T.height||60},T.data),metrics:{width:T.glyphWidth/2||24,height:T.glyphHeight/2||24,left:T.glyphLeft/2+.5||0,top:T.glyphTop/2-27.5||-8,advance:T.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ge.loadGlyphRange=function(g,a,d,p){return c._(this,void 0,void 0,function*(){const _=256*a,v=_+255,T=p.transformRequest(d.replace("{fontstack}",g).replace("{range}",`${_}-${v}`),"Glyphs"),k=yield c.l(T,new AbortController);if(!k||!k.data)throw new Error(`Could not load glyph range. range: ${a}, ${_}-${v}`);const E={};for(const L of c.n(k.data))E[L.id]=L;return E})},Ge.TinySDF=class{constructor({fontSize:g=24,buffer:a=3,radius:d=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:v="normal",fontStyle:T="normal"}={}){this.buffer=a,this.cutoff=p,this.radius=d;const k=this.size=g+4*a,E=this._createCanvas(k),L=this.ctx=E.getContext("2d",{willReadFrequently:!0});L.font=`${T} ${v} ${g}px ${_}`,L.textBaseline="alphabetic",L.textAlign="left",L.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(g){const a=document.createElement("canvas");return a.width=a.height=g,a}draw(g){const{width:a,actualBoundingBoxAscent:d,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:v}=this.ctx.measureText(g),T=Math.ceil(d),k=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-_))),E=Math.min(this.size-this.buffer,T+Math.ceil(p)),L=k+2*this.buffer,R=E+2*this.buffer,N=Math.max(L*R,0),W=new Uint8ClampedArray(N),X={data:W,width:L,height:R,glyphWidth:k,glyphHeight:E,glyphTop:T,glyphLeft:0,glyphAdvance:a};if(k===0||E===0)return X;const{ctx:te,buffer:ue,gridInner:re,gridOuter:pe}=this;te.clearRect(ue,ue,k,E),te.fillText(g,ue,ue+T);const ve=te.getImageData(ue,ue,k,E);pe.fill(He,0,N),re.fill(0,0,N);for(let ce=0;ce<E;ce++)for(let Se=0;Se<k;Se++){const ze=ve.data[4*(ce*k+Se)+3]/255;if(ze===0)continue;const Oe=(ce+ue)*L+Se+ue;if(ze===1)pe[Oe]=0,re[Oe]=He;else{const Qe=.5-ze;pe[Oe]=Qe>0?Qe*Qe:0,re[Oe]=Qe<0?Qe*Qe:0}}Be(pe,0,0,L,R,L,this.f,this.v,this.z),Be(re,ue,ue,k,E,L,this.f,this.v,this.z);for(let ce=0;ce<N;ce++){const Se=Math.sqrt(pe[ce])-Math.sqrt(re[ce]);W[ce]=Math.round(255-255*(Se/this.radius+this.cutoff))}return X}};class ot{constructor(){this.specification=c.v.light.position}possiblyEvaluate(a,d){return c.y(a.expression.evaluate(d))}interpolate(a,d,p){return{x:c.z.number(a.x,d.x,p),y:c.z.number(a.y,d.y,p),z:c.z.number(a.z,d.z,p)}}}let je;class Ve extends c.E{constructor(a){super(),je=je||new c.q({anchor:new c.D(c.v.light.anchor),position:new ot,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(je),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,d={}){if(!this._validate(c.r,a,d))for(const p in a){const _=a[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,d,p){return(!p||p.validate!==!1)&&c.t(this,a.call(c.x,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}class $e{constructor(a,d){this.width=a,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(a,d){const p=a.join(",")+String(d);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(a,d)),this.dashEntry[p]}getDashRanges(a,d,p){const _=[];let v=a.length%2==1?-a[a.length-1]*p:0,T=a[0]*p,k=!0;_.push({left:v,right:T,isDash:k,zeroLength:a[0]===0});let E=a[0];for(let L=1;L<a.length;L++){k=!k;const R=a[L];v=E*p,E+=R,T=E*p,_.push({left:v,right:T,isDash:k,zeroLength:R===0})}return _}addRoundDash(a,d,p){const _=d/2;for(let v=-p;v<=p;v++){const T=this.width*(this.nextRow+p+v);let k=0,E=a[k];for(let L=0;L<this.width;L++){L/E.right>1&&(E=a[++k]);const R=Math.abs(L-E.left),N=Math.abs(L-E.right),W=Math.min(R,N);let X;const te=v/p*(_+1);if(E.isDash){const ue=_-Math.abs(te);X=Math.sqrt(W*W+ue*ue)}else X=_-Math.sqrt(W*W+te*te);this.data[T+L]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(a){for(let k=a.length-1;k>=0;--k){const E=a[k],L=a[k+1];E.zeroLength?a.splice(k,1):L&&L.isDash===E.isDash&&(L.left=E.left,a.splice(k,1))}const d=a[0],p=a[a.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const _=this.width*this.nextRow;let v=0,T=a[v];for(let k=0;k<this.width;k++){k/T.right>1&&(T=a[++v]);const E=Math.abs(k-T.left),L=Math.abs(k-T.right),R=Math.min(E,L);this.data[_+k]=Math.max(0,Math.min(255,(T.isDash?R:-R)+128))}}addDash(a,d){const p=d?7:0,_=2*p+1;if(this.nextRow+_>this.height)return c.w("LineAtlas out of space"),null;let v=0;for(let k=0;k<a.length;k++)v+=a[k];if(v!==0){const k=this.width/v,E=this.getDashRanges(a,this.width,k);d?this.addRoundDash(E,k,p):this.addRegularDash(E)}const T={y:(this.nextRow+p+.5)/this.height,height:2*p/this.height,width:v};return this.nextRow+=_,this.dirty=!0,T}bind(a){const d=a.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const st="maplibre_preloaded_worker_pool";class ct{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<ct.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[st]}numActive(){return Object.keys(this.active).length}}const Pt=Math.floor(M.hardwareConcurrency/2);let Ut,Lt;function gt(){return Ut||(Ut=new ct),Ut}ct.workerCount=c.B(globalThis)?Math.max(Math.min(Pt,3),1):1;class Bt{constructor(a,d){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=d;const p=this.workerPool.acquire(d);for(let _=0;_<p.length;_++){const v=new c.C(p[_],d);v.name=`Worker ${_}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(a,d){const p=[];for(const _ of this.actors)p.push(_.sendAsync({type:a,data:d}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(a=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],a&&this.workerPool.release(this.id)}registerMessageHandler(a,d){for(const p of this.actors)p.registerMessageHandler(a,d)}}function tt(){return Lt||(Lt=new Bt(gt(),c.G),Lt.registerMessageHandler("GR",(g,a,d)=>c.m(a,d))),Lt}function Le(g,a){const d=c.F();return c.H(d,d,[1,1,0]),c.J(d,d,[.5*g.width,.5*g.height,1]),c.K(d,d,g.calculatePosMatrix(a.toUnwrapped()))}function ut(g,a,d,p,_,v){const T=function(N,W,X){if(N)for(const te of N){const ue=W[te];if(ue&&ue.source===X&&ue.type==="fill-extrusion")return!0}else for(const te in W){const ue=W[te];if(ue.source===X&&ue.type==="fill-extrusion")return!0}return!1}(_&&_.layers,a,g.id),k=v.maxPitchScaleFactor(),E=g.tilesIn(p,k,T);E.sort(Re);const L=[];for(const N of E)L.push({wrappedTileID:N.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(a,d,g._state,N.queryGeometry,N.cameraQueryGeometry,N.scale,_,v,k,Le(g.transform,N.tileID))});const R=function(N){const W={},X={};for(const te of N){const ue=te.queryResults,re=te.wrappedTileID,pe=X[re]=X[re]||{};for(const ve in ue){const ce=ue[ve],Se=pe[ve]=pe[ve]||{},ze=W[ve]=W[ve]||[];for(const Oe of ce)Se[Oe.featureIndex]||(Se[Oe.featureIndex]=!0,ze.push(Oe))}}return W}(L);for(const N in R)R[N].forEach(W=>{const X=W.feature,te=g.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=te});return R}function Re(g,a){const d=g.tileID,p=a.tileID;return d.overscaledZ-p.overscaledZ||d.canonical.y-p.canonical.y||d.wrap-p.wrap||d.canonical.x-p.canonical.x}function Ke(g,a,d){return c._(this,void 0,void 0,function*(){let p=g;if(g.url?p=(yield c.h(a.transformRequest(g.url,"Source"),d)).data:yield M.frameAsync(d),!p)return null;const _=c.L(c.e(p,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(_.vectorLayerIds=p.vector_layers.map(v=>v.id)),_})}class Ee{constructor(a,d){a&&(d?this.setSouthWest(a).setNorthEast(d):Array.isArray(a)&&(a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1])))}setNorthEast(a){return this._ne=a instanceof c.M?new c.M(a.lng,a.lat):c.M.convert(a),this}setSouthWest(a){return this._sw=a instanceof c.M?new c.M(a.lng,a.lat):c.M.convert(a),this}extend(a){const d=this._sw,p=this._ne;let _,v;if(a instanceof c.M)_=a,v=a;else{if(!(a instanceof Ee))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Ee.convert(a)):this.extend(c.M.convert(a)):a&&("lng"in a||"lon"in a)&&"lat"in a?this.extend(c.M.convert(a)):this;if(_=a._sw,v=a._ne,!_||!v)return this}return d||p?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),p.lng=Math.max(v.lng,p.lng),p.lat=Math.max(v.lat,p.lat)):(this._sw=new c.M(_.lng,_.lat),this._ne=new c.M(v.lng,v.lat)),this}getCenter(){return new c.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.M(this.getWest(),this.getNorth())}getSouthEast(){return new c.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:d,lat:p}=c.M.convert(a);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(a){return a instanceof Ee?a:a&&new Ee(a)}static fromLngLat(a,d=0){const p=360*d/40075017,_=p/Math.cos(Math.PI/180*a.lat);return new Ee(new c.M(a.lng-_,a.lat-p),new c.M(a.lng+_,a.lat+p))}}class wt{constructor(a,d,p){this.bounds=Ee.convert(this.validateBounds(a)),this.minzoom=d||0,this.maxzoom=p||24}validateBounds(a){return Array.isArray(a)&&a.length===4?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const d=Math.pow(2,a.z),p=Math.floor(c.N(this.bounds.getWest())*d),_=Math.floor(c.O(this.bounds.getNorth())*d),v=Math.ceil(c.N(this.bounds.getEast())*d),T=Math.ceil(c.O(this.bounds.getSouth())*d);return a.x>=p&&a.x<v&&a.y>=_&&a.y<T}}class De extends c.E{constructor(a,d,p,_){if(super(),this.id=a,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.L(d,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield Ke(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),a&&(c.e(this,a),a.bounds&&(this.tileBounds=new wt(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(a){this._tileJSONRequest=null,this.fire(new c.j(a))}})}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}setSourceProperty(a){this._tileJSONRequest&&this._tileJSONRequest.abort(),a(),this.load()}setTiles(a){return this.setSourceProperty(()=>{this._options.tiles=a}),this}setUrl(a){return this.setSourceProperty(()=>{this.url=a,this._options.url=a}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(a){return c._(this,void 0,void 0,function*(){const d=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(d,"Tile"),uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};p.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(a.actor&&a.state!=="expired"){if(a.state==="loading")return new Promise((v,T)=>{a.reloadPromise={resolve:v,reject:T}})}else a.actor=this.dispatcher.getActor(),_="LT";a.abortController=new AbortController;try{const v=yield a.actor.sendAsync({type:_,data:p},a.abortController);if(delete a.abortController,a.aborted)return;this._afterTileLoadWorkerResponse(a,v)}catch(v){if(delete a.abortController,a.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(a,null)}})}_afterTileLoadWorkerResponse(a,d){if(d&&d.resourceTiming&&(a.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&a.setExpiryData(d),a.loadVectorData(d,this.map.painter),a.reloadPromise){const p=a.reloadPromise;a.reloadPromise=null,this.loadTile(a).then(p.resolve).catch(p.reject)}}abortTile(a){return c._(this,void 0,void 0,function*(){a.abortController&&(a.abortController.abort(),delete a.abortController),a.actor&&(yield a.actor.sendAsync({type:"AT",data:{uid:a.uid,type:this.type,source:this.id}}))})}unloadTile(a){return c._(this,void 0,void 0,function*(){a.unloadVectorData(),a.actor&&(yield a.actor.sendAsync({type:"RMT",data:{uid:a.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class wn extends c.E{constructor(a,d,p,_){super(),this.id=a,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},d),c.e(this,c.L(d,["url","scheme","tileSize"]))}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield Ke(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(c.e(this,a),a.bounds&&(this.tileBounds=new wt(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(a){this._tileJSONRequest=null,this.fire(new c.j(a))}})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(a){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),a(),this.load()}setTiles(a){return this.setSourceProperty(()=>{this._options.tiles=a}),this}setUrl(a){return this.setSourceProperty(()=>{this.url=a,this._options.url=a}),this}serialize(){return c.e({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a){return c._(this,void 0,void 0,function*(){const d=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);a.abortController=new AbortController;try{const p=yield le.getImage(this.map._requestManager.transformRequest(d,"Tile"),a.abortController,this.map._refreshExpiredTiles);if(delete a.abortController,a.aborted)return void(a.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&a.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const _=this.map.painter.context,v=_.gl,T=p.data;a.texture=this.map.painter.getTileTexture(T.width),a.texture?a.texture.update(T,{useMipmap:!0}):(a.texture=new Y(_,T,v.RGBA,{useMipmap:!0}),a.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),_.extTextureFilterAnisotropic&&v.texParameterf(v.TEXTURE_2D,_.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_.extTextureFilterAnisotropicMax)),a.state="loaded"}}catch(p){if(delete a.abortController,a.aborted)a.state="unloaded";else if(p)throw a.state="errored",p}})}abortTile(a){return c._(this,void 0,void 0,function*(){a.abortController&&(a.abortController.abort(),delete a.abortController)})}unloadTile(a){return c._(this,void 0,void 0,function*(){a.texture&&this.map.painter.saveTileTexture(a.texture)})}hasTransition(){return!1}}class Wn extends wn{constructor(a,d,p,_){super(a,d,p,_),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(a){return c._(this,void 0,void 0,function*(){const d=a.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(d,"Tile");a.neighboringTiles=this._getNeighboringTiles(a.tileID),a.abortController=new AbortController;try{const _=yield le.getImage(p,a.abortController,this.map._refreshExpiredTiles);if(delete a.abortController,a.aborted)return void(a.state="unloaded");if(_&&_.data){const v=_.data;this.map._refreshExpiredTiles&&_.cacheControl&&_.expires&&a.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const T=c.b(v)&&c.S()?v:yield this.readImageNow(v),k={type:this.type,uid:a.uid,source:this.id,rawImageData:T,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!a.actor||a.state==="expired"){a.actor=this.dispatcher.getActor();const E=yield a.actor.sendAsync({type:"LDT",data:k});a.dem=E,a.needsHillshadePrepare=!0,a.needsTerrainPrepare=!0,a.state="loaded"}}}catch(_){if(delete a.abortController,a.aborted)a.state="unloaded";else if(_)throw a.state="errored",_}})}readImageNow(a){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.U()){const d=a.width+2,p=a.height+2;try{return new c.R({width:d,height:p},yield c.V(a,-1,-1,d,p))}catch{}}return M.getImageData(a,1)})}_getNeighboringTiles(a){const d=a.canonical,p=Math.pow(2,d.z),_=(d.x-1+p)%p,v=d.x===0?a.wrap-1:a.wrap,T=(d.x+1+p)%p,k=d.x+1===p?a.wrap+1:a.wrap,E={};return E[new c.Q(a.overscaledZ,v,d.z,_,d.y).key]={backfilled:!1},E[new c.Q(a.overscaledZ,k,d.z,T,d.y).key]={backfilled:!1},d.y>0&&(E[new c.Q(a.overscaledZ,v,d.z,_,d.y-1).key]={backfilled:!1},E[new c.Q(a.overscaledZ,a.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},E[new c.Q(a.overscaledZ,k,d.z,T,d.y-1).key]={backfilled:!1}),d.y+1<p&&(E[new c.Q(a.overscaledZ,v,d.z,_,d.y+1).key]={backfilled:!1},E[new c.Q(a.overscaledZ,a.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},E[new c.Q(a.overscaledZ,k,d.z,T,d.y+1).key]={backfilled:!1}),E}unloadTile(a){return c._(this,void 0,void 0,function*(){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&(yield a.actor.sendAsync({type:"RDT",data:{type:this.type,uid:a.uid,source:this.id}}))})}}class on extends c.E{constructor(a,d,p,_){super(),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=p.getActor(),this.setEventedParent(_),this._data=d.data,this._options=c.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const v=c.W/this.tileSize;this.workerOptions=c.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*v,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*v,extent:c.W,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:c.W,radius:(d.clusterRadius||50)*v,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(a){this.map=a,this.load()}setData(a){return this._data=a,this._updateWorkerData(),this}updateData(a){return this._updateWorkerData(a),this}getData(){return c._(this,void 0,void 0,function*(){const a=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:a})})}setClusterOptions(a){return this.workerOptions.cluster=a.cluster,a&&(a.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=a.clusterRadius),a.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=a.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(a){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:a,source:this.id}})}getClusterChildren(a){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:a,source:this.id}})}getClusterLeaves(a,d,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:a,limit:d,offset:p}})}_updateWorkerData(a){return c._(this,void 0,void 0,function*(){const d=c.e({type:this.type},this.workerOptions);a?d.dataDiff=a:typeof this._data=="string"?(d.request=this.map._requestManager.transformRequest(M.resolveURL(this._data),"Source"),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const p=yield this.actor.sendAsync({type:"LD",data:d});if(this._pendingLoads--,this._removed||p.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let _=null;p.resourceTiming&&p.resourceTiming[this.id]&&(_=p.resourceTiming[this.id].slice(0));const v={dataType:"source"};this._collectResourceTiming&&_&&_.length>0&&c.e(v,{resourceTiming:_}),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},v),{sourceDataType:"content"})))}catch(p){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(p))}})}loaded(){return this._pendingLoads===0}loadTile(a){return c._(this,void 0,void 0,function*(){const d=a.actor?"RT":"LT";a.actor=this.actor;const p={type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};a.abortController=new AbortController;const _=yield this.actor.sendAsync({type:d,data:p},a.abortController);delete a.abortController,a.unloadVectorData(),a.aborted||a.loadVectorData(_,this.map.painter,d==="RT")})}abortTile(a){return c._(this,void 0,void 0,function*(){a.abortController&&(a.abortController.abort(),delete a.abortController),a.aborted=!0})}unloadTile(a){return c._(this,void 0,void 0,function*(){a.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:a.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var An=c.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class yr extends c.E{constructor(a,d,p,_){super(),this.id=a,this.dispatcher=p,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=d}load(a){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield le.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,a&&(this.coordinates=a),this._finishLoading())}catch(d){this._request=null,this._loaded=!0,this.fire(new c.j(d))}})}loaded(){return this._loaded}updateImage(a){return a.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=a.url,this.load(a.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(a){this.coordinates=a;const d=a.map(c.Y.fromLngLat);this.tileID=function(_){let v=1/0,T=1/0,k=-1/0,E=-1/0;for(const W of _)v=Math.min(v,W.x),T=Math.min(T,W.y),k=Math.max(k,W.x),E=Math.max(E,W.y);const L=Math.max(k-v,E-T),R=Math.max(0,Math.floor(-Math.log(L)/Math.LN2)),N=Math.pow(2,R);return new c.a0(R,Math.floor((v+k)/2*N),Math.floor((T+E)/2*N))}(d),this.minzoom=this.maxzoom=this.tileID.z;const p=d.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new c.Z,this._boundsArray.emplaceBack(p[0].x,p[0].y,0,0),this._boundsArray.emplaceBack(p[1].x,p[1].y,c.W,0),this._boundsArray.emplaceBack(p[3].x,p[3].y,0,c.W),this._boundsArray.emplaceBack(p[2].x,p[2].y,c.W,c.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const a=this.map.painter.context,d=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,An.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Y(a,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const v=this.tiles[_];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(a){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={}):a.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class br extends yr{constructor(a,d,p,_){super(a,d,p,_),this.roundZoom=!0,this.type="video",this.options=d}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const a=this.options;this.urls=[];for(const d of a.urls)this.urls.push(this.map._requestManager.transformRequest(d,"Source").url);try{const d=yield c.a2(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new c.j(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(a){if(this.video){const d=this.video.seekable;a<d.start(0)||a>d.end(0)?this.fire(new c.j(new c.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=a}}getVideo(){return this.video}onAdd(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const a=this.map.painter.context,d=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,An.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new Y(a,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const v=this.tiles[_];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Zn extends yr{constructor(a,d,p,_){super(a,d,p,_),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(T=>typeof T!="number"))||this.fire(new c.j(new c.a1(`sources.${a}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.a1(`sources.${a}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new c.j(new c.a1(`sources.${a}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.a1(`sources.${a}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.a1(`sources.${a}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let a=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,p=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,An.members)),this.boundsSegments||(this.boundsSegments=c.$.simpleSegment(0,0,4,2)),this.texture?(a||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Y(d,this.canvas,p.RGBA,{premultiply:!0});let _=!1;for(const v in this.tiles){const T=this.tiles[v];T.state!=="loaded"&&(T.state="loaded",T.texture=this.texture,_=!0)}_&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const a of[this.canvas.width,this.canvas.height])if(isNaN(a)||a<=0)return!0;return!1}}const Tn={},pi=g=>{switch(g){case"geojson":return on;case"image":return yr;case"raster":return wn;case"raster-dem":return Wn;case"vector":return De;case"video":return br;case"canvas":return Zn}return Tn[g]},vr="RTLPluginLoaded";class Jn extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=tt()}_syncState(a){return this.status=a,this.dispatcher.broadcast("SRPS",{pluginStatus:a,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(a){return c._(this,arguments,void 0,function*(d,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=M.resolveURL(d),!this.url)throw new Error(`requested url ${d} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(vr))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let dt=null;function at(){return dt||(dt=new Jn),dt}class Un{constructor(a,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=a,this.uid=c.a3(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(a){const d=a+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(a){this.demTexture&&a.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(a,d,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(_,v){const T={};if(!v)return T;for(const k of _){const E=k.layerIds.map(L=>v.getLayer(L)).filter(Boolean);if(E.length!==0){k.layers=E,k.stateDependentLayerIds&&(k.stateDependentLayers=k.stateDependentLayerIds.map(L=>E.filter(R=>R.id===L)[0]));for(const L of E)T[L.id]=k}}return T}(a.buckets,d.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof c.a5){if(this.hasSymbolBuckets=!0,!p)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof c.a5&&v.hasRTLText){this.hasRTLText=!0,at().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const v=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(_).queryRadius(v))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new c.a4}unloadVectorData(){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(a){return this.buckets[a.id]}upload(a){for(const p in this.buckets){const _=this.buckets[p];_.uploadPending()&&_.upload(a)}const d=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Y(a,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Y(a,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,d,p,_,v,T,k,E,L,R){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:v,scale:T,tileSize:this.tileSize,pixelPosMatrix:R,transform:E,params:k,queryPadding:this.queryPadding*L},a,d,p):{}}querySourceFeatures(a,d){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),v=d&&d.sourceLayer?d.sourceLayer:"",T=_._geojsonTileLayer||_[v];if(!T)return;const k=c.a6(d&&d.filter),{z:E,x:L,y:R}=this.tileID.canonical,N={z:E,x:L,y:R};for(let W=0;W<T.length;W++){const X=T.feature(W);if(k.needGeometry){const re=c.a7(X,!0);if(!k.filter(new c.a8(this.tileID.overscaledZ),re,this.tileID.canonical))continue}else if(!k.filter(new c.a8(this.tileID.overscaledZ),X))continue;const te=p.getId(X,v),ue=new c.a9(X,E,L,R,te);ue.tile=N,a.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const d=this.expirationTime;if(a.cacheControl){const p=c.aa(a.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(d)if(this.expirationTime<d)_=!0;else{const v=this.expirationTime-d;v?this.expirationTime=p+Math.max(v,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const v=this.buckets[_],T=v.layers[0].sourceLayer||"_geojsonTileLayer",k=p[T],E=a[T];if(!k||!E||Object.keys(E).length===0)continue;v.update(E,k,this.imageAtlas&&this.imageAtlas.patternPositions||{});const L=d&&d.style&&d.style.getLayer(_);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<M.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=M.now()+a}setDependencies(a,d){const p={};for(const _ of d)p[_]=!0;this.dependencies[a]=p}hasDependency(a,d){for(const p of a){const _=this.dependencies[p];if(_){for(const v of d)if(_[v])return!0}}return!1}}class ji{constructor(a,d){this.max=a,this.onRemove=d,this.reset()}reset(){for(const a in this.data)for(const d of this.data[a])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(a,d,p){const _=a.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const v={value:d,timeout:void 0};if(p!==void 0&&(v.timeout=setTimeout(()=>{this.remove(a,v)},p)),this.data[_].push(v),this.order.push(_),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const d=this.data[a].shift();return d.timeout&&clearTimeout(d.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),d.value}getByKey(a){const d=this.data[a];return d?d[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,d){if(!this.has(a))return this;const p=a.wrapped().key,_=d===void 0?0:this.data[p].indexOf(d),v=this.data[p][_];return this.data[p].splice(_,1),v.timeout&&clearTimeout(v.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(v.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(a){const d=[];for(const p in this.data)for(const _ of this.data[p])a(_.value)||d.push(_);for(const p of d)this.remove(p.value.tileID,p)}}class Bn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,d,p){const _=String(d);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][_]=this.stateChanges[a][_]||{},c.e(this.stateChanges[a][_],p),this.deletedStates[a]===null){this.deletedStates[a]={};for(const v in this.state[a])v!==_&&(this.deletedStates[a][v]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][_]===null){this.deletedStates[a][_]={};for(const v in this.state[a][_])p[v]||(this.deletedStates[a][_][v]=null)}else for(const v in p)this.deletedStates[a]&&this.deletedStates[a][_]&&this.deletedStates[a][_][v]===null&&delete this.deletedStates[a][_][v]}removeFeatureState(a,d,p){if(this.deletedStates[a]===null)return;const _=String(d);if(this.deletedStates[a]=this.deletedStates[a]||{},p&&d!==void 0)this.deletedStates[a][_]!==null&&(this.deletedStates[a][_]=this.deletedStates[a][_]||{},this.deletedStates[a][_][p]=null);else if(d!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][_])for(p in this.deletedStates[a][_]={},this.stateChanges[a][_])this.deletedStates[a][_][p]=null;else this.deletedStates[a][_]=null;else this.deletedStates[a]=null}getState(a,d){const p=String(d),_=c.e({},(this.state[a]||{})[p],(this.stateChanges[a]||{})[p]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const v=this.deletedStates[a][d];if(v===null)return{};for(const T in v)delete _[T]}return _}initializeTileState(a,d){a.setFeatureState(this.state,d)}coalesceChanges(a,d){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const v={};for(const T in this.stateChanges[_])this.state[_][T]||(this.state[_][T]={}),c.e(this.state[_][T],this.stateChanges[_][T]),v[T]=this.state[_][T];p[_]=v}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const v={};if(this.deletedStates[_]===null)for(const T in this.state[_])v[T]={},this.state[_][T]={};else for(const T in this.deletedStates[_]){if(this.deletedStates[_][T]===null)this.state[_][T]={};else for(const k of Object.keys(this.deletedStates[_][T]))delete this.state[_][T][k];v[T]=this.state[_][T]}p[_]=p[_]||{},c.e(p[_],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const _ in a)a[_].setFeatureState(p,d)}}class Ne extends c.E{constructor(a,d,p){super(),this.id=a,this.dispatcher=p,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,v,T,k)=>{const E=new(pi(v.type))(_,v,T,k);if(E.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${E.id}`);return E})(a,d,p,this),this._tiles={},this._cache=new ji(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Bn,this._didEmitContent=!1,this._updated=!1}onAdd(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._maxTileCacheZoomLevels=a?a._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(a)}onRemove(a){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(a)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const a in this._tiles){const d=this._tiles[a];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(a,d,p){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(a),this._tileLoaded(a,d,p)}catch(_){a.state="errored",_.status!==404?this._source.fire(new c.j(_,{tile:a})):this.update(this.transform,this.terrain)}})}_unloadTile(a){this._source.unloadTile&&this._source.unloadTile(a)}_abortTile(a){this._source.abortTile&&this._source.abortTile(a),this._source.fire(new c.k("dataabort",{tile:a,coord:a.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const p=this._tiles[d];p.upload(a),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(a=>a.tileID).sort(yt).map(a=>a.key)}getRenderableIds(a){const d=[];for(const p in this._tiles)this._isIdRenderable(p,a)&&d.push(this._tiles[p]);return a?d.sort((p,_)=>{const v=p.tileID,T=_.tileID,k=new c.P(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),E=new c.P(T.canonical.x,T.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-T.overscaledZ||E.y-k.y||E.x-k.x}).map(p=>p.tileID.key):d.map(p=>p.tileID).sort(yt).map(p=>p.key)}hasRenderableParent(a){const d=this.findLoadedParent(a,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(a,d){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(d||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(a,d){return c._(this,void 0,void 0,function*(){const p=this._tiles[a];p&&(p.state!=="loading"&&(p.state=d),yield this._loadTile(p,a,d))})}_tileLoaded(a,d,p){a.timeAdded=M.now(),p==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(d,a),this.getSource().type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),a.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:a,coord:a.tileID}))}_backfillDEM(a){const d=this.getRenderableIds();for(let _=0;_<d.length;_++){const v=d[_];if(a.neighboringTiles&&a.neighboringTiles[v]){const T=this.getTileByID(v);p(a,T),p(T,a)}}function p(_,v){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let T=v.tileID.canonical.x-_.tileID.canonical.x;const k=v.tileID.canonical.y-_.tileID.canonical.y,E=Math.pow(2,_.tileID.canonical.z),L=v.tileID.key;T===0&&k===0||Math.abs(k)>1||(Math.abs(T)>1&&(Math.abs(T+E)===1?T+=E:Math.abs(T-E)===1&&(T-=E)),v.dem&&_.dem&&(_.dem.backfillBorder(v.dem,T,k),_.neighboringTiles&&_.neighboringTiles[L]&&(_.neighboringTiles[L].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,d,p,_){for(const v in this._tiles){let T=this._tiles[v];if(_[v]||!T.hasData()||T.tileID.overscaledZ<=d||T.tileID.overscaledZ>p)continue;let k=T.tileID;for(;T&&T.tileID.overscaledZ>d+1;){const L=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[L.key],T&&T.hasData()&&(k=L)}let E=k;for(;E.overscaledZ>d;)if(E=E.scaledTo(E.overscaledZ-1),a[E.key]){_[k.key]=k;break}}}findLoadedParent(a,d){if(a.key in this._loadedParentTiles){const p=this._loadedParentTiles[a.key];return p&&p.tileID.overscaledZ>=d?p:null}for(let p=a.overscaledZ-1;p>=d;p--){const _=a.scaledTo(p),v=this._getLoadedTile(_);if(v)return v}}findLoadedSibling(a){return this._getLoadedTile(a)}_getLoadedTile(a){const d=this._tiles[a.key];return d&&d.hasData()?d:this._cache.getByKey(a.wrapped().key)}updateCacheSize(a){const d=Math.ceil(a.width/this._source.tileSize)+1,p=Math.ceil(a.height/this._source.tileSize)+1,_=Math.floor(d*p*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(v)}handleWrapJump(a){const d=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,d){const p={};for(const _ in this._tiles){const v=this._tiles[_];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+d),p[v.tileID.key]=v}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}_updateCoveredAndRetainedTiles(a,d,p,_,v,T){const k={},E={},L=Object.keys(a),R=M.now();for(const N of L){const W=a[N],X=this._tiles[N];if(!X||X.fadeEndTime!==0&&X.fadeEndTime<=R)continue;const te=this.findLoadedParent(W,d),ue=this.findLoadedSibling(W),re=te||ue||null;re&&(this._addTile(re.tileID),k[re.tileID.key]=re.tileID),E[N]=W}this._retainLoadedChildren(E,_,p,a);for(const N in k)a[N]||(this._coveredTiles[N]=!0,a[N]=k[N]);if(T){const N={},W={};for(const X of v)this._tiles[X.key].hasData()?N[X.key]=X:W[X.key]=X;for(const X in W){const te=W[X].children(this._source.maxzoom);this._tiles[te[0].key]&&this._tiles[te[1].key]&&this._tiles[te[2].key]&&this._tiles[te[3].key]&&(N[te[0].key]=a[te[0].key]=te[0],N[te[1].key]=a[te[1].key]=te[1],N[te[2].key]=a[te[2].key]=te[2],N[te[3].key]=a[te[3].key]=te[3],delete W[X])}for(const X in W){const te=W[X],ue=this.findLoadedParent(te,this._source.minzoom),re=this.findLoadedSibling(te),pe=ue||re||null;if(pe){N[pe.tileID.key]=a[pe.tileID.key]=pe.tileID;for(const ve in N)N[ve].isChildOf(pe.tileID)&&delete N[ve]}}for(const X in this._tiles)N[X]||(this._coveredTiles[X]=!0)}}update(a,d){if(!this._sourceLoaded||this._paused)return;let p;this.transform=a,this.terrain=d,this.updateCacheSize(a),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(R=>new c.Q(R.canonical.z,R.wrap,R.canonical.z,R.canonical.x,R.canonical.y)):(p=a.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(p=p.filter(R=>this._source.hasTile(R)))):p=[];const _=a.coveringZoomLevel(this._source),v=Math.max(_-Ne.maxOverzooming,this._source.minzoom),T=Math.max(_+Ne.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const R={};for(const N of p)if(N.canonical.z>this._source.minzoom){const W=N.scaledTo(N.canonical.z-1);R[W.key]=W;const X=N.scaledTo(Math.max(this._source.minzoom,Math.min(N.canonical.z,5)));R[X.key]=X}p=p.concat(Object.values(R))}const k=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,k&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const E=this._updateRetainedTiles(p,_);Zt(this._source.type)&&this._updateCoveredAndRetainedTiles(E,v,T,_,p,d);for(const R in E)this._tiles[R].clearFadeHold();const L=c.ab(this._tiles,E);for(const R of L){const N=this._tiles[R];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(R)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)}_updateRetainedTiles(a,d){var p;const _={},v={},T=Math.max(d-Ne.maxOverzooming,this._source.minzoom),k=Math.max(d+Ne.maxUnderzooming,this._source.minzoom),E={};for(const L of a){const R=this._addTile(L);_[L.key]=L,R.hasData()||d<this._source.maxzoom&&(E[L.key]=L)}this._retainLoadedChildren(E,d,k,_);for(const L of a){let R=this._tiles[L.key];if(R.hasData())continue;if(d+1>this._source.maxzoom){const W=L.children(this._source.maxzoom)[0],X=this.getTile(W);if(X&&X.hasData()){_[W.key]=W;continue}}else{const W=L.children(this._source.maxzoom);if(_[W[0].key]&&_[W[1].key]&&_[W[2].key]&&_[W[3].key])continue}let N=R.wasRequested();for(let W=L.overscaledZ-1;W>=T;--W){const X=L.scaledTo(W);if(v[X.key])break;if(v[X.key]=!0,R=this.getTile(X),!R&&N&&(R=this._addTile(X)),R){const te=R.hasData();if((te||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||N)&&(_[X.key]=X),N=R.wasRequested(),te)break}}}return _}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const d=[];let p,_=this._tiles[a].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}d.push(_.key);const v=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(v),p)break;_=v}for(const v of d)this._loadedParentTiles[v]=p}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const a in this._tiles){const d=this._tiles[a].tileID,p=this._getLoadedTile(d);this._loadedSiblingTiles[d.key]=p}}_addTile(a){let d=this._tiles[a.key];if(d)return d;d=this._cache.getAndRemove(a),d&&(this._setTileReloadTimer(a.key,d),d.tileID=a,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,d)));const p=d;return d||(d=new Un(a,this._source.tileSize*a.overscaleFactor()),this._loadTile(d,a.key,d.state)),d.uses++,this._tiles[a.key]=d,p||this._source.fire(new c.k("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(a,d){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const p=d.getExpiryTimeout();p&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},p))}_removeTile(a){const d=this._tiles[a];d&&(d.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}_dataHandler(a){const d=a.sourceDataType;a.dataType==="source"&&d==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&a.dataType==="source"&&d==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(a);this._cache.reset()}tilesIn(a,d,p){const _=[],v=this.transform;if(!v)return _;const T=p?v.getCameraQueryGeometry(a):a,k=a.map(te=>v.pointCoordinate(te,this.terrain)),E=T.map(te=>v.pointCoordinate(te,this.terrain)),L=this.getIds();let R=1/0,N=1/0,W=-1/0,X=-1/0;for(const te of E)R=Math.min(R,te.x),N=Math.min(N,te.y),W=Math.max(W,te.x),X=Math.max(X,te.y);for(let te=0;te<L.length;te++){const ue=this._tiles[L[te]];if(ue.holdingForFade())continue;const re=ue.tileID,pe=Math.pow(2,v.zoom-ue.tileID.overscaledZ),ve=d*ue.queryPadding*c.W/ue.tileSize/pe,ce=[re.getTilePoint(new c.Y(R,N)),re.getTilePoint(new c.Y(W,X))];if(ce[0].x-ve<c.W&&ce[0].y-ve<c.W&&ce[1].x+ve>=0&&ce[1].y+ve>=0){const Se=k.map(Oe=>re.getTilePoint(Oe)),ze=E.map(Oe=>re.getTilePoint(Oe));_.push({tile:ue,tileID:re,queryGeometry:Se,cameraQueryGeometry:ze,scale:pe})}}return _}getVisibleCoordinates(a){const d=this.getRenderableIds(a).map(p=>this._tiles[p].tileID);for(const p of d)p.posMatrix=this.transform.calculatePosMatrix(p.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Zt(this._source.type)){const a=M.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=a)return!0}return!1}setFeatureState(a,d,p){this._state.updateState(a=a||"_geojsonTileLayer",d,p)}removeFeatureState(a,d,p){this._state.removeFeatureState(a=a||"_geojsonTileLayer",d,p)}getFeatureState(a,d){return this._state.getState(a=a||"_geojsonTileLayer",d)}setDependencies(a,d,p){const _=this._tiles[a];_&&_.setDependencies(d,p)}reloadTilesForDependencies(a,d){for(const p in this._tiles)this._tiles[p].hasDependency(a,d)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(a,d))}}function yt(g,a){const d=Math.abs(2*g.wrap)-+(g.wrap<0),p=Math.abs(2*a.wrap)-+(a.wrap<0);return g.overscaledZ-a.overscaledZ||p-d||a.canonical.y-g.canonical.y||a.canonical.x-g.canonical.x}function Zt(g){return g==="raster"||g==="image"||g==="video"}Ne.maxOverzooming=10,Ne.maxUnderzooming=3;class ti{constructor(a,d){this.reset(a,d)}reset(a,d){this.points=a||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(this.points.length===1)return this.points[0];a=c.ac(a,0,1);let d=1,p=this._distances[d];const _=a*this.paddedLength+this.padding;for(;p<_&&d<this._distances.length;)p=this._distances[++d];const v=d-1,T=this._distances[v],k=p-T,E=k>0?(_-T)/k:0;return this.points[v].mult(1-E).add(this.points[d].mult(E))}}function Gn(g,a){let d=!0;return g==="always"||g!=="never"&&a!=="never"||(d=!1),d}class Qt{constructor(a,d,p){const _=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(a/p),this.yCellCount=Math.ceil(d/p);for(let T=0;T<this.xCellCount*this.yCellCount;T++)_.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=d,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,d,p,_,v){this._forEachCell(d,p,_,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(v)}insertCircle(a,d,p,_){this._forEachCell(d-_,p-_,d+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(d),this.circles.push(p),this.circles.push(_)}_insertBoxCell(a,d,p,_,v,T){this.boxCells[v].push(T)}_insertCircleCell(a,d,p,_,v,T){this.circleCells[v].push(T)}_query(a,d,p,_,v,T,k){if(p<0||a>this.width||_<0||d>this.height)return[];const E=[];if(a<=0&&d<=0&&this.width<=p&&this.height<=_){if(v)return[{key:null,x1:a,y1:d,x2:p,y2:_}];for(let L=0;L<this.boxKeys.length;L++)E.push({key:this.boxKeys[L],x1:this.bboxes[4*L],y1:this.bboxes[4*L+1],x2:this.bboxes[4*L+2],y2:this.bboxes[4*L+3]});for(let L=0;L<this.circleKeys.length;L++){const R=this.circles[3*L],N=this.circles[3*L+1],W=this.circles[3*L+2];E.push({key:this.circleKeys[L],x1:R-W,y1:N-W,x2:R+W,y2:N+W})}}else this._forEachCell(a,d,p,_,this._queryCell,E,{hitTest:v,overlapMode:T,seenUids:{box:{},circle:{}}},k);return E}query(a,d,p,_){return this._query(a,d,p,_,!1,null)}hitTest(a,d,p,_,v,T){return this._query(a,d,p,_,!0,v,T).length>0}hitTestCircle(a,d,p,_,v){const T=a-p,k=a+p,E=d-p,L=d+p;if(k<0||T>this.width||L<0||E>this.height)return!1;const R=[];return this._forEachCell(T,E,k,L,this._queryCellCircle,R,{hitTest:!0,overlapMode:_,circle:{x:a,y:d,radius:p},seenUids:{box:{},circle:{}}},v),R.length>0}_queryCell(a,d,p,_,v,T,k,E){const{seenUids:L,hitTest:R,overlapMode:N}=k,W=this.boxCells[v];if(W!==null){const te=this.bboxes;for(const ue of W)if(!L.box[ue]){L.box[ue]=!0;const re=4*ue,pe=this.boxKeys[ue];if(a<=te[re+2]&&d<=te[re+3]&&p>=te[re+0]&&_>=te[re+1]&&(!E||E(pe))&&(!R||!Gn(N,pe.overlapMode))&&(T.push({key:pe,x1:te[re],y1:te[re+1],x2:te[re+2],y2:te[re+3]}),R))return!0}}const X=this.circleCells[v];if(X!==null){const te=this.circles;for(const ue of X)if(!L.circle[ue]){L.circle[ue]=!0;const re=3*ue,pe=this.circleKeys[ue];if(this._circleAndRectCollide(te[re],te[re+1],te[re+2],a,d,p,_)&&(!E||E(pe))&&(!R||!Gn(N,pe.overlapMode))){const ve=te[re],ce=te[re+1],Se=te[re+2];if(T.push({key:pe,x1:ve-Se,y1:ce-Se,x2:ve+Se,y2:ce+Se}),R)return!0}}}return!1}_queryCellCircle(a,d,p,_,v,T,k,E){const{circle:L,seenUids:R,overlapMode:N}=k,W=this.boxCells[v];if(W!==null){const te=this.bboxes;for(const ue of W)if(!R.box[ue]){R.box[ue]=!0;const re=4*ue,pe=this.boxKeys[ue];if(this._circleAndRectCollide(L.x,L.y,L.radius,te[re+0],te[re+1],te[re+2],te[re+3])&&(!E||E(pe))&&!Gn(N,pe.overlapMode))return T.push(!0),!0}}const X=this.circleCells[v];if(X!==null){const te=this.circles;for(const ue of X)if(!R.circle[ue]){R.circle[ue]=!0;const re=3*ue,pe=this.circleKeys[ue];if(this._circlesCollide(te[re],te[re+1],te[re+2],L.x,L.y,L.radius)&&(!E||E(pe))&&!Gn(N,pe.overlapMode))return T.push(!0),!0}}}_forEachCell(a,d,p,_,v,T,k,E){const L=this._convertToXCellCoord(a),R=this._convertToYCellCoord(d),N=this._convertToXCellCoord(p),W=this._convertToYCellCoord(_);for(let X=L;X<=N;X++)for(let te=R;te<=W;te++)if(v.call(this,a,d,p,_,this.xCellCount*te+X,T,k,E))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,d,p,_,v,T){const k=_-a,E=v-d,L=p+T;return L*L>k*k+E*E}_circleAndRectCollide(a,d,p,_,v,T,k){const E=(T-_)/2,L=Math.abs(a-(_+E));if(L>E+p)return!1;const R=(k-v)/2,N=Math.abs(d-(v+R));if(N>R+p)return!1;if(L<=E||N<=R)return!0;const W=L-E,X=N-R;return W*W+X*X<=p*p}}function qi(g,a,d,p,_){const v=c.F();return a?(c.J(v,v,[1/_,1/_,1]),d||c.ad(v,v,p.angle)):c.K(v,p.labelPlaneMatrix,g),v}function ar(g,a,d,p,_){if(a){const v=c.ae(g);return c.J(v,v,[_,_,1]),d||c.ad(v,v,-p.angle),v}return p.glCoordMatrix}function Oi(g,a,d){let p;d?(p=[g.x,g.y,d(g.x,g.y),1],c.af(p,p,a)):(p=[g.x,g.y,0,1],function(v,T,k){const E=T[0],L=T[1];v[0]=k[0]*E+k[4]*L+k[12],v[1]=k[1]*E+k[5]*L+k[13],v[3]=k[3]*E+k[7]*L+k[15]}(p,p,a));const _=p[3];return{point:new c.P(p[0]/_,p[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function ie(g,a){return .5+g/a*.5}function V(g,a){return g.x>=-a[0]&&g.x<=a[0]&&g.y>=-a[1]&&g.y<=a[1]}function j(g,a,d,p,_,v,T,k,E,L,R,N,W,X,te){const ue=p?g.textSizeData:g.iconSizeData,re=c.ag(ue,d.transform.zoom),pe=[256/d.width*2+1,256/d.height*2+1],ve=p?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ve.clear();const ce=g.lineVertexArray,Se=p?g.text.placedSymbolArray:g.icon.placedSymbolArray,ze=d.transform.width/d.transform.height;let Oe=!1;for(let Qe=0;Qe<Se.length;Qe++){const ft=Se.get(Qe);if(ft.hidden||ft.writingMode===c.ah.vertical&&!Oe){Ft(ft.numGlyphs,ve);continue}Oe=!1;const Et=Oi(new c.P(ft.anchorX,ft.anchorY),a,te);if(!V(Et.point,pe)){Ft(ft.numGlyphs,ve);continue}const Dt=ie(d.transform.cameraToCenterDistance,Et.signedDistanceFromCamera),pt=c.ai(ue,re,ft),_t=T?pt/Dt:pt*Dt,jt={getElevation:te,labelPlaneMatrix:_,lineVertexArray:ce,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:L,tileAnchorPoint:new c.P(ft.anchorX,ft.anchorY),unwrappedTileID:R,width:N,height:W,translation:X},rn=_e(jt,ft,_t,!1,k,a,v,g.glyphOffsetArray,ve,ze,E);Oe=rn.useVertical,(rn.notEnoughRoom||Oe||rn.needsFlipping&&_e(jt,ft,_t,!0,k,a,v,g.glyphOffsetArray,ve,ze,E).notEnoughRoom)&&Ft(ft.numGlyphs,ve)}p?g.text.dynamicLayoutVertexBuffer.updateData(ve):g.icon.dynamicLayoutVertexBuffer.updateData(ve)}function H(g,a,d,p,_,v,T,k){const E=v.glyphStartIndex+v.numGlyphs,L=v.lineStartIndex,R=v.lineStartIndex+v.lineLength,N=a.getoffsetX(v.glyphStartIndex),W=a.getoffsetX(E-1),X=We(g*N,d,p,_,v.segment,L,R,k,T);if(!X)return null;const te=We(g*W,d,p,_,v.segment,L,R,k,T);return te?k.projectionCache.anyProjectionOccluded?null:{first:X,last:te}:null}function se(g,a,d,p){return g===c.ah.horizontal&&Math.abs(d.y-a.y)>Math.abs(d.x-a.x)*p?{useVertical:!0}:(g===c.ah.vertical?a.y<d.y:a.x>d.x)?{needsFlipping:!0}:null}function _e(g,a,d,p,_,v,T,k,E,L,R){const N=d/24,W=a.lineOffsetX*N,X=a.lineOffsetY*N;let te;if(a.numGlyphs>1){const ue=a.glyphStartIndex+a.numGlyphs,re=a.lineStartIndex,pe=a.lineStartIndex+a.lineLength,ve=H(N,k,W,X,p,a,R,g);if(!ve)return{notEnoughRoom:!0};const ce=Oi(ve.first.point,T,g.getElevation).point,Se=Oi(ve.last.point,T,g.getElevation).point;if(_&&!p){const ze=se(a.writingMode,ce,Se,L);if(ze)return ze}te=[ve.first];for(let ze=a.glyphStartIndex+1;ze<ue-1;ze++)te.push(We(N*k.getoffsetX(ze),W,X,p,a.segment,re,pe,g,R));te.push(ve.last)}else{if(_&&!p){const re=Oi(g.tileAnchorPoint,v,g.getElevation).point,pe=a.lineStartIndex+a.segment+1,ve=new c.P(g.lineVertexArray.getx(pe),g.lineVertexArray.gety(pe)),ce=Oi(ve,v,g.getElevation),Se=ce.signedDistanceFromCamera>0?ce.point:function(Oe,Qe,ft,Et,Dt,pt){return xe(Oe,Qe,ft,1,Dt,pt)}(g.tileAnchorPoint,ve,re,0,v,g),ze=se(a.writingMode,re,Se,L);if(ze)return ze}const ue=We(N*k.getoffsetX(a.glyphStartIndex),W,X,p,a.segment,a.lineStartIndex,a.lineStartIndex+a.lineLength,g,R);if(!ue||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};te=[ue]}for(const ue of te)c.aj(E,ue.point,ue.angle);return{}}function xe(g,a,d,p,_,v){const T=g.add(g.sub(a)._unit()),k=_!==void 0?Oi(T,_,v.getElevation).point:de(T.x,T.y,v).point,E=d.sub(k);return d.add(E._mult(p/E.mag()))}function we(g,a,d){const p=a.projectionCache;if(p.projections[g])return p.projections[g];const _=new c.P(a.lineVertexArray.getx(g),a.lineVertexArray.gety(g)),v=de(_.x,_.y,a);if(v.signedDistanceFromCamera>0)return p.projections[g]=v.point,p.anyProjectionOccluded=p.anyProjectionOccluded||v.isOccluded,v.point;const T=g-d.direction;return function(k,E,L,R,N){return xe(k,E,L,R,void 0,N)}(d.distanceFromAnchor===0?a.tileAnchorPoint:new c.P(a.lineVertexArray.getx(T),a.lineVertexArray.gety(T)),_,d.previousVertex,d.absOffsetX-d.distanceFromAnchor+1,a)}function de(g,a,d){const p=g+d.translation[0],_=a+d.translation[1];let v;return!d.pitchWithMap&&d.projection.useSpecialProjectionForSymbols?(v=d.projection.projectTileCoordinates(p,_,d.unwrappedTileID,d.getElevation),v.point.x=(.5*v.point.x+.5)*d.width,v.point.y=(.5*-v.point.y+.5)*d.height):(v=Oi(new c.P(p,_),d.labelPlaneMatrix,d.getElevation),v.isOccluded=!1),v}function Pe(g,a,d){return g._unit()._perp()._mult(a*d)}function Xe(g,a,d,p,_,v,T,k,E){if(k.projectionCache.offsets[g])return k.projectionCache.offsets[g];const L=d.add(a);if(g+E.direction<p||g+E.direction>=_)return k.projectionCache.offsets[g]=L,L;const R=we(g+E.direction,k,E),N=Pe(R.sub(d),T,E.direction),W=d.add(N),X=R.add(N);return k.projectionCache.offsets[g]=c.ak(v,L,W,X)||L,k.projectionCache.offsets[g]}function We(g,a,d,p,_,v,T,k,E){const L=p?g-a:g+a;let R=L>0?1:-1,N=0;p&&(R*=-1,N=Math.PI),R<0&&(N+=Math.PI);let W,X=R>0?v+_:v+_+1;k.projectionCache.cachedAnchorPoint?W=k.projectionCache.cachedAnchorPoint:(W=de(k.tileAnchorPoint.x,k.tileAnchorPoint.y,k).point,k.projectionCache.cachedAnchorPoint=W);let te,ue,re=W,pe=W,ve=0,ce=0;const Se=Math.abs(L),ze=[];let Oe;for(;ve+ce<=Se;){if(X+=R,X<v||X>=T)return null;ve+=ce,pe=re,ue=te;const Et={absOffsetX:Se,direction:R,distanceFromAnchor:ve,previousVertex:pe};if(re=we(X,k,Et),d===0)ze.push(pe),Oe=re.sub(pe);else{let Dt;const pt=re.sub(pe);Dt=pt.mag()===0?Pe(we(X+R,k,Et).sub(re),d,R):Pe(pt,d,R),ue||(ue=pe.add(Dt)),te=Xe(X,Dt,re,v,T,ue,d,k,Et),ze.push(ue),Oe=te.sub(ue)}ce=Oe.mag()}const Qe=Oe._mult((Se-ve)/ce)._add(ue||pe),ft=N+Math.atan2(re.y-pe.y,re.x-pe.x);return ze.push(Qe),{point:Qe,angle:E?ft:0,path:ze}}const Ue=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ft(g,a){for(let d=0;d<g;d++){const p=a.length;a.resize(p+4),a.float32.set(Ue,3*p)}}const Nt=100;class gn{constructor(a,d,p=new Qt(a.width+200,a.height+200,25),_=new Qt(a.width+200,a.height+200,25)){this.transform=a,this.mapProjection=d,this.grid=p,this.ignoredGrid=_,this.pitchFactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+Nt,this.screenBottomBoundary=a.height+Nt,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(a,d,p,_,v,T,k,E,L,R,N){const W=a.anchorPointX+E[0],X=a.anchorPointY+E[1],te=this.projectAndGetPerspectiveRatio(_,W,X,v,R),ue=this._projectCollisionBox(a,p,_,v,T,k,E,te,R,N),[re,pe,ve,ce]=ue.box;return this.mapProjection.useSpecialProjectionForSymbols&&(T?ue.allPointsOccluded:this.mapProjection.isOccluded(W,X,v))||te.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(re,pe,ve,ce)||d!=="always"&&this.grid.hitTest(re,pe,ve,ce,d,L)?{box:[re,pe,ve,ce],placeable:!1,offscreen:!1}:{box:[re,pe,ve,ce],placeable:!0,offscreen:this.isOffscreen(re,pe,ve,ce)}}placeCollisionCircles(a,d,p,_,v,T,k,E,L,R,N,W,X,te,ue,re){const pe=[],ve=new c.P(d.anchorX,d.anchorY),ce=this.getPerspectiveRatio(T,ve.x,ve.y,k,re),Se=(N?v/ce:v*ce)/c.ap,ze={getElevation:re,labelPlaneMatrix:E,lineVertexArray:p,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:ve,unwrappedTileID:k,width:this.transform.width,height:this.transform.height,translation:ue},Oe=H(Se,_,d.lineOffsetX*Se,d.lineOffsetY*Se,!1,d,!1,ze);let Qe=!1,ft=!1,Et=!0;if(Oe){const Dt=.5*X*ce+te,pt=new c.P(-100,-100),_t=new c.P(this.screenRightBoundary,this.screenBottomBoundary),jt=new ti,rn=Oe.first,bt=Oe.last;let St=[];for(let xn=rn.path.length-1;xn>=1;xn--)St.push(rn.path[xn]);for(let xn=1;xn<bt.path.length;xn++)St.push(bt.path[xn]);const $t=2.5*Dt;if(L){const xn=this.projectPathToScreenSpace(St,ze,L);St=xn.some(Dn=>Dn.signedDistanceFromCamera<=0)?[]:xn.map(Dn=>Dn.point)}let Ei=[];if(St.length>0){const xn=St[0].clone(),Dn=St[0].clone();for(let Di=1;Di<St.length;Di++)xn.x=Math.min(xn.x,St[Di].x),xn.y=Math.min(xn.y,St[Di].y),Dn.x=Math.max(Dn.x,St[Di].x),Dn.y=Math.max(Dn.y,St[Di].y);Ei=xn.x>=pt.x&&Dn.x<=_t.x&&xn.y>=pt.y&&Dn.y<=_t.y?[St]:Dn.x<pt.x||xn.x>_t.x||Dn.y<pt.y||xn.y>_t.y?[]:c.al([St],pt.x,pt.y,_t.x,_t.y)}for(const xn of Ei){jt.reset(xn,.25*Dt);let Dn=0;Dn=jt.length<=.5*Dt?1:Math.ceil(jt.paddedLength/$t)+1;for(let Di=0;Di<Dn;Di++){const ta=Di/Math.max(Dn-1,1),xs=jt.lerp(ta),Pi=xs.x+Nt,ka=xs.y+Nt;pe.push(Pi,ka,Dt,0);const _a=Pi-Dt,na=ka-Dt,ia=Pi+Dt,ws=ka+Dt;if(Et=Et&&this.isOffscreen(_a,na,ia,ws),ft=ft||this.isInsideGrid(_a,na,ia,ws),a!=="always"&&this.grid.hitTestCircle(Pi,ka,Dt,a,W)&&(Qe=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Qe}}}}return{circles:!R&&Qe||!ft||ce<this.perspectiveRatioCutoff?[]:pe,offscreen:Et,collisionDetected:Qe}}projectPathToScreenSpace(a,d,p){return a.map(_=>Oi(_,p,d.getElevation))}queryRenderedSymbols(a){if(a.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[];let p=1/0,_=1/0,v=-1/0,T=-1/0;for(const R of a){const N=new c.P(R.x+Nt,R.y+Nt);p=Math.min(p,N.x),_=Math.min(_,N.y),v=Math.max(v,N.x),T=Math.max(T,N.y),d.push(N)}const k=this.grid.query(p,_,v,T).concat(this.ignoredGrid.query(p,_,v,T)),E={},L={};for(const R of k){const N=R.key;if(E[N.bucketInstanceId]===void 0&&(E[N.bucketInstanceId]={}),E[N.bucketInstanceId][N.featureIndex])continue;const W=[new c.P(R.x1,R.y1),new c.P(R.x2,R.y1),new c.P(R.x2,R.y2),new c.P(R.x1,R.y2)];c.am(d,W)&&(E[N.bucketInstanceId][N.featureIndex]=!0,L[N.bucketInstanceId]===void 0&&(L[N.bucketInstanceId]=[]),L[N.bucketInstanceId].push(N.featureIndex))}return L}insertCollisionBox(a,d,p,_,v,T){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:v,collisionGroupID:T,overlapMode:d},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,d,p,_,v,T){const k=p?this.ignoredGrid:this.grid,E={bucketInstanceId:_,featureIndex:v,collisionGroupID:T,overlapMode:d};for(let L=0;L<a.length;L+=4)k.insertCircle(E,a[L],a[L+1],a[L+2])}projectAndGetPerspectiveRatio(a,d,p,_,v){const T=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(d,p,_,v):Oi(new c.P(d,p),a,v);return{point:new c.P((T.point.x+1)/2*this.transform.width+Nt,(1-T.point.y)/2*this.transform.height+Nt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5,isOccluded:T.isOccluded,signedDistanceFromCamera:T.signedDistanceFromCamera}}getPerspectiveRatio(a,d,p,_,v){const T=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(d,p,_,v):Oi(new c.P(d,p),a,v);return .5+this.transform.cameraToCenterDistance/T.signedDistanceFromCamera*.5}isOffscreen(a,d,p,_){return p<Nt||a>=this.screenRightBoundary||_<Nt||d>this.screenBottomBoundary}isInsideGrid(a,d,p,_){return p>=0&&a<this.gridRightBoundary&&_>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const a=c.an([]);return c.H(a,a,[-100,-100,0]),a}_projectCollisionBox(a,d,p,_,v,T,k,E,L,R){const N=d*E.perspectiveRatio;let W=new c.P(1,0),X=new c.P(0,1);const te=new c.P(a.anchorPointX+k[0],a.anchorPointY+k[1]);if(T&&!v){const Dt=this.projectAndGetPerspectiveRatio(p,te.x+1,te.y,_,L).point.sub(E.point).unit(),pt=Math.atan(Dt.y/Dt.x)+(Dt.x<0?Math.PI:0),_t=Math.sin(pt),jt=Math.cos(pt);W=new c.P(jt,_t),X=new c.P(-_t,jt)}else if(!T&&v){const Dt=-this.transform.angle,pt=Math.sin(Dt),_t=Math.cos(Dt);W=new c.P(_t,pt),X=new c.P(-pt,_t)}let ue=E.point,re=N;if(v){ue=te;const Dt=this.transform.zoom-Math.floor(this.transform.zoom);re=Math.pow(2,-Dt),re*=this.mapProjection.getPitchedTextCorrection(this.transform,te,_),R||(re*=c.ac(.5+E.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}R&&(ue=ue.add(W.mult(R.x*re)).add(X.mult(R.y*re)));const pe=a.x1*re,ve=a.x2*re,ce=(pe+ve)/2,Se=a.y1*re,ze=a.y2*re,Oe=(Se+ze)/2,Qe=[{offsetX:pe,offsetY:Se},{offsetX:ce,offsetY:Se},{offsetX:ve,offsetY:Se},{offsetX:ve,offsetY:Oe},{offsetX:ve,offsetY:ze},{offsetX:ce,offsetY:ze},{offsetX:pe,offsetY:ze},{offsetX:pe,offsetY:Oe}];let ft=[];for(const{offsetX:Dt,offsetY:pt}of Qe)ft.push(new c.P(ue.x+W.x*Dt+X.x*pt,ue.y+W.y*Dt+X.y*pt));let Et=!1;if(v){const Dt=ft.map(pt=>this.projectAndGetPerspectiveRatio(p,pt.x,pt.y,_,L));Et=Dt.some(pt=>!pt.isOccluded),ft=Dt.map(pt=>pt.point)}else Et=!0;return{box:c.ao(ft),allPointsOccluded:!Et}}}function Kt(g,a,d){return a*(c.W/(g.tileSize*Math.pow(2,d-g.tileID.overscaledZ)))}class tn{constructor(a,d,p,_){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?d:-d))):_&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class en{constructor(a,d,p,_,v){this.text=new tn(a?a.text:null,d,p,v),this.icon=new tn(a?a.icon:null,d,_,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Kn{constructor(a,d,p){this.text=a,this.icon=d,this.skipFade=p}}class ni{constructor(){this.invProjMatrix=c.F(),this.viewportMatrix=c.F(),this.circles=[]}}class nn{constructor(a,d,p,_,v){this.bucketInstanceId=a,this.featureIndex=d,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=v}}class Fn{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const d=++this.maxGroupID;this.collisionGroups[a]={ID:d,predicate:p=>p.collisionGroupID===d}}return this.collisionGroups[a]}}function $n(g,a,d,p,_){const{horizontalAlign:v,verticalAlign:T}=c.au(g);return new c.P(-(v-.5)*a+p[0]*_,-(T-.5)*d+p[1]*_)}class Ai{constructor(a,d,p,_,v,T){this.transform=a.clone(),this.terrain=p,this.collisionIndex=new gn(this.transform,d),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=_,this.retainedQueryData={},this.collisionGroups=new Fn(v),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(a){const d=this.terrain;return d?(p,_)=>d.getElevation(a,p,_):null}getBucketParts(a,d,p,_){const v=p.getBucket(d),T=p.latestFeatureIndex;if(!v||!T||d.id!==v.layerIds[0])return;const k=p.collisionBoxArray,E=v.layers[0].layout,L=v.layers[0].paint,R=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),N=p.tileSize/c.W,W=p.tileID.toUnwrapped(),X=this.transform.calculatePosMatrix(W),te=E.get("text-pitch-alignment")==="map",ue=E.get("text-rotation-alignment")==="map",re=Kt(p,1,this.transform.zoom),pe=this.collisionIndex.mapProjection.translatePosition(this.transform,p,L.get("text-translate"),L.get("text-translate-anchor")),ve=this.collisionIndex.mapProjection.translatePosition(this.transform,p,L.get("icon-translate"),L.get("icon-translate-anchor")),ce=qi(X,te,ue,this.transform,re);let Se=null;if(te){const Oe=ar(X,te,ue,this.transform,re);Se=c.K([],this.transform.labelPlaneMatrix,Oe)}this.retainedQueryData[v.bucketInstanceId]=new nn(v.bucketInstanceId,T,v.sourceLayerIndex,v.index,p.tileID);const ze={bucket:v,layout:E,translationText:pe,translationIcon:ve,posMatrix:X,unwrappedTileID:W,textLabelPlaneMatrix:ce,labelToScreenMatrix:Se,scale:R,textPixelRatio:N,holdingForFade:p.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:c.ag(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(_)for(const Oe of v.sortKeyRanges){const{sortKey:Qe,symbolInstanceStart:ft,symbolInstanceEnd:Et}=Oe;a.push({sortKey:Qe,symbolInstanceStart:ft,symbolInstanceEnd:Et,parameters:ze})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:ze})}attemptAnchorPlacement(a,d,p,_,v,T,k,E,L,R,N,W,X,te,ue,re,pe,ve,ce){const Se=c.aq[a.textAnchor],ze=[a.textOffset0,a.textOffset1],Oe=$n(Se,p,_,ze,v),Qe=this.collisionIndex.placeCollisionBox(d,W,E,L,R,k,T,re,N.predicate,ce,Oe);if((!ve||this.collisionIndex.placeCollisionBox(ve,W,E,L,R,k,T,pe,N.predicate,ce,Oe).placeable)&&Qe.placeable){let ft;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(ft=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:ze,width:p,height:_,anchor:Se,textBoxScale:v,prevAnchor:ft},this.markUsedJustification(te,Se,X,ue),te.allowVerticalPlacement&&(this.markUsedOrientation(te,ue,X),this.placedOrientations[X.crossTileID]=ue),{shift:Oe,placedGlyphBoxes:Qe}}}placeLayerBucketPart(a,d,p){const{bucket:_,layout:v,translationText:T,translationIcon:k,posMatrix:E,unwrappedTileID:L,textLabelPlaneMatrix:R,labelToScreenMatrix:N,textPixelRatio:W,holdingForFade:X,collisionBoxArray:te,partiallyEvaluatedTextSize:ue,collisionGroup:re}=a.parameters,pe=v.get("text-optional"),ve=v.get("icon-optional"),ce=c.ar(v,"text-overlap","text-allow-overlap"),Se=ce==="always",ze=c.ar(v,"icon-overlap","icon-allow-overlap"),Oe=ze==="always",Qe=v.get("text-rotation-alignment")==="map",ft=v.get("text-pitch-alignment")==="map",Et=v.get("icon-text-fit")!=="none",Dt=v.get("symbol-z-order")==="viewport-y",pt=Se&&(Oe||!_.hasIconData()||ve),_t=Oe&&(Se||!_.hasTextData()||pe);!_.collisionArrays&&te&&_.deserializeCollisionBoxes(te);const jt=this._getTerrainElevationFunc(this.retainedQueryData[_.bucketInstanceId].tileID),rn=(bt,St,$t)=>{var Ei,xn;if(d[bt.crossTileID])return;if(X)return void(this.placements[bt.crossTileID]=new Kn(!1,!1,!1));let Dn=!1,Di=!1,ta=!0,xs=null,Pi={box:null,placeable:!1,offscreen:null},ka={box:null,placeable:!1,offscreen:null},_a=null,na=null,ia=null,ws=0,Ql=0,od=0;St.textFeatureIndex?ws=St.textFeatureIndex:bt.useRuntimeCollisionCircles&&(ws=bt.featureIndex),St.verticalTextFeatureIndex&&(Ql=St.verticalTextFeatureIndex);const Xc=St.textBox;if(Xc){const Zr=ra=>{let aa=c.ah.horizontal;if(_.allowVerticalPlacement&&!ra&&this.prevPlacement){const zr=this.prevPlacement.placedOrientations[bt.crossTileID];zr&&(this.placedOrientations[bt.crossTileID]=zr,aa=zr,this.markUsedOrientation(_,aa,bt))}return aa},Ss=(ra,aa)=>{if(_.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&St.verticalTextBox){for(const zr of _.writingModes)if(zr===c.ah.vertical?(Pi=aa(),ka=Pi):Pi=ra(),Pi&&Pi.placeable)break}else Pi=ra()},sl=bt.textAnchorOffsetStartIndex,Qc=bt.textAnchorOffsetEndIndex;if(Qc===sl){const ra=(aa,zr)=>{const Ui=this.collisionIndex.placeCollisionBox(aa,ce,W,E,L,ft,Qe,T,re.predicate,jt);return Ui&&Ui.placeable&&(this.markUsedOrientation(_,zr,bt),this.placedOrientations[bt.crossTileID]=zr),Ui};Ss(()=>ra(Xc,c.ah.horizontal),()=>{const aa=St.verticalTextBox;return _.allowVerticalPlacement&&bt.numVerticalGlyphVertices>0&&aa?ra(aa,c.ah.vertical):{box:null,offscreen:null}}),Zr(Pi&&Pi.placeable)}else{let ra=c.aq[(xn=(Ei=this.prevPlacement)===null||Ei===void 0?void 0:Ei.variableOffsets[bt.crossTileID])===null||xn===void 0?void 0:xn.anchor];const aa=(Ui,$c,Yf)=>{const Cr=Ui.x2-Ui.x1,h0=Ui.y2-Ui.y1,cd=bt.textBoxScale,ud=Et&&ze==="never"?$c:null;let ol=null,d0=ce==="never"?1:2,Jf="never";ra&&d0++;for(let Kf=0;Kf<d0;Kf++){for(let Xf=sl;Xf<Qc;Xf++){const hd=_.textAnchorOffsets.get(Xf);if(ra&&hd.textAnchor!==ra)continue;const eu=this.attemptAnchorPlacement(hd,Ui,Cr,h0,cd,Qe,ft,W,E,L,re,Jf,bt,_,Yf,T,k,ud,jt);if(eu&&(ol=eu.placedGlyphBoxes,ol&&ol.placeable))return Dn=!0,xs=eu.shift,ol}ra?ra=null:Jf=ce}return p&&!ol&&(ol={box:this.collisionIndex.placeCollisionBox(Xc,"always",W,E,L,ft,Qe,T,re.predicate,jt,new c.P(0,0)).box,offscreen:!1,placeable:!1}),ol};Ss(()=>aa(Xc,St.iconBox,c.ah.horizontal),()=>{const Ui=St.verticalTextBox;return _.allowVerticalPlacement&&(!Pi||!Pi.placeable)&&bt.numVerticalGlyphVertices>0&&Ui?aa(Ui,St.verticalIconBox,c.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Pi&&(Dn=Pi.placeable,ta=Pi.offscreen);const zr=Zr(Pi&&Pi.placeable);if(!Dn&&this.prevPlacement){const Ui=this.prevPlacement.variableOffsets[bt.crossTileID];Ui&&(this.variableOffsets[bt.crossTileID]=Ui,this.markUsedJustification(_,Ui.anchor,bt,zr))}}}if(_a=Pi,Dn=_a&&_a.placeable,ta=_a&&_a.offscreen,bt.useRuntimeCollisionCircles){const Zr=_.text.placedSymbolArray.get(bt.centerJustifiedTextSymbolIndex),Ss=c.ai(_.textSizeData,ue,Zr),sl=v.get("text-padding");na=this.collisionIndex.placeCollisionCircles(ce,Zr,_.lineVertexArray,_.glyphOffsetArray,Ss,E,L,R,N,p,ft,re.predicate,bt.collisionCircleDiameter,sl,T,jt),na.circles.length&&na.collisionDetected&&!p&&c.w("Collisions detected, but collision boxes are not shown"),Dn=Se||na.circles.length>0&&!na.collisionDetected,ta=ta&&na.offscreen}if(St.iconFeatureIndex&&(od=St.iconFeatureIndex),St.iconBox){const Zr=Ss=>this.collisionIndex.placeCollisionBox(Ss,ze,W,E,L,ft,Qe,k,re.predicate,jt,Et&&xs?xs:void 0);ka&&ka.placeable&&St.verticalIconBox?(ia=Zr(St.verticalIconBox),Di=ia.placeable):(ia=Zr(St.iconBox),Di=ia.placeable),ta=ta&&ia.offscreen}const $l=pe||bt.numHorizontalGlyphVertices===0&&bt.numVerticalGlyphVertices===0,ld=ve||bt.numIconVertices===0;$l||ld?ld?$l||(Di=Di&&Dn):Dn=Di&&Dn:Di=Dn=Di&&Dn;const Gf=Di&&ia.placeable;if(Dn&&_a.placeable&&this.collisionIndex.insertCollisionBox(_a.box,ce,v.get("text-ignore-placement"),_.bucketInstanceId,ka&&ka.placeable&&Ql?Ql:ws,re.ID),Gf&&this.collisionIndex.insertCollisionBox(ia.box,ze,v.get("icon-ignore-placement"),_.bucketInstanceId,od,re.ID),na&&Dn&&this.collisionIndex.insertCollisionCircles(na.circles,ce,v.get("text-ignore-placement"),_.bucketInstanceId,ws,re.ID),p&&this.storeCollisionData(_.bucketInstanceId,$t,St,_a,ia,na),bt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[bt.crossTileID]=new Kn(Dn||pt,Di||_t,ta||_.justReloaded),d[bt.crossTileID]=!0};if(Dt){if(a.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const bt=_.getSortedSymbolIndexes(this.transform.angle);for(let St=bt.length-1;St>=0;--St){const $t=bt[St];rn(_.symbolInstances.get($t),_.collisionArrays[$t],$t)}}else for(let bt=a.symbolInstanceStart;bt<a.symbolInstanceEnd;bt++)rn(_.symbolInstances.get(bt),_.collisionArrays[bt],bt);if(p&&_.bucketInstanceId in this.collisionCircleArrays){const bt=this.collisionCircleArrays[_.bucketInstanceId];c.as(bt.invProjMatrix,E),bt.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}storeCollisionData(a,d,p,_,v,T){if(p.textBox||p.iconBox){let k,E;this.collisionBoxArrays.has(a)?k=this.collisionBoxArrays.get(a):(k=new Map,this.collisionBoxArrays.set(a,k)),k.has(d)?E=k.get(d):(E={text:null,icon:null},k.set(d,E)),p.textBox&&(E.text=_.box),p.iconBox&&(E.icon=v.box)}if(T){let k=this.collisionCircleArrays[a];k===void 0&&(k=this.collisionCircleArrays[a]=new ni);for(let E=0;E<T.circles.length;E+=4)k.circles.push(T.circles[E+0]),k.circles.push(T.circles[E+1]),k.circles.push(T.circles[E+2]),k.circles.push(T.collisionDetected?1:0)}}markUsedJustification(a,d,p,_){let v;v=_===c.ah.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[c.at(d)];const T=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const k of T)k>=0&&(a.text.placedSymbolArray.get(k).crossTileID=v>=0&&k!==v?0:p.crossTileID)}markUsedOrientation(a,d,p){const _=d===c.ah.horizontal||d===c.ah.horizontalOnly?d:0,v=d===c.ah.vertical?d:0,T=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const k of T)a.text.placedSymbolArray.get(k).placedOrientation=_;p.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let p=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const _=d?d.symbolFadeChange(a):1,v=d?d.opacities:{},T=d?d.variableOffsets:{},k=d?d.placedOrientations:{};for(const E in this.placements){const L=this.placements[E],R=v[E];R?(this.opacities[E]=new en(R,_,L.text,L.icon),p=p||L.text!==R.text.placed||L.icon!==R.icon.placed):(this.opacities[E]=new en(null,_,L.text,L.icon,L.skipFade),p=p||L.text||L.icon)}for(const E in v){const L=v[E];if(!this.opacities[E]){const R=new en(L,_,!1,!1);R.isHidden()||(this.opacities[E]=R,p=p||L.text.placed||L.icon.placed)}}for(const E in T)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=T[E]);for(const E in k)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=k[E]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=a:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:a)}updateLayerOpacities(a,d){const p={};for(const _ of d){const v=_.getBucket(a);v&&_.latestFeatureIndex&&a.id===v.layerIds[0]&&this.updateBucketOpacities(v,_.tileID,p,_.collisionBoxArray)}}updateBucketOpacities(a,d,p,_){a.hasTextData()&&(a.text.opacityVertexArray.clear(),a.text.hasVisibleVertices=!1),a.hasIconData()&&(a.icon.opacityVertexArray.clear(),a.icon.hasVisibleVertices=!1),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const v=a.layers[0],T=v.layout,k=new en(null,0,!1,!1,!0),E=T.get("text-allow-overlap"),L=T.get("icon-allow-overlap"),R=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),N=T.get("text-rotation-alignment")==="map",W=T.get("text-pitch-alignment")==="map",X=T.get("icon-text-fit")!=="none",te=new en(null,0,E&&(L||!a.hasIconData()||T.get("icon-optional")),L&&(E||!a.hasTextData()||T.get("text-optional")),!0);!a.collisionArrays&&_&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(_);const ue=(pe,ve,ce)=>{for(let Se=0;Se<ve/4;Se++)pe.opacityVertexArray.emplaceBack(ce);pe.hasVisibleVertices=pe.hasVisibleVertices||ce!==fa},re=this.collisionBoxArrays.get(a.bucketInstanceId);for(let pe=0;pe<a.symbolInstances.length;pe++){const ve=a.symbolInstances.get(pe),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:Se,crossTileID:ze}=ve;let Oe=this.opacities[ze];p[ze]?Oe=k:Oe||(Oe=te,this.opacities[ze]=Oe),p[ze]=!0;const Qe=ve.numIconVertices>0,ft=this.placedOrientations[ve.crossTileID],Et=ft===c.ah.vertical,Dt=ft===c.ah.horizontal||ft===c.ah.horizontalOnly;if(ce>0||Se>0){const _t=Bi(Oe.text);ue(a.text,ce,Et?fa:_t),ue(a.text,Se,Dt?fa:_t);const jt=Oe.text.isHidden();[ve.rightJustifiedTextSymbolIndex,ve.centerJustifiedTextSymbolIndex,ve.leftJustifiedTextSymbolIndex].forEach(St=>{St>=0&&(a.text.placedSymbolArray.get(St).hidden=jt||Et?1:0)}),ve.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(ve.verticalPlacedTextSymbolIndex).hidden=jt||Dt?1:0);const rn=this.variableOffsets[ve.crossTileID];rn&&this.markUsedJustification(a,rn.anchor,ve,ft);const bt=this.placedOrientations[ve.crossTileID];bt&&(this.markUsedJustification(a,"left",ve,bt),this.markUsedOrientation(a,bt,ve))}if(Qe){const _t=Bi(Oe.icon),jt=!(X&&ve.verticalPlacedIconSymbolIndex&&Et);ve.placedIconSymbolIndex>=0&&(ue(a.icon,ve.numIconVertices,jt?_t:fa),a.icon.placedSymbolArray.get(ve.placedIconSymbolIndex).hidden=Oe.icon.isHidden()),ve.verticalPlacedIconSymbolIndex>=0&&(ue(a.icon,ve.numVerticalIconVertices,jt?fa:_t),a.icon.placedSymbolArray.get(ve.verticalPlacedIconSymbolIndex).hidden=Oe.icon.isHidden())}const pt=re&&re.has(pe)?re.get(pe):{text:null,icon:null};if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const _t=a.collisionArrays[pe];if(_t){let jt=new c.P(0,0);if(_t.textBox||_t.verticalTextBox){let rn=!0;if(R){const bt=this.variableOffsets[ze];bt?(jt=$n(bt.anchor,bt.width,bt.height,bt.textOffset,bt.textBoxScale),N&&jt._rotate(W?this.transform.angle:-this.transform.angle)):rn=!1}if(_t.textBox||_t.verticalTextBox){let bt;_t.textBox&&(bt=Et),_t.verticalTextBox&&(bt=Dt),xr(a.textCollisionBox.collisionVertexArray,Oe.text.placed,!rn||bt,pt.text,jt.x,jt.y)}}if(_t.iconBox||_t.verticalIconBox){const rn=!!(!Dt&&_t.verticalIconBox);let bt;_t.iconBox&&(bt=rn),_t.verticalIconBox&&(bt=!rn),xr(a.iconCollisionBox.collisionVertexArray,Oe.icon.placed,bt,pt.icon,X?jt.x:0,X?jt.y:0)}}}}if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.text.opacityVertexArray.length!==a.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${a.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${a.text.layoutVertexArray.length}) / 4`);if(a.icon.opacityVertexArray.length!==a.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${a.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${a.icon.layoutVertexArray.length}) / 4`);if(a.bucketInstanceId in this.collisionCircleArrays){const pe=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=pe.invProjMatrix,a.placementViewportMatrix=pe.viewportMatrix,a.collisionCircleArray=pe.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return this.fadeDuration===0?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,d){const p=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*p>a}setStale(){this.stale=!0}}function xr(g,a,d,p,_,v){p&&p.length!==0||(p=[0,0,0,0]);const T=p[0]-Nt,k=p[1]-Nt,E=p[2]-Nt,L=p[3]-Nt;g.emplaceBack(a?1:0,d?1:0,_||0,v||0,T,k),g.emplaceBack(a?1:0,d?1:0,_||0,v||0,E,k),g.emplaceBack(a?1:0,d?1:0,_||0,v||0,E,L),g.emplaceBack(a?1:0,d?1:0,_||0,v||0,T,L)}const mi=Math.pow(2,25),sr=Math.pow(2,24),ps=Math.pow(2,17),Vn=Math.pow(2,16),Ta=Math.pow(2,9),uo=Math.pow(2,8),_i=Math.pow(2,1);function Bi(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const a=g.placed?1:0,d=Math.floor(127*g.opacity);return d*mi+a*sr+d*ps+a*Vn+d*Ta+a*uo+d*_i+a}const fa=0;function wr(){return{isOccluded:(g,a,d)=>!1,getPitchedTextCorrection:(g,a,d)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,a,d,p){throw new Error("Not implemented.")},translatePosition:(g,a,d,p)=>function(_,v,T,k,E=!1){if(!T[0]&&!T[1])return[0,0];const L=E?k==="map"?_.angle:0:k==="viewport"?-_.angle:0;if(L){const R=Math.sin(L),N=Math.cos(L);T=[T[0]*N-T[1]*R,T[0]*R+T[1]*N]}return[E?T[0]:Kt(v,T[0],_.zoom),E?T[1]:Kt(v,T[1],_.zoom)]}(g,a,d,p),getCircleRadiusCorrection:g=>1}}class or{constructor(a){this._sortAcrossTiles=a.layout.get("symbol-z-order")!=="viewport-y"&&!a.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(a,d,p,_,v){const T=this._bucketParts;for(;this._currentTileIndex<a.length;)if(d.getBucketParts(T,_,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((k,E)=>k.sortKey-E.sortKey));this._currentPartIndex<T.length;)if(d.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,v())return!0;return!1}}class Xr{constructor(a,d,p,_,v,T,k,E){this.placement=new Ai(a,wr(),d,T,k,E),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(a,d,p){const _=M.now(),v=()=>!this._forceFullPlacement&&M.now()-_>2;for(;this._currentPlacementIndex>=0;){const T=d[a[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=k)&&(!T.maxzoom||T.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new or(T)),this._inProgressLayer.continuePlacement(p[T.source],this.placement,this._showCollisionBoxes,T,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const Sr=512/c.W/2;class Ci{constructor(a,d,p){this.tileID=a,this.bucketInstanceId=p,this._symbolsByKey={};const _=new Map;for(let v=0;v<d.length;v++){const T=d.get(v),k=T.key,E=_.get(k);E?E.push(T):_.set(k,[T])}for(const[v,T]of _){const k={positions:T.map(E=>({x:Math.floor(E.anchorX*Sr),y:Math.floor(E.anchorY*Sr)})),crossTileIDs:T.map(E=>E.crossTileID)};if(k.positions.length>128){const E=new c.av(k.positions.length,16,Uint16Array);for(const{x:L,y:R}of k.positions)E.add(L,R);E.finish(),delete k.positions,k.index=E}this._symbolsByKey[v]=k}}getScaledCoordinates(a,d){const{x:p,y:_,z:v}=this.tileID.canonical,{x:T,y:k,z:E}=d.canonical,L=Sr/Math.pow(2,E-v),R=(k*c.W+a.anchorY)*L,N=_*c.W*Sr;return{x:Math.floor((T*c.W+a.anchorX)*L-p*c.W*Sr),y:Math.floor(R-N)}}findMatches(a,d,p){const _=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let v=0;v<a.length;v++){const T=a.get(v);if(T.crossTileID)continue;const k=this._symbolsByKey[T.key];if(!k)continue;const E=this.getScaledCoordinates(T,d);if(k.index){const L=k.index.range(E.x-_,E.y-_,E.x+_,E.y+_).sort();for(const R of L){const N=k.crossTileIDs[R];if(!p[N]){p[N]=!0,T.crossTileID=N;break}}}else if(k.positions)for(let L=0;L<k.positions.length;L++){const R=k.positions[L],N=k.crossTileIDs[L];if(Math.abs(R.x-E.x)<=_&&Math.abs(R.y-E.y)<=_&&!p[N]){p[N]=!0,T.crossTileID=N;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:a})=>a)}}class pa{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Na{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const d=Math.round((a-this.lng)/360);if(d!==0)for(const p in this.indexes){const _=this.indexes[p],v={};for(const T in _){const k=_[T];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+d),v[k.tileID.key]=k}this.indexes[p]=v}this.lng=a}addBucket(a,d,p){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let v=0;v<d.symbolInstances.length;v++)d.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});const _=this.usedCrossTileIDs[a.overscaledZ];for(const v in this.indexes){const T=this.indexes[v];if(Number(v)>a.overscaledZ)for(const k in T){const E=T[k];E.tileID.isChildOf(a)&&E.findMatches(d.symbolInstances,a,_)}else{const k=T[a.scaledTo(Number(v)).key];k&&k.findMatches(d.symbolInstances,a,_)}}for(let v=0;v<d.symbolInstances.length;v++){const T=d.symbolInstances.get(v);T.crossTileID||(T.crossTileID=p.generate(),_[T.crossTileID]=!0)}return this.indexes[a.overscaledZ]===void 0&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new Ci(a,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(a,d){for(const p of d.getCrossTileIDsLists())for(const _ of p)delete this.usedCrossTileIDs[a][_]}removeStaleBuckets(a){let d=!1;for(const p in this.indexes){const _=this.indexes[p];for(const v in _)a[_[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[v]),delete _[v],d=!0)}return d}}class Xn{constructor(){this.layerIndexes={},this.crossTileIDs=new pa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,d,p){let _=this.layerIndexes[a.id];_===void 0&&(_=this.layerIndexes[a.id]=new Na);let v=!1;const T={};_.handleWrapJump(p);for(const k of d){const E=k.getBucket(a);E&&a.id===E.layerIds[0]&&(E.bucketInstanceId||(E.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(k.tileID,E,this.crossTileIDs)&&(v=!0),T[E.bucketInstanceId]=!0)}return _.removeStaleBuckets(T)&&(v=!0),v}pruneUnusedLayers(a){const d={};a.forEach(p=>{d[p]=!0});for(const p in this.layerIndexes)d[p]||delete this.layerIndexes[p]}}const Pr=(g,a)=>c.t(g,a&&a.filter(d=>d.identifier!=="source.canvas")),tr=c.aw();class ho extends c.E{constructor(a,d={}){super(),this._rtlPluginLoaded=()=>{for(const p in this.sourceCaches){const _=this.sourceCaches[p].getSource().type;_!=="vector"&&_!=="geojson"||this.sourceCaches[p].reload()}},this.map=a,this.dispatcher=new Bt(gt(),a._getMapId()),this.dispatcher.registerMessageHandler("GG",(p,_)=>this.getGlyphs(p,_)),this.dispatcher.registerMessageHandler("GI",(p,_)=>this.getImages(p,_)),this.imageManager=new qe,this.imageManager.setEventedParent(this),this.glyphManager=new Ge(a._requestManager,d.localIdeographFontFamily),this.lineAtlas=new $e(256,512),this.crossTileSymbolIndex=new Xn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.ay()),at().on(vr,this._rtlPluginLoaded),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const _=this.sourceCaches[p.sourceId];if(!_)return;const v=_.getSource();if(v&&v.vectorLayerIds)for(const T in this._layers){const k=this._layers[T];k.source===v.id&&this._validateLayer(k)}})}loadURL(a,d={},p){this.fire(new c.k("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const _=this.map._requestManager.transformRequest(a,"Style");this._loadStyleRequest=new AbortController,c.h(_,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,d,p)}).catch(v=>{this._loadStyleRequest=null,v&&this.fire(new c.j(v))})}loadJSON(a,d={},p){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(a,d,p)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(tr,{validate:!1})}_load(a,d,p){var _;const v=d.transformStyle?d.transformStyle(p,a):a;if(!d.validate||!Pr(this,c.x(v))){this._loaded=!0,this.stylesheet=v;for(const T in v.sources)this.addSource(T,v.sources[T],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Ve(this.stylesheet.light),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const a=c.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",a),this._order=a.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of a){const p=c.aA(d);p.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=p}}_loadSprite(a,d=!1,p=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(v,T,k,E){return c._(this,void 0,void 0,function*(){const L=me(v),R=k>1?"@2x":"",N={},W={};for(const{id:X,url:te}of L){const ue=T.transformRequest(Te(te,R,".json"),"SpriteJSON");N[X]=c.h(ue,E);const re=T.transformRequest(Te(te,R,".png"),"SpriteImage");W[X]=le.getImage(re,E)}return yield Promise.all([...Object.values(N),...Object.values(W)]),function(X,te){return c._(this,void 0,void 0,function*(){const ue={};for(const re in X){ue[re]={};const pe=M.getImageCanvasContext((yield te[re]).data),ve=(yield X[re]).data;for(const ce in ve){const{width:Se,height:ze,x:Oe,y:Qe,sdf:ft,pixelRatio:Et,stretchX:Dt,stretchY:pt,content:_t,textFitWidth:jt,textFitHeight:rn}=ve[ce];ue[re][ce]={data:null,pixelRatio:Et,sdf:ft,stretchX:Dt,stretchY:pt,content:_t,textFitWidth:jt,textFitHeight:rn,spriteData:{width:Se,height:ze,x:Oe,y:Qe,context:pe}}}}return ue})}(N,W)})}(a,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(v=>{if(this._spriteRequest=null,v)for(const T in v){this._spritesImagesIds[T]=[];const k=this._spritesImagesIds[T]?this._spritesImagesIds[T].filter(E=>!(E in v)):[];for(const E of k)this.imageManager.removeImage(E),this._changedImages[E]=!0;for(const E in v[T]){const L=T==="default"?E:`${T}:${E}`;this._spritesImagesIds[T].push(L),L in this.imageManager.images?this.imageManager.updateImage(L,v[T][E],!1):this.imageManager.addImage(L,v[T][E]),d&&(this._changedImages[L]=!0)}}}).catch(v=>{this._spriteRequest=null,_=v,this.fire(new c.j(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),p&&p(_)})}_unloadSprite(){for(const a of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(a),this._changedImages[a]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(a){const d=this.sourceCaches[a.source];if(!d)return;const p=a.sourceLayer;if(!p)return;const _=d.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(p)===-1)&&this.fire(new c.j(new Error(`Source layer "${p}" does not exist on source "${_.id}" as specified by style layer "${a.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(a){const d=this._serializedAllLayers();if(!a||a.length===0)return Object.values(d);const p=[];for(const _ of a)d[_]&&p.push(d[_]);return p}_serializedAllLayers(){let a=this._serializedLayers;if(a)return a;a=this._serializedLayers={};const d=Object.keys(this._layers);for(const p of d){const _=this._layers[p];_.type!=="custom"&&(a[p]=_.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(a){if(!this._loaded)return;const d=this._changed;if(d){const _=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(_.length||v.length)&&this._updateWorkerLayers(_,v);for(const T in this._updatedSources){const k=this._updatedSources[T];if(k==="reload")this._reloadSource(T);else{if(k!=="clear")throw new Error(`Invalid action ${k}`);this._clearSource(T)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(a);this.light.updateTransitions(a),this._resetUpdates()}const p={};for(const _ in this.sourceCaches){const v=this.sourceCaches[_];p[_]=v.used,v.used=!1}for(const _ of this._order){const v=this._layers[_];v.recalculate(a,this._availableImages),!v.isHidden(a.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const _ in p){const v=this.sourceCaches[_];!!p[_]!=!!v.used&&v.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(a),this.z=a.zoom,d&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(a,d){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(a),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(a,d={}){var p;this._checkLoaded();const _=this.serialize();if(a=d.transformStyle?d.transformStyle(_,a):a,((p=d.validate)===null||p===void 0||p)&&Pr(this,c.x(a)))return!1;(a=c.aB(a)).layers=c.az(a.layers);const v=c.aC(_,a),T=this._getOperationsToPerform(v);if(T.unimplemented.length>0)throw new Error(`Unimplemented: ${T.unimplemented.join(", ")}.`);if(T.operations.length===0)return!1;for(const k of T.operations)k();return this.stylesheet=a,this._serializedLayers=null,!0}_getOperationsToPerform(a){const d=[],p=[];for(const _ of a)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":d.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":d.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setTransition":d.push(()=>{});break;default:p.push(_.command)}return{operations:d,unimplemented:p}}addImage(a,d){if(this.getImage(a))return this.fire(new c.j(new Error(`An image named "${a}" already exists.`)));this.imageManager.addImage(a,d),this._afterImageUpdated(a)}updateImage(a,d){this.imageManager.updateImage(a,d)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){if(!this.getImage(a))return this.fire(new c.j(new Error(`An image named "${a}" does not exist.`)));this.imageManager.removeImage(a),this._afterImageUpdated(a)}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(a,d,p={}){if(this._checkLoaded(),this.sourceCaches[a]!==void 0)throw new Error(`Source "${a}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(c.x.source,`sources.${a}`,d,null,p))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const _=this.sourceCaches[a]=new Ne(a,d,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:a})),_.onAdd(this.map),this._changed=!0}removeSource(a){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===a)return this.fire(new c.j(new Error(`Source "${a}" cannot be removed while layer "${p}" is using it.`)));const d=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],d.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:a})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(a,d){if(this._checkLoaded(),this.sourceCaches[a]===void 0)throw new Error(`There is no source with this ID=${a}`);const p=this.sourceCaches[a].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(d),this._changed=!0}getSource(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()}addLayer(a,d,p={}){this._checkLoaded();const _=a.id;if(this.getLayer(_))return void this.fire(new c.j(new Error(`Layer "${_}" already exists on this map.`)));let v;if(a.type==="custom"){if(Pr(this,c.aD(a)))return;v=c.aA(a)}else{if("source"in a&&typeof a.source=="object"&&(this.addSource(_,a.source),a=c.aB(a),a=c.e(a,{source:_})),this._validate(c.x.layer,`layers.${_}`,a,{arrayIndex:-1},p))return;v=c.aA(a),this._validateLayer(v),v.setEventedParent(this,{layer:{id:_}})}const T=d?this._order.indexOf(d):this._order.length;if(d&&T===-1)this.fire(new c.j(new Error(`Cannot add layer "${_}" before non-existing layer "${d}".`)));else{if(this._order.splice(T,0,_),this._layerOrderChanged=!0,this._layers[_]=v,this._removedLayers[_]&&v.source&&v.type!=="custom"){const k=this._removedLayers[_];delete this._removedLayers[_],k.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(a,d){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new c.j(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===d)return;const p=this._order.indexOf(a);this._order.splice(p,1);const _=d?this._order.indexOf(d):this._order.length;d&&_===-1?this.fire(new c.j(new Error(`Cannot move layer "${a}" before non-existing layer "${d}".`))):(this._order.splice(_,0,a),this._layerOrderChanged=!0)}removeLayer(a){this._checkLoaded();const d=this._layers[a];if(!d)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${a}".`)));d.setEventedParent(null);const p=this._order.indexOf(a);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=d,delete this._layers[a],this._serializedLayers&&delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],d.onRemove&&d.onRemove(this.map)}getLayer(a){return this._layers[a]}getLayersOrder(){return[...this._order]}hasLayer(a){return a in this._layers}setLayerZoomRange(a,d,p){this._checkLoaded();const _=this.getLayer(a);_?_.minzoom===d&&_.maxzoom===p||(d!=null&&(_.minzoom=d),p!=null&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${a}".`)))}setFilter(a,d,p={}){this._checkLoaded();const _=this.getLayer(a);if(_){if(!c.aE(_.filter,d))return d==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(c.x.filter,`layers.${_.id}.filter`,d,null,p)||(_.filter=c.aB(d),this._updateLayer(_)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${a}".`)))}getFilter(a){return c.aB(this.getLayer(a).filter)}setLayoutProperty(a,d,p,_={}){this._checkLoaded();const v=this.getLayer(a);v?c.aE(v.getLayoutProperty(d),p)||(v.setLayoutProperty(d,p,_),this._updateLayer(v)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${a}".`)))}getLayoutProperty(a,d){const p=this.getLayer(a);if(p)return p.getLayoutProperty(d);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${a}".`)))}setPaintProperty(a,d,p,_={}){this._checkLoaded();const v=this.getLayer(a);v?c.aE(v.getPaintProperty(d),p)||(v.setPaintProperty(d,p,_)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[a]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${a}".`)))}getPaintProperty(a,d){return this.getLayer(a).getPaintProperty(d)}setFeatureState(a,d){this._checkLoaded();const p=a.source,_=a.sourceLayer,v=this.sourceCaches[p];if(v===void 0)return void this.fire(new c.j(new Error(`The source '${p}' does not exist in the map's style.`)));const T=v.getSource().type;T==="geojson"&&_?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||_?(a.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),v.setFeatureState(_,a.id,d)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(a,d){this._checkLoaded();const p=a.source,_=this.sourceCaches[p];if(_===void 0)return void this.fire(new c.j(new Error(`The source '${p}' does not exist in the map's style.`)));const v=_.getSource().type,T=v==="vector"?a.sourceLayer:void 0;v!=="vector"||T?d&&typeof a.id!="string"&&typeof a.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(T,a.id,d):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(a){this._checkLoaded();const d=a.source,p=a.sourceLayer,_=this.sourceCaches[d];if(_!==void 0)return _.getSource().type!=="vector"||p?(a.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),_.getFeatureState(p,a.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const a=c.aF(this.sourceCaches,v=>v.serialize()),d=this._serializeByIds(this._order),p=this.map.getTerrain()||void 0,_=this.stylesheet;return c.aG({version:_.version,name:_.name,metadata:_.metadata,light:_.light,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,sources:a,layers:d,terrain:p},v=>v!==void 0)}_updateLayer(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&this.sourceCaches[a.source].getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(a){const d=T=>this._layers[T].type==="fill-extrusion",p={},_=[];for(let T=this._order.length-1;T>=0;T--){const k=this._order[T];if(d(k)){p[k]=T;for(const E of a){const L=E[k];if(L)for(const R of L)_.push(R)}}}_.sort((T,k)=>k.intersectionZ-T.intersectionZ);const v=[];for(let T=this._order.length-1;T>=0;T--){const k=this._order[T];if(d(k))for(let E=_.length-1;E>=0;E--){const L=_[E].feature;if(p[L.layer.id]<T)break;v.push(L),_.pop()}else for(const E of a){const L=E[k];if(L)for(const R of L)v.push(R.feature)}}return v}queryRenderedFeatures(a,d,p){d&&d.filter&&this._validate(c.x.filter,"queryRenderedFeatures.filter",d.filter,null,d);const _={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new c.j(new Error("parameters.layers must be an Array."))),[];for(const k of d.layers){const E=this._layers[k];if(!E)return this.fire(new c.j(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];_[E.source]=!0}}const v=[];d.availableImages=this._availableImages;const T=this._serializedAllLayers();for(const k in this.sourceCaches)d.layers&&!_[k]||v.push(ut(this.sourceCaches[k],this._layers,T,a,d,p));return this.placement&&v.push(function(k,E,L,R,N,W,X){const te={},ue=W.queryRenderedSymbols(R),re=[];for(const pe of Object.keys(ue).map(Number))re.push(X[pe]);re.sort(Re);for(const pe of re){const ve=pe.featureIndex.lookupSymbolFeatures(ue[pe.bucketInstanceId],E,pe.bucketIndex,pe.sourceLayerIndex,N.filter,N.layers,N.availableImages,k);for(const ce in ve){const Se=te[ce]=te[ce]||[],ze=ve[ce];ze.sort((Oe,Qe)=>{const ft=pe.featureSortOrder;if(ft){const Et=ft.indexOf(Oe.featureIndex);return ft.indexOf(Qe.featureIndex)-Et}return Qe.featureIndex-Oe.featureIndex});for(const Oe of ze)Se.push(Oe)}}for(const pe in te)te[pe].forEach(ve=>{const ce=ve.feature,Se=L[k[pe].source].getFeatureState(ce.layer["source-layer"],ce.id);ce.source=ce.layer.source,ce.layer["source-layer"]&&(ce.sourceLayer=ce.layer["source-layer"]),ce.state=Se});return te}(this._layers,T,this.sourceCaches,a,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(a,d){d&&d.filter&&this._validate(c.x.filter,"querySourceFeatures.filter",d.filter,null,d);const p=this.sourceCaches[a];return p?function(_,v){const T=_.getRenderableIds().map(L=>_.getTileByID(L)),k=[],E={};for(let L=0;L<T.length;L++){const R=T[L],N=R.tileID.canonical.key;E[N]||(E[N]=!0,R.querySourceFeatures(k,v))}return k}(p,d):[]}getLight(){return this.light.getLight()}setLight(a,d={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const T in a)if(!c.aE(a[T],p[T])){_=!0;break}if(!_)return;const v={now:M.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(a,d),this.light.updateTransitions(v)}_validate(a,d,p,_,v={}){return(!v||v.validate!==!1)&&Pr(this,a.call(c.x,c.e({key:d,style:this.serialize(),value:p,styleSpec:c.v},_)))}_remove(a=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),at().off(vr,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const p=this.sourceCaches[d];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),a&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(a)}_clearSource(a){this.sourceCaches[a].clearTiles()}_reloadSource(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()}_updateSources(a){for(const d in this.sourceCaches)this.sourceCaches[d].update(a,this.map.terrain)}_generateCollisionBoxes(){for(const a in this.sourceCaches)this._reloadSource(a)}_updatePlacement(a,d,p,_,v=!1){let T=!1,k=!1;const E={};for(const L of this._order){const R=this._layers[L];if(R.type!=="symbol")continue;if(!E[R.source]){const W=this.sourceCaches[R.source];E[R.source]=W.getRenderableIds(!0).map(X=>W.getTileByID(X)).sort((X,te)=>te.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(te.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(R,E[R.source],a.center.lng);T=T||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(M.now(),a.zoom))&&(this.pauseablePlacement=new Xr(a,this.map.terrain,this._order,v,d,p,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(M.now()),k=!0),T&&this.pauseablePlacement.placement.setStale()),k||T)for(const L of this._order){const R=this._layers[L];R.type==="symbol"&&this.placement.updateLayerOpacities(R,E[R.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(M.now())}_releaseSymbolFadeTiles(){for(const a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,d){return c._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,d.icons),p})}getGlyphs(a,d){return c._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(d.stacks),_=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(a,d={}){this._checkLoaded(),a&&this._validate(c.x.glyphs,"glyphs",a,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=a,this.glyphManager.entries={},this.glyphManager.setURL(a))}addSprite(a,d,p={},_){this._checkLoaded();const v=[{id:a,url:d}],T=[...me(this.stylesheet.sprite),...v];this._validate(c.x.sprite,"sprite",T,null,p)||(this.stylesheet.sprite=T,this._loadSprite(v,!0,_))}removeSprite(a){this._checkLoaded();const d=me(this.stylesheet.sprite);if(d.find(p=>p.id===a)){if(this._spritesImagesIds[a])for(const p of this._spritesImagesIds[a])this.imageManager.removeImage(p),this._changedImages[p]=!0;d.splice(d.findIndex(p=>p.id===a),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[a],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${a}" doesn't exists on this map.`)))}getSprite(){return me(this.stylesheet.sprite)}setSprite(a,d={},p){this._checkLoaded(),a&&this._validate(c.x.sprite,"sprite",a,null,d)||(this.stylesheet.sprite=a,a?this._loadSprite(a,!0,p):(this._unloadSprite(),p&&p(null)))}}var Qr=c.X([{name:"a_pos",type:"Int16",components:2}]),Hr="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const $r={prelude:zn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:zn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:zn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:zn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:zn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:zn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:zn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:zn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:zn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:zn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:zn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:zn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:zn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:zn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:zn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:zn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:zn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:zn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:zn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:zn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:zn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:zn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Hr),terrainDepth:zn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Hr),terrainCoords:zn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Hr)};function zn(g,a){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=a.match(/attribute ([\w]+) ([\w]+)/g),_=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=v?v.concat(_):_,k={};return{fragmentSource:g=g.replace(d,(E,L,R,N,W)=>(k[W]=!0,L==="define"?`
#ifndef HAS_UNIFORM_u_${W}
varying ${R} ${N} ${W};
#else
uniform ${R} ${N} u_${W};
#endif
`:`
#ifdef HAS_UNIFORM_u_${W}
    ${R} ${N} ${W} = u_${W};
#endif
`)),vertexSource:a=a.replace(d,(E,L,R,N,W)=>{const X=N==="float"?"vec2":"vec4",te=W.match(/color/)?"color":X;return k[W]?L==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${R} ${X} a_${W};
varying ${R} ${N} ${W};
#else
uniform ${R} ${N} u_${W};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = a_${W};
#else
    ${R} ${N} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${W} = unpack_mix_${te}(a_${W}, u_${W}_t);
#else
    ${R} ${N} ${W} = u_${W};
#endif
`:L==="define"?`
#ifndef HAS_UNIFORM_u_${W}
uniform lowp float u_${W}_t;
attribute ${R} ${X} a_${W};
#else
uniform ${R} ${N} u_${W};
#endif
`:te==="vec4"?`
#ifndef HAS_UNIFORM_u_${W}
    ${R} ${N} ${W} = a_${W};
#else
    ${R} ${N} ${W} = u_${W};
#endif
`:`
#ifndef HAS_UNIFORM_u_${W}
    ${R} ${N} ${W} = unpack_mix_${te}(a_${W}, u_${W}_t);
#else
    ${R} ${N} ${W} = u_${W};
#endif
`}),staticAttributes:p,staticUniforms:T}}class Ma{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(a,d,p,_,v,T,k,E,L){this.context=a;let R=this.boundPaintVertexBuffers.length!==_.length;for(let N=0;!R&&N<_.length;N++)this.boundPaintVertexBuffers[N]!==_[N]&&(R=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==p||R||this.boundIndexBuffer!==v||this.boundVertexOffset!==T||this.boundDynamicVertexBuffer!==k||this.boundDynamicVertexBuffer2!==E||this.boundDynamicVertexBuffer3!==L?this.freshBind(d,p,_,v,T,k,E,L):(a.bindVertexArray.set(this.vao),k&&k.bind(),v&&v.dynamicDraw&&v.bind(),E&&E.bind(),L&&L.bind())}freshBind(a,d,p,_,v,T,k,E){const L=a.numAttributes,R=this.context,N=R.gl;this.vao&&this.destroy(),this.vao=R.createVertexArray(),R.bindVertexArray.set(this.vao),this.boundProgram=a,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=k,this.boundDynamicVertexBuffer3=E,d.enableAttributes(N,a);for(const W of p)W.enableAttributes(N,a);T&&T.enableAttributes(N,a),k&&k.enableAttributes(N,a),E&&E.enableAttributes(N,a),d.bind(),d.setVertexAttribPointers(N,a,v);for(const W of p)W.bind(),W.setVertexAttribPointers(N,a,v);T&&(T.bind(),T.setVertexAttribPointers(N,a,v)),_&&_.bind(),k&&(k.bind(),k.setVertexAttribPointers(N,a,v)),E&&(E.bind(),E.setVertexAttribPointers(N,a,v)),R.currentNumAttributes=L}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function fe(g){const a=[];for(let d=0;d<g.length;d++){if(g[d]===null)continue;const p=g[d].split(" ");a.push(p.pop())}return a}class zt{constructor(a,d,p,_,v,T){const k=a.gl;this.program=k.createProgram();const E=fe(d.staticAttributes),L=p?p.getBinderAttributes():[],R=E.concat(L),N=$r.prelude.staticUniforms?fe($r.prelude.staticUniforms):[],W=d.staticUniforms?fe(d.staticUniforms):[],X=p?p.getBinderUniforms():[],te=N.concat(W).concat(X),ue=[];for(const Oe of te)ue.indexOf(Oe)<0&&ue.push(Oe);const re=p?p.defines():[];v&&re.push("#define OVERDRAW_INSPECTOR;"),T&&re.push("#define TERRAIN3D;");const pe=re.concat($r.prelude.fragmentSource,d.fragmentSource).join(`
`),ve=re.concat($r.prelude.vertexSource,d.vertexSource).join(`
`),ce=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(ce,pe),k.compileShader(ce),!k.getShaderParameter(ce,k.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${k.getShaderInfoLog(ce)}`);k.attachShader(this.program,ce);const Se=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);if(k.shaderSource(Se,ve),k.compileShader(Se),!k.getShaderParameter(Se,k.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${k.getShaderInfoLog(Se)}`);k.attachShader(this.program,Se),this.attributes={};const ze={};this.numAttributes=R.length;for(let Oe=0;Oe<this.numAttributes;Oe++)R[Oe]&&(k.bindAttribLocation(this.program,Oe,R[Oe]),this.attributes[R[Oe]]=Oe);if(k.linkProgram(this.program),!k.getProgramParameter(this.program,k.LINK_STATUS))throw new Error(`Program failed to link: ${k.getProgramInfoLog(this.program)}`);k.deleteShader(Se),k.deleteShader(ce);for(let Oe=0;Oe<ue.length;Oe++){const Qe=ue[Oe];if(Qe&&!ze[Qe]){const ft=k.getUniformLocation(this.program,Qe);ft&&(ze[Qe]=ft)}}this.fixedUniforms=_(a,ze),this.terrainUniforms=((Oe,Qe)=>({u_depth:new c.aH(Oe,Qe.u_depth),u_terrain:new c.aH(Oe,Qe.u_terrain),u_terrain_dim:new c.aI(Oe,Qe.u_terrain_dim),u_terrain_matrix:new c.aJ(Oe,Qe.u_terrain_matrix),u_terrain_unpack:new c.aK(Oe,Qe.u_terrain_unpack),u_terrain_exaggeration:new c.aI(Oe,Qe.u_terrain_exaggeration)}))(a,ze),this.binderUniforms=p?p.getUniforms(a,ze):[]}draw(a,d,p,_,v,T,k,E,L,R,N,W,X,te,ue,re,pe,ve){const ce=a.gl;if(this.failedToCreate)return;if(a.program.set(this.program),a.setDepthMode(p),a.setStencilMode(_),a.setColorMode(v),a.setCullFace(T),E){a.activeTexture.set(ce.TEXTURE2),ce.bindTexture(ce.TEXTURE_2D,E.depthTexture),a.activeTexture.set(ce.TEXTURE3),ce.bindTexture(ce.TEXTURE_2D,E.texture);for(const ze in this.terrainUniforms)this.terrainUniforms[ze].set(E[ze])}for(const ze in this.fixedUniforms)this.fixedUniforms[ze].set(k[ze]);ue&&ue.setUniforms(a,this.binderUniforms,X,{zoom:te});let Se=0;switch(d){case ce.LINES:Se=2;break;case ce.TRIANGLES:Se=3;break;case ce.LINE_STRIP:Se=1}for(const ze of W.get()){const Oe=ze.vaos||(ze.vaos={});(Oe[L]||(Oe[L]=new Ma)).bind(a,this,R,ue?ue.getPaintVertexBuffers():[],N,ze.vertexOffset,re,pe,ve),ce.drawElements(d,ze.primitiveLength*Se,ce.UNSIGNED_SHORT,ze.primitiveOffset*Se*2)}}}function Nn(g,a,d){const p=1/Kt(d,1,a.transform.tileZoom),_=Math.pow(2,d.tileID.overscaledZ),v=d.tileSize*Math.pow(2,a.transform.tileZoom)/_,T=v*(d.tileID.canonical.x+d.tileID.wrap*_),k=v*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[p,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[T>>16,k>>16],u_pixel_coord_lower:[65535&T,65535&k]}}const Hi=(g,a,d,p)=>{const _=a.style.light,v=_.properties.get("position"),T=[v.x,v.y,v.z],k=function(){var L=new c.A(9);return c.A!=Float32Array&&(L[1]=0,L[2]=0,L[3]=0,L[5]=0,L[6]=0,L[7]=0),L[0]=1,L[4]=1,L[8]=1,L}();_.properties.get("anchor")==="viewport"&&function(L,R){var N=Math.sin(R),W=Math.cos(R);L[0]=W,L[1]=N,L[2]=0,L[3]=-N,L[4]=W,L[5]=0,L[6]=0,L[7]=0,L[8]=1}(k,-a.transform.angle),function(L,R,N){var W=R[0],X=R[1],te=R[2];L[0]=W*N[0]+X*N[3]+te*N[6],L[1]=W*N[1]+X*N[4]+te*N[7],L[2]=W*N[2]+X*N[5]+te*N[8]}(T,T,k);const E=_.properties.get("color");return{u_matrix:g,u_lightpos:T,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+d,u_opacity:p}},Ra=(g,a,d,p,_,v,T)=>c.e(Hi(g,a,d,p),Nn(v,a,T),{u_height_factor:-Math.pow(2,_.overscaledZ)/T.tileSize/8}),Lr=g=>({u_matrix:g}),Wr=(g,a,d,p)=>c.e(Lr(g),Nn(d,a,p)),is=(g,a)=>({u_matrix:g,u_world:a}),fo=(g,a,d,p,_)=>c.e(Wr(g,a,d,p),{u_world:_}),po=(g,a,d,p)=>{const _=g.transform;let v,T;if(p.paint.get("circle-pitch-alignment")==="map"){const k=Kt(d,1,_.zoom);v=!0,T=[k,k]}else v=!1,T=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(a.posMatrix,d,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:T}},Fu=(g,a,d)=>({u_matrix:g,u_inv_matrix:a,u_camera_to_center_distance:d.cameraToCenterDistance,u_viewport_size:[d.width,d.height]}),rs=(g,a,d=1)=>({u_matrix:g,u_color:a,u_overlay:0,u_overlay_scale:d}),ms=g=>({u_matrix:g}),ma=(g,a,d,p)=>({u_matrix:g,u_extrude_scale:Kt(a,1,d),u_intensity:p});function Ol(g,a){const d=Math.pow(2,a.canonical.z),p=a.canonical.y;return[new c.Y(0,p/d).toLngLat().lat,new c.Y(0,(p+1)/d).toLngLat().lat]}const Ir=(g,a,d,p)=>{const _=g.transform;return{u_matrix:Ko(g,a,d,p),u_ratio:1/Kt(a,1,_.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Fi=(g,a,d,p,_)=>c.e(Ir(g,a,d,_),{u_image:0,u_image_height:p}),_s=(g,a,d,p,_)=>{const v=g.transform,T=gs(a,v);return{u_matrix:Ko(g,a,d,_),u_texsize:a.imageAtlasTexture.size,u_ratio:1/Kt(a,1,v.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[T,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Jo=(g,a,d,p,_,v)=>{const T=g.lineAtlas,k=gs(a,g.transform),E=d.layout.get("line-cap")==="round",L=T.getDash(p.from,E),R=T.getDash(p.to,E),N=L.width*_.fromScale,W=R.width*_.toScale;return c.e(Ir(g,a,d,v),{u_patternscale_a:[k/N,-L.height/2],u_patternscale_b:[k/W,-R.height/2],u_sdfgamma:T.width/(256*Math.min(N,W)*g.pixelRatio)/2,u_image:0,u_tex_y_a:L.y,u_tex_y_b:R.y,u_mix:_.t})};function gs(g,a){return 1/Kt(g,1,a.tileZoom)}function Ko(g,a,d,p){return g.translatePosMatrix(p?p.posMatrix:a.tileID.posMatrix,a,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const ys=(g,a,d,p,_)=>{return{u_matrix:g,u_tl_parent:a,u_scale_parent:d,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(T=_.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(v=_.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:Nu(_.paint.get("raster-hue-rotate"))};var v,T};function Nu(g){g*=Math.PI/180;const a=Math.sin(g),d=Math.cos(g);return[(2*d+1)/3,(-Math.sqrt(3)*a-d+1)/3,(Math.sqrt(3)*a-d+1)/3]}const bs=(g,a,d,p,_,v,T,k,E,L,R,N,W,X)=>{const te=T.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:te.cameraToCenterDistance,u_pitch:te.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:te.width/te.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:k,u_label_plane_matrix:E,u_coord_matrix:L,u_is_text:+N,u_pitch_with_map:+p,u_is_along_line:_,u_is_variable_anchor:v,u_texsize:W,u_texture:0,u_translation:R,u_pitched_scale:X}},Aa=(g,a,d,p,_,v,T,k,E,L,R,N,W,X,te)=>{const ue=T.transform;return c.e(bs(g,a,d,p,_,v,T,k,E,L,R,N,W,te),{u_gamma_scale:p?Math.cos(ue._pitch)*ue.cameraToCenterDistance:1,u_device_pixel_ratio:T.pixelRatio,u_is_halo:+X})},Oa=(g,a,d,p,_,v,T,k,E,L,R,N,W,X)=>c.e(Aa(g,a,d,p,_,v,T,k,E,L,R,!0,N,!0,X),{u_texsize_icon:W,u_texture_icon:1}),mo=(g,a,d)=>({u_matrix:g,u_opacity:a,u_color:d}),Ru=(g,a,d,p,_,v)=>c.e(function(T,k,E,L){const R=E.imageManager.getPattern(T.from.toString()),N=E.imageManager.getPattern(T.to.toString()),{width:W,height:X}=E.imageManager.getPixelSize(),te=Math.pow(2,L.tileID.overscaledZ),ue=L.tileSize*Math.pow(2,E.transform.tileZoom)/te,re=ue*(L.tileID.canonical.x+L.tileID.wrap*te),pe=ue*L.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:R.tl,u_pattern_br_a:R.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[W,X],u_mix:k.t,u_pattern_size_a:R.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/Kt(L,1,E.transform.tileZoom),u_pixel_coord_upper:[re>>16,pe>>16],u_pixel_coord_lower:[65535&re,65535&pe]}}(p,v,d,_),{u_matrix:g,u_opacity:a}),Ul={fillExtrusion:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_lightpos:new c.aL(g,a.u_lightpos),u_lightintensity:new c.aI(g,a.u_lightintensity),u_lightcolor:new c.aL(g,a.u_lightcolor),u_vertical_gradient:new c.aI(g,a.u_vertical_gradient),u_opacity:new c.aI(g,a.u_opacity)}),fillExtrusionPattern:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_lightpos:new c.aL(g,a.u_lightpos),u_lightintensity:new c.aI(g,a.u_lightintensity),u_lightcolor:new c.aL(g,a.u_lightcolor),u_vertical_gradient:new c.aI(g,a.u_vertical_gradient),u_height_factor:new c.aI(g,a.u_height_factor),u_image:new c.aH(g,a.u_image),u_texsize:new c.aM(g,a.u_texsize),u_pixel_coord_upper:new c.aM(g,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(g,a.u_pixel_coord_lower),u_scale:new c.aL(g,a.u_scale),u_fade:new c.aI(g,a.u_fade),u_opacity:new c.aI(g,a.u_opacity)}),fill:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix)}),fillPattern:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_image:new c.aH(g,a.u_image),u_texsize:new c.aM(g,a.u_texsize),u_pixel_coord_upper:new c.aM(g,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(g,a.u_pixel_coord_lower),u_scale:new c.aL(g,a.u_scale),u_fade:new c.aI(g,a.u_fade)}),fillOutline:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_world:new c.aM(g,a.u_world)}),fillOutlinePattern:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_world:new c.aM(g,a.u_world),u_image:new c.aH(g,a.u_image),u_texsize:new c.aM(g,a.u_texsize),u_pixel_coord_upper:new c.aM(g,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(g,a.u_pixel_coord_lower),u_scale:new c.aL(g,a.u_scale),u_fade:new c.aI(g,a.u_fade)}),circle:(g,a)=>({u_camera_to_center_distance:new c.aI(g,a.u_camera_to_center_distance),u_scale_with_map:new c.aH(g,a.u_scale_with_map),u_pitch_with_map:new c.aH(g,a.u_pitch_with_map),u_extrude_scale:new c.aM(g,a.u_extrude_scale),u_device_pixel_ratio:new c.aI(g,a.u_device_pixel_ratio),u_matrix:new c.aJ(g,a.u_matrix)}),collisionBox:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_pixel_extrude_scale:new c.aM(g,a.u_pixel_extrude_scale)}),collisionCircle:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_inv_matrix:new c.aJ(g,a.u_inv_matrix),u_camera_to_center_distance:new c.aI(g,a.u_camera_to_center_distance),u_viewport_size:new c.aM(g,a.u_viewport_size)}),debug:(g,a)=>({u_color:new c.aN(g,a.u_color),u_matrix:new c.aJ(g,a.u_matrix),u_overlay:new c.aH(g,a.u_overlay),u_overlay_scale:new c.aI(g,a.u_overlay_scale)}),clippingMask:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix)}),heatmap:(g,a)=>({u_extrude_scale:new c.aI(g,a.u_extrude_scale),u_intensity:new c.aI(g,a.u_intensity),u_matrix:new c.aJ(g,a.u_matrix)}),heatmapTexture:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_world:new c.aM(g,a.u_world),u_image:new c.aH(g,a.u_image),u_color_ramp:new c.aH(g,a.u_color_ramp),u_opacity:new c.aI(g,a.u_opacity)}),hillshade:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_image:new c.aH(g,a.u_image),u_latrange:new c.aM(g,a.u_latrange),u_light:new c.aM(g,a.u_light),u_shadow:new c.aN(g,a.u_shadow),u_highlight:new c.aN(g,a.u_highlight),u_accent:new c.aN(g,a.u_accent)}),hillshadePrepare:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_image:new c.aH(g,a.u_image),u_dimension:new c.aM(g,a.u_dimension),u_zoom:new c.aI(g,a.u_zoom),u_unpack:new c.aK(g,a.u_unpack)}),line:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_ratio:new c.aI(g,a.u_ratio),u_device_pixel_ratio:new c.aI(g,a.u_device_pixel_ratio),u_units_to_pixels:new c.aM(g,a.u_units_to_pixels)}),lineGradient:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_ratio:new c.aI(g,a.u_ratio),u_device_pixel_ratio:new c.aI(g,a.u_device_pixel_ratio),u_units_to_pixels:new c.aM(g,a.u_units_to_pixels),u_image:new c.aH(g,a.u_image),u_image_height:new c.aI(g,a.u_image_height)}),linePattern:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_texsize:new c.aM(g,a.u_texsize),u_ratio:new c.aI(g,a.u_ratio),u_device_pixel_ratio:new c.aI(g,a.u_device_pixel_ratio),u_image:new c.aH(g,a.u_image),u_units_to_pixels:new c.aM(g,a.u_units_to_pixels),u_scale:new c.aL(g,a.u_scale),u_fade:new c.aI(g,a.u_fade)}),lineSDF:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_ratio:new c.aI(g,a.u_ratio),u_device_pixel_ratio:new c.aI(g,a.u_device_pixel_ratio),u_units_to_pixels:new c.aM(g,a.u_units_to_pixels),u_patternscale_a:new c.aM(g,a.u_patternscale_a),u_patternscale_b:new c.aM(g,a.u_patternscale_b),u_sdfgamma:new c.aI(g,a.u_sdfgamma),u_image:new c.aH(g,a.u_image),u_tex_y_a:new c.aI(g,a.u_tex_y_a),u_tex_y_b:new c.aI(g,a.u_tex_y_b),u_mix:new c.aI(g,a.u_mix)}),raster:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_tl_parent:new c.aM(g,a.u_tl_parent),u_scale_parent:new c.aI(g,a.u_scale_parent),u_buffer_scale:new c.aI(g,a.u_buffer_scale),u_fade_t:new c.aI(g,a.u_fade_t),u_opacity:new c.aI(g,a.u_opacity),u_image0:new c.aH(g,a.u_image0),u_image1:new c.aH(g,a.u_image1),u_brightness_low:new c.aI(g,a.u_brightness_low),u_brightness_high:new c.aI(g,a.u_brightness_high),u_saturation_factor:new c.aI(g,a.u_saturation_factor),u_contrast_factor:new c.aI(g,a.u_contrast_factor),u_spin_weights:new c.aL(g,a.u_spin_weights)}),symbolIcon:(g,a)=>({u_is_size_zoom_constant:new c.aH(g,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,a.u_is_size_feature_constant),u_size_t:new c.aI(g,a.u_size_t),u_size:new c.aI(g,a.u_size),u_camera_to_center_distance:new c.aI(g,a.u_camera_to_center_distance),u_pitch:new c.aI(g,a.u_pitch),u_rotate_symbol:new c.aH(g,a.u_rotate_symbol),u_aspect_ratio:new c.aI(g,a.u_aspect_ratio),u_fade_change:new c.aI(g,a.u_fade_change),u_matrix:new c.aJ(g,a.u_matrix),u_label_plane_matrix:new c.aJ(g,a.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,a.u_coord_matrix),u_is_text:new c.aH(g,a.u_is_text),u_pitch_with_map:new c.aH(g,a.u_pitch_with_map),u_is_along_line:new c.aH(g,a.u_is_along_line),u_is_variable_anchor:new c.aH(g,a.u_is_variable_anchor),u_texsize:new c.aM(g,a.u_texsize),u_texture:new c.aH(g,a.u_texture),u_translation:new c.aM(g,a.u_translation),u_pitched_scale:new c.aI(g,a.u_pitched_scale)}),symbolSDF:(g,a)=>({u_is_size_zoom_constant:new c.aH(g,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,a.u_is_size_feature_constant),u_size_t:new c.aI(g,a.u_size_t),u_size:new c.aI(g,a.u_size),u_camera_to_center_distance:new c.aI(g,a.u_camera_to_center_distance),u_pitch:new c.aI(g,a.u_pitch),u_rotate_symbol:new c.aH(g,a.u_rotate_symbol),u_aspect_ratio:new c.aI(g,a.u_aspect_ratio),u_fade_change:new c.aI(g,a.u_fade_change),u_matrix:new c.aJ(g,a.u_matrix),u_label_plane_matrix:new c.aJ(g,a.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,a.u_coord_matrix),u_is_text:new c.aH(g,a.u_is_text),u_pitch_with_map:new c.aH(g,a.u_pitch_with_map),u_is_along_line:new c.aH(g,a.u_is_along_line),u_is_variable_anchor:new c.aH(g,a.u_is_variable_anchor),u_texsize:new c.aM(g,a.u_texsize),u_texture:new c.aH(g,a.u_texture),u_gamma_scale:new c.aI(g,a.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,a.u_device_pixel_ratio),u_is_halo:new c.aH(g,a.u_is_halo),u_translation:new c.aM(g,a.u_translation),u_pitched_scale:new c.aI(g,a.u_pitched_scale)}),symbolTextAndIcon:(g,a)=>({u_is_size_zoom_constant:new c.aH(g,a.u_is_size_zoom_constant),u_is_size_feature_constant:new c.aH(g,a.u_is_size_feature_constant),u_size_t:new c.aI(g,a.u_size_t),u_size:new c.aI(g,a.u_size),u_camera_to_center_distance:new c.aI(g,a.u_camera_to_center_distance),u_pitch:new c.aI(g,a.u_pitch),u_rotate_symbol:new c.aH(g,a.u_rotate_symbol),u_aspect_ratio:new c.aI(g,a.u_aspect_ratio),u_fade_change:new c.aI(g,a.u_fade_change),u_matrix:new c.aJ(g,a.u_matrix),u_label_plane_matrix:new c.aJ(g,a.u_label_plane_matrix),u_coord_matrix:new c.aJ(g,a.u_coord_matrix),u_is_text:new c.aH(g,a.u_is_text),u_pitch_with_map:new c.aH(g,a.u_pitch_with_map),u_is_along_line:new c.aH(g,a.u_is_along_line),u_is_variable_anchor:new c.aH(g,a.u_is_variable_anchor),u_texsize:new c.aM(g,a.u_texsize),u_texsize_icon:new c.aM(g,a.u_texsize_icon),u_texture:new c.aH(g,a.u_texture),u_texture_icon:new c.aH(g,a.u_texture_icon),u_gamma_scale:new c.aI(g,a.u_gamma_scale),u_device_pixel_ratio:new c.aI(g,a.u_device_pixel_ratio),u_is_halo:new c.aH(g,a.u_is_halo),u_translation:new c.aM(g,a.u_translation),u_pitched_scale:new c.aI(g,a.u_pitched_scale)}),background:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_opacity:new c.aI(g,a.u_opacity),u_color:new c.aN(g,a.u_color)}),backgroundPattern:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_opacity:new c.aI(g,a.u_opacity),u_image:new c.aH(g,a.u_image),u_pattern_tl_a:new c.aM(g,a.u_pattern_tl_a),u_pattern_br_a:new c.aM(g,a.u_pattern_br_a),u_pattern_tl_b:new c.aM(g,a.u_pattern_tl_b),u_pattern_br_b:new c.aM(g,a.u_pattern_br_b),u_texsize:new c.aM(g,a.u_texsize),u_mix:new c.aI(g,a.u_mix),u_pattern_size_a:new c.aM(g,a.u_pattern_size_a),u_pattern_size_b:new c.aM(g,a.u_pattern_size_b),u_scale_a:new c.aI(g,a.u_scale_a),u_scale_b:new c.aI(g,a.u_scale_b),u_pixel_coord_upper:new c.aM(g,a.u_pixel_coord_upper),u_pixel_coord_lower:new c.aM(g,a.u_pixel_coord_lower),u_tile_units_to_pixels:new c.aI(g,a.u_tile_units_to_pixels)}),terrain:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_texture:new c.aH(g,a.u_texture),u_ele_delta:new c.aI(g,a.u_ele_delta)}),terrainDepth:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_ele_delta:new c.aI(g,a.u_ele_delta)}),terrainCoords:(g,a)=>({u_matrix:new c.aJ(g,a.u_matrix),u_texture:new c.aH(g,a.u_texture),u_terrain_coords_id:new c.aI(g,a.u_terrain_coords_id),u_ele_delta:new c.aI(g,a.u_ele_delta)})};class Ou{constructor(a,d,p){this.context=a;const _=a.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Vl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Rs{constructor(a,d,p,_){this.length=d.length,this.attributes=p,this.itemSize=d.bytesPerElement,this.dynamicDraw=_,this.context=a;const v=a.gl;this.buffer=v.createBuffer(),a.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){if(a.length!==this.length)throw new Error(`Length of new data is ${a.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,d){for(let p=0;p<this.attributes.length;p++){const _=d.attributes[this.attributes[p].name];_!==void 0&&a.enableVertexAttribArray(_)}}setVertexAttribPointers(a,d,p){for(let _=0;_<this.attributes.length;_++){const v=this.attributes[_],T=d.attributes[v.name];T!==void 0&&a.vertexAttribPointer(T,v.components,a[Vl[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Wi=new WeakMap;function lr(g){var a;if(Wi.has(g))return Wi.get(g);{const d=(a=g.getParameter(g.VERSION))===null||a===void 0?void 0:a.startsWith("WebGL 2.0");return Wi.set(g,d),d}}class sn{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Os extends sn{getDefault(){return c.aP.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class Zi extends sn{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class ki extends sn{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class Vh extends sn{getDefault(){return[!0,!0,!0,!0]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class as extends sn{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class jh extends sn{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class xt extends sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const d=this.current;(a.func!==d.func||a.ref!==d.ref||a.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class Qi extends sn{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class Ni extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=a,this.dirty=!1}}class Us extends sn{getDefault(){return[0,1]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class Sn extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=a,this.dirty=!1}}class Tr extends sn{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class jl extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.BLEND):d.disable(d.BLEND),this.current=a,this.dirty=!1}}class ql extends sn{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class Hl extends sn{getDefault(){return c.aP.transparent}set(a){const d=this.current;(a.r!==d.r||a.g!==d.g||a.b!==d.b||a.a!==d.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class _o extends sn{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class vs extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;a?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=a,this.dirty=!1}}class Uu extends sn{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class Nc extends sn{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}class qh extends sn{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}}class Wl extends sn{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class Vs extends sn{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const d=this.current;(a[0]!==d[0]||a[1]!==d[1]||a[2]!==d[2]||a[3]!==d[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Rc extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class go extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class Vu extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Oc extends sn{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class ju extends sn{getDefault(){return null}set(a){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class qu extends sn{getDefault(){return null}set(a){var d;if(a===this.current&&!this.dirty)return;const p=this.gl;lr(p)?p.bindVertexArray(a):(d=p.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(a),this.current=a,this.dirty=!1}}class nr extends sn{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class Xo extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class Zl extends sn{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class yo extends sn{constructor(a,d){super(a),this.context=a,this.parent=d}getDefault(){return null}}class Ca extends yo{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class Qo extends yo{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class Uc extends yo{set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class $o{constructor(a,d,p,_,v){this.context=a,this.width=d,this.height=p;const T=a.gl,k=this.framebuffer=T.createFramebuffer();if(this.colorAttachment=new Ca(a,k),_)this.depthAttachment=v?new Uc(a,k):new Qo(a,k);else if(v)throw new Error("Stencil cannot be set without depth");if(T.checkFramebufferStatus(T.FRAMEBUFFER)!==T.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const a=this.context.gl,d=this.colorAttachment.get();if(d&&a.deleteTexture(d),this.depthAttachment){const p=this.depthAttachment.get();p&&a.deleteRenderbuffer(p)}a.deleteFramebuffer(this.framebuffer)}}class vi{constructor(a,d,p){this.blendFunction=a,this.blendColor=d,this.mask=p}}vi.Replace=[1,0],vi.disabled=new vi(vi.Replace,c.aP.transparent,[!1,!1,!1,!1]),vi.unblended=new vi(vi.Replace,c.aP.transparent,[!0,!0,!0,!0]),vi.alphaBlended=new vi([1,771],c.aP.transparent,[!0,!0,!0,!0]);class Vc{constructor(a){var d,p;if(this.gl=a,this.clearColor=new Os(this),this.clearDepth=new Zi(this),this.clearStencil=new ki(this),this.colorMask=new Vh(this),this.depthMask=new as(this),this.stencilMask=new jh(this),this.stencilFunc=new xt(this),this.stencilOp=new Qi(this),this.stencilTest=new Ni(this),this.depthRange=new Us(this),this.depthTest=new Sn(this),this.depthFunc=new Tr(this),this.blend=new jl(this),this.blendFunc=new ql(this),this.blendColor=new Hl(this),this.blendEquation=new _o(this),this.cullFace=new vs(this),this.cullFaceSide=new Uu(this),this.frontFace=new Nc(this),this.program=new qh(this),this.activeTexture=new Wl(this),this.viewport=new Vs(this),this.bindFramebuffer=new Rc(this),this.bindRenderbuffer=new go(this),this.bindTexture=new Vu(this),this.bindVertexBuffer=new Oc(this),this.bindElementBuffer=new ju(this),this.bindVertexArray=new qu(this),this.pixelStoreUnpack=new nr(this),this.pixelStoreUnpackPremultiplyAlpha=new Xo(this),this.pixelStoreUnpackFlipY=new Zl(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE),lr(a)){this.HALF_FLOAT=a.HALF_FLOAT;const _=a.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=a.RGBA16F)!==null&&d!==void 0?d:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(p=a.RGB16F)!==null&&p!==void 0?p:_==null?void 0:_.RGB16F_EXT,a.getExtension("EXT_color_buffer_float")}else{a.getExtension("EXT_color_buffer_half_float"),a.getExtension("OES_texture_half_float_linear");const _=a.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,d){return new Ou(this,a,d)}createVertexBuffer(a,d,p){return new Rs(this,a,d,p)}createRenderbuffer(a,d,p){const _=this.gl,v=_.createRenderbuffer();return this.bindRenderbuffer.set(v),_.renderbufferStorage(_.RENDERBUFFER,a,d,p),this.bindRenderbuffer.set(null),v}createFramebuffer(a,d,p,_){return new $o(this,a,d,p,_)}clear({color:a,depth:d,stencil:p}){const _=this.gl;let v=0;a&&(v|=_.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(v|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),p!==void 0&&(v|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(v)}setCullFace(a){a.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){c.aE(a.blendFunction,vi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}createVertexArray(){var a;return lr(this.gl)?this.gl.createVertexArray():(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.createVertexArrayOES()}deleteVertexArray(a){var d;return lr(this.gl)?this.gl.deleteVertexArray(a):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(a)}unbindVAO(){this.bindVertexArray.set(null)}}class dn{constructor(a,d,p){this.func=a,this.mask=d,this.range=p}}dn.ReadOnly=!1,dn.ReadWrite=!0,dn.disabled=new dn(519,dn.ReadOnly,[0,1]);const js=7680;class xi{constructor(a,d,p,_,v,T){this.test=a,this.ref=d,this.mask=p,this.fail=_,this.depthFail=v,this.pass=T}}xi.disabled=new xi({func:519,mask:0},0,0,js,js,js);class oi{constructor(a,d,p){this.enable=a,this.mode=d,this.frontFace=p}}let bo;function Hu(g,a,d,p,_){const v=g.context,T=v.gl,k=g.useProgram("collisionBox"),E=[];let L=0,R=0;for(let pe=0;pe<p.length;pe++){const ve=p[pe],ce=a.getTile(ve).getBucket(d);if(!ce)continue;const Se=_?ce.textCollisionBox:ce.iconCollisionBox,ze=ce.collisionCircleArray;if(ze.length>0){const Oe=c.F();c.aQ(Oe,ce.placementInvProjMatrix,g.transform.glCoordMatrix),c.aQ(Oe,Oe,ce.placementViewportMatrix),E.push({circleArray:ze,circleOffset:R,transform:ve.posMatrix,invTransform:Oe,coord:ve}),L+=ze.length/4,R=L}Se&&k.draw(v,T.LINES,dn.disabled,xi.disabled,g.colorModeForRenderPass(),oi.disabled,{u_matrix:ve.posMatrix,u_pixel_extrude_scale:[1/(N=g.transform).width,1/N.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(ve),d.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,null,g.transform.zoom,null,null,Se.collisionVertexBuffer)}var N;if(!_||!E.length)return;const W=g.useProgram("collisionCircle"),X=new c.aR;X.resize(4*L),X._trim();let te=0;for(const pe of E)for(let ve=0;ve<pe.circleArray.length/4;ve++){const ce=4*ve,Se=pe.circleArray[ce+0],ze=pe.circleArray[ce+1],Oe=pe.circleArray[ce+2],Qe=pe.circleArray[ce+3];X.emplace(te++,Se,ze,Oe,Qe,0),X.emplace(te++,Se,ze,Oe,Qe,1),X.emplace(te++,Se,ze,Oe,Qe,2),X.emplace(te++,Se,ze,Oe,Qe,3)}(!bo||bo.length<2*L)&&(bo=function(pe){const ve=2*pe,ce=new c.aT;ce.resize(ve),ce._trim();for(let Se=0;Se<ve;Se++){const ze=6*Se;ce.uint16[ze+0]=4*Se+0,ce.uint16[ze+1]=4*Se+1,ce.uint16[ze+2]=4*Se+2,ce.uint16[ze+3]=4*Se+2,ce.uint16[ze+4]=4*Se+3,ce.uint16[ze+5]=4*Se+0}return ce}(L));const ue=v.createIndexBuffer(bo,!0),re=v.createVertexBuffer(X,c.aS.members,!0);for(const pe of E){const ve=Fu(pe.transform,pe.invTransform,g.transform);W.draw(v,T.TRIANGLES,dn.disabled,xi.disabled,g.colorModeForRenderPass(),oi.disabled,ve,g.style.map.terrain&&g.style.map.terrain.getTerrainData(pe.coord),d.id,re,ue,c.$.simpleSegment(0,2*pe.circleOffset,pe.circleArray.length,pe.circleArray.length/2),null,g.transform.zoom,null,null,null)}re.destroy(),ue.destroy()}oi.disabled=new oi(!1,1029,2305),oi.backCCW=new oi(!0,1029,2305);const el=c.an(new Float32Array(16));function jc(g,a,d,p,_,v){const{horizontalAlign:T,verticalAlign:k}=c.au(g);return new c.P((-(T-.5)*a/_+p[0])*v,(-(k-.5)*d/_+p[1])*v)}function Wu(g,a,d,p,_,v){const T=a.tileAnchorPoint.add(new c.P(a.translation[0],a.translation[1]));if(a.pitchWithMap){let k=p.mult(v);return d||(k=k.rotate(-_)),Oi(T.add(k),a.labelPlaneMatrix,a.getElevation).point}if(d){const k=de(a.tileAnchorPoint.x+1,a.tileAnchorPoint.y,a).point.sub(g),E=Math.atan(k.y/k.x)+(k.x<0?Math.PI:0);return g.add(p.rotate(E))}return g.add(p)}function vo(g,a,d,p,_,v,T,k,E,L,R,N,W,X){const te=g.text.placedSymbolArray,ue=g.text.dynamicLayoutVertexArray,re=g.icon.dynamicLayoutVertexArray,pe={};ue.clear();for(let ve=0;ve<te.length;ve++){const ce=te.get(ve),Se=ce.hidden||!ce.crossTileID||g.allowVerticalPlacement&&!ce.placedOrientation?null:p[ce.crossTileID];if(Se){const ze=new c.P(ce.anchorX,ce.anchorY),Oe={getElevation:X,width:_.width,height:_.height,labelPlaneMatrix:v,lineVertexArray:null,pitchWithMap:d,projection:R,projectionCache:null,tileAnchorPoint:ze,translation:N,unwrappedTileID:W},Qe=d?Oi(ze,T,X):de(ze.x,ze.y,Oe),ft=ie(_.cameraToCenterDistance,Qe.signedDistanceFromCamera);let Et=c.ai(g.textSizeData,E,ce)*ft/c.ap;d&&(Et*=g.tilePixelRatio/k);const{width:Dt,height:pt,anchor:_t,textOffset:jt,textBoxScale:rn}=Se,bt=jc(_t,Dt,pt,jt,rn,Et),St=R.getPitchedTextCorrection(_,ze.add(new c.P(N[0],N[1])),W),$t=Wu(Qe.point,Oe,a,bt,_.angle,St),Ei=g.allowVerticalPlacement&&ce.placedOrientation===c.ah.vertical?Math.PI/2:0;for(let xn=0;xn<ce.numGlyphs;xn++)c.aj(ue,$t,Ei);L&&ce.associatedIconIndex>=0&&(pe[ce.associatedIconIndex]={shiftedAnchor:$t,angle:Ei})}else Ft(ce.numGlyphs,ue)}if(L){re.clear();const ve=g.icon.placedSymbolArray;for(let ce=0;ce<ve.length;ce++){const Se=ve.get(ce);if(Se.hidden)Ft(Se.numGlyphs,re);else{const ze=pe[ce];if(ze)for(let Oe=0;Oe<Se.numGlyphs;Oe++)c.aj(re,ze.shiftedAnchor,ze.angle);else Ft(Se.numGlyphs,re)}}g.icon.dynamicLayoutVertexBuffer.updateData(re)}g.text.dynamicLayoutVertexBuffer.updateData(ue)}function xo(g,a,d){return d.iconsInText&&a?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function tl(g,a,d,p,_,v,T,k,E,L,R,N){const W=g.context,X=W.gl,te=g.transform,ue=wr(),re=k==="map",pe=E==="map",ve=k!=="viewport"&&d.layout.get("symbol-placement")!=="point",ce=re&&!pe&&!ve,Se=!pe&&ve,ze=!d.layout.get("symbol-sort-key").isConstant();let Oe=!1;const Qe=g.depthModeForSublayer(0,dn.ReadOnly),ft=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Et=[],Dt=ue.getCircleRadiusCorrection(te);for(const pt of p){const _t=a.getTile(pt),jt=_t.getBucket(d);if(!jt)continue;const rn=_?jt.text:jt.icon;if(!rn||!rn.segments.get().length||!rn.hasVisibleVertices)continue;const bt=rn.programConfigurations.get(d.id),St=_||jt.sdfIcons,$t=_?jt.textSizeData:jt.iconSizeData,Ei=pe||te.pitch!==0,xn=g.useProgram(xo(St,_,jt),bt),Dn=c.ag($t,te.zoom),Di=g.style.map.terrain&&g.style.map.terrain.getTerrainData(pt);let ta,xs,Pi,ka,_a=[0,0],na=null;if(_)xs=_t.glyphAtlasTexture,Pi=X.LINEAR,ta=_t.glyphAtlasTexture.size,jt.iconsInText&&(_a=_t.imageAtlasTexture.size,na=_t.imageAtlasTexture,ka=Ei||g.options.rotating||g.options.zooming||$t.kind==="composite"||$t.kind==="camera"?X.LINEAR:X.NEAREST);else{const Ui=d.layout.get("icon-size").constantOr(0)!==1||jt.iconsNeedLinear;xs=_t.imageAtlasTexture,Pi=St||g.options.rotating||g.options.zooming||Ui||Ei?X.LINEAR:X.NEAREST,ta=_t.imageAtlasTexture.size}const ia=Kt(_t,1,g.transform.zoom),ws=Se?pt.posMatrix:el,Ql=qi(ws,pe,re,g.transform,ia),od=ar(ws,pe,re,g.transform,ia),Xc=ar(pt.posMatrix,pe,re,g.transform,ia),$l=ue.translatePosition(g.transform,_t,v,T),ld=ft&&jt.hasTextData(),Gf=d.layout.get("icon-text-fit")!=="none"&&ld&&jt.hasIconData();if(ve){const Ui=g.style.map.terrain?(Yf,Cr)=>g.style.map.terrain.getElevation(pt,Yf,Cr):null,$c=d.layout.get("text-rotation-alignment")==="map";j(jt,pt.posMatrix,g,_,Ql,Xc,pe,L,$c,ue,pt.toUnwrapped(),te.width,te.height,$l,Ui)}const Zr=pt.posMatrix,Ss=_&&ft||Gf,sl=ve||Ss?el:Ql,Qc=od,ra=St&&d.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let aa;aa=St?jt.iconsInText?Oa($t.kind,Dn,ce,pe,ve,Ss,g,Zr,sl,Qc,$l,ta,_a,Dt):Aa($t.kind,Dn,ce,pe,ve,Ss,g,Zr,sl,Qc,$l,_,ta,!0,Dt):bs($t.kind,Dn,ce,pe,ve,Ss,g,Zr,sl,Qc,$l,_,ta,Dt);const zr={program:xn,buffers:rn,uniformValues:aa,atlasTexture:xs,atlasTextureIcon:na,atlasInterpolation:Pi,atlasInterpolationIcon:ka,isSDF:St,hasHalo:ra};if(ze&&jt.canOverlap){Oe=!0;const Ui=rn.segments.get();for(const $c of Ui)Et.push({segments:new c.$([$c]),sortKey:$c.sortKey,state:zr,terrainData:Di})}else Et.push({segments:rn.segments,sortKey:0,state:zr,terrainData:Di})}Oe&&Et.sort((pt,_t)=>pt.sortKey-_t.sortKey);for(const pt of Et){const _t=pt.state;if(W.activeTexture.set(X.TEXTURE0),_t.atlasTexture.bind(_t.atlasInterpolation,X.CLAMP_TO_EDGE),_t.atlasTextureIcon&&(W.activeTexture.set(X.TEXTURE1),_t.atlasTextureIcon&&_t.atlasTextureIcon.bind(_t.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),_t.isSDF){const jt=_t.uniformValues;_t.hasHalo&&(jt.u_is_halo=1,wo(_t.buffers,pt.segments,d,g,_t.program,Qe,R,N,jt,pt.terrainData)),jt.u_is_halo=0}wo(_t.buffers,pt.segments,d,g,_t.program,Qe,R,N,_t.uniformValues,pt.terrainData)}}function wo(g,a,d,p,_,v,T,k,E,L){const R=p.context;_.draw(R,R.gl.TRIANGLES,v,T,k,oi.disabled,E,L,d.id,g.layoutVertexBuffer,g.indexBuffer,a,d.paint,p.transform.zoom,g.programConfigurations.get(d.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Ua(g,a,d,p,_){if(!d||!p||!p.imageAtlas)return;const v=p.imageAtlas.patternPositions;let T=v[d.to.toString()],k=v[d.from.toString()];if(!T&&k&&(T=k),!k&&T&&(k=T),!T||!k){const E=_.getPaintProperty(a);T=v[E],k=v[E]}T&&k&&g.setConstantPatternPositions(T,k)}function qs(g,a,d,p,_,v,T){const k=g.context.gl,E="fill-pattern",L=d.paint.get(E),R=L&&L.constantOr(1),N=d.getCrossfadeParameters();let W,X,te,ue,re;T?(X=R&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=k.LINES):(X=R?"fillPattern":"fill",W=k.TRIANGLES);const pe=L.constantOr(null);for(const ve of p){const ce=a.getTile(ve);if(R&&!ce.patternsLoaded())continue;const Se=ce.getBucket(d);if(!Se)continue;const ze=Se.programConfigurations.get(d.id),Oe=g.useProgram(X,ze),Qe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ve);R&&(g.context.activeTexture.set(k.TEXTURE0),ce.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ze.updatePaintBuffers(N)),Ua(ze,E,pe,ce,d);const ft=Qe?ve:null,Et=g.translatePosMatrix(ft?ft.posMatrix:ve.posMatrix,ce,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(T){ue=Se.indexBuffer2,re=Se.segments2;const Dt=[k.drawingBufferWidth,k.drawingBufferHeight];te=X==="fillOutlinePattern"&&R?fo(Et,g,N,ce,Dt):is(Et,Dt)}else ue=Se.indexBuffer,re=Se.segments,te=R?Wr(Et,g,N,ce):Lr(Et);Oe.draw(g.context,W,_,g.stencilModeForClipping(ve),v,oi.disabled,te,Qe,d.id,Se.layoutVertexBuffer,ue,re,d.paint,g.transform.zoom,ze)}}function Mr(g,a,d,p,_,v,T){const k=g.context,E=k.gl,L="fill-extrusion-pattern",R=d.paint.get(L),N=R.constantOr(1),W=d.getCrossfadeParameters(),X=d.paint.get("fill-extrusion-opacity"),te=R.constantOr(null);for(const ue of p){const re=a.getTile(ue),pe=re.getBucket(d);if(!pe)continue;const ve=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ue),ce=pe.programConfigurations.get(d.id),Se=g.useProgram(N?"fillExtrusionPattern":"fillExtrusion",ce);N&&(g.context.activeTexture.set(E.TEXTURE0),re.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ce.updatePaintBuffers(W)),Ua(ce,L,te,re,d);const ze=g.translatePosMatrix(ue.posMatrix,re,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Oe=d.paint.get("fill-extrusion-vertical-gradient"),Qe=N?Ra(ze,g,Oe,X,ue,W,re):Hi(ze,g,Oe,X);Se.draw(k,k.gl.TRIANGLES,_,v,T,oi.backCCW,Qe,ve,d.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,d.paint,g.transform.zoom,ce,g.style.map.terrain&&pe.centroidVertexBuffer)}}function Gl(g,a,d,p,_,v,T){const k=g.context,E=k.gl,L=d.fbo;if(!L)return;const R=g.useProgram("hillshade"),N=g.style.map.terrain&&g.style.map.terrain.getTerrainData(a);k.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,L.colorAttachment.get()),R.draw(k,E.TRIANGLES,_,v,T,oi.disabled,((W,X,te,ue)=>{const re=te.paint.get("hillshade-shadow-color"),pe=te.paint.get("hillshade-highlight-color"),ve=te.paint.get("hillshade-accent-color");let ce=te.paint.get("hillshade-illumination-direction")*(Math.PI/180);te.paint.get("hillshade-illumination-anchor")==="viewport"&&(ce-=W.transform.angle);const Se=!W.options.moving;return{u_matrix:ue?ue.posMatrix:W.transform.calculatePosMatrix(X.tileID.toUnwrapped(),Se),u_image:0,u_latrange:Ol(0,X.tileID),u_light:[te.paint.get("hillshade-exaggeration"),ce],u_shadow:re,u_highlight:pe,u_accent:ve}})(g,d,p,N?a:null),N,p.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function Zu(g,a,d,p,_,v){const T=g.context,k=T.gl,E=a.dem;if(E&&E.data){const L=E.dim,R=E.stride,N=E.getPixels();if(T.activeTexture.set(k.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||g.getTileTexture(R),a.demTexture){const X=a.demTexture;X.update(N,{premultiply:!1}),X.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else a.demTexture=new Y(T,N,k.RGBA,{premultiply:!1}),a.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);T.activeTexture.set(k.TEXTURE0);let W=a.fbo;if(!W){const X=new Y(T,{width:L,height:L,data:null},k.RGBA);X.bind(k.LINEAR,k.CLAMP_TO_EDGE),W=a.fbo=T.createFramebuffer(L,L,!0,!1),W.colorAttachment.set(X.texture)}T.bindFramebuffer.set(W.framebuffer),T.viewport.set([0,0,L,L]),g.useProgram("hillshadePrepare").draw(T,k.TRIANGLES,p,_,v,oi.disabled,((X,te)=>{const ue=te.stride,re=c.F();return c.aO(re,0,c.W,-c.W,0,0,1),c.H(re,re,[0,-c.W,0]),{u_matrix:re,u_image:1,u_dimension:[ue,ue],u_zoom:X.overscaledZ,u_unpack:te.getUnpackVector()}})(a.tileID,E),null,d.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function qc(g,a,d,p,_,v){const T=p.paint.get("raster-fade-duration");if(!v&&T>0){const k=M.now(),E=(k-g.timeAdded)/T,L=a?(k-a.timeAdded)/T:-1,R=d.getSource(),N=_.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),W=!a||Math.abs(a.tileID.overscaledZ-N)>Math.abs(g.tileID.overscaledZ-N),X=W&&g.refreshedUponExpiration?1:c.ac(W?E:1-L,0,1);return g.refreshedUponExpiration&&E>=1&&(g.refreshedUponExpiration=!1),a?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}const Ar=new c.aP(1,0,0,1),Hh=new c.aP(0,1,0,1),Wh=new c.aP(0,0,1,1),Gu=new c.aP(1,0,1,1),Zh=new c.aP(0,1,1,1);function Mf(g,a,d,p){So(g,0,a+d/2,g.transform.width,d,p)}function Yl(g,a,d,p){So(g,a-d/2,0,d,g.transform.height,p)}function So(g,a,d,p,_,v){const T=g.context,k=T.gl;k.enable(k.SCISSOR_TEST),k.scissor(a*g.pixelRatio,d*g.pixelRatio,p*g.pixelRatio,_*g.pixelRatio),T.clear({color:v}),k.disable(k.SCISSOR_TEST)}function Ym(g,a,d){const p=g.context,_=p.gl,v=d.posMatrix,T=g.useProgram("debug"),k=dn.disabled,E=xi.disabled,L=g.colorModeForRenderPass(),R="$debug",N=g.style.map.terrain&&g.style.map.terrain.getTerrainData(d);p.activeTexture.set(_.TEXTURE0);const W=a.getTileByID(d.key).latestRawTileData,X=Math.floor((W&&W.byteLength||0)/1024),te=a.getTile(d).tileSize,ue=512/Math.min(te,512)*(d.overscaledZ/g.transform.zoom)*.5;let re=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(re+=` => ${d.overscaledZ}`),function(pe,ve){pe.initDebugOverlayCanvas();const ce=pe.debugOverlayCanvas,Se=pe.context.gl,ze=pe.debugOverlayCanvas.getContext("2d");ze.clearRect(0,0,ce.width,ce.height),ze.shadowColor="white",ze.shadowBlur=2,ze.lineWidth=1.5,ze.strokeStyle="white",ze.textBaseline="top",ze.font="bold 36px Open Sans, sans-serif",ze.fillText(ve,5,5),ze.strokeText(ve,5,5),pe.debugOverlayTexture.update(ce),pe.debugOverlayTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE)}(g,`${re} ${X}kB`),T.draw(p,_.TRIANGLES,k,E,vi.alphaBlended,oi.disabled,rs(v,c.aP.transparent,ue),null,R,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),T.draw(p,_.LINE_STRIP,k,E,L,oi.disabled,rs(v,c.aP.red),N,R,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function Gh(g,a,d){const p=g.context,_=p.gl,v=g.colorModeForRenderPass(),T=new dn(_.LEQUAL,dn.ReadWrite,g.depthRangeFor3D),k=g.useProgram("terrain"),E=a.getTerrainMesh();p.bindFramebuffer.set(null),p.viewport.set([0,0,g.width,g.height]);for(const L of d){const R=g.renderToTexture.getTexture(L),N=a.getTerrainData(L.tileID);p.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,R.texture);const W={u_matrix:g.transform.calculatePosMatrix(L.tileID.toUnwrapped()),u_texture:0,u_ele_delta:a.getMeshFrameDelta(g.transform.zoom)};k.draw(p,_.TRIANGLES,T,xi.disabled,v,oi.backCCW,W,N,"terrain",E.vertexBuffer,E.indexBuffer,E.segments)}}class Qn{constructor(a,d){this.context=new Vc(a),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ne.maxUnderzooming+Ne.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Xn}resize(a,d,p){if(this.width=Math.floor(a*p),this.height=Math.floor(d*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const a=this.context,d=new c.aW;d.emplaceBack(0,0),d.emplaceBack(c.W,0),d.emplaceBack(0,c.W),d.emplaceBack(c.W,c.W),this.tileExtentBuffer=a.createVertexBuffer(d,Qr.members),this.tileExtentSegments=c.$.simpleSegment(0,0,4,2);const p=new c.aW;p.emplaceBack(0,0),p.emplaceBack(c.W,0),p.emplaceBack(0,c.W),p.emplaceBack(c.W,c.W),this.debugBuffer=a.createVertexBuffer(p,Qr.members),this.debugSegments=c.$.simpleSegment(0,0,4,5);const _=new c.Z;_.emplaceBack(0,0,0,0),_.emplaceBack(c.W,0,c.W,0),_.emplaceBack(0,c.W,0,c.W),_.emplaceBack(c.W,c.W,c.W,c.W),this.rasterBoundsBuffer=a.createVertexBuffer(_,An.members),this.rasterBoundsSegments=c.$.simpleSegment(0,0,4,2);const v=new c.aW;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(v,Qr.members),this.viewportSegments=c.$.simpleSegment(0,0,4,2);const T=new c.aX;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(T);const k=new c.aY;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(k);const E=this.context.gl;this.stencilClearMode=new xi({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO)}clearStencil(){const a=this.context,d=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=c.F();c.aO(p,0,this.width,this.height,0,0,1),c.J(p,p,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,d.TRIANGLES,dn.disabled,this.stencilClearMode,vi.disabled,oi.disabled,ms(p),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(a,d){if(this.currentStencilSource===a.source||!a.isTileClipped()||!d||!d.length)return;this.currentStencilSource=a.source;const p=this.context,_=p.gl;this.nextStencilID+d.length>256&&this.clearStencil(),p.setColorMode(vi.disabled),p.setDepthMode(dn.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of d){const k=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(T);v.draw(p,_.TRIANGLES,dn.disabled,new xi({func:_.ALWAYS,mask:0},k,255,_.KEEP,_.KEEP,_.REPLACE),vi.disabled,oi.disabled,ms(T.posMatrix),E,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,d=this.context.gl;return new xi({func:d.NOTEQUAL,mask:255},a,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(a){const d=this.context.gl;return new xi({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(a){const d=this.context.gl,p=a.sort((T,k)=>k.overscaledZ-T.overscaledZ),_=p[p.length-1].overscaledZ,v=p[0].overscaledZ-_+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const T={};for(let k=0;k<v;k++)T[k+_]=new xi({func:d.GEQUAL,mask:255},k+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=v,[T,p]}return[{[_]:xi.disabled},p]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new vi([a.CONSTANT_COLOR,a.ONE],new c.aP(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?vi.unblended:vi.alphaBlended}depthModeForSublayer(a,d,p){if(!this.opaquePassEnabledForLayer())return dn.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new dn(p||this.context.gl.LEQUAL,d,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,d){this.style=a,this.options=d,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(M.now()),this.imageManager.beginFrame();const p=this.style._order,_=this.style.sourceCaches,v={},T={},k={};for(const E in _){const L=_[E];L.used&&L.prepare(this.context),v[E]=L.getVisibleCoordinates(),T[E]=v[E].slice().reverse(),k[E]=L.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<p.length;E++)if(this.style._layers[p[E]].is3D()){this.opaquePassCutoff=E;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const E of p){const L=this.style._layers[E];if(!L.hasOffscreenPass()||L.isHidden(this.transform.zoom))continue;const R=T[L.source];(L.type==="custom"||R.length)&&this.renderLayer(this,_[L.source],L,R)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?c.aP.black:c.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[p[this.currentLayer]],L=_[E.source],R=v[E.source];this._renderTileClippingMasks(E,R),this.renderLayer(this,L,E,R)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const E=this.style._layers[p[this.currentLayer]],L=_[E.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(E))continue;const R=(E.type==="symbol"?k:T)[E.source];this._renderTileClippingMasks(E,v[E.source]),this.renderLayer(this,L,E,R)}if(this.options.showTileBoundaries){const E=function(L,R){let N=null;const W=Object.values(L._layers).flatMap(re=>re.source&&!re.isHidden(R)?[L.sourceCaches[re.source]]:[]),X=W.filter(re=>re.getSource().type==="vector"),te=W.filter(re=>re.getSource().type!=="vector"),ue=re=>{(!N||N.getSource().maxzoom<re.getSource().maxzoom)&&(N=re)};return X.forEach(re=>ue(re)),N||te.forEach(re=>ue(re)),N}(this.style,this.transform.zoom);E&&function(L,R,N){for(let W=0;W<N.length;W++)Ym(L,R,N[W])}(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const L=E.transform.padding;Mf(E,E.transform.height-(L.top||0),3,Ar),Mf(E,L.bottom||0,3,Hh),Yl(E,L.left||0,3,Wh),Yl(E,E.transform.width-(L.right||0),3,Gu);const R=E.transform.centerPoint;(function(N,W,X,te){So(N,W-1,X-10,2,20,te),So(N,W-10,X-1,20,2,te)})(E,R.x,E.transform.height-R.y,Zh)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(a){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,p=this.transform.projMatrix;let _=this.terrainFacilitator.dirty;_||(_=a?!c.aZ(d,p):!c.a_(d,p)),_||(_=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),_&&(c.a$(d,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(v,T){const k=v.context,E=k.gl,L=vi.unblended,R=new dn(E.LEQUAL,dn.ReadWrite,[0,1]),N=T.getTerrainMesh(),W=T.sourceCache.getRenderableTiles(),X=v.useProgram("terrainDepth");k.bindFramebuffer.set(T.getFramebuffer("depth").framebuffer),k.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),k.clear({color:c.aP.transparent,depth:1});for(const te of W){const ue=T.getTerrainData(te.tileID),re={u_matrix:v.transform.calculatePosMatrix(te.tileID.toUnwrapped()),u_ele_delta:T.getMeshFrameDelta(v.transform.zoom)};X.draw(k,E.TRIANGLES,R,xi.disabled,L,oi.backCCW,re,ue,"terrain",N.vertexBuffer,N.indexBuffer,N.segments)}k.bindFramebuffer.set(null),k.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain),function(v,T){const k=v.context,E=k.gl,L=vi.unblended,R=new dn(E.LEQUAL,dn.ReadWrite,[0,1]),N=T.getTerrainMesh(),W=T.getCoordsTexture(),X=T.sourceCache.getRenderableTiles(),te=v.useProgram("terrainCoords");k.bindFramebuffer.set(T.getFramebuffer("coords").framebuffer),k.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),k.clear({color:c.aP.transparent,depth:1}),T.coordsIndex=[];for(const ue of X){const re=T.getTerrainData(ue.tileID);k.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,W.texture);const pe={u_matrix:v.transform.calculatePosMatrix(ue.tileID.toUnwrapped()),u_terrain_coords_id:(255-T.coordsIndex.length)/255,u_texture:0,u_ele_delta:T.getMeshFrameDelta(v.transform.zoom)};te.draw(k,E.TRIANGLES,R,xi.disabled,L,oi.backCCW,pe,re,"terrain",N.vertexBuffer,N.indexBuffer,N.segments),T.coordsIndex.push(ue.tileID.key)}k.bindFramebuffer.set(null),k.viewport.set([0,0,v.width,v.height])}(this,this.style.map.terrain))}renderLayer(a,d,p,_){if(!p.isHidden(this.transform.zoom)&&(p.type==="background"||p.type==="custom"||(_||[]).length))switch(this.id=p.id,p.type){case"symbol":(function(v,T,k,E,L){if(v.renderPass!=="translucent")return;const R=xi.disabled,N=v.colorModeForRenderPass();(k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(W,X,te,ue,re,pe,ve,ce,Se){const ze=X.transform,Oe=wr(),Qe=re==="map",ft=pe==="map";for(const Et of W){const Dt=ue.getTile(Et),pt=Dt.getBucket(te);if(!pt||!pt.text||!pt.text.segments.get().length)continue;const _t=c.ag(pt.textSizeData,ze.zoom),jt=Kt(Dt,1,X.transform.zoom),rn=qi(Et.posMatrix,ft,Qe,X.transform,jt),bt=te.layout.get("icon-text-fit")!=="none"&&pt.hasIconData();if(_t){const St=Math.pow(2,ze.zoom-Dt.tileID.overscaledZ),$t=X.style.map.terrain?(xn,Dn)=>X.style.map.terrain.getElevation(Et,xn,Dn):null,Ei=Oe.translatePosition(ze,Dt,ve,ce);vo(pt,Qe,ft,Se,ze,rn,Et.posMatrix,St,_t,bt,Oe,Ei,Et.toUnwrapped(),$t)}}}(E,v,k,T,k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),L),k.paint.get("icon-opacity").constantOr(1)!==0&&tl(v,T,k,E,!1,k.paint.get("icon-translate"),k.paint.get("icon-translate-anchor"),k.layout.get("icon-rotation-alignment"),k.layout.get("icon-pitch-alignment"),k.layout.get("icon-keep-upright"),R,N),k.paint.get("text-opacity").constantOr(1)!==0&&tl(v,T,k,E,!0,k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.layout.get("text-keep-upright"),R,N),T.map.showCollisionBoxes&&(Hu(v,T,k,E,!0),Hu(v,T,k,E,!1))})(a,d,p,_,this.style.placement.variableOffsets);break;case"circle":(function(v,T,k,E){if(v.renderPass!=="translucent")return;const L=k.paint.get("circle-opacity"),R=k.paint.get("circle-stroke-width"),N=k.paint.get("circle-stroke-opacity"),W=!k.layout.get("circle-sort-key").isConstant();if(L.constantOr(1)===0&&(R.constantOr(1)===0||N.constantOr(1)===0))return;const X=v.context,te=X.gl,ue=v.depthModeForSublayer(0,dn.ReadOnly),re=xi.disabled,pe=v.colorModeForRenderPass(),ve=[];for(let ce=0;ce<E.length;ce++){const Se=E[ce],ze=T.getTile(Se),Oe=ze.getBucket(k);if(!Oe)continue;const Qe=Oe.programConfigurations.get(k.id),ft=v.useProgram("circle",Qe),Et=Oe.layoutVertexBuffer,Dt=Oe.indexBuffer,pt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Se),_t={programConfiguration:Qe,program:ft,layoutVertexBuffer:Et,indexBuffer:Dt,uniformValues:po(v,Se,ze,k),terrainData:pt};if(W){const jt=Oe.segments.get();for(const rn of jt)ve.push({segments:new c.$([rn]),sortKey:rn.sortKey,state:_t})}else ve.push({segments:Oe.segments,sortKey:0,state:_t})}W&&ve.sort((ce,Se)=>ce.sortKey-Se.sortKey);for(const ce of ve){const{programConfiguration:Se,program:ze,layoutVertexBuffer:Oe,indexBuffer:Qe,uniformValues:ft,terrainData:Et}=ce.state;ze.draw(X,te.TRIANGLES,ue,re,pe,oi.disabled,ft,Et,k.id,Oe,Qe,ce.segments,k.paint,v.transform.zoom,Se)}})(a,d,p,_);break;case"heatmap":(function(v,T,k,E){if(k.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const L=v.context,R=L.gl,N=xi.disabled,W=new vi([R.ONE,R.ONE],c.aP.transparent,[!0,!0,!0,!0]);(function(X,te,ue){const re=X.gl;X.activeTexture.set(re.TEXTURE1),X.viewport.set([0,0,te.width/4,te.height/4]);let pe=ue.heatmapFbo;if(pe)re.bindTexture(re.TEXTURE_2D,pe.colorAttachment.get()),X.bindFramebuffer.set(pe.framebuffer);else{const ve=re.createTexture();re.bindTexture(re.TEXTURE_2D,ve),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_S,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_WRAP_T,re.CLAMP_TO_EDGE),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,re.LINEAR),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,re.LINEAR),pe=ue.heatmapFbo=X.createFramebuffer(te.width/4,te.height/4,!1,!1),function(ce,Se,ze,Oe){var Qe,ft;const Et=ce.gl,Dt=(Qe=ce.HALF_FLOAT)!==null&&Qe!==void 0?Qe:Et.UNSIGNED_BYTE,pt=(ft=ce.RGBA16F)!==null&&ft!==void 0?ft:Et.RGBA;Et.texImage2D(Et.TEXTURE_2D,0,pt,Se.width/4,Se.height/4,0,Et.RGBA,Dt,null),Oe.colorAttachment.set(ze)}(X,te,ve,pe)}})(L,v,k),L.clear({color:c.aP.transparent});for(let X=0;X<E.length;X++){const te=E[X];if(T.hasRenderableParent(te))continue;const ue=T.getTile(te),re=ue.getBucket(k);if(!re)continue;const pe=re.programConfigurations.get(k.id),ve=v.useProgram("heatmap",pe),{zoom:ce}=v.transform;ve.draw(L,R.TRIANGLES,dn.disabled,N,W,oi.disabled,ma(te.posMatrix,ue,ce,k.paint.get("heatmap-intensity")),null,k.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,k.paint,v.transform.zoom,pe)}L.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(L,R){const N=L.context,W=N.gl,X=R.heatmapFbo;if(!X)return;N.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,X.colorAttachment.get()),N.activeTexture.set(W.TEXTURE1);let te=R.colorRampTexture;te||(te=R.colorRampTexture=new Y(N,R.colorRamp,W.RGBA)),te.bind(W.LINEAR,W.CLAMP_TO_EDGE),L.useProgram("heatmapTexture").draw(N,W.TRIANGLES,dn.disabled,xi.disabled,L.colorModeForRenderPass(),oi.disabled,((ue,re,pe,ve)=>{const ce=c.F();c.aO(ce,0,ue.width,ue.height,0,0,1);const Se=ue.context.gl;return{u_matrix:ce,u_world:[Se.drawingBufferWidth,Se.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:re.paint.get("heatmap-opacity")}})(L,R),null,R.id,L.viewportBuffer,L.quadTriangleIndexBuffer,L.viewportSegments,R.paint,L.transform.zoom)}(v,k))})(a,d,p,_);break;case"line":(function(v,T,k,E){if(v.renderPass!=="translucent")return;const L=k.paint.get("line-opacity"),R=k.paint.get("line-width");if(L.constantOr(1)===0||R.constantOr(1)===0)return;const N=v.depthModeForSublayer(0,dn.ReadOnly),W=v.colorModeForRenderPass(),X=k.paint.get("line-dasharray"),te=k.paint.get("line-pattern"),ue=te.constantOr(1),re=k.paint.get("line-gradient"),pe=k.getCrossfadeParameters(),ve=ue?"linePattern":X?"lineSDF":re?"lineGradient":"line",ce=v.context,Se=ce.gl;let ze=!0;for(const Oe of E){const Qe=T.getTile(Oe);if(ue&&!Qe.patternsLoaded())continue;const ft=Qe.getBucket(k);if(!ft)continue;const Et=ft.programConfigurations.get(k.id),Dt=v.context.program.get(),pt=v.useProgram(ve,Et),_t=ze||pt.program!==Dt,jt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Oe),rn=te.constantOr(null);if(rn&&Qe.imageAtlas){const $t=Qe.imageAtlas,Ei=$t.patternPositions[rn.to.toString()],xn=$t.patternPositions[rn.from.toString()];Ei&&xn&&Et.setConstantPatternPositions(Ei,xn)}const bt=jt?Oe:null,St=ue?_s(v,Qe,k,pe,bt):X?Jo(v,Qe,k,X,pe,bt):re?Fi(v,Qe,k,ft.lineClipsArray.length,bt):Ir(v,Qe,k,bt);if(ue)ce.activeTexture.set(Se.TEXTURE0),Qe.imageAtlasTexture.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),Et.updatePaintBuffers(pe);else if(X&&(_t||v.lineAtlas.dirty))ce.activeTexture.set(Se.TEXTURE0),v.lineAtlas.bind(ce);else if(re){const $t=ft.gradients[k.id];let Ei=$t.texture;if(k.gradientVersion!==$t.version){let xn=256;if(k.stepInterpolant){const Dn=T.getSource().maxzoom,Di=Oe.canonical.z===Dn?Math.ceil(1<<v.transform.maxZoom-Oe.canonical.z):1;xn=c.ac(c.aU(ft.maxLineLength/c.W*1024*Di),256,ce.maxTextureSize)}$t.gradient=c.aV({expression:k.gradientExpression(),evaluationKey:"lineProgress",resolution:xn,image:$t.gradient||void 0,clips:ft.lineClipsArray}),$t.texture?$t.texture.update($t.gradient):$t.texture=new Y(ce,$t.gradient,Se.RGBA),$t.version=k.gradientVersion,Ei=$t.texture}ce.activeTexture.set(Se.TEXTURE0),Ei.bind(k.stepInterpolant?Se.NEAREST:Se.LINEAR,Se.CLAMP_TO_EDGE)}pt.draw(ce,Se.TRIANGLES,N,v.stencilModeForClipping(Oe),W,oi.disabled,St,jt,k.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,k.paint,v.transform.zoom,Et,ft.layoutVertexBuffer2),ze=!1}})(a,d,p,_);break;case"fill":(function(v,T,k,E){const L=k.paint.get("fill-color"),R=k.paint.get("fill-opacity");if(R.constantOr(1)===0)return;const N=v.colorModeForRenderPass(),W=k.paint.get("fill-pattern"),X=v.opaquePassEnabledForLayer()&&!W.constantOr(1)&&L.constantOr(c.aP.transparent).a===1&&R.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===X){const te=v.depthModeForSublayer(1,v.renderPass==="opaque"?dn.ReadWrite:dn.ReadOnly);qs(v,T,k,E,te,N,!1)}if(v.renderPass==="translucent"&&k.paint.get("fill-antialias")){const te=v.depthModeForSublayer(k.getPaintProperty("fill-outline-color")?2:0,dn.ReadOnly);qs(v,T,k,E,te,N,!0)}})(a,d,p,_);break;case"fill-extrusion":(function(v,T,k,E){const L=k.paint.get("fill-extrusion-opacity");if(L!==0&&v.renderPass==="translucent"){const R=new dn(v.context.gl.LEQUAL,dn.ReadWrite,v.depthRangeFor3D);if(L!==1||k.paint.get("fill-extrusion-pattern").constantOr(1))Mr(v,T,k,E,R,xi.disabled,vi.disabled),Mr(v,T,k,E,R,v.stencilModeFor3D(),v.colorModeForRenderPass());else{const N=v.colorModeForRenderPass();Mr(v,T,k,E,R,xi.disabled,N)}}})(a,d,p,_);break;case"hillshade":(function(v,T,k,E){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const L=v.context,R=v.depthModeForSublayer(0,dn.ReadOnly),N=v.colorModeForRenderPass(),[W,X]=v.renderPass==="translucent"?v.stencilConfigForOverlap(E):[{},E];for(const te of X){const ue=T.getTile(te);ue.needsHillshadePrepare!==void 0&&ue.needsHillshadePrepare&&v.renderPass==="offscreen"?Zu(v,ue,k,R,xi.disabled,N):v.renderPass==="translucent"&&Gl(v,te,ue,k,R,W[te.overscaledZ],N)}L.viewport.set([0,0,v.width,v.height])})(a,d,p,_);break;case"raster":(function(v,T,k,E){if(v.renderPass!=="translucent"||k.paint.get("raster-opacity")===0||!E.length)return;const L=v.context,R=L.gl,N=T.getSource(),W=v.useProgram("raster"),X=v.colorModeForRenderPass(),[te,ue]=N instanceof yr?[{},E]:v.stencilConfigForOverlap(E),re=ue[ue.length-1].overscaledZ,pe=!v.options.moving;for(const ve of ue){const ce=v.depthModeForSublayer(ve.overscaledZ-re,k.paint.get("raster-opacity")===1?dn.ReadWrite:dn.ReadOnly,R.LESS),Se=T.getTile(ve);Se.registerFadeDuration(k.paint.get("raster-fade-duration"));const ze=T.findLoadedParent(ve,0),Oe=T.findLoadedSibling(ve),Qe=qc(Se,ze||Oe||null,T,k,v.transform,v.style.map.terrain);let ft,Et;const Dt=k.paint.get("raster-resampling")==="nearest"?R.NEAREST:R.LINEAR;L.activeTexture.set(R.TEXTURE0),Se.texture.bind(Dt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),L.activeTexture.set(R.TEXTURE1),ze?(ze.texture.bind(Dt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST),ft=Math.pow(2,ze.tileID.overscaledZ-Se.tileID.overscaledZ),Et=[Se.tileID.canonical.x*ft%1,Se.tileID.canonical.y*ft%1]):Se.texture.bind(Dt,R.CLAMP_TO_EDGE,R.LINEAR_MIPMAP_NEAREST);const pt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(ve),_t=pt?ve:null,jt=_t?_t.posMatrix:v.transform.calculatePosMatrix(ve.toUnwrapped(),pe),rn=ys(jt,Et||[0,0],ft||1,Qe,k);N instanceof yr?W.draw(L,R.TRIANGLES,ce,xi.disabled,X,oi.disabled,rn,pt,k.id,N.boundsBuffer,v.quadTriangleIndexBuffer,N.boundsSegments):W.draw(L,R.TRIANGLES,ce,te[ve.overscaledZ],X,oi.disabled,rn,pt,k.id,v.rasterBoundsBuffer,v.quadTriangleIndexBuffer,v.rasterBoundsSegments)}})(a,d,p,_);break;case"background":(function(v,T,k,E){const L=k.paint.get("background-color"),R=k.paint.get("background-opacity");if(R===0)return;const N=v.context,W=N.gl,X=v.transform,te=X.tileSize,ue=k.paint.get("background-pattern");if(v.isPatternMissing(ue))return;const re=!ue&&L.a===1&&R===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==re)return;const pe=xi.disabled,ve=v.depthModeForSublayer(0,re==="opaque"?dn.ReadWrite:dn.ReadOnly),ce=v.colorModeForRenderPass(),Se=v.useProgram(ue?"backgroundPattern":"background"),ze=E||X.coveringTiles({tileSize:te,terrain:v.style.map.terrain});ue&&(N.activeTexture.set(W.TEXTURE0),v.imageManager.bind(v.context));const Oe=k.getCrossfadeParameters();for(const Qe of ze){const ft=E?Qe.posMatrix:v.transform.calculatePosMatrix(Qe.toUnwrapped()),Et=ue?Ru(ft,R,v,ue,{tileID:Qe,tileSize:te},Oe):mo(ft,R,L),Dt=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Qe);Se.draw(N,W.TRIANGLES,ve,pe,ce,oi.disabled,Et,Dt,k.id,v.tileExtentBuffer,v.quadTriangleIndexBuffer,v.tileExtentSegments)}})(a,0,p,_);break;case"custom":(function(v,T,k){const E=v.context,L=k.implementation;if(v.renderPass==="offscreen"){const R=L.prerender;R&&(v.setCustomLayerDefaults(),E.setColorMode(v.colorModeForRenderPass()),R.call(L,E.gl,v.transform.customLayerMatrix()),E.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),E.setColorMode(v.colorModeForRenderPass()),E.setStencilMode(xi.disabled);const R=L.renderingMode==="3d"?new dn(v.context.gl.LEQUAL,dn.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,dn.ReadOnly);E.setDepthMode(R),L.render(E.gl,v.transform.customLayerMatrix()),E.setDirty(),v.setBaseState(),E.bindFramebuffer.set(null)}})(a,0,p)}}translatePosMatrix(a,d,p,_,v){if(!p[0]&&!p[1])return a;const T=v?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(T){const L=Math.sin(T),R=Math.cos(T);p=[p[0]*R-p[1]*L,p[0]*L+p[1]*R]}const k=[v?p[0]:Kt(d,p[0],this.transform.zoom),v?p[1]:Kt(d,p[1],this.transform.zoom),0],E=new Float32Array(16);return c.H(E,a,k),E}saveTileTexture(a){const d=this._tileTextures[a.size[0]];d?d.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const d=this._tileTextures[a];return d&&d.length>0?d.pop():null}isPatternMissing(a){if(!a)return!1;if(!a.from||!a.to)return!0;const d=this.imageManager.getPattern(a.from.toString()),p=this.imageManager.getPattern(a.to.toString());return!d||!p}useProgram(a,d){this.cache=this.cache||{};const p=a+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[p]||(this.cache[p]=new zt(this.context,$r[a],d,Ul[a],this._showOverdrawInspector,this.style.map.terrain)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Y(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:a,drawingBufferHeight:d}=this.context.gl;return this.width!==a||this.height!==d}}class Hc{constructor(a,d){this.points=a,this.planes=d}static fromInvProjectionMatrix(a,d,p){const _=Math.pow(2,p),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const E=1/(k=c.af([],k,a))[3]/d*_;return c.b0(k,k,[E,E,1/k[3],E])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const E=function(W,X){var te=X[0],ue=X[1],re=X[2],pe=te*te+ue*ue+re*re;return pe>0&&(pe=1/Math.sqrt(pe)),W[0]=X[0]*pe,W[1]=X[1]*pe,W[2]=X[2]*pe,W}([],function(W,X,te){var ue=X[0],re=X[1],pe=X[2],ve=te[0],ce=te[1],Se=te[2];return W[0]=re*Se-pe*ce,W[1]=pe*ve-ue*Se,W[2]=ue*ce-re*ve,W}([],ne([],v[k[0]],v[k[1]]),ne([],v[k[2]],v[k[1]]))),L=-((R=E)[0]*(N=v[k[1]])[0]+R[1]*N[1]+R[2]*N[2]);var R,N;return E.concat(L)});return new Hc(v,T)}}class Yh{constructor(a,d){this.min=a,this.max=d,this.center=function(p,_,v){return p[0]=.5*_[0],p[1]=.5*_[1],p[2]=.5*_[2],p}([],function(p,_,v){return p[0]=_[0]+v[0],p[1]=_[1]+v[1],p[2]=_[2]+v[2],p}([],this.min,this.max))}quadrant(a){const d=[a%2==0,a<2],p=oe(this.min),_=oe(this.max);for(let v=0;v<d.length;v++)p[v]=d[v]?this.min[v]:this.center[v],_[v]=d[v]?this.center[v]:this.max[v];return _[2]=this.max[2],new Yh(p,_)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}intersects(a){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let p=!0;for(let _=0;_<a.planes.length;_++){const v=a.planes[_];let T=0;for(let k=0;k<d.length;k++)c.b1(v,d[k])>=0&&T++;if(T===0)return 0;T!==d.length&&(p=!1)}if(p)return 2;for(let _=0;_<3;_++){let v=Number.MAX_VALUE,T=-Number.MAX_VALUE;for(let k=0;k<a.points.length;k++){const E=a.points[k][_]-this.min[_];v=Math.min(v,E),T=Math.max(T,E)}if(T<0||v>this.max[_]-this.min[_])return 0}return 1}}class Yu{constructor(a=0,d=0,p=0,_=0){if(isNaN(a)||a<0||isNaN(d)||d<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=d,this.left=p,this.right=_}interpolate(a,d,p){return d.top!=null&&a.top!=null&&(this.top=c.z.number(a.top,d.top,p)),d.bottom!=null&&a.bottom!=null&&(this.bottom=c.z.number(a.bottom,d.bottom,p)),d.left!=null&&a.left!=null&&(this.left=c.z.number(a.left,d.left,p)),d.right!=null&&a.right!=null&&(this.right=c.z.number(a.right,d.right,p)),this}getCenter(a,d){const p=c.ac((this.left+a-this.right)/2,0,a),_=c.ac((this.top+d-this.bottom)/2,0,d);return new c.P(p,_)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Yu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Wc=85.051129;class Af{constructor(a,d,p,_,v){this.tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=a||0,this._maxZoom=d||22,this._minPitch=p??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Yu,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const a=new Af(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.apply(this),a}apply(a){this.tileSize=a.tileSize,this.latRange=a.latRange,this.width=a.width,this.height=a.height,this._center=a._center,this._elevation=a._elevation,this.minElevationForCurrentTile=a.minElevationForCurrentTile,this.zoom=a.zoom,this.angle=a.angle,this._fov=a._fov,this._pitch=a._pitch,this._unmodified=a._unmodified,this._edgeInsets=a._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(a){a===void 0?a=!0:a===null&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(a){const d=-c.b2(a,-180,180)*Math.PI/180;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=function(){var p=new c.A(4);return c.A!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p}(),function(p,_,v){var T=_[0],k=_[1],E=_[2],L=_[3],R=Math.sin(v),N=Math.cos(v);p[0]=T*N+E*R,p[1]=k*N+L*R,p[2]=T*-R+E*N,p[3]=k*-R+L*N}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const d=c.ac(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(a){const d=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(a){a!==this._elevation&&(this._elevation=a,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,d,p){this._unmodified=!1,this._edgeInsets.interpolate(a,d,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const d=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(a){const d=[new c.b3(0,a)];if(this._renderWorldCopies){const p=this.pointCoordinate(new c.P(0,0)),_=this.pointCoordinate(new c.P(this.width,0)),v=this.pointCoordinate(new c.P(this.width,this.height)),T=this.pointCoordinate(new c.P(0,this.height)),k=Math.floor(Math.min(p.x,_.x,v.x,T.x)),E=Math.floor(Math.max(p.x,_.x,v.x,T.x)),L=1;for(let R=k-L;R<=E+L;R++)R!==0&&d.push(new c.b3(R,a))}return d}coveringTiles(a){var d,p;let _=this.coveringZoomLevel(a);const v=_;if(a.minzoom!==void 0&&_<a.minzoom)return[];a.maxzoom!==void 0&&_>a.maxzoom&&(_=a.maxzoom);const T=this.pointCoordinate(this.getCameraPoint()),k=c.Y.fromLngLat(this.center),E=Math.pow(2,_),L=[E*T.x,E*T.y,0],R=[E*k.x,E*k.y,0],N=Hc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let W=a.minzoom||0;!a.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(W=_);const X=a.terrain?2/Math.min(this.tileSize,a.tileSize)*this.tileSize:3,te=ce=>({aabb:new Yh([ce*E,0,0],[(ce+1)*E,E,0]),zoom:0,x:0,y:0,wrap:ce,fullyVisible:!1}),ue=[],re=[],pe=_,ve=a.reparseOverscaled?v:_;if(this._renderWorldCopies)for(let ce=1;ce<=3;ce++)ue.push(te(-ce)),ue.push(te(ce));for(ue.push(te(0));ue.length>0;){const ce=ue.pop(),Se=ce.x,ze=ce.y;let Oe=ce.fullyVisible;if(!Oe){const pt=ce.aabb.intersects(N);if(pt===0)continue;Oe=pt===2}const Qe=a.terrain?L:R,ft=ce.aabb.distanceX(Qe),Et=ce.aabb.distanceY(Qe),Dt=Math.max(Math.abs(ft),Math.abs(Et));if(ce.zoom===pe||Dt>X+(1<<pe-ce.zoom)-2&&ce.zoom>=W){const pt=pe-ce.zoom,_t=L[0]-.5-(Se<<pt),jt=L[1]-.5-(ze<<pt);re.push({tileID:new c.Q(ce.zoom===pe?ve:ce.zoom,ce.wrap,ce.zoom,Se,ze),distanceSq:be([R[0]-.5-Se,R[1]-.5-ze]),tileDistanceToCamera:Math.sqrt(_t*_t+jt*jt)})}else for(let pt=0;pt<4;pt++){const _t=(Se<<1)+pt%2,jt=(ze<<1)+(pt>>1),rn=ce.zoom+1;let bt=ce.aabb.quadrant(pt);if(a.terrain){const St=new c.Q(rn,ce.wrap,rn,_t,jt),$t=a.terrain.getMinMaxElevation(St),Ei=(d=$t.minElevation)!==null&&d!==void 0?d:this.elevation,xn=(p=$t.maxElevation)!==null&&p!==void 0?p:this.elevation;bt=new Yh([bt.min[0],bt.min[1],Ei],[bt.max[0],bt.max[1],xn])}ue.push({aabb:bt,zoom:rn,x:_t,y:jt,wrap:ce.wrap,fullyVisible:Oe})}}return re.sort((ce,Se)=>ce.distanceSq-Se.distanceSq).map(ce=>ce.tileID)}resize(a,d){this.width=a,this.height=d,this.pixelsToGLUnits=[2/a,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const d=c.ac(a.lat,-85.051129,Wc);return new c.P(c.N(a.lng)*this.worldSize,c.O(d)*this.worldSize)}unproject(a){return new c.Y(a.x/this.worldSize,a.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(a){const d=this.elevation,p=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,_=this.pointLocation(this.centerPoint,a),v=a.getElevationForLngLatZoom(_,this.tileZoom);if(!(this.elevation-v))return;const T=p+d-v,k=Math.cos(this._pitch)*this.cameraToCenterDistance/T/c.b4(1,_.lat),E=this.scaleZoom(k/this.tileSize);this._elevation=v,this._center=_,this.zoom=E}setLocationAtPoint(a,d){const p=this.pointCoordinate(d),_=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(a),T=new c.Y(v.x-(p.x-_.x),v.y-(p.y-_.y));this.center=this.coordinateLocation(T),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(a,d){return d?this.coordinatePoint(this.locationCoordinate(a),d.getElevationForLngLatZoom(a,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(a))}pointLocation(a,d){return this.coordinateLocation(this.pointCoordinate(a,d))}locationCoordinate(a){return c.Y.fromLngLat(a)}coordinateLocation(a){return a&&a.toLngLat()}pointCoordinate(a,d){if(d){const W=d.pointCoordinate(a);if(W!=null)return W}const p=[a.x,a.y,0,1],_=[a.x,a.y,1,1];c.af(p,p,this.pixelMatrixInverse),c.af(_,_,this.pixelMatrixInverse);const v=p[3],T=_[3],k=p[1]/v,E=_[1]/T,L=p[2]/v,R=_[2]/T,N=L===R?0:(0-L)/(R-L);return new c.Y(c.z.number(p[0]/v,_[0]/T,N)/this.worldSize,c.z.number(k,E,N)/this.worldSize)}coordinatePoint(a,d=0,p=this.pixelMatrix){const _=[a.x*this.worldSize,a.y*this.worldSize,d,1];return c.af(_,_,p),new c.P(_[0]/_[3],_[1]/_[3])}getBounds(){const a=Math.max(0,this.height/2-this.getHorizon());return new Ee().extend(this.pointLocation(new c.P(0,a))).extend(this.pointLocation(new c.P(this.width,a))).extend(this.pointLocation(new c.P(this.width,this.height))).extend(this.pointLocation(new c.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ee([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Wc])}calculatePosMatrix(a,d=!1){const p=a.key,_=d?this._alignedPosMatrixCache:this._posMatrixCache;if(_[p])return _[p];const v=a.canonical,T=this.worldSize/this.zoomScale(v.z),k=v.x+Math.pow(2,v.z)*a.wrap,E=c.an(new Float64Array(16));return c.H(E,E,[k*T,v.y*T,0]),c.J(E,E,[T/c.W,T/c.W,1]),c.K(E,d?this.alignedProjMatrix:this.projMatrix,E),_[p]=new Float32Array(E),_[p]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(a,d){d=c.ac(+d,this.minZoom,this.maxZoom);const p={center:new c.M(a.lng,a.lat),zoom:d};let _=this.lngRange;if(!this._renderWorldCopies&&_===null){const ce=179.9999999999;_=[-ce,ce]}const v=this.tileSize*this.zoomScale(p.zoom);let T=0,k=v,E=0,L=v,R=0,N=0;const{x:W,y:X}=this.size;if(this.latRange){const ce=this.latRange;T=c.O(ce[1])*v,k=c.O(ce[0])*v,k-T<X&&(R=X/(k-T))}_&&(E=c.b2(c.N(_[0])*v,0,v),L=c.b2(c.N(_[1])*v,0,v),L<E&&(L+=v),L-E<W&&(N=W/(L-E)));const{x:te,y:ue}=this.project.call({worldSize:v},a);let re,pe;const ve=Math.max(N||0,R||0);if(ve){const ce=new c.P(N?(L+E)/2:te,R?(k+T)/2:ue);return p.center=this.unproject.call({worldSize:v},ce).wrap(),p.zoom+=this.scaleZoom(ve),p}if(this.latRange){const ce=X/2;ue-ce<T&&(pe=T+ce),ue+ce>k&&(pe=k-ce)}if(_){const ce=(E+L)/2;let Se=te;this._renderWorldCopies&&(Se=c.b2(te,ce-v/2,ce+v/2));const ze=W/2;Se-ze<E&&(re=E+ze),Se+ze>L&&(re=L-ze)}if(re!==void 0||pe!==void 0){const ce=new c.P(re??te,pe??ue);p.center=this.unproject.call({worldSize:v},ce).wrap()}return p}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const a=this._unmodified,{center:d,zoom:p}=this.getConstrained(this.center,this.zoom);this.center=d,this.zoom=p,this._unmodified=a,this._constraining=!1}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,d=this.point.x,p=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.b4(1,this.center.lat)*this.worldSize;let _=c.an(new Float64Array(16));c.J(_,_,[this.width/2,-this.height/2,1]),c.H(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=c.an(new Float64Array(16)),c.J(_,_,[1,-1,1]),c.H(_,_,[-1,-1,0]),c.J(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_;const v=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),T=Math.min(this.elevation,this.minElevationForCurrentTile),k=v-T*this._pixelPerMeter/Math.cos(this._pitch),E=T<0?k:v,L=Math.PI/2+this._pitch,R=this._fov*(.5+a.y/this.height),N=Math.sin(R)*E/Math.sin(c.ac(Math.PI-L-R,.01,Math.PI-.01)),W=this.getHorizon(),X=2*Math.atan(W/this.cameraToCenterDistance)*(.5+a.y/(2*W)),te=Math.sin(X)*E/Math.sin(c.ac(Math.PI-L-X,.01,Math.PI-.01)),ue=Math.min(N,te),re=1.01*(Math.cos(Math.PI/2-this._pitch)*ue+E),pe=this.height/50;_=new Float64Array(16),c.b5(_,this._fov,this.width/this.height,pe,re),_[8]=2*-a.x/this.width,_[9]=2*a.y/this.height,c.J(_,_,[1,-1,1]),c.H(_,_,[0,0,-this.cameraToCenterDistance]),c.b6(_,_,this._pitch),c.ad(_,_,this.angle),c.H(_,_,[-d,-p,0]),this.mercatorMatrix=c.J([],_,[this.worldSize,this.worldSize,this.worldSize]),c.J(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.K(new Float64Array(16),this.labelPlaneMatrix,_),c.H(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=c.as([],_),this.pixelMatrix3D=c.K(new Float64Array(16),this.labelPlaneMatrix,_);const ve=this.width%2/2,ce=this.height%2/2,Se=Math.cos(this.angle),ze=Math.sin(this.angle),Oe=d-Math.round(d)+Se*ve+ze*ce,Qe=p-Math.round(p)+Se*ce+ze*ve,ft=new Float64Array(_);if(c.H(ft,ft,[Oe>.5?Oe-1:Oe,Qe>.5?Qe-1:Qe,0]),this.alignedProjMatrix=ft,_=c.as(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const a=this.pointCoordinate(new c.P(0,0)),d=[a.x*this.worldSize,a.y*this.worldSize,0,1];return c.af(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(0,a))}getCameraQueryGeometry(a){const d=this.getCameraPoint();if(a.length===1)return[a[0],d];{let p=d.x,_=d.y,v=d.x,T=d.y;for(const k of a)p=Math.min(p,k.x),_=Math.min(_,k.y),v=Math.max(v,k.x),T=Math.max(T,k.y);return[new c.P(p,_),new c.P(v,_),new c.P(v,T),new c.P(p,T),new c.P(p,_)]}}lngLatToCameraDepth(a,d){const p=this.locationCoordinate(a),_=[p.x*this.worldSize,p.y*this.worldSize,d,1];return c.af(_,_,this.projMatrix),_[2]/_[3]}}function Jm(g,a){let d,p=!1,_=null,v=null;const T=()=>{_=null,p&&(g.apply(v,d),_=setTimeout(T,a),p=!1)};return(...k)=>(p=!0,v=this,d=k,_||T(),_)}class Cf{constructor(a){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let p;return d.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(p=_)}),(p&&p[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(d.length>=3&&!d.some(p=>isNaN(p))){const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,d)}catch{}},this._updateHash=Jm(this._updateHashUnthrottled,300),this._hashName=a&&encodeURIComponent(a)}addTo(a){return this._map=a,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(a){const d=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,_),T=Math.round(d.lng*v)/v,k=Math.round(d.lat*v)/v,E=this._map.getBearing(),L=this._map.getPitch();let R="";if(R+=a?`/${T}/${k}/${p}`:`${p}/${k}/${T}`,(E||L)&&(R+="/"+Math.round(10*E)/10),L&&(R+=`/${Math.round(L)}`),this._hashName){const N=this._hashName;let W=!1;const X=window.location.hash.slice(1).split("&").map(te=>{const ue=te.split("=")[0];return ue===N?(W=!0,`${ue}=${R}`):te}).filter(te=>te);return W||X.push(`${N}=${R}`),`#${X.join("&")}`}return`#${R}`}}const Jh={linearity:.3,easing:c.b7(0,0,.3,1)},kf=c.e({deceleration:2500,maxSpeed:1400},Jh),Kh=c.e({deceleration:20,maxSpeed:1400},Jh),Xh=c.e({deceleration:1e3,maxSpeed:360},Jh),Ef=c.e({deceleration:1e3,maxSpeed:90},Jh);class Df{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:M.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,d=M.now();for(;a.length>0&&d-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)d.zoom+=v.zoomDelta||0,d.bearing+=v.bearingDelta||0,d.pitch+=v.pitchDelta||0,v.panDelta&&d.pan._add(v.panDelta),v.around&&(d.around=v.around),v.pinchAround&&(d.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(d.pan.mag()){const v=Jl(d.pan.mag(),p,c.e({},kf,a||{}));_.offset=d.pan.mult(v.amount/d.pan.mag()),_.center=this._map.transform.center,Ju(_,v)}if(d.zoom){const v=Jl(d.zoom,p,Kh);_.zoom=this._map.transform.zoom+v.amount,Ju(_,v)}if(d.bearing){const v=Jl(d.bearing,p,Xh);_.bearing=this._map.transform.bearing+c.ac(v.amount,-179,179),Ju(_,v)}if(d.pitch){const v=Jl(d.pitch,p,Ef);_.pitch=this._map.transform.pitch+v.amount,Ju(_,v)}if(_.zoom||_.bearing){const v=d.pinchAround===void 0?d.around:d.pinchAround;_.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),c.e(_,{noMoveStart:!0})}}function Ju(g,a){(!g.duration||g.duration<a.duration)&&(g.duration=a.duration,g.easing=a.easing)}function Jl(g,a,d){const{maxSpeed:p,linearity:_,deceleration:v}=d,T=c.ac(g*_/(a/1e3),-p,p),k=Math.abs(T)/(v*_);return{easing:d.easing,duration:1e3*k,amount:T*(k/2)}}class ea extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,p,_={}){const v=A.mousePos(d.getCanvas(),p),T=d.unproject(v);super(a,c.e({point:v,lngLat:T,originalEvent:p},_)),this._defaultPrevented=!1,this.target=d}}class Kl extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,p){const _=a==="touchend"?p.changedTouches:p.touches,v=A.touchPos(d.getCanvasContainer(),_),T=v.map(E=>d.unproject(E)),k=v.reduce((E,L,R,N)=>E.add(L.div(N.length)),new c.P(0,0));super(a,{points:v,point:k,lngLats:T,lngLat:d.unproject(k),originalEvent:p}),this._defaultPrevented=!1}}class Km extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,d,p){super(a,{originalEvent:p}),this._defaultPrevented=!1}}class Pf{constructor(a,d){this._map=a,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(a){return this._firePreventable(new Km(a.type,this._map,a))}mousedown(a,d){return this._mousedownPos=d,this._firePreventable(new ea(a.type,this._map,a))}mouseup(a){this._map.fire(new ea(a.type,this._map,a))}click(a,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new ea(a.type,this._map,a))}dblclick(a){return this._firePreventable(new ea(a.type,this._map,a))}mouseover(a){this._map.fire(new ea(a.type,this._map,a))}mouseout(a){this._map.fire(new ea(a.type,this._map,a))}touchstart(a){return this._firePreventable(new Kl(a.type,this._map,a))}touchmove(a){this._map.fire(new Kl(a.type,this._map,a))}touchend(a){this._map.fire(new Kl(a.type,this._map,a))}touchcancel(a){this._map.fire(new Kl(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bg{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(a){this._map.fire(new ea(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ea("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._ignoreContextMenu||this._map.fire(new ea(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Zc{constructor(a){this._map=a}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(a){return this.transform.pointLocation(c.P.convert(a),this._map.terrain)}}class Ku{constructor(a,d){this._map=a,this._tr=new Zc(a),this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,d){this.isEnabled()&&a.shiftKey&&a.button===0&&(A.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(a,d){if(!this._active)return;const p=d;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=p,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",a));const v=Math.min(_.x,p.x),T=Math.max(_.x,p.x),k=Math.min(_.y,p.y),E=Math.max(_.y,p.y);A.setTransform(this._box,`translate(${v}px,${k}px)`),this._box.style.width=T-v+"px",this._box.style.height=E-k+"px"}mouseupWindow(a,d){if(!this._active||a.button!==0)return;const p=this._startPos,_=d;if(this.reset(),A.suppressClick(),p.x!==_.x||p.y!==_.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:a})),{cameraAnimation:v=>v.fitScreenCoordinates(p,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",a)}keydown(a){this._active&&a.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",a))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(a,d){return this._map.fire(new c.k(a,{originalEvent:d}))}}function Xu(g,a){if(g.length!==a.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${a.length}`);const d={};for(let p=0;p<g.length;p++)d[g[p].identifier]=a[p];return d}class Xm{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(a,d,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=a.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const v=new c.P(0,0);for(const T of _)v._add(T);return v.div(_.length)}(d),this.touches=Xu(p,d)))}touchmove(a,d,p){if(this.aborted||!this.centroid)return;const _=Xu(p,d);for(const v in this.touches){const T=_[v];(!T||T.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(a,d,p){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Qh{constructor(a){this.singleTap=new Xm(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(a,d,p){this.singleTap.touchstart(a,d,p)}touchmove(a,d,p){this.singleTap.touchmove(a,d,p)}touchend(a,d,p){const _=this.singleTap.touchend(a,d,p);if(_){const v=a.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(_)<30;if(v&&T||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class $h{constructor(a){this._tr=new Zc(a),this._zoomIn=new Qh({numTouches:1,numTaps:2}),this._zoomOut=new Qh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,d,p){this._zoomIn.touchstart(a,d,p),this._zoomOut.touchstart(a,d,p)}touchmove(a,d,p){this._zoomIn.touchmove(a,d,p),this._zoomOut.touchmove(a,d,p)}touchend(a,d,p){const _=this._zoomIn.touchend(a,d,p),v=this._zoomOut.touchend(a,d,p),T=this._tr;return _?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:T.zoom+1,around:T.unproject(_)},{originalEvent:a})}):v?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:T.zoom-1,around:T.unproject(v)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xl{constructor(a){this._enabled=!!a.enable,this._moveStateManager=a.moveStateManager,this._clickTolerance=a.clickTolerance||1,this._moveFunction=a.move,this._activateOnStart=!!a.activateOnStart,a.assignEvents(this),this.reset()}reset(a){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(a)}_move(...a){const d=this._moveFunction(...a);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(a,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(a)&&(this._moveStateManager.startMove(a),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(a,d){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(a.preventDefault(),!this._moveStateManager.isValidMoveEvent(a))return void this.reset(a);const _=d.length?d[0]:d;return!this._moved&&_.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(p,_))}dragEnd(a){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(a)&&(this._moved&&A.suppressClick(),this.reset(a))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Fg={0:1,2:2};class ed{constructor(a){this._correctEvent=a.checkCorrectEvent}startMove(a){const d=A.mouseButton(a);this._eventButton=d}endMove(a){delete this._eventButton}isValidStartEvent(a){return this._correctEvent(a)}isValidMoveEvent(a){return!function(d,p){const _=Fg[p];return d.buttons===void 0||(d.buttons&_)!==_}(a,this._eventButton)}isValidEndEvent(a){return A.mouseButton(a)===this._eventButton}}class Gi{constructor(){this._firstTouch=void 0}_isOneFingerTouch(a){return a.targetTouches.length===1}_isSameTouchEvent(a){return a.targetTouches[0].identifier===this._firstTouch}startMove(a){this._firstTouch=a.targetTouches[0].identifier}endMove(a){delete this._firstTouch}isValidStartEvent(a){return this._isOneFingerTouch(a)}isValidMoveEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}isValidEndEvent(a){return this._isOneFingerTouch(a)&&this._isSameTouchEvent(a)}}const Io=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=a=>{a.preventDefault()}},Va=({enable:g,clickTolerance:a,bearingDegreesPerPixelMoved:d=.8})=>{const p=new ed({checkCorrectEvent:_=>A.mouseButton(_)===0&&_.ctrlKey||A.mouseButton(_)===2});return new Xl({clickTolerance:a,move:(_,v)=>({bearingDelta:(v.x-_.x)*d}),moveStateManager:p,enable:g,assignEvents:Io})},td=({enable:g,clickTolerance:a,pitchDegreesPerPixelMoved:d=-.5})=>{const p=new ed({checkCorrectEvent:_=>A.mouseButton(_)===0&&_.ctrlKey||A.mouseButton(_)===2});return new Xl({clickTolerance:a,move:(_,v)=>({pitchDelta:(v.y-_.y)*d}),moveStateManager:p,enable:g,assignEvents:Io})};class Lf{constructor(a,d){this._clickTolerance=a.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(a,d,p){return this._calculateTransform(a,d,p)}touchmove(a,d,p){if(this._active&&!(p.length<this.minTouchs()))return a.preventDefault(),this._calculateTransform(a,d,p)}touchend(a,d,p){this._calculateTransform(a,d,p),this._active&&p.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,d,p){p.length>0&&(this._active=!0);const _=Xu(p,d),v=new c.P(0,0),T=new c.P(0,0);let k=0;for(const L in _){const R=_[L],N=this._touches[L];N&&(v._add(R),T._add(R.sub(N)),k++,_[L]=R)}if(this._touches=_,k<this.minTouchs()||!T.mag())return;const E=T.div(k);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(k),panDelta:E}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nd{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(a,d,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([d[0],d[1]]))}touchmove(a,d,p){if(!this._firstTwoTouches)return;a.preventDefault();const[_,v]=this._firstTwoTouches,T=To(p,d,_),k=To(p,d,v);if(!T||!k)return;const E=this._aroundCenter?null:T.add(k).div(2);return this._move([T,k],E,a)}touchend(a,d,p){if(!this._firstTwoTouches)return;const[_,v]=this._firstTwoTouches,T=To(p,d,_),k=To(p,d,v);T&&k||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&a.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function To(g,a,d){for(let p=0;p<g.length;p++)if(g[p].identifier===d)return a[p]}function Gc(g,a){return Math.log(g/a)/Math.LN2}class id extends nd{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,d){const p=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Gc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gc(this._distance,p),pinchAround:d}}}function zf(g,a){return 180*g.angleWith(a)/Math.PI}class Bf extends nd{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,d,p){const _=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zf(this._vector,_),pinchAround:d}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const d=25/(Math.PI*this._minDiameter)*360,p=zf(a,this._startVector);return Math.abs(p)<d}}function rd(g){return Math.abs(g.y)>Math.abs(g.x)}class Ff extends nd{constructor(a){super(),this._currentTouchCount=0,this._map=a}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(a,d,p){super.touchstart(a,d,p),this._currentTouchCount=p.length}_start(a){this._lastPoints=a,rd(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,d,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=a[0].sub(this._lastPoints[0]),v=a[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,v,p.timeStamp),this._valid?(this._lastPoints=a,this._active=!0,{pitchDelta:(_.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(a,d,p){if(this._valid!==void 0)return this._valid;const _=a.mag()>=2,v=d.mag()>=2;if(!_&&!v)return;if(!_||!v)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const T=a.y>0==d.y>0;return rd(a)&&rd(d)&&T}}const Qm={panStep:100,bearingStep:15,pitchStep:10};class nl{constructor(a){this._tr=new Zc(a);const d=Qm;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let d=0,p=0,_=0,v=0,T=0;switch(a.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:a.shiftKey?p=-1:(a.preventDefault(),v=-1);break;case 39:a.shiftKey?p=1:(a.preventDefault(),v=1);break;case 38:a.shiftKey?_=1:(a.preventDefault(),T=-1);break;case 40:a.shiftKey?_=-1:(a.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:k=>{const E=this._tr;k.easeTo({duration:300,easeId:"keyboardHandler",easing:$m,zoom:d?Math.round(E.zoom)+d*(a.shiftKey?2:1):E.zoom,bearing:E.bearing+p*this._bearingStep,pitch:E.pitch+_*this._pitchStep,offset:[-v*this._panStep,-T*this._panStep],center:E.center},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function $m(g){return g*(2-g)}const Nf=4.000244140625;class Rf{constructor(a,d){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=a,this._tr=new Zc(a),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&a.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(a){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!a[this._map.cooperativeGestures._bypassKey])return;let d=a.deltaMode===WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const p=M.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,d!==0&&d%Nf==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(_*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),a.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=a,this._delta-=d,this._active||this._start(a)),a.preventDefault()}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=A.mousePos(this._map.getCanvas(),a),p=this._tr;this._around=d.y>p.transform.height/2-p.transform.getHorizon()?c.M.convert(this._aroundCenter?p.center:p.unproject(d)):c.M.convert(p.center),this._aroundPoint=p.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._tr.transform;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>Nf?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&E!==0&&(E=1/E);const L=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(L*E))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,p=this._startZoom,_=this._easing;let v,T=!1;if(this._type==="wheel"&&p&&_){const k=Math.min((M.now()-this._lastWheelEventTime)/200,1),E=_(k);v=c.z.number(p,d,E),k<1?this._frameId||(this._frameId=!0):T=!0}else v=d,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:v-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let d=c.b8;if(this._prevEase){const p=this._prevEase,_=(M.now()-p.start)/p.duration,v=p.easing(_+.01)-p.easing(_),T=.27/Math.sqrt(v*v+1e-4)*.01,k=Math.sqrt(.0729-T*T);d=c.b7(T,k,.25,1)}return this._prevEase={start:M.now(),duration:a,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Of{constructor(a,d){this._clickZoom=a,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class e0{constructor(a){this._tr=new Zc(a),this.reset()}reset(){this._active=!1}dblclick(a,d){return a.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(a.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class t0{constructor(){this._tap=new Qh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(a,d,p){if(!this._swipePoint)if(this._tapTime){const _=d[0],v=a.timeStamp-this._tapTime<500,T=this._tapPoint.dist(_)<30;v&&T?p.length>0&&(this._swipePoint=_,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(a,d,p)}touchmove(a,d,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=d[0],v=_.y-this._swipePoint.y;return this._swipePoint=_,a.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(a,d,p)}touchend(a,d,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const _=this._tap.touchend(a,d,p);_&&(this._tapTime=a.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uf{constructor(a,d,p){this._el=a,this._mousePan=d,this._touchPan=p}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yc{constructor(a,d,p){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=d,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Vf{constructor(a,d,p,_){this._el=a,this._touchZoom=d,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ss{constructor(a,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=a,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const a=this._map.getCanvasContainer();a.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",a);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=d,this._container.appendChild(_);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=p,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(a){this._onCooperativeGesture(a.touches.length===1)}wheel(a){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!a[this._bypassKey])}_onCooperativeGesture(a){this._enabled&&a&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ja=g=>g.zoom||g.drag||g.pitch||g.rotate;class n0 extends c.k{}function os(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Qu{constructor(a,d){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,v)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const T=_.type==="renderFrame"?void 0:_,k={needsRenderFrame:!1},E={},L={},R=_.touches,N=R?this._getMapTouches(R):void 0,W=N?A.touchPos(this._map.getCanvas(),N):A.mousePos(this._map.getCanvas(),_);for(const{handlerName:ue,handler:re,allowed:pe}of this._handlers){if(!re.isEnabled())continue;let ve;this._blockedByActive(L,pe,ue)?re.reset():re[v||_.type]&&(ve=re[v||_.type](_,W,N),this.mergeHandlerResult(k,E,ve,ue,T),ve&&ve.needsRenderFrame&&this._triggerRenderFrame()),(ve||re.isActive())&&(L[ue]=re)}const X={};for(const ue in this._previousActiveHandlers)L[ue]||(X[ue]=T);this._previousActiveHandlers=L,(Object.keys(X).length||os(k))&&(this._changes.push([k,E,X]),this._triggerRenderFrame()),(Object.keys(L).length||os(k))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:te}=k;te&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],te(this._map))},this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Df(a),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,v,T]of this._listeners)A.addEventListener(_,v,_===document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[a,d,p]of this._listeners)A.removeEventListener(a,d,a===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(a){const d=this._map,p=d.getCanvasContainer();this._add("mapEvent",new Pf(d,a));const _=d.boxZoom=new Ku(d,a);this._add("boxZoom",_),a.interactive&&a.boxZoom&&_.enable();const v=d.cooperativeGestures=new ss(d,a.cooperativeGestures);this._add("cooperativeGestures",v),a.cooperativeGestures&&v.enable();const T=new $h(d),k=new e0(d);d.doubleClickZoom=new Of(k,T),this._add("tapZoom",T),this._add("clickZoom",k),a.interactive&&a.doubleClickZoom&&d.doubleClickZoom.enable();const E=new t0;this._add("tapDragZoom",E);const L=d.touchPitch=new Ff(d);this._add("touchPitch",L),a.interactive&&a.touchPitch&&d.touchPitch.enable(a.touchPitch);const R=Va(a),N=td(a);d.dragRotate=new Yc(a,R,N),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",N,["mouseRotate"]),a.interactive&&a.dragRotate&&d.dragRotate.enable();const W=(({enable:ve,clickTolerance:ce})=>{const Se=new ed({checkCorrectEvent:ze=>A.mouseButton(ze)===0&&!ze.ctrlKey});return new Xl({clickTolerance:ce,move:(ze,Oe)=>({around:Oe,panDelta:Oe.sub(ze)}),activateOnStart:!0,moveStateManager:Se,enable:ve,assignEvents:Io})})(a),X=new Lf(a,d);d.dragPan=new Uf(p,W,X),this._add("mousePan",W),this._add("touchPan",X,["touchZoom","touchRotate"]),a.interactive&&a.dragPan&&d.dragPan.enable(a.dragPan);const te=new Bf,ue=new id;d.touchZoomRotate=new Vf(p,ue,te,E),this._add("touchRotate",te,["touchPan","touchZoom"]),this._add("touchZoom",ue,["touchPan","touchRotate"]),a.interactive&&a.touchZoomRotate&&d.touchZoomRotate.enable(a.touchZoomRotate);const re=d.scrollZoom=new Rf(d,()=>this._triggerRenderFrame());this._add("scrollZoom",re,["mousePan"]),a.interactive&&a.scrollZoom&&d.scrollZoom.enable(a.scrollZoom);const pe=d.keyboard=new nl(d);this._add("keyboard",pe),a.interactive&&a.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new Bg(d))}_add(a,d,p){this._handlers.push({handlerName:a,handler:d,allowed:p}),this._handlersById[a]=d}stop(a){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ja(this._eventsInProgress)||this.isZooming()}_blockedByActive(a,d,p){for(const _ in a)if(_!==p&&(!d||d.indexOf(_)<0))return!0;return!1}_getMapTouches(a){const d=[];for(const p of a)this._el.contains(p.target)&&d.push(p);return d}mergeHandlerResult(a,d,p,_,v){if(!p)return;c.e(a,p);const T={handlerName:_,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(d.zoom=T),p.panDelta!==void 0&&(d.drag=T),p.pitchDelta!==void 0&&(d.pitch=T),p.bearingDelta!==void 0&&(d.rotate=T)}_applyChanges(){const a={},d={},p={};for(const[_,v,T]of this._changes)_.panDelta&&(a.panDelta=(a.panDelta||new c.P(0,0))._add(_.panDelta)),_.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(a.around=_.around),_.pinchAround!==void 0&&(a.pinchAround=_.pinchAround),_.noInertia&&(a.noInertia=_.noInertia),c.e(d,v),c.e(p,T);this._updateMapTransform(a,d,p),this._changes=[]}_updateMapTransform(a,d,p){const _=this._map,v=_._getTransformForUpdate(),T=_.terrain;if(!(os(a)||T&&this._terrainMovement))return this._fireEvents(d,p,!0);let{panDelta:k,zoomDelta:E,bearingDelta:L,pitchDelta:R,around:N,pinchAround:W}=a;W!==void 0&&(N=W),_._stop(!0),N=N||_.transform.centerPoint;const X=v.pointLocation(k?N.sub(k):N);L&&(v.bearing+=L),R&&(v.pitch+=R),E&&(v.zoom+=E),T?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?v.center=v.pointLocation(v.centerPoint.sub(k)):v.setLocationAtPoint(X,N):(this._terrainMovement=!0,this._map._elevationFreeze=!0,v.setLocationAtPoint(X,N)):v.setLocationAtPoint(X,N),_._applyUpdatedTransform(v),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(d,p,!0)}_fireEvents(a,d,p){const _=ja(this._eventsInProgress),v=ja(a),T={};for(const N in a){const{originalEvent:W}=a[N];this._eventsInProgress[N]||(T[`${N}start`]=W),this._eventsInProgress[N]=a[N]}!_&&v&&this._fireEvent("movestart",v.originalEvent);for(const N in T)this._fireEvent(N,T[N]);v&&this._fireEvent("move",v.originalEvent);for(const N in a){const{originalEvent:W}=a[N];this._fireEvent(N,W)}const k={};let E;for(const N in this._eventsInProgress){const{handlerName:W,originalEvent:X}=this._eventsInProgress[N];this._handlersById[W].isActive()||(delete this._eventsInProgress[N],E=d[W]||X,k[`${N}end`]=E)}for(const N in k)this._fireEvent(N,k[N]);const L=ja(this._eventsInProgress),R=(_||v)&&!L;if(R&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),p&&R){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!N||!N.essential&&M.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:E})),W(this._map.getBearing())&&this._map.resetNorth()):(W(N.bearing||this._map.getBearing())&&(N.bearing=0),N.freezeElevation=!0,this._map.easeTo(N,{originalEvent:E})),this._updatingCamera=!1}}_fireEvent(a,d){this._map.fire(new c.k(a,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{delete this._frameId,this.handleEvent(new n0("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ng extends c.E{constructor(a,d){super(),this._renderFrameCallback=()=>{const p=Math.min((M.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(p)),p<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=d.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new c.M(this.transform.center.lng,this.transform.center.lat)}setCenter(a,d){return this.jumpTo({center:a},d)}panBy(a,d,p){return a=c.P.convert(a).mult(-1),this.panTo(this.transform.center,c.e({offset:a},d),p)}panTo(a,d,p){return this.easeTo(c.e({center:a},d),p)}getZoom(){return this.transform.zoom}setZoom(a,d){return this.jumpTo({zoom:a},d),this}zoomTo(a,d,p){return this.easeTo(c.e({zoom:a},d),p)}zoomIn(a,d){return this.zoomTo(this.getZoom()+1,a,d),this}zoomOut(a,d){return this.zoomTo(this.getZoom()-1,a,d),this}getBearing(){return this.transform.bearing}setBearing(a,d){return this.jumpTo({bearing:a},d),this}getPadding(){return this.transform.padding}setPadding(a,d){return this.jumpTo({padding:a},d),this}rotateTo(a,d,p){return this.easeTo(c.e({bearing:a},d),p)}resetNorth(a,d){return this.rotateTo(0,c.e({duration:1e3},a),d),this}resetNorthPitch(a,d){return this.easeTo(c.e({bearing:0,pitch:0,duration:1e3},a),d),this}snapToNorth(a,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,d):this}getPitch(){return this.transform.pitch}setPitch(a,d){return this.jumpTo({pitch:a},d),this}cameraForBounds(a,d){a=Ee.convert(a);const p=d&&d.bearing||0;return this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),p,d)}_cameraForBoxAndBearing(a,d,p,_){const v={top:0,bottom:0,right:0,left:0};if(typeof(_=c.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const pt=_.padding;_.padding={top:pt,bottom:pt,right:pt,left:pt}}_.padding=c.e(v,_.padding);const T=this.transform,k=T.padding,E=new Ee(a,d),L=T.project(E.getNorthWest()),R=T.project(E.getNorthEast()),N=T.project(E.getSouthEast()),W=T.project(E.getSouthWest()),X=c.b9(-p),te=L.rotate(X),ue=R.rotate(X),re=N.rotate(X),pe=W.rotate(X),ve=new c.P(Math.max(te.x,ue.x,pe.x,re.x),Math.max(te.y,ue.y,pe.y,re.y)),ce=new c.P(Math.min(te.x,ue.x,pe.x,re.x),Math.min(te.y,ue.y,pe.y,re.y)),Se=ve.sub(ce),ze=(T.width-(k.left+k.right+_.padding.left+_.padding.right))/Se.x,Oe=(T.height-(k.top+k.bottom+_.padding.top+_.padding.bottom))/Se.y;if(Oe<0||ze<0)return void c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Qe=Math.min(T.scaleZoom(T.scale*Math.min(ze,Oe)),_.maxZoom),ft=c.P.convert(_.offset),Et=new c.P((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(c.b9(p)),Dt=ft.add(Et).mult(T.scale/T.zoomScale(Qe));return{center:T.unproject(L.add(N).div(2).sub(Dt)),zoom:Qe,bearing:p}}fitBounds(a,d,p){return this._fitInternal(this.cameraForBounds(a,d),d,p)}fitScreenCoordinates(a,d,p,_,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.P.convert(a)),this.transform.pointLocation(c.P.convert(d)),p,_),_,v)}_fitInternal(a,d,p){return a?(delete(d=c.e(a,d)).padding,d.linear?this.easeTo(d,p):this.flyTo(d,p)):this}jumpTo(a,d){this.stop();const p=this._getTransformForUpdate();let _=!1,v=!1,T=!1;return"zoom"in a&&p.zoom!==+a.zoom&&(_=!0,p.zoom=+a.zoom),a.center!==void 0&&(p.center=c.M.convert(a.center)),"bearing"in a&&p.bearing!==+a.bearing&&(v=!0,p.bearing=+a.bearing),"pitch"in a&&p.pitch!==+a.pitch&&(T=!0,p.pitch=+a.pitch),a.padding==null||p.isPaddingEqual(a.padding)||(p.padding=a.padding),this._applyUpdatedTransform(p),this.fire(new c.k("movestart",d)).fire(new c.k("move",d)),_&&this.fire(new c.k("zoomstart",d)).fire(new c.k("zoom",d)).fire(new c.k("zoomend",d)),v&&this.fire(new c.k("rotatestart",d)).fire(new c.k("rotate",d)).fire(new c.k("rotateend",d)),T&&this.fire(new c.k("pitchstart",d)).fire(new c.k("pitch",d)).fire(new c.k("pitchend",d)),this.fire(new c.k("moveend",d))}calculateCameraOptionsFromTo(a,d,p,_=0){const v=c.Y.fromLngLat(a,d),T=c.Y.fromLngLat(p,_),k=T.x-v.x,E=T.y-v.y,L=T.z-v.z,R=Math.hypot(k,E,L);if(R===0)throw new Error("Can't calculate camera options with same From and To");const N=Math.hypot(k,E),W=this.transform.scaleZoom(this.transform.cameraToCenterDistance/R/this.transform.tileSize),X=180*Math.atan2(k,-E)/Math.PI;let te=180*Math.acos(N/R)/Math.PI;return te=L<0?90-te:90+te,{center:T.toLngLat(),zoom:W,pitch:te,bearing:X}}easeTo(a,d){var p;this._stop(!1,a.easeId),((a=c.e({offset:[0,0],duration:500,easing:c.b8},a)).animate===!1||!a.essential&&M.prefersReducedMotion)&&(a.duration=0);const _=this._getTransformForUpdate(),v=this.getZoom(),T=this.getBearing(),k=this.getPitch(),E=this.getPadding(),L="bearing"in a?this._normalizeBearing(a.bearing,T):T,R="pitch"in a?+a.pitch:k,N="padding"in a?a.padding:_.padding,W=c.P.convert(a.offset);let X=_.centerPoint.add(W);const te=_.pointLocation(X),{center:ue,zoom:re}=_.getConstrained(c.M.convert(a.center||te),(p=a.zoom)!==null&&p!==void 0?p:v);this._normalizeCenter(ue);const pe=_.project(te),ve=_.project(ue).sub(pe),ce=_.zoomScale(re-v);let Se,ze;a.around&&(Se=c.M.convert(a.around),ze=_.locationPoint(Se));const Oe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||re!==v,this._rotating=this._rotating||T!==L,this._pitching=this._pitching||R!==k,this._padding=!_.isPaddingEqual(N),this._easeId=a.easeId,this._prepareEase(d,a.noMoveStart,Oe),this.terrain&&this._prepareElevation(ue),this._ease(Qe=>{if(this._zooming&&(_.zoom=c.z.number(v,re,Qe)),this._rotating&&(_.bearing=c.z.number(T,L,Qe)),this._pitching&&(_.pitch=c.z.number(k,R,Qe)),this._padding&&(_.interpolatePadding(E,N,Qe),X=_.centerPoint.add(W)),this.terrain&&!a.freezeElevation&&this._updateElevation(Qe),Se)_.setLocationAtPoint(Se,ze);else{const ft=_.zoomScale(_.zoom-v),Et=re>v?Math.min(2,ce):Math.max(.5,ce),Dt=Math.pow(Et,1-Qe),pt=_.unproject(pe.add(ve.mult(Qe*Dt)).mult(ft));_.setLocationAtPoint(_.renderWorldCopies?pt.wrap():pt,X)}this._applyUpdatedTransform(_),this._fireMoveEvents(d)},Qe=>{this.terrain&&a.freezeElevation&&this._finalizeElevation(),this._afterEase(d,Qe)},a),this}_prepareEase(a,d,p={}){this._moving=!0,d||p.moving||this.fire(new c.k("movestart",a)),this._zooming&&!p.zooming&&this.fire(new c.k("zoomstart",a)),this._rotating&&!p.rotating&&this.fire(new c.k("rotatestart",a)),this._pitching&&!p.pitching&&this.fire(new c.k("pitchstart",a))}_prepareElevation(a){this._elevationCenter=a,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(a){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(a<1&&d!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=a*(p-(d-(p*a+this._elevationStart))/(1-a)),this._elevationTarget=d}this.transform.elevation=c.z.number(this._elevationStart,this._elevationTarget,a)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(a){if(!this.transformCameraUpdate)return;const d=a.clone(),{center:p,zoom:_,pitch:v,bearing:T,elevation:k}=this.transformCameraUpdate(d);p&&(d.center=p),_!==void 0&&(d.zoom=_),v!==void 0&&(d.pitch=v),T!==void 0&&(d.bearing=T),k!==void 0&&(d.elevation=k),this.transform.apply(d)}_fireMoveEvents(a){this.fire(new c.k("move",a)),this._zooming&&this.fire(new c.k("zoom",a)),this._rotating&&this.fire(new c.k("rotate",a)),this._pitching&&this.fire(new c.k("pitch",a))}_afterEase(a,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const p=this._zooming,_=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new c.k("zoomend",a)),_&&this.fire(new c.k("rotateend",a)),v&&this.fire(new c.k("pitchend",a)),this.fire(new c.k("moveend",a))}flyTo(a,d){var p;if(!a.essential&&M.prefersReducedMotion){const St=c.L(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(St,d)}this.stop(),a=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.b8},a);const _=this._getTransformForUpdate(),v=this.getZoom(),T=this.getBearing(),k=this.getPitch(),E=this.getPadding(),L="bearing"in a?this._normalizeBearing(a.bearing,T):T,R="pitch"in a?+a.pitch:k,N="padding"in a?a.padding:_.padding,W=c.P.convert(a.offset);let X=_.centerPoint.add(W);const te=_.pointLocation(X),{center:ue,zoom:re}=_.getConstrained(c.M.convert(a.center||te),(p=a.zoom)!==null&&p!==void 0?p:v);this._normalizeCenter(ue);const pe=_.zoomScale(re-v),ve=_.project(te),ce=_.project(ue).sub(ve);let Se=a.curve;const ze=Math.max(_.width,_.height),Oe=ze/pe,Qe=ce.mag();if("minZoom"in a){const St=c.ac(Math.min(a.minZoom,v,re),_.minZoom,_.maxZoom),$t=ze/_.zoomScale(St-v);Se=Math.sqrt($t/Qe*2)}const ft=Se*Se;function Et(St){const $t=(Oe*Oe-ze*ze+(St?-1:1)*ft*ft*Qe*Qe)/(2*(St?Oe:ze)*ft*Qe);return Math.log(Math.sqrt($t*$t+1)-$t)}function Dt(St){return(Math.exp(St)-Math.exp(-St))/2}function pt(St){return(Math.exp(St)+Math.exp(-St))/2}const _t=Et(!1);let jt=function(St){return pt(_t)/pt(_t+Se*St)},rn=function(St){return ze*((pt(_t)*(Dt($t=_t+Se*St)/pt($t))-Dt(_t))/ft)/Qe;var $t},bt=(Et(!0)-_t)/Se;if(Math.abs(Qe)<1e-6||!isFinite(bt)){if(Math.abs(ze-Oe)<1e-6)return this.easeTo(a,d);const St=Oe<ze?-1:1;bt=Math.abs(Math.log(Oe/ze))/Se,rn=()=>0,jt=$t=>Math.exp(St*Se*$t)}return a.duration="duration"in a?+a.duration:1e3*bt/("screenSpeed"in a?+a.screenSpeed/Se:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this._zooming=!0,this._rotating=T!==L,this._pitching=R!==k,this._padding=!_.isPaddingEqual(N),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(ue),this._ease(St=>{const $t=St*bt,Ei=1/jt($t);_.zoom=St===1?re:v+_.scaleZoom(Ei),this._rotating&&(_.bearing=c.z.number(T,L,St)),this._pitching&&(_.pitch=c.z.number(k,R,St)),this._padding&&(_.interpolatePadding(E,N,St),X=_.centerPoint.add(W)),this.terrain&&!a.freezeElevation&&this._updateElevation(St);const xn=St===1?ue:_.unproject(ve.add(ce.mult(rn($t))).mult(Ei));_.setLocationAtPoint(_.renderWorldCopies?xn.wrap():xn,X),this._applyUpdatedTransform(_),this._fireMoveEvents(d)},()=>{this.terrain&&a.freezeElevation&&this._finalizeElevation(),this._afterEase(d)},a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,d){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,d)}return a||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(a,d,p){p.animate===!1||p.duration===0?(a(1),d()):(this._easeStart=M.now(),this._easeOptions=p,this._onEaseFrame=a,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(a,d){a=c.b2(a,-180,180);const p=Math.abs(a-d);return Math.abs(a-360-d)<p&&(a-=360),Math.abs(a+360-d)<p&&(a+=360),a}_normalizeCenter(a){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const p=a.lng-d.center.lng;a.lng+=p>180?-360:p<-180?360:0}queryTerrainElevation(a){return this.terrain?this.terrain.getElevationForLngLatZoom(c.M.convert(a),this.transform.tileZoom)-this.transform.elevation:null}}const i0={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class r0{constructor(a=i0){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=a}getDefaultPosition(){return"bottom-right"}onAdd(a){return this._map=a,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(a,d){const p=this._map._getUIString(`AttributionControl.${d}`);a.title=p,a.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&a.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const d=this._map.style.sourceCaches;for(const _ in d){const v=d[_];if(v.used||v.usedForTerrain){const T=v.getSource();T.attribution&&a.indexOf(T.attribution)<0&&a.push(T.attribution)}}a=a.filter(_=>String(_).trim()),a.sort((_,v)=>_.length-v.length),a=a.filter((_,v)=>{for(let T=v+1;T<a.length;T++)if(a[T].indexOf(_)>=0)return!1;return!0});const p=a.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,a.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class jf{constructor(a={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const p=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=a}getDefaultPosition(){return"bottom-left"}onAdd(a){this._map=a,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const d=A.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class $u{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const d=++this._id;return this._queue.push({callback:a,id:d,cancelled:!1}),d}remove(a){const d=this._currentlyRunning,p=d?this._queue.concat(d):this._queue;for(const _ of p)if(_.id===a)return void(_.cancelled=!0)}run(a=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const p of d)if(!p.cancelled&&(p.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var il=c.X([{name:"a_pos3d",type:"Int16",components:3}]);class Rt extends c.E{constructor(a){super(),this.sourceCache=a,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,a.usedForTerrain=!0,a.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(a,d){this.sourceCache.update(a,d),this._renderableTilesKeys=[];const p={};for(const _ of a.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))p[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.posMatrix=new Float64Array(16),c.aO(_.posMatrix,0,c.W,0,c.W,0,1),this._tiles[_.key]=new Un(_,this.tileSize));for(const _ in this._tiles)p[_]||delete this._tiles[_]}freeRtt(a){for(const d in this._tiles){const p=this._tiles[d];(!a||p.tileID.equals(a)||p.tileID.isChildOf(a)||a.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(a=>this.getTileByID(a))}getTileByID(a){return this._tiles[a]}getTerrainCoords(a){const d={};for(const p of this._renderableTilesKeys){const _=this._tiles[p].tileID;if(_.canonical.equals(a.canonical)){const v=a.clone();v.posMatrix=new Float64Array(16),c.aO(v.posMatrix,0,c.W,0,c.W,0,1),d[p]=v}else if(_.canonical.isChildOf(a.canonical)){const v=a.clone();v.posMatrix=new Float64Array(16);const T=_.canonical.z-a.canonical.z,k=_.canonical.x-(_.canonical.x>>T<<T),E=_.canonical.y-(_.canonical.y>>T<<T),L=c.W>>T;c.aO(v.posMatrix,0,L,0,L,0,1),c.H(v.posMatrix,v.posMatrix,[-k*L,-E*L,0]),d[p]=v}else if(a.canonical.isChildOf(_.canonical)){const v=a.clone();v.posMatrix=new Float64Array(16);const T=a.canonical.z-_.canonical.z,k=a.canonical.x-(a.canonical.x>>T<<T),E=a.canonical.y-(a.canonical.y>>T<<T),L=c.W>>T;c.aO(v.posMatrix,0,c.W,0,c.W,0,1),c.H(v.posMatrix,v.posMatrix,[k*L,E*L,0]),c.J(v.posMatrix,v.posMatrix,[1/2**T,1/2**T,0]),d[p]=v}}return d}getSourceTile(a,d){const p=this.sourceCache._source;let _=a.overscaledZ-this.deltaZoom;if(_>p.maxzoom&&(_=p.maxzoom),_<p.minzoom)return null;this._sourceTileCache[a.key]||(this._sourceTileCache[a.key]=a.scaledTo(_).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[a.key]);if((!v||!v.dem)&&d)for(;_>=p.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(a.scaledTo(_--).key);return v}tilesAfterTime(a=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=a)}}class a0{constructor(a,d,p){this.painter=a,this.sourceCache=new Rt(d),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(a,d,p,_=c.W){var v;if(!(d>=0&&d<_&&p>=0&&p<_))return 0;const T=this.getTerrainData(a),k=(v=T.tile)===null||v===void 0?void 0:v.dem;if(!k)return 0;const E=function(te,ue,re){var pe=ue[0],ve=ue[1];return te[0]=re[0]*pe+re[4]*ve+re[12],te[1]=re[1]*pe+re[5]*ve+re[13],te}([],[d/_*c.W,p/_*c.W],T.u_terrain_matrix),L=[E[0]*k.dim,E[1]*k.dim],R=Math.floor(L[0]),N=Math.floor(L[1]),W=L[0]-R,X=L[1]-N;return k.get(R,N)*(1-W)*(1-X)+k.get(R+1,N)*W*(1-X)+k.get(R,N+1)*(1-W)*X+k.get(R+1,N+1)*W*X}getElevationForLngLatZoom(a,d){const{tileID:p,mercatorX:_,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(a,d);return this.getElevation(p,_%c.W,v%c.W,c.W)}getElevation(a,d,p,_=c.W){return this.getDEMElevation(a,d,p,_)*this.exaggeration}getTerrainData(a){if(!this._emptyDemTexture){const _=this.painter.context,v=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Y(_,v,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Y(_,new c.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.an([])}const d=this.sourceCache.getSourceTile(a,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const _=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new Y(_,d.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),d.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const p=d&&d+d.tileID.key+a.key;if(p&&!this._demMatrixCache[p]){const _=this.sourceCache.sourceCache._source.maxzoom;let v=a.canonical.z-d.tileID.canonical.z;a.overscaledZ>a.canonical.z&&(a.canonical.z>=_?v=a.canonical.z-_:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const T=a.canonical.x-(a.canonical.x>>v<<v),k=a.canonical.y-(a.canonical.y>>v<<v),E=c.ba(new Float64Array(16),[1/(c.W<<v),1/(c.W<<v),0]);c.H(E,E,[T*c.W,k*c.W,0]),this._demMatrixCache[a.key]={matrix:E,coord:a}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[a.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(a){const d=this.painter,p=d.width/devicePixelRatio,_=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Y(d.context,{width:p,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Y(d.context,{width:p,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(p,_,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,p,_))),this._fbo.colorAttachment.set(a==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const a=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,T=0;v<this._coordsTextureSize;v++)for(let k=0;k<this._coordsTextureSize;k++,T+=4)d[T+0]=255&k,d[T+1]=255&v,d[T+2]=k>>8<<4|v>>8,d[T+3]=0;const p=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),_=new Y(a,p,a.gl.RGBA,{premultiply:!1});return _.bind(a.gl.NEAREST,a.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(a){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),p=this.painter.context,_=p.gl,v=Math.round(a.x*this.painter.pixelRatio/devicePixelRatio),T=Math.round(a.y*this.painter.pixelRatio/devicePixelRatio),k=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(v,k-T-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null);const E=d[0]+(d[2]>>4<<8),L=d[1]+((15&d[2])<<8),R=this.coordsIndex[255-d[3]],N=R&&this.sourceCache.getTileByID(R);if(!N)return null;const W=this._coordsTextureSize,X=(1<<N.tileID.canonical.z)*W;return new c.Y((N.tileID.canonical.x*W+E)/X+N.tileID.wrap,(N.tileID.canonical.y*W+L)/X,this.getElevation(N.tileID,E,L,W))}depthAtPoint(a){const d=new Uint8Array(4),p=this.painter.context,_=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(a.x,this.painter.height/devicePixelRatio-a.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const a=this.painter.context,d=new c.bb,p=new c.aY,_=this.meshSize,v=c.W/_,T=_*_;for(let N=0;N<=_;N++)for(let W=0;W<=_;W++)d.emplaceBack(W*v,N*v,0);for(let N=0;N<T;N+=_+1)for(let W=0;W<_;W++)p.emplaceBack(W+N,_+W+N+1,_+W+N+2),p.emplaceBack(W+N,_+W+N+2,W+N+1);const k=d.length,E=k+2*(_+1);for(const N of[0,1])for(let W=0;W<=_;W++)for(const X of[0,1])d.emplaceBack(W*v,N*c.W,X);for(let N=0;N<2*_;N+=2)p.emplaceBack(E+N,E+N+1,E+N+3),p.emplaceBack(E+N,E+N+3,E+N+2),p.emplaceBack(k+N,k+N+3,k+N+1),p.emplaceBack(k+N,k+N+2,k+N+3);const L=d.length,R=L+2*(_+1);for(const N of[0,1])for(let W=0;W<=_;W++)for(const X of[0,1])d.emplaceBack(N*c.W,W*v,X);for(let N=0;N<2*_;N+=2)p.emplaceBack(L+N,L+N+1,L+N+3),p.emplaceBack(L+N,L+N+3,L+N+2),p.emplaceBack(R+N,R+N+3,R+N+1),p.emplaceBack(R+N,R+N+2,R+N+3);return this._mesh={indexBuffer:a.createIndexBuffer(p),vertexBuffer:a.createVertexBuffer(d,il.members),segments:c.$.simpleSegment(0,0,d.length,p.length)},this._mesh}getMeshFrameDelta(a){return 2*Math.PI*c.bc/Math.pow(2,a)/5}getMinTileElevationForLngLatZoom(a,d){var p;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(a,d);return(p=this.getMinMaxElevation(_).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(a){const d=this.getTerrainData(a).tile,p={minElevation:null,maxElevation:null};return d&&d.dem&&(p.minElevation=d.dem.min*this.exaggeration,p.maxElevation=d.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(a,d){const p=c.Y.fromLngLat(a.wrap()),_=(1<<d)*c.W,v=p.x*_,T=p.y*_,k=Math.floor(v/c.W),E=Math.floor(T/c.W);return{tileID:new c.Q(d,0,d,k,E),mercatorX:v,mercatorY:T}}}class eh{constructor(a,d,p){this._context=a,this._size=d,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const a of this._objects)a.texture.destroy(),a.fbo.destroy()}_createObject(a){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new Y(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(p.texture),{id:a,fbo:d,texture:p,stamp:-1,inUse:!1}}getObjectForId(a){return this._objects[a]}useObject(a){a.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>a.id!==d),this._recentlyUsed.push(a.id)}stampObject(a){a.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const a=this._createObject(this._objects.length);return this._objects.push(a),a}freeObject(a){a.inUse=!1}freeAllObjects(){for(const a of this._objects)this.freeObject(a)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(a=>!a.inUse)===!1}}const Hs={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class s0{constructor(a,d){this.painter=a,this.terrain=d,this.pool=new eh(a.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(a){return this.pool.getObjectForId(a.rtt[this._stacks.length-1].id).texture}prepareForRender(a,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=a._order.filter(p=>!a._layers[p].isHidden(d)),this._coordsDescendingInv={};for(const p in a.sourceCaches){this._coordsDescendingInv[p]={};const _=a.sourceCaches[p].getVisibleCoordinates();for(const v of _){const T=this.terrain.sourceCache.getTerrainCoords(v);for(const k in T)this._coordsDescendingInv[p][k]||(this._coordsDescendingInv[p][k]=[]),this._coordsDescendingInv[p][k].push(T[k])}}this._coordsDescendingInvStr={};for(const p of a._order){const _=a._layers[p],v=_.source;if(Hs[_.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const T in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][T]=this._coordsDescendingInv[v][T].map(k=>k.key).sort().join()}}for(const p of this._renderableTiles)for(const _ in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[_][p.tileID.key];v&&v!==p.rttCoords[_]&&(p.rtt=[])}}renderLayer(a){if(a.isHidden(this.painter.transform.zoom))return!1;const d=a.type,p=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===a.id;if(Hs[d]&&(this._prevType&&Hs[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(a.id),!_))return!0;if(Hs[this._prevType]||Hs[d]&&_){this._prevType=d;const v=this._stacks.length-1,T=this._stacks[v]||[];for(const k of this._renderableTiles){if(this.pool.isFull()&&(Gh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(k),k.rtt[v]){const L=this.pool.getObjectForId(k.rtt[v].id);if(L.stamp===k.rtt[v].stamp){this.pool.useObject(L);continue}}const E=this.pool.getOrCreateFreeObject();this.pool.useObject(E),this.pool.stampObject(E),k.rtt[v]={id:E.id,stamp:E.stamp},p.context.bindFramebuffer.set(E.fbo.framebuffer),p.context.clear({color:c.aP.transparent,stencil:0}),p.currentStencilSource=void 0;for(let L=0;L<T.length;L++){const R=p.style._layers[T[L]],N=R.source?this._coordsDescendingInv[R.source][k.tileID.key]:[k.tileID];p.context.viewport.set([0,0,E.fbo.width,E.fbo.height]),p._renderTileClippingMasks(R,N),p.renderLayer(p,p.style.sourceCaches[R.source],R,N),R.source&&(k.rttCoords[R.source]=this._coordsDescendingInvStr[R.source][k.tileID.key])}}return Gh(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Hs[d]}return!1}}const Ct={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},qf=b,Rg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:i0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},o0=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},Hf={showCompass:!0,showZoom:!0,visualizePitch:!1};class l0{constructor(a,d,p=!1){this.mousedown=T=>{this.startMouse(c.e({},T,{ctrlKey:!0,preventDefault:()=>T.preventDefault()}),A.mousePos(this.element,T)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=T=>{this.moveMouse(T,A.mousePos(this.element,T))},this.mouseup=T=>{this.mouseRotate.dragEnd(T),this.mousePitch&&this.mousePitch.dragEnd(T),this.offTemp()},this.touchstart=T=>{T.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,T.targetTouches)[0],this.startTouch(T,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=T=>{T.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,T.targetTouches)[0],this.moveTouch(T,this._lastPos))},this.touchend=T=>{T.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const _=a.dragRotate._mouseRotate.getClickTolerance(),v=a.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=Va({clickTolerance:_,enable:!0}),this.touchRotate=(({enable:T,clickTolerance:k,bearingDegreesPerPixelMoved:E=.8})=>{const L=new Gi;return new Xl({clickTolerance:k,move:(R,N)=>({bearingDelta:(N.x-R.x)*E}),moveStateManager:L,enable:T,assignEvents:o0})})({clickTolerance:_,enable:!0}),this.map=a,p&&(this.mousePitch=td({clickTolerance:v,enable:!0}),this.touchPitch=(({enable:T,clickTolerance:k,pitchDegreesPerPixelMoved:E=-.5})=>{const L=new Gi;return new Xl({clickTolerance:k,move:(R,N)=>({pitchDelta:(N.y-R.y)*E}),moveStateManager:L,enable:T,assignEvents:o0})})({clickTolerance:v,enable:!0})),A.addEventListener(d,"mousedown",this.mousedown),A.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(d,"touchcancel",this.reset)}startMouse(a,d){this.mouseRotate.dragStart(a,d),this.mousePitch&&this.mousePitch.dragStart(a,d),A.disableDrag()}startTouch(a,d){this.touchRotate.dragStart(a,d),this.touchPitch&&this.touchPitch.dragStart(a,d),A.disableDrag()}moveMouse(a,d){const p=this.map,{bearingDelta:_}=this.mouseRotate.dragMove(a,d)||{};if(_&&p.setBearing(p.getBearing()+_),this.mousePitch){const{pitchDelta:v}=this.mousePitch.dragMove(a,d)||{};v&&p.setPitch(p.getPitch()+v)}}moveTouch(a,d){const p=this.map,{bearingDelta:_}=this.touchRotate.dragMove(a,d)||{};if(_&&p.setBearing(p.getBearing()+_),this.touchPitch){const{pitchDelta:v}=this.touchPitch.dragMove(a,d)||{};v&&p.setPitch(p.getPitch()+v)}}off(){const a=this.element;A.removeEventListener(a,"mousedown",this.mousedown),A.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(a,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let rl;function c0(g,a,d){const p=new c.M(g.lng,g.lat);if(g=new c.M(g.lng,g.lat),a){const _=new c.M(g.lng-360,g.lat),v=new c.M(g.lng+360,g.lat),T=d.locationPoint(g).distSqr(a);d.locationPoint(_).distSqr(a)<T?g=_:d.locationPoint(v).distSqr(a)<T&&(g=v)}for(;Math.abs(g.lng-d.center.lng)>180;){const _=d.locationPoint(g);if(_.x>=0&&_.y>=0&&_.x<=d.width&&_.y<=d.height)break;g.lng>d.center.lng?g.lng-=360:g.lng+=360}return g.lng!==p.lng&&d.locationPoint(g).y>d.height/2-d.getHorizon()?g:p}const Wf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function al(g,a,d){const p=g.classList;for(const _ in Wf)p.remove(`maplibregl-${d}-anchor-${_}`);p.add(`maplibregl-${d}-anchor-${a}`)}class wi extends c.E{constructor(a){if(super(),this._onKeyPress=d=>{const p=d.code,_=d.charCode||d.keyCode;p!=="Space"&&p!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=d=>{const p=d.originalEvent.target,_=this._element;this._popup&&(p===_||_.contains(p))&&this.togglePopup()},this._update=d=>{var p;if(!this._map)return;const _=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!_)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?c0(this._lngLat,this._flatPos,this._map.transform):(p=this._lngLat)===null||p===void 0?void 0:p.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let v="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?v=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(v=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let T="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?T="rotateX(0deg)":this._pitchAlignment==="map"&&(T=`rotateX(${this._map.getPitch()}deg)`),d&&d.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${Wf[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${T} ${v}`),M.frameAsync(new AbortController).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment!=="auto"?a.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(a==null?void 0:a.opacity,a==null?void 0:a.opacityWhenCovered),a&&a.element)this._element=a.element,this._offset=c.P.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div"),this._element.setAttribute("aria-label","Map marker");const d=A.createNS("http://www.w3.org/2000/svg","svg"),p=41,_=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${p}px`),d.setAttributeNS(null,"width",`${_}px`),d.setAttributeNS(null,"viewBox",`0 0 ${_} ${p}`);const v=A.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const T=A.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill-rule","nonzero");const k=A.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const E=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const pe of E){const ve=A.createNS("http://www.w3.org/2000/svg","ellipse");ve.setAttributeNS(null,"opacity","0.04"),ve.setAttributeNS(null,"cx","10.5"),ve.setAttributeNS(null,"cy","5.80029008"),ve.setAttributeNS(null,"rx",pe.rx),ve.setAttributeNS(null,"ry",pe.ry),k.appendChild(ve)}const L=A.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill",this._color);const R=A.createNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),L.appendChild(R);const N=A.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"opacity","0.25"),N.setAttributeNS(null,"fill","#000000");const W=A.createNS("http://www.w3.org/2000/svg","path");W.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),N.appendChild(W);const X=A.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const te=A.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ue=A.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#000000"),ue.setAttributeNS(null,"opacity","0.25"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962");const re=A.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#FFFFFF"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962"),te.appendChild(ue),te.appendChild(re),T.appendChild(k),T.appendChild(L),T.appendChild(N),T.appendChild(X),T.appendChild(te),d.appendChild(T),d.setAttributeNS(null,"height",p*this._scale+"px"),d.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(d),this._offset=c.P.convert(a&&a.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),al(this._element,this._anchor,"marker"),a&&a.className)for(const d of a.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),a.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=c.M.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const _=Math.abs(13.5)/Math.SQRT2;a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=a,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const a=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:a?(a.isOpen()?a.remove():(a.setLngLat(this._lngLat),a.addTo(this._map)),this):this}_updateOpacity(a=!1){var d,p;if(!(!((d=this._map)===null||d===void 0)&&d.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(a)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const _=this._map,v=_.terrain.depthAtPoint(this._pos),T=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,T)-v<.006)return void(this._element.style.opacity=this._opacity);const k=-this._offset.y/_.transform._pixelPerMeter,E=Math.sin(_.getPitch()*Math.PI/180)*k,L=_.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),R=_.transform.lngLatToCameraDepth(this._lngLat,T+E)-L>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&R&&this._popup.remove(),this._element.style.opacity=R?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(a){return this._offset=c.P.convert(a),this._update(),this}addClassName(a){this._element.classList.add(a)}removeClassName(a){this._element.classList.remove(a)}toggleClassName(a){return this._element.classList.toggle(a)}setDraggable(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a&&a!=="auto"?a:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(a,d){return a===void 0&&d===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),a!==void 0&&(this._opacity=a),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const ad={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Jc=0,Kc=!1;const u0={maxWidth:100,unit:"metric"};function Zf(g,a,d){const p=d&&d.maxWidth||100,_=g._container.clientHeight/2,v=g.unproject([0,_]),T=g.unproject([p,_]),k=v.distanceTo(T);if(d&&d.unit==="imperial"){const E=3.2808*k;E>5280?th(a,p,E/5280,g._getUIString("ScaleControl.Miles")):th(a,p,E,g._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?th(a,p,k/1852,g._getUIString("ScaleControl.NauticalMiles")):k>=1e3?th(a,p,k/1e3,g._getUIString("ScaleControl.Kilometers")):th(a,p,k,g._getUIString("ScaleControl.Meters"))}function th(g,a,d,p){const _=function(v){const T=Math.pow(10,`${Math.floor(v)}`.length-1);let k=v/T;return k=k>=10?10:k>=5?5:k>=3?3:k>=2?2:k>=1?1:function(E){const L=Math.pow(10,Math.ceil(-Math.log(E)/Math.LN10));return Math.round(E*L)/L}(k),T*k}(d);g.style.width=a*(_/d)+"px",g.innerHTML=`${_}&nbsp;${p}`}const Ws={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},sd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Gt(g){if(g){if(typeof g=="number"){const a=Math.round(Math.abs(g)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,g),"top-left":new c.P(a,a),"top-right":new c.P(-a,a),bottom:new c.P(0,-g),"bottom-left":new c.P(a,-a),"bottom-right":new c.P(-a,-a),left:new c.P(g,0),right:new c.P(-g,0)}}if(g instanceof c.P||Array.isArray(g)){const a=c.P.convert(g);return{center:a,top:a,"top-left":a,"top-right":a,bottom:a,"bottom-left":a,"bottom-right":a,left:a,right:a}}return{center:c.P.convert(g.center||[0,0]),top:c.P.convert(g.top||[0,0]),"top-left":c.P.convert(g["top-left"]||[0,0]),"top-right":c.P.convert(g["top-right"]||[0,0]),bottom:c.P.convert(g.bottom||[0,0]),"bottom-left":c.P.convert(g["bottom-left"]||[0,0]),"bottom-right":c.P.convert(g["bottom-right"]||[0,0]),left:c.P.convert(g.left||[0,0]),right:c.P.convert(g.right||[0,0])}}return Gt(new c.P(0,0))}const Xt=b;h.AJAXError=c.bf,h.Evented=c.E,h.LngLat=c.M,h.MercatorCoordinate=c.Y,h.Point=c.P,h.addProtocol=c.bg,h.config=c.a,h.removeProtocol=c.bh,h.AttributionControl=r0,h.BoxZoomHandler=Ku,h.CanvasSource=Zn,h.CooperativeGesturesHandler=ss,h.DoubleClickZoomHandler=Of,h.DragPanHandler=Uf,h.DragRotateHandler=Yc,h.EdgeInsets=Yu,h.FullscreenControl=class extends c.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var a;let d=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((a=d==null?void 0:d.shadowRoot)===null||a===void 0)&&a.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},h.GeoJSONSource=on,h.GeolocateControl=class extends c.E{constructor(g){super(),this._onSuccess=a=>{if(this._map){if(this._isOutOfMapMaxBounds(a))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",a)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(a),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(a),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",a)),this._finish()}},this._updateCamera=a=>{const d=new c.M(a.coords.longitude,a.coords.latitude),p=a.coords.accuracy,_=this._map.getBearing(),v=c.e({bearing:_},this.options.fitBoundsOptions),T=Ee.fromLngLat(d,p);this._map.fitBounds(T,v,{geolocateSource:!0})},this._updateMarker=a=>{if(a){const d=new c.M(a.coords.longitude,a.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=a.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=a=>{if(this._map){if(this.options.trackUserLocation)if(a.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(a.code===3&&Kc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",a)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=a=>{if(this._map){if(this._container.addEventListener("contextmenu",d=>d.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",a===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new wi({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new wi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||d.originalEvent&&d.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")))})}},this.options=c.e({},ad,g)}onAdd(g){return this._map=g,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return c._(this,arguments,void 0,function*(a=!1){if(rl!==void 0&&!a)return rl;if(window.navigator.permissions===void 0)return rl=!!window.navigator.geolocation,rl;try{rl=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{rl=!!window.navigator.geolocation}return rl})}().then(a=>this._setupUI(a)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Jc=0,Kc=!1}_isOutOfMapMaxBounds(g){const a=this._map.getMaxBounds(),d=g.coords;return a&&(d.longitude<a.getWest()||d.longitude>a.getEast()||d.latitude<a.getSouth()||d.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),a=g.getSouthEast(),d=g.getNorthEast(),p=a.distanceTo(d),_=Math.ceil(this._accuracy/(p/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Jc--,Kc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Jc++,Jc>1?(g={maximumAge:6e5,timeout:0},Kc=!0):(g=this.options.positionOptions,Kc=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},h.Hash=Cf,h.ImageSource=yr,h.KeyboardHandler=nl,h.LngLatBounds=Ee,h.LogoControl=jf,h.Map=class extends Ng{constructor(g){if(c.bd.mark(c.be.create),(g=c.e({},Rg,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Af(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),{bearingSnap:g.bearingSnap}),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._maxTileCacheZoomLevels=g.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._renderTaskQueue=new $u,this._controls=[],this._mapId=c.a3(),this._locale=c.e({},Ct,g.locale),this._clickTolerance=g.clickTolerance,this._overridePixelRatio=g.pixelRatio,this._maxCanvasSize=g.maxCanvasSize,this.transformCameraUpdate=g.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=g.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=le.addThrottleControl(()=>this.isMoving()),this._requestManager=new ee(g.transformRequest),typeof g.container=="string"){if(this._container=document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const d=Jm(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{a?d(p):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Qu(this,g),this._hash=g.hash&&new Cf(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,c.e({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=g.localIdeographFontFamily,this._validateStyle=g.validateStyle,g.style&&this.setStyle(g.style,{localIdeographFontFamily:g.localIdeographFontFamily}),g.attributionControl&&this.addControl(new r0(typeof g.attributionControl=="boolean"?void 0:g.attributionControl)),g.maplibreLogo&&this.addControl(new jf,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(g,a){if(a===void 0&&(a=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=g.onAdd(this);this._controls.push(g);const p=this._controlPositions[a];return a.indexOf("bottom")!==-1?p.insertBefore(d,p.firstChild):p.appendChild(d),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(g);return a>-1&&this._controls.splice(a,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,a,d,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,a,d,p)}resize(g){var a;const d=this._containerDimensions(),p=d[0],_=d[1],v=this._getClampedPixelRatio(p,_);if(this._resizeCanvas(p,_,v),this.painter.resize(p,_,v),this.painter.overLimit()){const k=this.painter.context.gl;this._maxCanvasSize=[k.drawingBufferWidth,k.drawingBufferHeight];const E=this._getClampedPixelRatio(p,_);this._resizeCanvas(p,_,E),this.painter.resize(p,_,E)}this.transform.resize(p,_),(a=this._requestedCameraState)===null||a===void 0||a.resize(p,_);const T=!this._moving;return T&&(this.stop(),this.fire(new c.k("movestart",g)).fire(new c.k("move",g))),this.fire(new c.k("resize",g)),T&&this.fire(new c.k("moveend",g)),this}_getClampedPixelRatio(g,a){const{0:d,1:p}=this._maxCanvasSize,_=this.getPixelRatio(),v=g*_,T=a*_;return Math.min(v>d?d/v:1,T>p?p/T:1)*_}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Ee.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(c.M.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(c.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,a,d){if(g==="mouseenter"||g==="mouseover"){let p=!1;return{layer:a,listener:d,delegates:{mousemove:v=>{const T=this.getLayer(a)?this.queryRenderedFeatures(v.point,{layers:[a]}):[];T.length?p||(p=!0,d.call(this,new ea(g,this,v.originalEvent,{features:T}))):p=!1},mouseout:()=>{p=!1}}}}if(g==="mouseleave"||g==="mouseout"){let p=!1;return{layer:a,listener:d,delegates:{mousemove:T=>{(this.getLayer(a)?this.queryRenderedFeatures(T.point,{layers:[a]}):[]).length?p=!0:p&&(p=!1,d.call(this,new ea(g,this,T.originalEvent)))},mouseout:T=>{p&&(p=!1,d.call(this,new ea(g,this,T.originalEvent)))}}}}{const p=_=>{const v=this.getLayer(a)?this.queryRenderedFeatures(_.point,{layers:[a]}):[];v.length&&(_.features=v,d.call(this,_),delete _.features)};return{layer:a,listener:d,delegates:{[g]:p}}}}on(g,a,d){if(d===void 0)return super.on(g,a);const p=this._createDelegatedListener(g,a,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(p);for(const _ in p.delegates)this.on(_,p.delegates[_]);return this}once(g,a,d){if(d===void 0)return super.once(g,a);const p=this._createDelegatedListener(g,a,d);for(const _ in p.delegates)this.once(_,p.delegates[_]);return this}off(g,a,d){return d===void 0?super.off(g,a):(this._delegatedListeners&&this._delegatedListeners[g]&&(p=>{const _=this._delegatedListeners[g];for(let v=0;v<_.length;v++){const T=_[v];if(T.layer===a&&T.listener===d){for(const k in T.delegates)this.off(k,T.delegates[k]);return _.splice(v,1),this}}})(),this)}queryRenderedFeatures(g,a){if(!this.style)return[];let d;const p=g instanceof c.P||Array.isArray(g),_=p?g:[[0,0],[this.transform.width,this.transform.height]];if(a=a||(p?{}:g)||{},_ instanceof c.P||typeof _[0]=="number")d=[c.P.convert(_)];else{const v=c.P.convert(_[0]),T=c.P.convert(_[1]);d=[v,new c.P(T.x,v.y),T,new c.P(v.x,T.y),v]}return this.style.queryRenderedFeatures(d,a,this.transform)}querySourceFeatures(g,a){return this.style.querySourceFeatures(g,a)}setStyle(g,a){return(a=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},a)).diff!==!1&&a.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._updateStyle(g,a))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const a=this._locale[g];if(a==null)throw new Error(`Missing UI string '${g}'`);return a}_updateStyle(g,a){if(a.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,a));const d=this.style&&a.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new ho(this,a||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,a,d):this.style.loadJSON(g,a,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ho(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,a){if(typeof g=="string"){const d=this._requestManager.transformRequest(g,"Style");c.h(d,new AbortController).then(p=>{this._updateDiff(p.data,a)}).catch(p=>{p&&this.fire(new c.j(p))})}else typeof g=="object"&&this._updateDiff(g,a)}_updateDiff(g,a){try{this.style.setState(g,a)&&this._update(!0)}catch(d){c.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(g,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(g,a){return this._lazyInitEmptyStyle(),this.style.addSource(g,a),this._update(!0)}isSourceLoaded(g){const a=this.style&&this.style.sourceCaches[g];if(a!==void 0)return a.loaded();this.fire(new c.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const a=this.style.sourceCaches[g.source];if(!a)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&a.reload();for(const d in this.style._layers){const p=this.style._layers[d];p.type==="hillshade"&&p.source===g.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new a0(this.painter,a,g),this.painter.renderToTexture=new s0(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=d=>{d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new c.k("terrain",{terrain:g})),this}getTerrain(){var g,a;return(a=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&a!==void 0?a:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const a in g){const d=g[a]._tiles;for(const p in d){const _=d[p];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,a,d={}){const{pixelRatio:p=1,sdf:_=!1,stretchX:v,stretchY:T,content:k,textFitWidth:E,textFitHeight:L}=d;if(this._lazyInitEmptyStyle(),!(a instanceof HTMLImageElement||c.b(a))){if(a.width===void 0||a.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:R,height:N,data:W}=a,X=a;return this.style.addImage(g,{data:new c.R({width:R,height:N},new Uint8Array(W)),pixelRatio:p,stretchX:v,stretchY:T,content:k,textFitWidth:E,textFitHeight:L,sdf:_,version:0,userImage:X}),X.onAdd&&X.onAdd(this,g),this}}{const{width:R,height:N,data:W}=M.getImageData(a);this.style.addImage(g,{data:new c.R({width:R,height:N},W),pixelRatio:p,stretchX:v,stretchY:T,content:k,textFitWidth:E,textFitHeight:L,sdf:_,version:0})}}updateImage(g,a){const d=this.style.getImage(g);if(!d)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=a instanceof HTMLImageElement||c.b(a)?M.getImageData(a):a,{width:_,height:v,data:T}=p;if(_===void 0||v===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==d.data.width||v!==d.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const k=!(a instanceof HTMLImageElement||c.b(a));return d.data.replace(T,k),this.style.updateImage(g,d),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return le.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,a){return this._lazyInitEmptyStyle(),this.style.addLayer(g,a),this._update(!0)}moveLayer(g,a){return this.style.moveLayer(g,a),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,a,d){return this.style.setLayerZoomRange(g,a,d),this._update(!0)}setFilter(g,a,d={}){return this.style.setFilter(g,a,d),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,a,d,p={}){return this.style.setPaintProperty(g,a,d,p),this._update(!0)}getPaintProperty(g,a){return this.style.getPaintProperty(g,a)}setLayoutProperty(g,a,d,p={}){return this.style.setLayoutProperty(g,a,d,p),this._update(!0)}getLayoutProperty(g,a){return this.style.getLayoutProperty(g,a)}setGlyphs(g,a={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,a),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,a,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,a,d,p=>{p||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,a={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,a,d=>{d||this._update(!0)}),this}setLight(g,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,a),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(g,a){return this.style.setFeatureState(g,a),this._update()}removeFeatureState(g,a){return this.style.removeFeatureState(g,a),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,a=0;return this._container&&(g=this._container.clientWidth||400,a=this._container.clientHeight||300),[g,a]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const a=this._canvasContainer=A.create("div","maplibregl-canvas-container",g);this._interactive&&a.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),p=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],p);const _=this._controlContainer=A.create("div","maplibregl-control-container",g),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(T=>{v[T]=A.create("div",`maplibregl-ctrl-${T} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,a,d){this._canvas.width=Math.floor(d*g),this._canvas.height=Math.floor(d*a),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${a}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let a=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{a={requestedAttributes:g},p&&(a.statusMessage=p.statusMessage,a.type=p.type)},{once:!0});const d=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!d){const p="Failed to initialize WebGL";throw a?(a.message=p,new Error(JSON.stringify(a))):new Error(p)}this.painter=new Qn(d,this.transform),P.testSupport(d)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const a=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const _=this.transform.zoom,v=M.now();this.style.zoomHistory.update(_,v);const T=new c.a8(_,{now:v,fadeDuration:a,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),k=T.crossFadingFactor();k===1&&k===this._crossFadingFactor||(d=!0,this._crossFadingFactor=k),this.style.update(T)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.bd.mark(c.be.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const p=this._sourcesDirty||this._styleDirty||this._placementDirty;return p||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||p||(this._fullyLoaded=!0,c.bd.mark(c.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),le.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const a=this.painter.context.gl.getExtension("WEBGL_lose_context");a&&a.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),c.bd.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,M.frameAsync(this._frameRequest).then(g=>{c.bd.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return qf}getCameraTargetElevation(){return this.transform.elevation}},h.MapMouseEvent=ea,h.MapTouchEvent=Kl,h.MapWheelEvent=Km,h.Marker=wi,h.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const a=this._map.getZoom(),d=a===this._map.getMaxZoom(),p=a===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=a},this._setButtonTitle=(a,d)=>{const p=this._map._getUIString(`NavigationControl.${d}`);a.title=p,a.setAttribute("aria-label",p)},this.options=c.e({},Hf,g),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",a=>this._map.zoomIn({},{originalEvent:a})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",a=>this._map.zoomOut({},{originalEvent:a})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",a=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:a}):this._map.resetNorth({},{originalEvent:a})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new l0(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,a){const d=A.create("button",g,this._container);return d.type="button",d.addEventListener("click",a),d}},h.Popup=class extends c.E{constructor(g){super(),this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=a=>{this._update(a.point)},this._onMouseMove=a=>{this._update(a.point)},this._onDrag=a=>{this._update(a.point)},this._update=a=>{var d;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const k of this.options.className.split(" "))this._container.classList.add(k);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?c0(this._lngLat,this._flatPos,this._map.transform):(d=this._lngLat)===null||d===void 0?void 0:d.wrap(),this._trackPointer&&!a)return;const p=this._flatPos=this._pos=this._trackPointer&&a?a:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&a?a:this._map.transform.locationPoint(this._lngLat));let _=this.options.anchor;const v=Gt(this.options.offset);if(!_){const k=this._container.offsetWidth,E=this._container.offsetHeight;let L;L=p.y+v.bottom.y<E?["top"]:p.y>this._map.transform.height-E?["bottom"]:[],p.x<k/2?L.push("left"):p.x>this._map.transform.width-k/2&&L.push("right"),_=L.length===0?"bottom":L.join("-")}let T=p.add(v[_]);this.options.subpixelPositioning||(T=T.round()),A.setTransform(this._container,`${Wf[_]} translate(${T.x}px,${T.y}px)`),al(this._container,_,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Ws),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=c.M.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const a=document.createDocumentFragment(),d=document.createElement("body");let p;for(d.innerHTML=g;p=d.firstChild,p;)a.appendChild(p);return this.setDOMContent(a)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(sd);g&&g.focus()}},h.RasterDEMTileSource=Wn,h.RasterTileSource=wn,h.ScaleControl=class{constructor(g){this._onMove=()=>{Zf(this._map,this._container,this.options)},this.setUnit=a=>{this.options.unit=a,Zf(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},u0),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},h.ScrollZoomHandler=Rf,h.Style=ho,h.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},h.TwoFingersTouchPitchHandler=Ff,h.TwoFingersTouchRotateHandler=Bf,h.TwoFingersTouchZoomHandler=id,h.TwoFingersTouchZoomRotateHandler=Vf,h.VectorTileSource=De,h.VideoSource=br,h.addSourceType=(g,a)=>c._(void 0,void 0,void 0,function*(){if(pi(g))throw new Error(`A source type called "${g}" already exists.`);((d,p)=>{Tn[d]=p})(g,a)}),h.clearPrewarmedResources=function(){const g=Ut;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(st),Ut=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},h.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},h.getRTLTextPluginStatus=function(){return at().getRTLTextPluginStatus()},h.getVersion=function(){return Xt},h.getWorkerCount=function(){return ct.workerCount},h.getWorkerUrl=function(){return c.a.WORKER_URL},h.importScriptInWorkers=function(g){return tt().broadcast("IS",g)},h.prewarm=function(){gt().acquire(st)},h.setMaxParallelImageRequests=function(g){c.a.MAX_PARALLEL_IMAGE_REQUESTS=g},h.setRTLTextPlugin=function(g,a){return at().setRTLTextPlugin(g,a)},h.setWorkerCount=function(g){ct.workerCount=g},h.setWorkerUrl=function(g){c.a.WORKER_URL=g}});var u=n;return u})})($9);var KE=$9.exports;const Fo=Q9(KE);function D8(t){let e;return n=>{if(n)for(let i in n){let o=e==null?void 0:e[i],u=n[i];o!==u&&t(i,u,o)}else if(e)for(let i in e)t(i,void 0,e[i]);e=n}}function XE(t,...e){let n=[t];for(let i of e)if(i)Array.isArray(i)&&i[0]===t?n.push(...i.slice(1)):n.push(i);else continue;if(n.length!==1)return n.length===2?n[1]:n}function QE(t){return t===!0?["has","point_count"]:t===!1?["!",["has","point_count"]]:void 0}var A_=$E;function $E(t){var e,n,i;if(t){if(Array.isArray(t)){for(e=[],n=t.length,i=0;i<n;i++){var o=t[i];o!=null&&e.push(o)}return e}if(typeof t=="object"){e={};var u=Object.keys(t);for(n=u.length,i=0;i<n;i++){var h=u[i],c=t[h];c!=null&&(e[h]=c)}return e}}}function P8(t){let e=t[0],n,i,o=L8(t);return{c(){o.c(),n=er()},l(u){o.l(u),n=er()},m(u,h){o.m(u,h),Jt(u,n,h),i=!0},p(u,h){h[0]&1&&gr(e,e=u[0])?(Ji(),mt(o,1,1,fi),Ki(),o=L8(u),o.c(),rt(o,1),o.m(n.parentNode,n)):o.p(u,h)},i(u){i||(rt(o),i=!0)},o(u){mt(o),i=!1},d(u){u&&Fe(n),o.d(u)}}}function L8(t){let e;const n=t[36].default,i=Rr(n,t,t[35],null);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u[1]&16)&&Or(i,n,o,o[35],e?Vr(n,o[35],u,null):Ur(o[35]),null)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function eD(t){let e,n,i=t[0]&&P8(t);return{c(){i&&i.c(),e=er()},l(o){i&&i.l(o),e=er()},m(o,u){i&&i.m(o,u),Jt(o,e,u),n=!0},p(o,u){o[0]?i?(i.p(o,u),u[0]&1&&rt(i,1)):(i=P8(o),i.c(),rt(i,1),i.m(e.parentNode,e)):i&&(Ji(),mt(i,1,1,()=>{i=null}),Ki())},i(o){n||(rt(i),n=!0)},o(o){mt(i),n=!1},d(o){o&&Fe(e),i&&i.d(o)}}}function tD(t,e,n){let i,o,u,h,c,b,w,S,M,A,P,B,{$$slots:U={},$$scope:J}=e,{id:Q=Z1("layer")}=e,{source:K=void 0}=e,{sourceLayer:le=void 0}=e,{beforeId:ee=void 0}=e,{beforeLayerType:oe=void 0}=e,{type:Z}=e,{paint:ne=void 0}=e,{layout:be=void 0}=e,{filter:me=void 0}=e,{applyToClusters:Te=void 0}=e,{minzoom:Y=void 0}=e,{maxzoom:ye=void 0}=e,{manageHoverState:qe=!1}=e,{hovered:He=null}=e,{interactive:Be=!0}=e,{hoverCursor:lt=void 0}=e,{eventsIfTopMost:Ge=!1}=e;const ot=O1(),{map:je,source:Ve,self:$e,minzoom:st,maxzoom:ct,eventTopMost:Pt,layerInfo:Ut}=GE();ua(t,je,Ke=>n(31,M=Ke)),ua(t,Ve,Ke=>n(32,A=Ke)),ua(t,$e,Ke=>n(0,S=Ke)),ua(t,st,Ke=>n(34,B=Ke)),ua(t,ct,Ke=>n(33,P=Ke)),Ro(()=>{S&&M&&(Ut.delete(S),M==null||M.removeLayer(S))});let Lt;function gt(Ke){var wn,Wn;if(!Be||!S||!M||Ge&&Pt(Ke)!==S)return;let Ee=Ke.features??[],wt=(Wn=(wn=Ee[0])==null?void 0:wn.properties)==null?void 0:Wn.cluster_id,De={event:Ke,map:M,clusterId:wt,layer:S,source:c,features:Ee};ot(Ke.type,De)}function Bt(Ke){var wn,Wn;if(!Be||!S||!M||Ge&&Pt(Ke)!==S)return;lt&&(M.getCanvas().style.cursor=lt);let Ee=Ke.features??[];n(6,He=Ee[0]??null);let wt=(Wn=(wn=Ee[0])==null?void 0:wn.properties)==null?void 0:Wn.cluster_id;ot("mouseenter",{event:Ke,map:M,clusterId:wt,layer:S,source:c,features:Ee})}function tt(Ke){var wn,Wn,on;if(!Be||!M)return;if(Ge&&Pt(Ke)!==S){n(6,He=null),qe&&Lt!==void 0&&(M==null||M.setFeatureState({source:c,sourceLayer:le,id:Lt},{hover:!1}),Lt=void 0);return}M.getCanvas().style.cursor=lt;let Ee=Ke.features??[],wt=(Wn=(wn=Ee[0])==null?void 0:wn.properties)==null?void 0:Wn.cluster_id,De=(on=Ee[0])==null?void 0:on.id;De!==Lt&&(qe&&(Lt!==void 0&&(M==null||M.setFeatureState({source:c,id:Lt,sourceLayer:le},{hover:!1})),M==null||M.setFeatureState({source:c,id:De,sourceLayer:le},{hover:!0})),Lt=De,n(6,He=Ee[0]??null)),ot("mousemove",{event:Ke,map:M,clusterId:wt,layer:S,source:c,features:Ee})}function Le(Ke){if(!(!Be||!S||!M)){if(lt&&(M.getCanvas().style.cursor=""),n(6,He=null),qe&&Lt!==void 0){const Ee={source:c,id:Lt,sourceLayer:le};M==null||M.setFeatureState(Ee,{hover:!1}),Lt=void 0}ot("mouseleave",{map:M,layer:S,source:c})}}let ut=!0;function Re(Ke){M&&(M.off("click",Ke,gt),M.off("dblclick",Ke,gt),M.off("contextmenu",Ke,gt),M.off("mouseenter",Ke,Bt),M.off("mousemove",Ke,tt),M.off("mouseleave",Ke,Le))}return Ro(()=>{M&&S&&Re(S)}),t.$$set=Ke=>{"id"in Ke&&n(7,Q=Ke.id),"source"in Ke&&n(8,K=Ke.source),"sourceLayer"in Ke&&n(9,le=Ke.sourceLayer),"beforeId"in Ke&&n(10,ee=Ke.beforeId),"beforeLayerType"in Ke&&n(11,oe=Ke.beforeLayerType),"type"in Ke&&n(12,Z=Ke.type),"paint"in Ke&&n(13,ne=Ke.paint),"layout"in Ke&&n(14,be=Ke.layout),"filter"in Ke&&n(15,me=Ke.filter),"applyToClusters"in Ke&&n(16,Te=Ke.applyToClusters),"minzoom"in Ke&&n(17,Y=Ke.minzoom),"maxzoom"in Ke&&n(18,ye=Ke.maxzoom),"manageHoverState"in Ke&&n(19,qe=Ke.manageHoverState),"hovered"in Ke&&n(6,He=Ke.hovered),"interactive"in Ke&&n(20,Be=Ke.interactive),"hoverCursor"in Ke&&n(21,lt=Ke.hoverCursor),"eventsIfTopMost"in Ke&&n(22,Ge=Ke.eventsIfTopMost),"$$scope"in Ke&&n(35,J=Ke.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&65536&&n(30,i=QE(Te)),t.$$.dirty[0]&1073774592&&n(24,o=XE("all",i,me)),t.$$.dirty[0]&131072|t.$$.dirty[1]&8&&n(26,u=Y??B),t.$$.dirty[0]&262144|t.$$.dirty[1]&4&&n(25,h=ye??P),t.$$.dirty[0]&256|t.$$.dirty[1]&2&&n(29,c=K||A),t.$$.dirty[0]&654343809|t.$$.dirty[1]&1&&M&&S!==Q&&c){S&&(Re(S),Ut.delete(S));let Ke=ee;if(!ee&&oe){let Ee=M.getStyle().layers,wt=typeof oe=="function"?oe:wn=>wn.type===oe,De=Ee==null?void 0:Ee.find(wt);De&&(Ke=De.id)}_u($e,S=Q,S),M.addLayer(A_({id:S,type:Z,source:c,"source-layer":le,filter:o,paint:ne,layout:be,minzoom:u,maxzoom:h}),Ke),n(23,ut=!0),M.on("click",S,gt),M.on("dblclick",S,gt),M.on("contextmenu",S,gt),M.on("mouseenter",S,Bt),M.on("mousemove",S,tt),M.on("mouseleave",S,Le)}t.$$.dirty[0]&1048577&&S&&Ut.set(S,{interactive:Be}),t.$$.dirty[0]&1|t.$$.dirty[1]&1&&n(28,b=S?D8((Ke,Ee)=>M==null?void 0:M.setPaintProperty(S,Ke,Ee)):void 0),t.$$.dirty[0]&1|t.$$.dirty[1]&1&&n(27,w=S?D8((Ke,Ee)=>M==null?void 0:M.setLayoutProperty(S,Ke,Ee)):void 0),t.$$.dirty[0]&268443648&&(b==null||b(ne)),t.$$.dirty[0]&134234112&&(w==null||w(be)),t.$$.dirty[0]&100663297|t.$$.dirty[1]&1&&S&&(M==null||M.setLayerZoomRange(S,u,h)),t.$$.dirty[0]&25165825|t.$$.dirty[1]&1&&S&&(ut?n(23,ut=!1):M==null||M.setFilter(S,o))},[S,je,Ve,$e,st,ct,He,Q,K,le,ee,oe,Z,ne,be,me,Te,Y,ye,qe,Be,lt,Ge,ut,o,h,u,w,b,c,i,M,A,P,B,J,U]}class t4 extends jr{constructor(e){super(),qr(this,e,tD,eD,gr,{id:7,source:8,sourceLayer:9,beforeId:10,beforeLayerType:11,type:12,paint:13,layout:14,filter:15,applyToClusters:16,minzoom:17,maxzoom:18,manageHoverState:19,hovered:6,interactive:20,hoverCursor:21,eventsIfTopMost:22},null,[-1,-1])}}function nD(t){let e;const n=t[16].default,i=Rr(n,t,t[24],null);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u&16777216)&&Or(i,n,o,o[24],e?Vr(n,o[24],u,null):Ur(o[24]),null)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function iD(t){let e,n,i;function o(h){t[17](h)}let u={id:t[1],type:"circle",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],applyToClusters:t[9],minzoom:t[10],maxzoom:t[11],hoverCursor:t[12],manageHoverState:t[13],eventsIfTopMost:t[14],interactive:t[15],$$slots:{default:[nD]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.hovered=t[0]),e=new t4({props:u}),Fr.push(()=>V1(e,"hovered",o)),e.$on("click",t[18]),e.$on("dblclick",t[19]),e.$on("contextmenu",t[20]),e.$on("mouseenter",t[21]),e.$on("mousemove",t[22]),e.$on("mouseleave",t[23]),{c(){ii(e.$$.fragment)},l(h){ri(e.$$.fragment,h)},m(h,c){ai(e,h,c),i=!0},p(h,[c]){const b={};c&2&&(b.id=h[1]),c&4&&(b.source=h[2]),c&8&&(b.sourceLayer=h[3]),c&16&&(b.beforeId=h[4]),c&32&&(b.beforeLayerType=h[5]),c&64&&(b.paint=h[6]),c&128&&(b.layout=h[7]),c&256&&(b.filter=h[8]),c&512&&(b.applyToClusters=h[9]),c&1024&&(b.minzoom=h[10]),c&2048&&(b.maxzoom=h[11]),c&4096&&(b.hoverCursor=h[12]),c&8192&&(b.manageHoverState=h[13]),c&16384&&(b.eventsIfTopMost=h[14]),c&32768&&(b.interactive=h[15]),c&16777216&&(b.$$scope={dirty:c,ctx:h}),!n&&c&1&&(n=!0,b.hovered=h[0],U1(()=>n=!1)),e.$set(b)},i(h){i||(rt(e.$$.fragment,h),i=!0)},o(h){mt(e.$$.fragment,h),i=!1},d(h){si(e,h)}}}function rD(t,e,n){let{$$slots:i={},$$scope:o}=e,{id:u=Z1("circle")}=e,{source:h=void 0}=e,{sourceLayer:c=void 0}=e,{beforeId:b=void 0}=e,{beforeLayerType:w=void 0}=e,{paint:S}=e,{layout:M=void 0}=e,{filter:A=void 0}=e,{applyToClusters:P=void 0}=e,{minzoom:B=void 0}=e,{maxzoom:U=void 0}=e,{hoverCursor:J=void 0}=e,{manageHoverState:Q=!1}=e,{hovered:K=null}=e,{eventsIfTopMost:le=!1}=e,{interactive:ee=!0}=e;function oe(ye){K=ye,n(0,K)}function Z(ye){Yi.call(this,t,ye)}function ne(ye){Yi.call(this,t,ye)}function be(ye){Yi.call(this,t,ye)}function me(ye){Yi.call(this,t,ye)}function Te(ye){Yi.call(this,t,ye)}function Y(ye){Yi.call(this,t,ye)}return t.$$set=ye=>{"id"in ye&&n(1,u=ye.id),"source"in ye&&n(2,h=ye.source),"sourceLayer"in ye&&n(3,c=ye.sourceLayer),"beforeId"in ye&&n(4,b=ye.beforeId),"beforeLayerType"in ye&&n(5,w=ye.beforeLayerType),"paint"in ye&&n(6,S=ye.paint),"layout"in ye&&n(7,M=ye.layout),"filter"in ye&&n(8,A=ye.filter),"applyToClusters"in ye&&n(9,P=ye.applyToClusters),"minzoom"in ye&&n(10,B=ye.minzoom),"maxzoom"in ye&&n(11,U=ye.maxzoom),"hoverCursor"in ye&&n(12,J=ye.hoverCursor),"manageHoverState"in ye&&n(13,Q=ye.manageHoverState),"hovered"in ye&&n(0,K=ye.hovered),"eventsIfTopMost"in ye&&n(14,le=ye.eventsIfTopMost),"interactive"in ye&&n(15,ee=ye.interactive),"$$scope"in ye&&n(24,o=ye.$$scope)},[K,u,h,c,b,w,S,M,A,P,B,U,J,Q,le,ee,i,oe,Z,ne,be,me,Te,Y,o]}class aD extends jr{constructor(e){super(),qr(this,e,rD,iD,gr,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,applyToClusters:9,minzoom:10,maxzoom:11,hoverCursor:12,manageHoverState:13,hovered:0,eventsIfTopMost:14,interactive:15})}}function sD(t,e,n){let i;const{map:o}=yf();ua(t,o,b=>n(4,i=b));let{position:u="top-left"}=e,{container:h=void 0}=e,c=null;return Ro(()=>{i!=null&&i.loaded()&&c&&i.removeControl(c)}),t.$$set=b=>{"position"in b&&n(1,u=b.position),"container"in b&&n(2,h=b.container)},t.$$.update=()=>{if(t.$$.dirty&30&&i&&!c){let b;typeof h=="string"?b=document.querySelector(h)??void 0:b=h,n(3,c=new Fo.FullscreenControl({container:b})),i.addControl(c,u)}},[o,u,h,c,i]}class oD extends jr{constructor(e){super(),qr(this,e,sD,null,gr,{position:1,container:2})}}function lD(t,e,n,i,o){let u=!1;t.getSource(e)&&(u=!0,t.removeSource(e));const h=()=>{i(e)&&(t.addSource(e,n),o())};if(u){const c=()=>{e&&(t.getSource(e)?setTimeout(c,1):h())};c()}else h()}function cD(t,e,n){F9().then(()=>{let i=_k(t);if(!i)return;i.getSource(e)===n&&i.removeSource(e)})}function z8(t){let e=t[0],n,i,o=B8(t);return{c(){o.c(),n=er()},l(u){o.l(u),n=er()},m(u,h){o.m(u,h),Jt(u,n,h),i=!0},p(u,h){h&1&&gr(e,e=u[0])?(Ji(),mt(o,1,1,fi),Ki(),o=B8(u),o.c(),rt(o,1),o.m(n.parentNode,n)):o.p(u,h)},i(u){i||(rt(o),i=!0)},o(u){mt(o),i=!1},d(u){u&&Fe(n),o.d(u)}}}function B8(t){let e;const n=t[15].default,i=Rr(n,t,t[14],null);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u&16384)&&Or(i,n,o,o[14],e?Vr(n,o[14],u,null):Ur(o[14]),null)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function uD(t){let e,n,i=t[0]&&z8(t);return{c(){i&&i.c(),e=er()},l(o){i&&i.l(o),e=er()},m(o,u){i&&i.m(o,u),Jt(o,e,u),n=!0},p(o,[u]){o[0]?i?(i.p(o,u),u&1&&rt(i,1)):(i=z8(o),i.c(),rt(i,1),i.m(e.parentNode,e)):i&&(Ji(),mt(i,1,1,()=>{i=null}),Ki())},i(o){n||(rt(i),n=!0)},o(o){mt(i),n=!1},d(o){o&&Fe(e),i&&i.d(o)}}}function hD(t,e,n){let i,o,u,{$$slots:h={},$$scope:c}=e,{id:b=Z1("geojson")}=e,{data:w}=e,{generateId:S=!1}=e,{promoteId:M=void 0}=e,{filter:A=void 0}=e,{lineMetrics:P=void 0}=e,{cluster:B=void 0}=e;const{map:U,cluster:J,self:Q}=ZE();ua(t,U,ee=>n(13,o=ee)),ua(t,J,ee=>n(16,u=ee)),ua(t,Q,ee=>n(0,i=ee));let K,le=!0;return Ro(()=>{i&&K&&o&&(cD(U,i,K),_u(Q,i=null,i),n(11,K=void 0))}),t.$$set=ee=>{"id"in ee&&n(4,b=ee.id),"data"in ee&&n(5,w=ee.data),"generateId"in ee&&n(6,S=ee.generateId),"promoteId"in ee&&n(7,M=ee.promoteId),"filter"in ee&&n(8,A=ee.filter),"lineMetrics"in ee&&n(9,P=ee.lineMetrics),"cluster"in ee&&n(10,B=ee.cluster),"$$scope"in ee&&n(14,c=ee.$$scope)},t.$$.update=()=>{t.$$.dirty&1024&&_u(J,u=B,u),t.$$.dirty&12273&&o&&i!==b&&(_u(Q,i=b,i),lD(o,i,A_({type:"geojson",data:w,filter:A,lineMetrics:P,generateId:S,promoteId:M,cluster:!!B,clusterMinPoints:B==null?void 0:B.minPoints,clusterMaxZoom:B==null?void 0:B.maxZoom,clusterRadius:B==null?void 0:B.radius,clusterProperties:B==null?void 0:B.properties}),ee=>o&&ee===i,()=>{i&&(n(11,K=o==null?void 0:o.getSource(i)),n(12,le=!0))})),t.$$.dirty&8208&&(o==null||o.on("style.load",()=>{n(11,K=o==null?void 0:o.getSource(b))})),t.$$.dirty&6176&&K&&(le?n(12,le=!1):K.setData(w)),t.$$.dirty&3072&&(K==null||K.setClusterOptions(A_({cluster:!!B,clusterMaxZoom:B==null?void 0:B.maxZoom,clusterRadius:B==null?void 0:B.radius})))},[i,U,J,Q,b,w,S,M,A,P,B,K,le,o,c,h]}class F8 extends jr{constructor(e){super(),qr(this,e,hD,uD,gr,{id:4,data:5,generateId:6,promoteId:7,filter:8,lineMetrics:9,cluster:10})}}function dD(t,e,n){let i;const{map:o}=yf();ua(t,o,A=>n(8,i=A));let{position:u="top-left"}=e,{positionOptions:h=void 0}=e,{fitBoundsOptions:c=void 0}=e,{trackUserLocation:b=!1}=e,{showAccuracyCircle:w=!0}=e,{showUserLocation:S=!0}=e,M=null;return Ro(()=>{i!=null&&i.loaded()&&M&&i.removeControl(M)}),t.$$set=A=>{"position"in A&&n(1,u=A.position),"positionOptions"in A&&n(2,h=A.positionOptions),"fitBoundsOptions"in A&&n(3,c=A.fitBoundsOptions),"trackUserLocation"in A&&n(4,b=A.trackUserLocation),"showAccuracyCircle"in A&&n(5,w=A.showAccuracyCircle),"showUserLocation"in A&&n(6,S=A.showUserLocation)},t.$$.update=()=>{t.$$.dirty&510&&i&&!M&&(n(7,M=new Fo.GeolocateControl({positionOptions:h,fitBoundsOptions:c,trackUserLocation:b,showAccuracyCircle:w,showUserLocation:S})),i.addControl(M,u))},[o,u,h,c,b,w,S,M,i]}class fD extends jr{constructor(e){super(),qr(this,e,dD,null,gr,{position:1,positionOptions:2,fitBoundsOptions:3,trackUserLocation:4,showAccuracyCircle:5,showUserLocation:6})}}function pD(t){let e;const n=t[15].default,i=Rr(n,t,t[23],null);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u&8388608)&&Or(i,n,o,o[23],e?Vr(n,o[23],u,null):Ur(o[23]),null)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function mD(t){let e,n,i;function o(h){t[16](h)}let u={id:t[1],type:"line",source:t[2],sourceLayer:t[3],beforeId:t[4],beforeLayerType:t[5],paint:t[6],layout:t[7],filter:t[8],minzoom:t[9],maxzoom:t[10],hoverCursor:t[11],manageHoverState:t[12],eventsIfTopMost:t[13],interactive:t[14],$$slots:{default:[pD]},$$scope:{ctx:t}};return t[0]!==void 0&&(u.hovered=t[0]),e=new t4({props:u}),Fr.push(()=>V1(e,"hovered",o)),e.$on("click",t[17]),e.$on("dblclick",t[18]),e.$on("contextmenu",t[19]),e.$on("mouseenter",t[20]),e.$on("mousemove",t[21]),e.$on("mouseleave",t[22]),{c(){ii(e.$$.fragment)},l(h){ri(e.$$.fragment,h)},m(h,c){ai(e,h,c),i=!0},p(h,[c]){const b={};c&2&&(b.id=h[1]),c&4&&(b.source=h[2]),c&8&&(b.sourceLayer=h[3]),c&16&&(b.beforeId=h[4]),c&32&&(b.beforeLayerType=h[5]),c&64&&(b.paint=h[6]),c&128&&(b.layout=h[7]),c&256&&(b.filter=h[8]),c&512&&(b.minzoom=h[9]),c&1024&&(b.maxzoom=h[10]),c&2048&&(b.hoverCursor=h[11]),c&4096&&(b.manageHoverState=h[12]),c&8192&&(b.eventsIfTopMost=h[13]),c&16384&&(b.interactive=h[14]),c&8388608&&(b.$$scope={dirty:c,ctx:h}),!n&&c&1&&(n=!0,b.hovered=h[0],U1(()=>n=!1)),e.$set(b)},i(h){i||(rt(e.$$.fragment,h),i=!0)},o(h){mt(e.$$.fragment,h),i=!1},d(h){si(e,h)}}}function _D(t,e,n){let{$$slots:i={},$$scope:o}=e,{id:u=Z1("line")}=e,{source:h=void 0}=e,{sourceLayer:c=void 0}=e,{beforeId:b=void 0}=e,{beforeLayerType:w=void 0}=e,{paint:S}=e,{layout:M=void 0}=e,{filter:A=void 0}=e,{minzoom:P=void 0}=e,{maxzoom:B=void 0}=e,{hoverCursor:U=void 0}=e,{manageHoverState:J=!1}=e,{hovered:Q=null}=e,{eventsIfTopMost:K=!1}=e,{interactive:le=!0}=e;function ee(Y){Q=Y,n(0,Q)}function oe(Y){Yi.call(this,t,Y)}function Z(Y){Yi.call(this,t,Y)}function ne(Y){Yi.call(this,t,Y)}function be(Y){Yi.call(this,t,Y)}function me(Y){Yi.call(this,t,Y)}function Te(Y){Yi.call(this,t,Y)}return t.$$set=Y=>{"id"in Y&&n(1,u=Y.id),"source"in Y&&n(2,h=Y.source),"sourceLayer"in Y&&n(3,c=Y.sourceLayer),"beforeId"in Y&&n(4,b=Y.beforeId),"beforeLayerType"in Y&&n(5,w=Y.beforeLayerType),"paint"in Y&&n(6,S=Y.paint),"layout"in Y&&n(7,M=Y.layout),"filter"in Y&&n(8,A=Y.filter),"minzoom"in Y&&n(9,P=Y.minzoom),"maxzoom"in Y&&n(10,B=Y.maxzoom),"hoverCursor"in Y&&n(11,U=Y.hoverCursor),"manageHoverState"in Y&&n(12,J=Y.manageHoverState),"hovered"in Y&&n(0,Q=Y.hovered),"eventsIfTopMost"in Y&&n(13,K=Y.eventsIfTopMost),"interactive"in Y&&n(14,le=Y.interactive),"$$scope"in Y&&n(23,o=Y.$$scope)},[Q,u,h,c,b,w,S,M,A,P,B,U,J,K,le,i,ee,oe,Z,ne,be,me,Te,o]}class gD extends jr{constructor(e){super(),qr(this,e,_D,mD,gr,{id:1,source:2,sourceLayer:3,beforeId:4,beforeLayerType:5,paint:6,layout:7,filter:8,minzoom:9,maxzoom:10,hoverCursor:11,manageHoverState:12,hovered:0,eventsIfTopMost:13,interactive:14})}}function yD(t){let e=t.getCenter(),n=Math.round(t.getZoom()*100)/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),u=Math.round(e.lat*o)/o,h=Math.round(e.lng*o)/o,c=`${n}/${u}/${h}`,b=t.getBearing(),w=t.getPitch();return(b||w)&&(c+=`/${Math.round(b*10)/10}`),w&&(c+=`/${Math.round(w)}`),`#${c}`}function bD(t){return t.replace("#","").split("/").map(parseFloat)}var N0=Fv;function Fv(t,e){return t===e||t!==t&&e!==e?!0:typeof t!=typeof e||{}.toString.call(t)!={}.toString.call(e)||t!==Object(t)||!t?!1:Array.isArray(t)?N8(t,e):{}.toString.call(t)=="[object Set]"?N8(Array.from(t),Array.from(e)):{}.toString.call(t)=="[object Object]"?xD(t,e):vD(t,e)}function vD(t,e){return t.toString()===e.toString()}function N8(t,e){var n=t.length;if(n!=e.length)return!1;for(var i=0;i<n;i++)if(!Fv(t[i],e[i]))return!1;return!0}function xD(t,e){var n=Object.keys(t),i=n.length;if(i!=Object.keys(e).length)return!1;for(var o=0;o<i;o++){var u=n[o];if(!(e.hasOwnProperty(u)&&Fv(t[u],e[u])))return!1}return!0}function wD(t,e,n){let i;const{map:o}=yf();ua(t,o,S=>n(6,i=S));let{position:u="top-left"}=e,{showCompass:h=!0}=e,{showZoom:c=!0}=e,{visualizePitch:b=!1}=e,w=null;return Ro(()=>{i!=null&&i.loaded()&&w&&i.removeControl(w)}),t.$$set=S=>{"position"in S&&n(1,u=S.position),"showCompass"in S&&n(2,h=S.showCompass),"showZoom"in S&&n(3,c=S.showZoom),"visualizePitch"in S&&n(4,b=S.visualizePitch)},t.$$.update=()=>{t.$$.dirty&126&&i&&!w&&(n(5,w=new Fo.NavigationControl({showCompass:h,showZoom:c,visualizePitch:b})),i.addControl(w,u))},[o,u,h,c,b,w,i]}class SD extends jr{constructor(e){super(),qr(this,e,wD,null,gr,{position:1,showCompass:2,showZoom:3,visualizePitch:4})}}function ID(t,e,n){let i;const{map:o}=yf();ua(t,o,w=>n(5,i=w));let{position:u="bottom-left"}=e,{maxWidth:h=void 0}=e,{unit:c="metric"}=e,b=null;return Ro(()=>{i!=null&&i.loaded()&&b&&i.removeControl(b)}),t.$$set=w=>{"position"in w&&n(1,u=w.position),"maxWidth"in w&&n(2,h=w.maxWidth),"unit"in w&&n(3,c=w.unit)},t.$$.update=()=>{t.$$.dirty&62&&i&&!b&&(n(4,b=new Fo.ScaleControl({maxWidth:h,unit:c})),i.addControl(b,u))},[o,u,h,c,b,i]}class TD extends jr{constructor(e){super(),qr(this,e,ID,null,gr,{position:1,maxWidth:2,unit:3})}}const{window:MD}=bk,AD=t=>({map:t[0]&8,loadedImages:t[0]&16,allImagesLoaded:t[0]&32}),R8=t=>({map:t[3],loadedImages:t[4],allImagesLoaded:t[5]});function O8(t){let e,n,i=t[2]&&U8(t);const o=t[38].default,u=Rr(o,t,t[37],R8);return{c(){i&&i.c(),e=Mt(),u&&u.c()},l(h){i&&i.l(h),e=At(h),u&&u.l(h)},m(h,c){i&&i.m(h,c),Jt(h,e,c),u&&u.m(h,c),n=!0},p(h,c){h[2]?i?(i.p(h,c),c[0]&4&&rt(i,1)):(i=U8(h),i.c(),rt(i,1),i.m(e.parentNode,e)):i&&(Ji(),mt(i,1,1,()=>{i=null}),Ki()),u&&u.p&&(!n||c[0]&56|c[1]&64)&&Or(u,o,h,h[37],n?Vr(o,h[37],c,AD):Ur(h[37]),R8)},i(h){n||(rt(i),rt(u,h),n=!0)},o(h){mt(i),mt(u,h),n=!1},d(h){h&&Fe(e),i&&i.d(h),u&&u.d(h)}}}function U8(t){let e,n,i,o,u,h,c,b;return e=new SD({props:{position:t[6]}}),i=new fD({props:{position:t[6],fitBoundsOptions:{maxZoom:12}}}),u=new oD({props:{position:t[6]}}),c=new TD({props:{position:t[6]}}),{c(){ii(e.$$.fragment),n=Mt(),ii(i.$$.fragment),o=Mt(),ii(u.$$.fragment),h=Mt(),ii(c.$$.fragment)},l(w){ri(e.$$.fragment,w),n=At(w),ri(i.$$.fragment,w),o=At(w),ri(u.$$.fragment,w),h=At(w),ri(c.$$.fragment,w)},m(w,S){ai(e,w,S),Jt(w,n,S),ai(i,w,S),Jt(w,o,S),ai(u,w,S),Jt(w,h,S),ai(c,w,S),b=!0},p(w,S){const M={};S[0]&64&&(M.position=w[6]),e.$set(M);const A={};S[0]&64&&(A.position=w[6]),i.$set(A);const P={};S[0]&64&&(P.position=w[6]),u.$set(P);const B={};S[0]&64&&(B.position=w[6]),c.$set(B)},i(w){b||(rt(e.$$.fragment,w),rt(i.$$.fragment,w),rt(u.$$.fragment,w),rt(c.$$.fragment,w),b=!0)},o(w){mt(e.$$.fragment,w),mt(i.$$.fragment,w),mt(u.$$.fragment,w),mt(c.$$.fragment,w),b=!1},d(w){w&&(Fe(n),Fe(o),Fe(h)),si(e,w),si(i,w),si(u,w),si(c,w)}}}function CD(t){let e,n,i,o,u,h=t[3]&&t[0]&&O8(t);return{c(){e=Ye("div"),h&&h.c(),this.h()},l(c){e=Je(c,"DIV",{class:!0,"data-testid":!0});var b=ht(e);h&&h.l(b),b.forEach(Fe),this.h()},h(){Me(e,"class",n=Jw(t[1])+" svelte-p00lfq"),Me(e,"data-testid","map-container"),Rn(e,"expand-map",!t[1])},m(c,b){Jt(c,e,b),h&&h.m(e,null),i=!0,o||(u=[Yn(MD,"hashchange",t[10]),Ga(t[9].call(null,e))],o=!0)},p(c,b){c[3]&&c[0]?h?(h.p(c,b),b[0]&9&&rt(h,1)):(h=O8(c),h.c(),rt(h,1),h.m(e,null)):h&&(Ji(),mt(h,1,1,()=>{h=null}),Ki()),(!i||b[0]&2&&n!==(n=Jw(c[1])+" svelte-p00lfq"))&&Me(e,"class",n),(!i||b[0]&2)&&Rn(e,"expand-map",!c[1])},i(c){i||(rt(h),i=!0)},o(c){mt(h),i=!1},d(c){c&&Fe(e),h&&h.d(),o=!1,Ph(u)}}}function kD(t,e,n){let i,o,u,h,{$$slots:c={},$$scope:b}=e,{map:w=null}=e,{class:S=void 0}=e,{style:M}=e,{diffStyleUpdates:A=!1}=e,{center:P=void 0}=e,{zoom:B=void 0}=e,{pitch:U=0}=e,{bearing:J=0}=e,{bounds:Q=void 0}=e,{hash:K=!1}=e,{loaded:le=!1}=e,{minZoom:ee=0}=e,{maxZoom:oe=22}=e,{antialias:Z=void 0}=e,{zoomOnDoubleClick:ne=!0}=e,{locale:be=void 0}=e,{interactive:me=!0}=e,{attributionControl:Te=!0}=e,{cooperativeGestures:Y=!1}=e,{preserveDrawingBuffer:ye=!1}=e,{maxBounds:qe=void 0}=e,{images:He=[]}=e,{standardControls:Be=!1}=e,{filterLayers:lt=void 0}=e,{transformRequest:Ge=void 0}=e;const ot=O1(),{map:je,loadedImages:Ve}=WE();ua(t,je,Le=>n(3,u=Le)),ua(t,Ve,Le=>n(4,h=Le));let $e=new Set;async function st(Le,ut=!1){if(u&&!(!u.loaded()&&!ut))if("url"in Le){$e.add(Le.id);try{let Re=await u.loadImage(Le.url);u==null||u.addImage(Le.id,Re.data,Le.options),h.add(Le.id),Ve.set(h)}catch(Re){ot("error",Re)}finally{$e.delete(Le.id)}}else u.addImage(Le.id,Le.data,Le.options),h.add(Le.id),Ve.set(h)}let ct,Pt,Ut,Lt;function gt(Le){return tt(),_u(je,u=new Fo.Map(A_({container:Le,style:M,locale:be,center:P,zoom:B,pitch:U,bearing:J,minZoom:ee,maxZoom:oe,antialias:Z,interactive:me,preserveDrawingBuffer:ye,maxBounds:qe,bounds:Q,attributionControl:Te,transformRequest:Ge,cooperativeGestures:Y})),u),u.on("load",ut=>{ut.target.getContainer().setAttribute("data-testid","map"),ut.target.getCanvas().setAttribute("data-testid","map-canvas"),n(0,le=!0),ot("load",u)}),u.on("error",ut=>ot("error",{...ut,map:u})),u.on("movestart",ut=>ot("movestart",{...ut,map:u})),u.on("moveend",ut=>{if(n(11,P=ut.target.getCenter()),n(12,B=ut.target.getZoom()),n(13,Q=ut.target.getBounds()),ot("moveend",{...ut,map:u}),K){let Re=window.location.href.replace(/(#.+)?$/,yD(u));window.history.replaceState(window.history.state,"",Re)}}),u.on("zoomstart",ut=>ot("zoomstart",{...ut,map:u})),u.on("zoom",ut=>{n(12,B=ut.target.getZoom()),ot("zoom",{...ut,map:u})}),u.on("zoomend",ut=>{n(12,B=ut.target.getZoom()),ot("zoomend",{...ut,map:u})}),u.on("style.load",()=>{if(u){const ut=u.getStyle();if(n(34,ct=ut.layers.map(Re=>Re.id)),n(35,Pt=Object.keys(ut.sources)),Lt)for(const[Re,Ke]of Object.entries(Lt))u.addSource(Re,Ke);if(Ut)for(const Re of Ut)u.addLayer(Re);for(const Re of He)st(Re,!0)}}),u.on("styledata",ut=>{if(u&&lt){const Re=u.getStyle().layers;if(Re)for(let Ke of Re)lt(Ke)||u.setLayoutProperty(Ke.id,"visibility","none")}ot("styledata",{...ut,map:u})}),{destroy(){n(0,le=!1),u==null||u.remove(),_u(je,u=null,u)}}}let Bt=M;function tt(){if(K){let Le=bD(window.location.hash);Le.length>=3&&(n(12,B=Le[0]),n(11,P=[Le[2],Le[1]])),Le.length==5&&(n(16,J=Le[3]),n(15,U=Le[4]))}}return t.$$set=Le=>{"map"in Le&&n(14,w=Le.map),"class"in Le&&n(1,S=Le.class),"style"in Le&&n(17,M=Le.style),"diffStyleUpdates"in Le&&n(18,A=Le.diffStyleUpdates),"center"in Le&&n(11,P=Le.center),"zoom"in Le&&n(12,B=Le.zoom),"pitch"in Le&&n(15,U=Le.pitch),"bearing"in Le&&n(16,J=Le.bearing),"bounds"in Le&&n(13,Q=Le.bounds),"hash"in Le&&n(19,K=Le.hash),"loaded"in Le&&n(0,le=Le.loaded),"minZoom"in Le&&n(20,ee=Le.minZoom),"maxZoom"in Le&&n(21,oe=Le.maxZoom),"antialias"in Le&&n(22,Z=Le.antialias),"zoomOnDoubleClick"in Le&&n(23,ne=Le.zoomOnDoubleClick),"locale"in Le&&n(24,be=Le.locale),"interactive"in Le&&n(25,me=Le.interactive),"attributionControl"in Le&&n(26,Te=Le.attributionControl),"cooperativeGestures"in Le&&n(27,Y=Le.cooperativeGestures),"preserveDrawingBuffer"in Le&&n(28,ye=Le.preserveDrawingBuffer),"maxBounds"in Le&&n(29,qe=Le.maxBounds),"images"in Le&&n(30,He=Le.images),"standardControls"in Le&&n(2,Be=Le.standardControls),"filterLayers"in Le&&n(31,lt=Le.filterLayers),"transformRequest"in Le&&n(32,Ge=Le.transformRequest),"$$scope"in Le&&n(37,b=Le.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&4&&n(6,i=typeof Be=="boolean"?void 0:Be),t.$$.dirty[0]&8&&n(14,w=u),t.$$.dirty[0]&393224|t.$$.dirty[1]&56&&u&&!N0(M,Bt)){const Le=u.getStyle();if(ct&&(Ut=Le.layers.filter(ut=>!ct.includes(ut.id))),Pt){const ut=Object.keys(Le.sources).filter(Re=>!Pt.includes(Re));Lt={};for(const Re of ut)Lt[Re]=Le.sources[Re]}n(36,Bt=M),u.setStyle(M,{diff:A}),_u(Ve,h=new Set,h),n(33,$e=new Set)}if(t.$$.dirty[0]&1073741849|t.$$.dirty[1]&4&&le&&u!=null&&u.loaded())for(let Le of He)!h.has(Le.id)&&!$e.has(Le.id)&&!u.hasImage(Le.id)&&st(Le);t.$$.dirty[0]&1073741840&&n(5,o=He.every(Le=>h.has(Le.id))),t.$$.dirty[0]&2056&&P&&!N0(P,u==null?void 0:u.getCenter())&&(u==null||u.panTo(P)),t.$$.dirty[0]&4104&&B&&!N0(B,u==null?void 0:u.getZoom())&&(u==null||u.zoomTo(B)),t.$$.dirty[0]&8200&&Q&&!N0(Q,u==null?void 0:u.getBounds())&&(u==null||u.fitBounds(Q)),t.$$.dirty[0]&8388616&&(ne?u==null||u.doubleClickZoom.enable():u==null||u.doubleClickZoom.disable())},[le,S,Be,u,h,o,i,je,Ve,gt,tt,P,B,Q,w,U,J,M,A,K,ee,oe,Z,ne,be,me,Te,Y,ye,qe,He,lt,Ge,$e,ct,Pt,Bt,b,c]}class ED extends jr{constructor(e){super(),qr(this,e,kD,CD,gr,{map:14,class:1,style:17,diffStyleUpdates:18,center:11,zoom:12,pitch:15,bearing:16,bounds:13,hash:19,loaded:0,minZoom:20,maxZoom:21,antialias:22,zoomOnDoubleClick:23,locale:24,interactive:25,attributionControl:26,cooperativeGestures:27,preserveDrawingBuffer:28,maxBounds:29,images:30,standardControls:2,filterLayers:31,transformRequest:32},null,[-1,-1])}}function gu(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function bm(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function G1(t){let e,n,i;t.length!==2?(e=gu,n=(c,b)=>gu(t(c),b),i=(c,b)=>t(c)-b):(e=t===gu||t===bm?t:DD,n=t,i=t);function o(c,b,w=0,S=c.length){if(w<S){if(e(b,b)!==0)return S;do{const M=w+S>>>1;n(c[M],b)<0?w=M+1:S=M}while(w<S)}return w}function u(c,b,w=0,S=c.length){if(w<S){if(e(b,b)!==0)return S;do{const M=w+S>>>1;n(c[M],b)<=0?w=M+1:S=M}while(w<S)}return w}function h(c,b,w=0,S=c.length){const M=o(c,b,w,S-1);return M>w&&i(c[M-1],b)>-i(c[M],b)?M-1:M}return{left:o,center:h,right:u}}function DD(){return 0}function n4(t){return t===null?NaN:+t}function*PD(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(i=+i)>=i&&(yield i)}}const LD=G1(gu),Nv=LD.right;G1(n4).center;function zD(t){return t.length|0}function BD(t){return!(t>0)}function FD(t){return typeof t!="object"||"length"in t?t:Array.from(t)}function ND(t){return e=>t(...e)}function RD(...t){const e=typeof t[t.length-1]=="function"&&ND(t.pop());t=t.map(FD);const n=t.map(zD),i=t.length-1,o=new Array(i+1).fill(0),u=[];if(i<0||n.some(BD))return u;for(;;){u.push(o.map((c,b)=>t[b][c]));let h=i;for(;++o[h]===n[h];){if(h===0)return e?u.map(e):u;o[h--]=0}}}function i4(t,e){let n=0,i,o=0,u=0;if(e===void 0)for(let h of t)h!=null&&(h=+h)>=h&&(i=h-o,o+=i/++n,u+=i*(h-o));else{let h=-1;for(let c of t)(c=e(c,++h,t))!=null&&(c=+c)>=c&&(i=c-o,o+=i/++n,u+=i*(c-o))}if(n>1)return u/(n-1)}function OD(t,e){const n=i4(t,e);return n&&Math.sqrt(n)}function yu(t,e){let n,i;for(const o of t)o!=null&&(n===void 0?o>=o&&(n=i=o):(n>o&&(n=o),i<o&&(i=o)));return[n,i]}class wh{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let i=0;for(let o=0;o<this._n&&o<32;o++){const u=n[o],h=e+u,c=Math.abs(e)<Math.abs(u)?e-(h-u):u-(h-e);c&&(n[i++]=c),e=h}return n[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let n=this._n,i,o,u,h=0;if(n>0){for(h=e[--n];n>0&&(i=h,o=e[--n],h=i+o,u=o-(h-i),!u););n>0&&(u<0&&e[n-1]<0||u>0&&e[n-1]>0)&&(o=u*2,i=h+o,o==i-h&&(h=i))}return h}}class Gp extends Map{constructor(e,n=s4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[i,o]of e)this.set(i,o)}get(e){return super.get(wb(this,e))}has(e){return super.has(wb(this,e))}set(e,n){return super.set(r4(this,e),n)}delete(e){return super.delete(a4(this,e))}}class Y1 extends Set{constructor(e,n=s4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const i of e)this.add(i)}has(e){return super.has(wb(this,e))}add(e){return super.add(r4(this,e))}delete(e){return super.delete(a4(this,e))}}function wb({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function r4({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function a4({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function s4(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Sb(t){return t}function UD(t,...e){return Rv(t,Sb,Sb,e)}function Dy(t,e,...n){return Rv(t,Sb,e,n)}function VD(t,e,...n){return Rv(t,Array.from,e,n)}function Rv(t,e,n,i){return function o(u,h){if(h>=i.length)return n(u);const c=new Gp,b=i[h++];let w=-1;for(const S of u){const M=b(S,++w,u),A=c.get(M);A?A.push(S):c.set(M,[S])}for(const[S,M]of c)c.set(S,o(M,h));return e(c)}(t,0)}function jD(t,e){return Array.from(e,n=>t[n])}function qD(t,...e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&n.length!==2||e.length>1){const i=Uint32Array.from(t,(o,u)=>u);return e.length>1?(e=e.map(o=>t.map(o)),i.sort((o,u)=>{for(const h of e){const c=C_(h[o],h[u]);if(c)return c}})):(n=t.map(n),i.sort((o,u)=>C_(n[o],n[u]))),jD(t,i)}return t.sort(o4(n))}function o4(t=gu){if(t===gu)return C_;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const i=t(e,n);return i||i===0?i:(t(n,n)===0)-(t(e,e)===0)}}function C_(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const HD=Math.sqrt(50),WD=Math.sqrt(10),ZD=Math.sqrt(2);function k_(t,e,n){const i=(e-t)/Math.max(0,n),o=Math.floor(Math.log10(i)),u=i/Math.pow(10,o),h=u>=HD?10:u>=WD?5:u>=ZD?2:1;let c,b,w;return o<0?(w=Math.pow(10,-o)/h,c=Math.round(t*w),b=Math.round(e*w),c/w<t&&++c,b/w>e&&--b,w=-w):(w=Math.pow(10,o)*h,c=Math.round(t/w),b=Math.round(e/w),c*w<t&&++c,b*w>e&&--b),b<c&&.5<=n&&n<2?k_(t,e,n*2):[c,b,w]}function E_(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const i=e<t,[o,u,h]=i?k_(e,t,n):k_(t,e,n);if(!(u>=o))return[];const c=u-o+1,b=new Array(c);if(i)if(h<0)for(let w=0;w<c;++w)b[w]=(u-w)/-h;else for(let w=0;w<c;++w)b[w]=(u-w)*h;else if(h<0)for(let w=0;w<c;++w)b[w]=(o+w)/-h;else for(let w=0;w<c;++w)b[w]=(o+w)*h;return b}function Ib(t,e,n){return e=+e,t=+t,n=+n,k_(t,e,n)[2]}function Tb(t,e,n){e=+e,t=+t,n=+n;const i=e<t,o=i?Ib(e,t,n):Ib(t,e,n);return(i?-1:1)*(o<0?1/-o:o)}function Dl(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n<o||n===void 0&&o>=o)&&(n=o)}return n}function GD(t,e){let n,i=-1,o=-1;if(e===void 0)for(const u of t)++o,u!=null&&(n<u||n===void 0&&u>=u)&&(n=u,i=o);else for(let u of t)(u=e(u,++o,t))!=null&&(n<u||n===void 0&&u>=u)&&(n=u,i=o);return i}function Yp(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n>o||n===void 0&&o>=o)&&(n=o)}return n}function YD(t,e){let n,i=-1,o=-1;if(e===void 0)for(const u of t)++o,u!=null&&(n>u||n===void 0&&u>=u)&&(n=u,i=o);else for(let u of t)(u=e(u,++o,t))!=null&&(n>u||n===void 0&&u>=u)&&(n=u,i=o);return i}function l4(t,e,n=0,i=1/0,o){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(t.length-1,i)),!(n<=e&&e<=i))return t;for(o=o===void 0?C_:o4(o);i>n;){if(i-n>600){const b=i-n+1,w=e-n+1,S=Math.log(b),M=.5*Math.exp(2*S/3),A=.5*Math.sqrt(S*M*(b-M)/b)*(w-b/2<0?-1:1),P=Math.max(n,Math.floor(e-w*M/b+A)),B=Math.min(i,Math.floor(e+(b-w)*M/b+A));l4(t,e,P,B,o)}const u=t[e];let h=n,c=i;for(mp(t,n,e),o(t[i],u)>0&&mp(t,n,i);h<c;){for(mp(t,h,c),++h,--c;o(t[h],u)<0;)++h;for(;o(t[c],u)>0;)--c}o(t[n],u)===0?mp(t,n,c):(++c,mp(t,c,i)),c<=e&&(n=c+1),e<=c&&(i=c-1)}return t}function mp(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function D_(t,e,n){if(t=Float64Array.from(PD(t,n)),!(!(i=t.length)||isNaN(e=+e))){if(e<=0||i<2)return Yp(t);if(e>=1)return Dl(t);var i,o=(i-1)*e,u=Math.floor(o),h=Dl(l4(t,u).subarray(0,u+1)),c=Yp(t.subarray(u+1));return h+(c-h)*(o-u)}}function JD(t,e,n=n4){if(!(!(i=t.length)||isNaN(e=+e))){if(e<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,o=(i-1)*e,u=Math.floor(o),h=+n(t[u],u,t),c=+n(t[u+1],u+1,t);return h+(c-h)*(o-u)}}function KD(t,e){let n=0,i=0;if(e===void 0)for(let o of t)o!=null&&(o=+o)>=o&&(++n,i+=o);else{let o=-1;for(let u of t)(u=e(u,++o,t))!=null&&(u=+u)>=u&&(++n,i+=u)}if(n)return i/n}function Mb(t,e){return D_(t,.5,e)}function*XD(t){for(const e of t)yield*e}function c4(t){return Array.from(XD(t))}function QD(t,e){const n=new Gp;if(e===void 0)for(let u of t)u!=null&&u>=u&&n.set(u,(n.get(u)||0)+1);else{let u=-1;for(let h of t)(h=e(h,++u,t))!=null&&h>=h&&n.set(h,(n.get(h)||0)+1)}let i,o=0;for(const[u,h]of n)h>o&&(o=h,i=u);return i}function $D(t,e=eP){const n=[];let i,o=!1;for(const u of t)o&&n.push(e(i,u)),i=u,o=!0;return n}function eP(t,e){return[t,e]}function Ab(t,e,n){t=+t,e=+e,n=(o=arguments.length)<2?(e=t,t=0,1):o<3?1:+n;for(var i=-1,o=Math.max(0,Math.ceil((e-t)/n))|0,u=new Array(o);++i<o;)u[i]=t+i*n;return u}function Ov(t,e){let n=0;if(e===void 0)for(let i of t)(i=+i)&&(n+=i);else{let i=-1;for(let o of t)(o=+e(o,++i,t))&&(n+=o)}return n}function P_(t){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(t).reverse()}var Ln=1e-6,u4=1e-12,qn=Math.PI,mr=qn/2,V8=qn/4,Bs=qn*2,Ja=180/qn,fr=qn/180,Mi=Math.abs,bf=Math.atan,Tc=Math.atan2,On=Math.cos,h4=Math.exp,L_=Math.log,Py=Math.pow,kn=Math.sin,io=Math.sign||function(t){return t>0?1:t<0?-1:0},hs=Math.sqrt,Uv=Math.tan;function d4(t){return t>1?0:t<-1?qn:Math.acos(t)}function oo(t){return t>1?mr:t<-1?-mr:Math.asin(t)}function ro(){}function z_(t,e){t&&q8.hasOwnProperty(t.type)&&q8[t.type](t,e)}var j8={Feature:function(t,e){z_(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,o=n.length;++i<o;)z_(n[i].geometry,e)}},q8={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,o=n.length;++i<o;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Cb(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,o=n.length;++i<o;)Cb(n[i],e,0)},Polygon:function(t,e){H8(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,o=n.length;++i<o;)H8(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,o=n.length;++i<o;)z_(n[i],e)}};function Cb(t,e,n){var i=-1,o=t.length-n,u;for(e.lineStart();++i<o;)u=t[i],e.point(u[0],u[1],u[2]);e.lineEnd()}function H8(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Cb(t[n],e,1);e.polygonEnd()}function hh(t,e){t&&j8.hasOwnProperty(t.type)?j8[t.type](t,e):z_(t,e)}function kb(t){return[Tc(t[1],t[0]),oo(t[2])]}function Kd(t){var e=t[0],n=t[1],i=On(n);return[i*On(e),i*kn(e),kn(n)]}function R0(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function B_(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ly(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function O0(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Eb(t){var e=hs(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Db(t,e){function n(i,o){return i=t(i,o),e(i[0],i[1])}return t.invert&&e.invert&&(n.invert=function(i,o){return i=e.invert(i,o),i&&t.invert(i[0],i[1])}),n}function Pb(t,e){return Mi(t)>qn&&(t-=Math.round(t/Bs)*Bs),[t,e]}Pb.invert=Pb;function f4(t,e,n){return(t%=Bs)?e||n?Db(Z8(t),G8(e,n)):Z8(t):e||n?G8(e,n):Pb}function W8(t){return function(e,n){return e+=t,Mi(e)>qn&&(e-=Math.round(e/Bs)*Bs),[e,n]}}function Z8(t){var e=W8(t);return e.invert=W8(-t),e}function G8(t,e){var n=On(t),i=kn(t),o=On(e),u=kn(e);function h(c,b){var w=On(b),S=On(c)*w,M=kn(c)*w,A=kn(b),P=A*n+S*i;return[Tc(M*o-P*u,S*n-A*i),oo(P*o+M*u)]}return h.invert=function(c,b){var w=On(b),S=On(c)*w,M=kn(c)*w,A=kn(b),P=A*o-M*u;return[Tc(M*o+A*u,S*n+P*i),oo(P*n-S*i)]},h}function tP(t){t=f4(t[0]*fr,t[1]*fr,t.length>2?t[2]*fr:0);function e(n){return n=t(n[0]*fr,n[1]*fr),n[0]*=Ja,n[1]*=Ja,n}return e.invert=function(n){return n=t.invert(n[0]*fr,n[1]*fr),n[0]*=Ja,n[1]*=Ja,n},e}function nP(t,e,n,i,o,u){if(n){var h=On(e),c=kn(e),b=i*n;o==null?(o=e+i*Bs,u=e-b/2):(o=Y8(h,o),u=Y8(h,u),(i>0?o<u:o>u)&&(o+=i*Bs));for(var w,S=o;i>0?S>u:S<u;S-=b)w=kb([h,-c*On(S),-c*kn(S)]),t.point(w[0],w[1])}}function Y8(t,e){e=Kd(e),e[0]-=t,Eb(e);var n=d4(-e[1]);return((-e[2]<0?-n:n)+Bs-Ln)%Bs}function p4(){var t=[],e;return{point:function(n,i,o){e.push([n,i,o])},lineStart:function(){t.push(e=[])},lineEnd:ro,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function r_(t,e){return Mi(t[0]-e[0])<Ln&&Mi(t[1]-e[1])<Ln}function U0(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function m4(t,e,n,i,o){var u=[],h=[],c,b;if(t.forEach(function(B){if(!((U=B.length-1)<=0)){var U,J=B[0],Q=B[U],K;if(r_(J,Q)){if(!J[2]&&!Q[2]){for(o.lineStart(),c=0;c<U;++c)o.point((J=B[c])[0],J[1]);o.lineEnd();return}Q[0]+=2*Ln}u.push(K=new U0(J,B,null,!0)),h.push(K.o=new U0(J,null,K,!1)),u.push(K=new U0(Q,B,null,!1)),h.push(K.o=new U0(Q,null,K,!0))}}),!!u.length){for(h.sort(e),J8(u),J8(h),c=0,b=h.length;c<b;++c)h[c].e=n=!n;for(var w=u[0],S,M;;){for(var A=w,P=!0;A.v;)if((A=A.n)===w)return;S=A.z,o.lineStart();do{if(A.v=A.o.v=!0,A.e){if(P)for(c=0,b=S.length;c<b;++c)o.point((M=S[c])[0],M[1]);else i(A.x,A.n.x,1,o);A=A.n}else{if(P)for(S=A.p.z,c=S.length-1;c>=0;--c)o.point((M=S[c])[0],M[1]);else i(A.x,A.p.x,-1,o);A=A.p}A=A.o,S=A.z,P=!P}while(!A.v);o.lineEnd()}}}function J8(t){if(e=t.length){for(var e,n=0,i=t[0],o;++n<e;)i.n=o=t[n],o.p=i,i=o;i.n=o=t[0],o.p=i}}function zy(t){return Mi(t[0])<=qn?t[0]:io(t[0])*((Mi(t[0])+qn)%Bs-qn)}function iP(t,e){var n=zy(e),i=e[1],o=kn(i),u=[kn(n),-On(n),0],h=0,c=0,b=new wh;o===1?i=mr+Ln:o===-1&&(i=-mr-Ln);for(var w=0,S=t.length;w<S;++w)if(A=(M=t[w]).length)for(var M,A,P=M[A-1],B=zy(P),U=P[1]/2+V8,J=kn(U),Q=On(U),K=0;K<A;++K,B=ee,J=Z,Q=ne,P=le){var le=M[K],ee=zy(le),oe=le[1]/2+V8,Z=kn(oe),ne=On(oe),be=ee-B,me=be>=0?1:-1,Te=me*be,Y=Te>qn,ye=J*Z;if(b.add(Tc(ye*me*kn(Te),Q*ne+ye*On(Te))),h+=Y?be+me*Bs:be,Y^B>=n^ee>=n){var qe=B_(Kd(P),Kd(le));Eb(qe);var He=B_(u,qe);Eb(He);var Be=(Y^be>=0?-1:1)*oo(He[2]);(i>Be||i===Be&&(qe[0]||qe[1]))&&(c+=Y^be>=0?1:-1)}}return(h<-Ln||h<Ln&&b<-u4)^c&1}function _4(t,e,n,i){return function(o){var u=e(o),h=p4(),c=e(h),b=!1,w,S,M,A={point:P,lineStart:U,lineEnd:J,polygonStart:function(){A.point=Q,A.lineStart=K,A.lineEnd=le,S=[],w=[]},polygonEnd:function(){A.point=P,A.lineStart=U,A.lineEnd=J,S=c4(S);var ee=iP(w,i);S.length?(b||(o.polygonStart(),b=!0),m4(S,aP,ee,n,o)):ee&&(b||(o.polygonStart(),b=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),b&&(o.polygonEnd(),b=!1),S=w=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function P(ee,oe){t(ee,oe)&&o.point(ee,oe)}function B(ee,oe){u.point(ee,oe)}function U(){A.point=B,u.lineStart()}function J(){A.point=P,u.lineEnd()}function Q(ee,oe){M.push([ee,oe]),c.point(ee,oe)}function K(){c.lineStart(),M=[]}function le(){Q(M[0][0],M[0][1]),c.lineEnd();var ee=c.clean(),oe=h.result(),Z,ne=oe.length,be,me,Te;if(M.pop(),w.push(M),M=null,!!ne){if(ee&1){if(me=oe[0],(be=me.length-1)>0){for(b||(o.polygonStart(),b=!0),o.lineStart(),Z=0;Z<be;++Z)o.point((Te=me[Z])[0],Te[1]);o.lineEnd()}return}ne>1&&ee&2&&oe.push(oe.pop().concat(oe.shift())),S.push(oe.filter(rP))}}return A}}function rP(t){return t.length>1}function aP(t,e){return((t=t.x)[0]<0?t[1]-mr-Ln:mr-t[1])-((e=e.x)[0]<0?e[1]-mr-Ln:mr-e[1])}const K8=_4(function(){return!0},sP,lP,[-qn,-mr]);function sP(t){var e=NaN,n=NaN,i=NaN,o;return{lineStart:function(){t.lineStart(),o=1},point:function(u,h){var c=u>0?qn:-qn,b=Mi(u-e);Mi(b-qn)<Ln?(t.point(e,n=(n+h)/2>0?mr:-mr),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(c,n),t.point(u,n),o=0):i!==c&&b>=qn&&(Mi(e-i)<Ln&&(e-=i*Ln),Mi(u-c)<Ln&&(u-=c*Ln),n=oP(e,n,u,h),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(c,n),o=0),t.point(e=u,n=h),i=c},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-o}}}function oP(t,e,n,i){var o,u,h=kn(t-n);return Mi(h)>Ln?bf((kn(e)*(u=On(i))*kn(n)-kn(i)*(o=On(e))*kn(t))/(o*u*h)):(e+i)/2}function lP(t,e,n,i){var o;if(t==null)o=n*mr,i.point(-qn,o),i.point(0,o),i.point(qn,o),i.point(qn,0),i.point(qn,-o),i.point(0,-o),i.point(-qn,-o),i.point(-qn,0),i.point(-qn,o);else if(Mi(t[0]-e[0])>Ln){var u=t[0]<e[0]?qn:-qn;o=n*u/2,i.point(-u,o),i.point(0,o),i.point(u,o)}else i.point(e[0],e[1])}function cP(t){var e=On(t),n=2*fr,i=e>0,o=Mi(e)>Ln;function u(S,M,A,P){nP(P,t,n,A,S,M)}function h(S,M){return On(S)*On(M)>e}function c(S){var M,A,P,B,U;return{lineStart:function(){B=P=!1,U=1},point:function(J,Q){var K=[J,Q],le,ee=h(J,Q),oe=i?ee?0:w(J,Q):ee?w(J+(J<0?qn:-qn),Q):0;if(!M&&(B=P=ee)&&S.lineStart(),ee!==P&&(le=b(M,K),(!le||r_(M,le)||r_(K,le))&&(K[2]=1)),ee!==P)U=0,ee?(S.lineStart(),le=b(K,M),S.point(le[0],le[1])):(le=b(M,K),S.point(le[0],le[1],2),S.lineEnd()),M=le;else if(o&&M&&i^ee){var Z;!(oe&A)&&(Z=b(K,M,!0))&&(U=0,i?(S.lineStart(),S.point(Z[0][0],Z[0][1]),S.point(Z[1][0],Z[1][1]),S.lineEnd()):(S.point(Z[1][0],Z[1][1]),S.lineEnd(),S.lineStart(),S.point(Z[0][0],Z[0][1],3)))}ee&&(!M||!r_(M,K))&&S.point(K[0],K[1]),M=K,P=ee,A=oe},lineEnd:function(){P&&S.lineEnd(),M=null},clean:function(){return U|(B&&P)<<1}}}function b(S,M,A){var P=Kd(S),B=Kd(M),U=[1,0,0],J=B_(P,B),Q=R0(J,J),K=J[0],le=Q-K*K;if(!le)return!A&&S;var ee=e*Q/le,oe=-e*K/le,Z=B_(U,J),ne=O0(U,ee),be=O0(J,oe);Ly(ne,be);var me=Z,Te=R0(ne,me),Y=R0(me,me),ye=Te*Te-Y*(R0(ne,ne)-1);if(!(ye<0)){var qe=hs(ye),He=O0(me,(-Te-qe)/Y);if(Ly(He,ne),He=kb(He),!A)return He;var Be=S[0],lt=M[0],Ge=S[1],ot=M[1],je;lt<Be&&(je=Be,Be=lt,lt=je);var Ve=lt-Be,$e=Mi(Ve-qn)<Ln,st=$e||Ve<Ln;if(!$e&&ot<Ge&&(je=Ge,Ge=ot,ot=je),st?$e?Ge+ot>0^He[1]<(Mi(He[0]-Be)<Ln?Ge:ot):Ge<=He[1]&&He[1]<=ot:Ve>qn^(Be<=He[0]&&He[0]<=lt)){var ct=O0(me,(-Te+qe)/Y);return Ly(ct,ne),[He,kb(ct)]}}}function w(S,M){var A=i?t:qn-t,P=0;return S<-A?P|=1:S>A&&(P|=2),M<-A?P|=4:M>A&&(P|=8),P}return _4(h,c,u,i?[0,-t]:[-qn,t-qn])}function uP(t,e,n,i,o,u){var h=t[0],c=t[1],b=e[0],w=e[1],S=0,M=1,A=b-h,P=w-c,B;if(B=n-h,!(!A&&B>0)){if(B/=A,A<0){if(B<S)return;B<M&&(M=B)}else if(A>0){if(B>M)return;B>S&&(S=B)}if(B=o-h,!(!A&&B<0)){if(B/=A,A<0){if(B>M)return;B>S&&(S=B)}else if(A>0){if(B<S)return;B<M&&(M=B)}if(B=i-c,!(!P&&B>0)){if(B/=P,P<0){if(B<S)return;B<M&&(M=B)}else if(P>0){if(B>M)return;B>S&&(S=B)}if(B=u-c,!(!P&&B<0)){if(B/=P,P<0){if(B>M)return;B>S&&(S=B)}else if(P>0){if(B<S)return;B<M&&(M=B)}return S>0&&(t[0]=h+S*A,t[1]=c+S*P),M<1&&(e[0]=h+M*A,e[1]=c+M*P),!0}}}}}var Sp=1e9,V0=-Sp;function g4(t,e,n,i){function o(w,S){return t<=w&&w<=n&&e<=S&&S<=i}function u(w,S,M,A){var P=0,B=0;if(w==null||(P=h(w,M))!==(B=h(S,M))||b(w,S)<0^M>0)do A.point(P===0||P===3?t:n,P>1?i:e);while((P=(P+M+4)%4)!==B);else A.point(S[0],S[1])}function h(w,S){return Mi(w[0]-t)<Ln?S>0?0:3:Mi(w[0]-n)<Ln?S>0?2:1:Mi(w[1]-e)<Ln?S>0?1:0:S>0?3:2}function c(w,S){return b(w.x,S.x)}function b(w,S){var M=h(w,1),A=h(S,1);return M!==A?M-A:M===0?S[1]-w[1]:M===1?w[0]-S[0]:M===2?w[1]-S[1]:S[0]-w[0]}return function(w){var S=w,M=p4(),A,P,B,U,J,Q,K,le,ee,oe,Z,ne={point:be,lineStart:ye,lineEnd:qe,polygonStart:Te,polygonEnd:Y};function be(Be,lt){o(Be,lt)&&S.point(Be,lt)}function me(){for(var Be=0,lt=0,Ge=P.length;lt<Ge;++lt)for(var ot=P[lt],je=1,Ve=ot.length,$e=ot[0],st,ct,Pt=$e[0],Ut=$e[1];je<Ve;++je)st=Pt,ct=Ut,$e=ot[je],Pt=$e[0],Ut=$e[1],ct<=i?Ut>i&&(Pt-st)*(i-ct)>(Ut-ct)*(t-st)&&++Be:Ut<=i&&(Pt-st)*(i-ct)<(Ut-ct)*(t-st)&&--Be;return Be}function Te(){S=M,A=[],P=[],Z=!0}function Y(){var Be=me(),lt=Z&&Be,Ge=(A=c4(A)).length;(lt||Ge)&&(w.polygonStart(),lt&&(w.lineStart(),u(null,null,1,w),w.lineEnd()),Ge&&m4(A,c,Be,u,w),w.polygonEnd()),S=w,A=P=B=null}function ye(){ne.point=He,P&&P.push(B=[]),oe=!0,ee=!1,K=le=NaN}function qe(){A&&(He(U,J),Q&&ee&&M.rejoin(),A.push(M.result())),ne.point=be,ee&&S.lineEnd()}function He(Be,lt){var Ge=o(Be,lt);if(P&&B.push([Be,lt]),oe)U=Be,J=lt,Q=Ge,oe=!1,Ge&&(S.lineStart(),S.point(Be,lt));else if(Ge&&ee)S.point(Be,lt);else{var ot=[K=Math.max(V0,Math.min(Sp,K)),le=Math.max(V0,Math.min(Sp,le))],je=[Be=Math.max(V0,Math.min(Sp,Be)),lt=Math.max(V0,Math.min(Sp,lt))];uP(ot,je,t,e,n,i)?(ee||(S.lineStart(),S.point(ot[0],ot[1])),S.point(je[0],je[1]),Ge||S.lineEnd(),Z=!1):Ge&&(S.lineStart(),S.point(Be,lt),Z=!1)}K=Be,le=lt,ee=Ge}return ne}}const Lb=t=>t;var By=new wh,zb=new wh,y4,b4,Bb,Fb,gc={point:ro,lineStart:ro,lineEnd:ro,polygonStart:function(){gc.lineStart=hP,gc.lineEnd=fP},polygonEnd:function(){gc.lineStart=gc.lineEnd=gc.point=ro,By.add(Mi(zb)),zb=new wh},result:function(){var t=By/2;return By=new wh,t}};function hP(){gc.point=dP}function dP(t,e){gc.point=v4,y4=Bb=t,b4=Fb=e}function v4(t,e){zb.add(Fb*t-Bb*e),Bb=t,Fb=e}function fP(){v4(y4,b4)}var Xd=1/0,F_=Xd,Jp=-Xd,N_=Jp,R_={point:pP,lineStart:ro,lineEnd:ro,polygonStart:ro,polygonEnd:ro,result:function(){var t=[[Xd,F_],[Jp,N_]];return Jp=N_=-(F_=Xd=1/0),t}};function pP(t,e){t<Xd&&(Xd=t),t>Jp&&(Jp=t),e<F_&&(F_=e),e>N_&&(N_=e)}var Nb=0,Rb=0,Ip=0,O_=0,U_=0,Fd=0,Ob=0,Ub=0,Tp=0,x4,w4,_l,gl,no={point:Sh,lineStart:X8,lineEnd:Q8,polygonStart:function(){no.lineStart=gP,no.lineEnd=yP},polygonEnd:function(){no.point=Sh,no.lineStart=X8,no.lineEnd=Q8},result:function(){var t=Tp?[Ob/Tp,Ub/Tp]:Fd?[O_/Fd,U_/Fd]:Ip?[Nb/Ip,Rb/Ip]:[NaN,NaN];return Nb=Rb=Ip=O_=U_=Fd=Ob=Ub=Tp=0,t}};function Sh(t,e){Nb+=t,Rb+=e,++Ip}function X8(){no.point=mP}function mP(t,e){no.point=_P,Sh(_l=t,gl=e)}function _P(t,e){var n=t-_l,i=e-gl,o=hs(n*n+i*i);O_+=o*(_l+t)/2,U_+=o*(gl+e)/2,Fd+=o,Sh(_l=t,gl=e)}function Q8(){no.point=Sh}function gP(){no.point=bP}function yP(){S4(x4,w4)}function bP(t,e){no.point=S4,Sh(x4=_l=t,w4=gl=e)}function S4(t,e){var n=t-_l,i=e-gl,o=hs(n*n+i*i);O_+=o*(_l+t)/2,U_+=o*(gl+e)/2,Fd+=o,o=gl*t-_l*e,Ob+=o*(_l+t),Ub+=o*(gl+e),Tp+=o*3,Sh(_l=t,gl=e)}function I4(t){this._context=t}I4.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Bs);break}}},result:ro};var Vb=new wh,Fy,T4,M4,Mp,Ap,Kp={point:ro,lineStart:function(){Kp.point=vP},lineEnd:function(){Fy&&A4(T4,M4),Kp.point=ro},polygonStart:function(){Fy=!0},polygonEnd:function(){Fy=null},result:function(){var t=+Vb;return Vb=new wh,t}};function vP(t,e){Kp.point=A4,T4=Mp=t,M4=Ap=e}function A4(t,e){Mp-=t,Ap-=e,Vb.add(hs(Mp*Mp+Ap*Ap)),Mp=t,Ap=e}let $8,V_,e3,t3;class n3{constructor(e){this._append=e==null?C4:xP(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==e3||this._append!==V_){const i=this._radius,o=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,e3=i,V_=this._append,t3=this._,this._=o}this._+=t3;break}}}result(){const e=this._;return this._="",e.length?e:null}}function C4(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function xP(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return C4;if(e!==$8){const n=10**e;$8=e,V_=function(o){let u=1;this._+=o[0];for(const h=o.length;u<h;++u)this._+=Math.round(arguments[u]*n)/n+o[u]}}return V_}function Vv(t,e){let n=3,i=4.5,o,u;function h(c){return c&&(typeof i=="function"&&u.pointRadius(+i.apply(this,arguments)),hh(c,o(u))),u.result()}return h.area=function(c){return hh(c,o(gc)),gc.result()},h.measure=function(c){return hh(c,o(Kp)),Kp.result()},h.bounds=function(c){return hh(c,o(R_)),R_.result()},h.centroid=function(c){return hh(c,o(no)),no.result()},h.projection=function(c){return arguments.length?(o=c==null?(t=null,Lb):(t=c).stream,h):t},h.context=function(c){return arguments.length?(u=c==null?(e=null,new n3(n)):new I4(e=c),typeof i!="function"&&u.pointRadius(i),h):e},h.pointRadius=function(c){return arguments.length?(i=typeof c=="function"?c:(u.pointRadius(+c),+c),h):i},h.digits=function(c){if(!arguments.length)return n;if(c==null)n=null;else{const b=Math.floor(c);if(!(b>=0))throw new RangeError(`invalid digits: ${c}`);n=b}return e===null&&(u=new n3(n)),h},h.projection(t).digits(n).context(e)}function jb(t){return{stream:J1(t)}}function J1(t){return function(e){var n=new qb;for(var i in t)n[i]=t[i];return n.stream=e,n}}function qb(){}qb.prototype={constructor:qb,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function jv(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),i!=null&&t.clipExtent(null),hh(n,t.stream(R_)),e(R_.result()),i!=null&&t.clipExtent(i),t}function qv(t,e,n){return jv(t,function(i){var o=e[1][0]-e[0][0],u=e[1][1]-e[0][1],h=Math.min(o/(i[1][0]-i[0][0]),u/(i[1][1]-i[0][1])),c=+e[0][0]+(o-h*(i[1][0]+i[0][0]))/2,b=+e[0][1]+(u-h*(i[1][1]+i[0][1]))/2;t.scale(150*h).translate([c,b])},n)}function k4(t,e,n){return qv(t,[[0,0],e],n)}function E4(t,e,n){return jv(t,function(i){var o=+e,u=o/(i[1][0]-i[0][0]),h=(o-u*(i[1][0]+i[0][0]))/2,c=-u*i[0][1];t.scale(150*u).translate([h,c])},n)}function D4(t,e,n){return jv(t,function(i){var o=+e,u=o/(i[1][1]-i[0][1]),h=-u*i[0][0],c=(o-u*(i[1][1]+i[0][1]))/2;t.scale(150*u).translate([h,c])},n)}var i3=16,wP=On(30*fr);function r3(t,e){return+e?IP(t,e):SP(t)}function SP(t){return J1({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function IP(t,e){function n(i,o,u,h,c,b,w,S,M,A,P,B,U,J){var Q=w-i,K=S-o,le=Q*Q+K*K;if(le>4*e&&U--){var ee=h+A,oe=c+P,Z=b+B,ne=hs(ee*ee+oe*oe+Z*Z),be=oo(Z/=ne),me=Mi(Mi(Z)-1)<Ln||Mi(u-M)<Ln?(u+M)/2:Tc(oe,ee),Te=t(me,be),Y=Te[0],ye=Te[1],qe=Y-i,He=ye-o,Be=K*qe-Q*He;(Be*Be/le>e||Mi((Q*qe+K*He)/le-.5)>.3||h*A+c*P+b*B<wP)&&(n(i,o,u,h,c,b,Y,ye,me,ee/=ne,oe/=ne,Z,U,J),J.point(Y,ye),n(Y,ye,me,ee,oe,Z,w,S,M,A,P,B,U,J))}}return function(i){var o,u,h,c,b,w,S,M,A,P,B,U,J={point:Q,lineStart:K,lineEnd:ee,polygonStart:function(){i.polygonStart(),J.lineStart=oe},polygonEnd:function(){i.polygonEnd(),J.lineStart=K}};function Q(be,me){be=t(be,me),i.point(be[0],be[1])}function K(){M=NaN,J.point=le,i.lineStart()}function le(be,me){var Te=Kd([be,me]),Y=t(be,me);n(M,A,S,P,B,U,M=Y[0],A=Y[1],S=be,P=Te[0],B=Te[1],U=Te[2],i3,i),i.point(M,A)}function ee(){J.point=Q,i.lineEnd()}function oe(){K(),J.point=Z,J.lineEnd=ne}function Z(be,me){le(o=be,me),u=M,h=A,c=P,b=B,w=U,J.point=le}function ne(){n(M,A,S,P,B,U,u,h,o,c,b,w,i3,i),J.lineEnd=ee,ee()}return J}}var TP=J1({point:function(t,e){this.stream.point(t*fr,e*fr)}});function MP(t){return J1({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}function AP(t,e,n,i,o){function u(h,c){return h*=i,c*=o,[e+t*h,n-t*c]}return u.invert=function(h,c){return[(h-e)/t*i,(n-c)/t*o]},u}function a3(t,e,n,i,o,u){if(!u)return AP(t,e,n,i,o);var h=On(u),c=kn(u),b=h*t,w=c*t,S=h/t,M=c/t,A=(c*n-h*e)/t,P=(c*e+h*n)/t;function B(U,J){return U*=i,J*=o,[b*U-w*J+e,n-w*U-b*J]}return B.invert=function(U,J){return[i*(S*U-M*J+A),o*(P-M*U-S*J)]},B}function Du(t){return P4(function(){return t})()}function P4(t){var e,n=150,i=480,o=250,u=0,h=0,c=0,b=0,w=0,S,M=0,A=1,P=1,B=null,U=K8,J=null,Q,K,le,ee=Lb,oe=.5,Z,ne,be,me,Te;function Y(Be){return be(Be[0]*fr,Be[1]*fr)}function ye(Be){return Be=be.invert(Be[0],Be[1]),Be&&[Be[0]*Ja,Be[1]*Ja]}Y.stream=function(Be){return me&&Te===Be?me:me=TP(MP(S)(U(Z(ee(Te=Be)))))},Y.preclip=function(Be){return arguments.length?(U=Be,B=void 0,He()):U},Y.postclip=function(Be){return arguments.length?(ee=Be,J=Q=K=le=null,He()):ee},Y.clipAngle=function(Be){return arguments.length?(U=+Be?cP(B=Be*fr):(B=null,K8),He()):B*Ja},Y.clipExtent=function(Be){return arguments.length?(ee=Be==null?(J=Q=K=le=null,Lb):g4(J=+Be[0][0],Q=+Be[0][1],K=+Be[1][0],le=+Be[1][1]),He()):J==null?null:[[J,Q],[K,le]]},Y.scale=function(Be){return arguments.length?(n=+Be,qe()):n},Y.translate=function(Be){return arguments.length?(i=+Be[0],o=+Be[1],qe()):[i,o]},Y.center=function(Be){return arguments.length?(u=Be[0]%360*fr,h=Be[1]%360*fr,qe()):[u*Ja,h*Ja]},Y.rotate=function(Be){return arguments.length?(c=Be[0]%360*fr,b=Be[1]%360*fr,w=Be.length>2?Be[2]%360*fr:0,qe()):[c*Ja,b*Ja,w*Ja]},Y.angle=function(Be){return arguments.length?(M=Be%360*fr,qe()):M*Ja},Y.reflectX=function(Be){return arguments.length?(A=Be?-1:1,qe()):A<0},Y.reflectY=function(Be){return arguments.length?(P=Be?-1:1,qe()):P<0},Y.precision=function(Be){return arguments.length?(Z=r3(ne,oe=Be*Be),He()):hs(oe)},Y.fitExtent=function(Be,lt){return qv(Y,Be,lt)},Y.fitSize=function(Be,lt){return k4(Y,Be,lt)},Y.fitWidth=function(Be,lt){return E4(Y,Be,lt)},Y.fitHeight=function(Be,lt){return D4(Y,Be,lt)};function qe(){var Be=a3(n,0,0,A,P,M).apply(null,e(u,h)),lt=a3(n,i-Be[0],o-Be[1],A,P,M);return S=f4(c,b,w),ne=Db(e,lt),be=Db(S,ne),Z=r3(ne,oe),He()}function He(){return me=Te=null,Y}return function(){return e=t.apply(this,arguments),Y.invert=e.invert&&ye,qe()}}function Hv(t){var e=0,n=qn/3,i=P4(t),o=i(e,n);return o.parallels=function(u){return arguments.length?i(e=u[0]*fr,n=u[1]*fr):[e*Ja,n*Ja]},o}function CP(t){var e=On(t);function n(i,o){return[i*e,kn(o)/e]}return n.invert=function(i,o){return[i/e,oo(o*e)]},n}function kP(t,e){var n=kn(t),i=(n+kn(e))/2;if(Mi(i)<Ln)return CP(t);var o=1+n*(2*i-n),u=hs(o)/i;function h(c,b){var w=hs(o-2*i*kn(b))/i;return[w*kn(c*=i),u-w*On(c)]}return h.invert=function(c,b){var w=u-b,S=Tc(c,Mi(w))*io(w);return w*i<0&&(S-=qn*io(c)*io(w)),[S/i,oo((o-(c*c+w*w)*i*i)/(2*i))]},h}function j_(){return Hv(kP).scale(155.424).center([0,33.6442])}function L4(){return j_().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function EP(t){var e=t.length;return{point:function(n,i){for(var o=-1;++o<e;)t[o].point(n,i)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function DP(){var t,e,n=L4(),i,o=j_().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u,h=j_().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c,b,w={point:function(A,P){b=[A,P]}};function S(A){var P=A[0],B=A[1];return b=null,i.point(P,B),b||(u.point(P,B),b)||(c.point(P,B),b)}S.invert=function(A){var P=n.scale(),B=n.translate(),U=(A[0]-B[0])/P,J=(A[1]-B[1])/P;return(J>=.12&&J<.234&&U>=-.425&&U<-.214?o:J>=.166&&J<.234&&U>=-.214&&U<-.115?h:n).invert(A)},S.stream=function(A){return t&&e===A?t:t=EP([n.stream(e=A),o.stream(A),h.stream(A)])},S.precision=function(A){return arguments.length?(n.precision(A),o.precision(A),h.precision(A),M()):n.precision()},S.scale=function(A){return arguments.length?(n.scale(A),o.scale(A*.35),h.scale(A),S.translate(n.translate())):n.scale()},S.translate=function(A){if(!arguments.length)return n.translate();var P=n.scale(),B=+A[0],U=+A[1];return i=n.translate(A).clipExtent([[B-.455*P,U-.238*P],[B+.455*P,U+.238*P]]).stream(w),u=o.translate([B-.307*P,U+.201*P]).clipExtent([[B-.425*P+Ln,U+.12*P+Ln],[B-.214*P-Ln,U+.234*P-Ln]]).stream(w),c=h.translate([B-.205*P,U+.212*P]).clipExtent([[B-.214*P+Ln,U+.166*P+Ln],[B-.115*P-Ln,U+.234*P-Ln]]).stream(w),M()},S.fitExtent=function(A,P){return qv(S,A,P)},S.fitSize=function(A,P){return k4(S,A,P)},S.fitWidth=function(A,P){return E4(S,A,P)},S.fitHeight=function(A,P){return D4(S,A,P)};function M(){return t=e=null,S}return S.scale(1070)}function z4(t){return function(e,n){var i=On(e),o=On(n),u=t(i*o);return u===1/0?[2,0]:[u*o*kn(e),u*kn(n)]}}function vm(t){return function(e,n){var i=hs(e*e+n*n),o=t(i),u=kn(o),h=On(o);return[Tc(e*u,i*h),oo(i&&n*u/i)]}}var B4=z4(function(t){return hs(2/(1+t))});B4.invert=vm(function(t){return 2*oo(t/2)});function PP(){return Du(B4).scale(124.75).clipAngle(180-.001)}var F4=z4(function(t){return(t=d4(t))&&t/kn(t)});F4.invert=vm(function(t){return t});function LP(){return Du(F4).scale(79.4188).clipAngle(180-.001)}function K1(t,e){return[t,L_(Uv((mr+e)/2))]}K1.invert=function(t,e){return[t,2*bf(h4(e))-mr]};function zP(){return N4(K1).scale(961/Bs)}function N4(t){var e=Du(t),n=e.center,i=e.scale,o=e.translate,u=e.clipExtent,h=null,c,b,w;e.scale=function(M){return arguments.length?(i(M),S()):i()},e.translate=function(M){return arguments.length?(o(M),S()):o()},e.center=function(M){return arguments.length?(n(M),S()):n()},e.clipExtent=function(M){return arguments.length?(M==null?h=c=b=w=null:(h=+M[0][0],c=+M[0][1],b=+M[1][0],w=+M[1][1]),S()):h==null?null:[[h,c],[b,w]]};function S(){var M=qn*i(),A=e(tP(e.rotate()).invert([0,0]));return u(h==null?[[A[0]-M,A[1]-M],[A[0]+M,A[1]+M]]:t===K1?[[Math.max(A[0]-M,h),c],[Math.min(A[0]+M,b),w]]:[[h,Math.max(A[1]-M,c)],[b,Math.min(A[1]+M,w)]])}return S()}function j0(t){return Uv((mr+t)/2)}function BP(t,e){var n=On(t),i=t===e?kn(t):L_(n/On(e))/L_(j0(e)/j0(t)),o=n*Py(j0(t),i)/i;if(!i)return K1;function u(h,c){o>0?c<-mr+Ln&&(c=-mr+Ln):c>mr-Ln&&(c=mr-Ln);var b=o/Py(j0(c),i);return[b*kn(i*h),o-b*On(i*h)]}return u.invert=function(h,c){var b=o-c,w=io(i)*hs(h*h+b*b),S=Tc(h,Mi(b))*io(b);return b*i<0&&(S-=qn*io(h)*io(b)),[S/i,2*bf(Py(o/w,1/i))-mr]},u}function FP(){return Hv(BP).scale(109.5).parallels([30,30])}function q_(t,e){return[t,e]}q_.invert=q_;function NP(){return Du(q_).scale(152.63)}function RP(t,e){var n=On(t),i=t===e?kn(t):(n-On(e))/(e-t),o=n/i+t;if(Mi(i)<Ln)return q_;function u(h,c){var b=o-c,w=i*h;return[b*kn(w),o-b*On(w)]}return u.invert=function(h,c){var b=o-c,w=Tc(h,Mi(b))*io(b);return b*i<0&&(w-=qn*io(h)*io(b)),[w/i,o-io(i)*hs(h*h+b*b)]},u}function OP(){return Hv(RP).scale(131.154).center([0,13.9389])}var Up=1.340264,Vp=-.081106,jp=893e-6,qp=.003796,H_=hs(3)/2,UP=12;function R4(t,e){var n=oo(H_*kn(e)),i=n*n,o=i*i*i;return[t*On(n)/(H_*(Up+3*Vp*i+o*(7*jp+9*qp*i))),n*(Up+Vp*i+o*(jp+qp*i))]}R4.invert=function(t,e){for(var n=e,i=n*n,o=i*i*i,u=0,h,c,b;u<UP&&(c=n*(Up+Vp*i+o*(jp+qp*i))-e,b=Up+3*Vp*i+o*(7*jp+9*qp*i),n-=h=c/b,i=n*n,o=i*i*i,!(Mi(h)<u4));++u);return[H_*t*(Up+3*Vp*i+o*(7*jp+9*qp*i))/On(n),oo(kn(n)/H_)]};function VP(){return Du(R4).scale(177.158)}function O4(t,e){var n=On(e),i=On(t)*n;return[n*kn(t)/i,kn(e)/i]}O4.invert=vm(bf);function jP(){return Du(O4).scale(144.049).clipAngle(60)}function U4(t,e){return[On(e)*kn(t),kn(e)]}U4.invert=vm(oo);function qP(){return Du(U4).scale(249.5).clipAngle(90+Ln)}function V4(t,e){var n=On(e),i=1+On(t)*n;return[n*kn(t)/i,kn(e)/i]}V4.invert=vm(function(t){return 2*bf(t)});function HP(){return Du(V4).scale(250).clipAngle(142)}function j4(t,e){return[L_(Uv((mr+e)/2)),-t]}j4.invert=function(t,e){return[-e,2*bf(h4(t))-mr]};function WP(){var t=N4(j4),e=t.center,n=t.rotate;return t.center=function(i){return arguments.length?e([-i[1],i[0]]):(i=e(),[i[1],-i[0]])},t.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}const ZP=t=>({features:t[0]&16,data:t[0]&16,map:t[0]&4,close:t[0]&1}),s3=t=>{var e;return{features:t[4],data:(e=t[4])==null?void 0:e[0],map:t[2],close:t[31]}};function o3(t){let e,n,i=(t[4]||t[3]instanceof Fo.Marker)&&l3(t);return{c(){e=Ye("div"),i&&i.c()},l(o){e=Je(o,"DIV",{});var u=ht(e);i&&i.l(u),u.forEach(Fe)},m(o,u){Jt(o,e,u),i&&i.m(e,null),t[32](e),n=!0},p(o,u){o[4]||o[3]instanceof Fo.Marker?i?(i.p(o,u),u[0]&24&&rt(i,1)):(i=l3(o),i.c(),rt(i,1),i.m(e,null)):i&&(Ji(),mt(i,1,1,()=>{i=null}),Ki())},i(o){n||(rt(i),n=!0)},o(o){mt(i),n=!1},d(o){o&&Fe(e),i&&i.d(),t[32](null)}}}function l3(t){let e;const n=t[30].default,i=Rr(n,t,t[29],s3);return{c(){i&&i.c()},l(o){i&&i.l(o)},m(o,u){i&&i.m(o,u),e=!0},p(o,u){i&&i.p&&(!e||u[0]&536870933)&&Or(i,n,o,o[29],e?Vr(n,o[29],u,ZP):Ur(o[29]),s3)},i(o){e||(rt(i,o),e=!0)},o(o){mt(i,o),e=!1},d(o){i&&i.d(o)}}}function GP(t){let e,n,i=t[9].default&&o3(t);return{c(){i&&i.c(),e=er()},l(o){i&&i.l(o),e=er()},m(o,u){i&&i.m(o,u),Jt(o,e,u),n=!0},p(o,u){o[9].default?i?(i.p(o,u),u[0]&512&&rt(i,1)):(i=o3(o),i.c(),rt(i,1),i.m(e.parentNode,e)):i&&(Ji(),mt(i,1,1,()=>{i=null}),Ki())},i(o){n||(rt(i),n=!0)},o(o){mt(i),n=!1},d(o){o&&Fe(e),i&&i.d(o)}}}function YP(t,e,n){let i,o,u,h,c,b,{$$slots:w={},$$scope:S}=e;const M=N9(w);let{closeButton:A=void 0}=e,{closeOnClickOutside:P=!0}=e,{closeOnClickInside:B=!1}=e,{closeOnMove:U=!1}=e,{openOn:J="click"}=e,{openIfTopMost:Q=!0}=e,{focusAfterOpen:K=!0}=e,{anchor:le=void 0}=e,{offset:ee=void 0}=e,{popupClass:oe=void 0}=e,{maxWidth:Z=void 0}=e,{lngLat:ne=void 0}=e,{html:be=void 0}=e,{open:me=!1}=e;const Te=O1(),{map:Y,popupTarget:ye,layerEvent:qe,layer:He,eventTopMost:Be}=yf();ua(t,Y,Ee=>n(2,u=Ee)),ua(t,ye,Ee=>n(3,c=Ee)),ua(t,qe,Ee=>n(28,h=Ee)),ua(t,He,Ee=>n(35,b=Ee));const lt=["click","dblclick","contextmenu"];let Ge,ot=!1,je;function Ve(){if(!Ge)return;let Ee=Ge.getElement();!Ee||Ee===je||(je=Ee,J==="hover"&&(je.style.pointerEvents="none"),je.addEventListener("mouseenter",()=>{n(24,ot=!0)},{passive:!0}),je.addEventListener("mouseleave",()=>{n(24,ot=!1)},{passive:!0}),je.addEventListener("click",()=>{B&&n(0,me=!1)},{passive:!0}))}Ev(()=>{if(u)return u.on("click",Le),u.on("contextmenu",Le),typeof c=="string"&&(u.on("click",c,Pt),u.on("dblclick",c,Pt),u.on("contextmenu",c,Pt),u.on("mousemove",c,tt),u.on("mouseleave",c,Bt),u.on("touchstart",c,Lt),u.on("touchend",c,gt)),()=>{u!=null&&u.loaded()&&(Ge==null||Ge.remove(),u.off("click",Le),u.off("contextmenu",Le),c instanceof Fo.Marker?c.getPopup()===Ge&&c.setPopup(void 0):typeof c=="string"&&(u.off("click",c,Pt),u.off("dblclick",c,Pt),u.off("contextmenu",c,Pt),u.off("mousemove",c,tt),u.off("mouseleave",c,Bt),u.off("touchstart",c,Lt),u.off("touchend",c,gt)))}});function $e(Ee){return Q?!("marker"in Ee)&&!YE(Ee)&&Be(Ee)!==b:!1}let st=null,ct="normal";function Pt(Ee){Ee.type===J&&($e(Ee)||("layerType"in Ee?Ee.layerType==="deckgl"?(n(10,ne=Ee.coordinate),n(4,st=Ee.object?[Ee.object]:null)):(n(10,ne=Ee.lngLat),n(4,st=Ee.features??[])):(n(10,ne=Ee.lngLat),n(4,st=Ee.features??[])),setTimeout(()=>n(0,me=!0))))}let Ut=null;function Lt(Ee){Ut=Ee.point}function gt(Ee){if(!Ut||J!=="hover")return;let wt=Ut.dist(Ee.point);Ut=null,wt<3&&(n(10,ne=Ee.lngLat),n(4,st=Ee.features??[]),Ge.isOpen()?n(25,ct="justOpened"):(n(25,ct="opening"),n(0,me=!0)))}function Bt(Ee){J!=="hover"||Ut||ct!=="normal"||(n(0,me=!1),n(4,st=null))}function tt(Ee){if(!(J!=="hover"||Ut||ct!=="normal")){if($e(Ee)){n(0,me=!1),n(4,st=null);return}n(0,me=!0),n(4,st=Ee.features??[]),n(10,ne=Ee.lngLat)}}function Le(Ee){if(ct==="justOpened"){n(25,ct="normal");return}if(!P)return;let wt=[je,c instanceof Fo.Marker?c==null?void 0:c.getElement():null];me&&Ge.isOpen()&&!wt.some(De=>De==null?void 0:De.contains(Ee.originalEvent.target))&&(Ee.type==="contextmenu"&&J==="contextmenu"||Ee.type!=="contextmenu")&&n(0,me=!1)}Ro(()=>{u&&(Ge!=null&&Ge.isOpen())&&Ge.remove()});let ut;const Re=()=>n(0,me=!1);function Ke(Ee){Fr[Ee?"unshift":"push"](()=>{ut=Ee,n(1,ut)})}return t.$$set=Ee=>{"closeButton"in Ee&&n(11,A=Ee.closeButton),"closeOnClickOutside"in Ee&&n(12,P=Ee.closeOnClickOutside),"closeOnClickInside"in Ee&&n(13,B=Ee.closeOnClickInside),"closeOnMove"in Ee&&n(14,U=Ee.closeOnMove),"openOn"in Ee&&n(15,J=Ee.openOn),"openIfTopMost"in Ee&&n(16,Q=Ee.openIfTopMost),"focusAfterOpen"in Ee&&n(17,K=Ee.focusAfterOpen),"anchor"in Ee&&n(18,le=Ee.anchor),"offset"in Ee&&n(19,ee=Ee.offset),"popupClass"in Ee&&n(20,oe=Ee.popupClass),"maxWidth"in Ee&&n(21,Z=Ee.maxWidth),"lngLat"in Ee&&n(10,ne=Ee.lngLat),"html"in Ee&&n(22,be=Ee.html),"open"in Ee&&n(0,me=Ee.open),"$$scope"in Ee&&n(29,S=Ee.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&14336&&n(27,i=A??(!P&&!B)),t.$$.dirty[0]&146685952&&(Ge||(n(23,Ge=new Fo.Popup({closeButton:i,closeOnClick:!1,closeOnMove:U,focusAfterOpen:K,maxWidth:Z,className:oe,anchor:le,offset:ee})),je=Ge.getElement(),Ge.on("open",()=>{n(0,me=!0),Ve(),Te("open",Ge)}),Ge.on("close",()=>{n(0,me=!1),Te("close",Ge)}),Ge.on("hover",()=>{Te("hover",Ge)}))),t.$$.dirty[0]&8421384&&Ge&&c instanceof Fo.Marker&&(J==="click"?c.setPopup(Ge):c.getPopup()===Ge&&c.setPopup(void 0)),t.$$.dirty[0]&268468224&&lt.includes(J)&&(h==null?void 0:h.type)===J&&(Pt(h),_u(qe,h=null,h)),t.$$.dirty[0]&268468224&&n(26,o=J==="hover"&&((h==null?void 0:h.type)==="mousemove"||(h==null?void 0:h.type)==="mouseenter")),t.$$.dirty[0]&352354304&&J==="hover"&&qe&&(o&&h&&(h.layerType==="deckgl"?(n(10,ne=h.coordinate),n(4,st=h.object?[h.object]:null)):(n(10,ne=h.lngLat),n(4,st=h.features??[]))),n(0,me=(o||ot)??!1)),t.$$.dirty[0]&12582914&&(ut?Ge.setDOMContent(ut):be&&Ge.setHTML(be)),t.$$.dirty[0]&8389632&&ne&&Ge.setLngLat(ne),t.$$.dirty[0]&41943045&&u){let Ee=Ge.isOpen();me&&!Ee?(Ge.addTo(u),ct==="opening"&&n(25,ct="justOpened")):!me&&Ee&&Ge.remove()}},[me,ut,u,c,st,Y,ye,qe,He,M,ne,A,P,B,U,J,Q,K,le,ee,oe,Z,be,Ge,ot,ct,o,i,h,S,w,Re,Ke]}class JP extends jr{constructor(e){super(),qr(this,e,YP,GP,gr,{closeButton:11,closeOnClickOutside:12,closeOnClickInside:13,closeOnMove:14,openOn:15,openIfTopMost:16,focusAfterOpen:17,anchor:18,offset:19,popupClass:20,maxWidth:21,lngLat:10,html:22,open:0},null,[-1,-1])}}var xm=Uint8Array,q4=Uint16Array,KP=Int32Array,XP=new xm([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),QP=new xm([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),H4=function(t,e){for(var n=new q4(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];for(var o=new KP(n[30]),i=1;i<30;++i)for(var u=n[i];u<n[i+1];++u)o[u]=u-n[i]<<5|i;return{b:n,r:o}},W4=H4(XP,2),$P=W4.b,eL=W4.r;$P[28]=258,eL[258]=28;H4(QP,0);var tL=new q4(32768);for(di=0;di<32768;++di)ac=(di&43690)>>1|(di&21845)<<1,ac=(ac&52428)>>2|(ac&13107)<<2,ac=(ac&61680)>>4|(ac&3855)<<4,tL[di]=((ac&65280)>>8|(ac&255)<<8)>>1;var ac,di,X1=new xm(288);for(di=0;di<144;++di)X1[di]=8;var di;for(di=144;di<256;++di)X1[di]=9;var di;for(di=256;di<280;++di)X1[di]=7;var di;for(di=280;di<288;++di)X1[di]=8;var di,nL=new xm(32);for(di=0;di<32;++di)nL[di]=5;var di,iL=new xm(0),rL=typeof TextDecoder<"u"&&new TextDecoder,aL=0;try{rL.decode(iL,{stream:!0}),aL=1}catch{}function sL(t){return t}var oL=3,c3=1e-6;function lL(t){return"translate("+t+",0)"}function cL(t){return e=>+t(e)}function uL(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function hL(){return!this.__axis}function dL(t,e){var n=[],i=null,o=null,u=6,h=6,c=3,b=typeof window<"u"&&window.devicePixelRatio>1?0:.5,w=1,S="y",M=lL;function A(P){var B=i??(e.ticks?e.ticks.apply(e,n):e.domain()),U=o??(e.tickFormat?e.tickFormat.apply(e,n):sL),J=Math.max(u,0)+c,Q=e.range(),K=+Q[0]+b,le=+Q[Q.length-1]+b,ee=(e.bandwidth?uL:cL)(e.copy(),b),oe=P.selection?P.selection():P,Z=oe.selectAll(".domain").data([null]),ne=oe.selectAll(".tick").data(B,e).order(),be=ne.exit(),me=ne.enter().append("g").attr("class","tick"),Te=ne.select("line"),Y=ne.select("text");Z=Z.merge(Z.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ne=ne.merge(me),Te=Te.merge(me.append("line").attr("stroke","currentColor").attr(S+"2",w*u)),Y=Y.merge(me.append("text").attr("fill","currentColor").attr(S,w*J).attr("dy","0.71em")),P!==oe&&(Z=Z.transition(P),ne=ne.transition(P),Te=Te.transition(P),Y=Y.transition(P),be=be.transition(P).attr("opacity",c3).attr("transform",function(ye){return isFinite(ye=ee(ye))?M(ye+b):this.getAttribute("transform")}),me.attr("opacity",c3).attr("transform",function(ye){var qe=this.parentNode.__axis;return M((qe&&isFinite(qe=qe(ye))?qe:ee(ye))+b)})),be.remove(),Z.attr("d",h?"M"+K+","+w*h+"V"+b+"H"+le+"V"+w*h:"M"+K+","+b+"H"+le),ne.attr("opacity",1).attr("transform",function(ye){return M(ee(ye)+b)}),Te.attr(S+"2",w*u),Y.attr(S,w*J).text(U),oe.filter(hL).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),oe.each(function(){this.__axis=ee})}return A.scale=function(P){return arguments.length?(e=P,A):e},A.ticks=function(){return n=Array.from(arguments),A},A.tickArguments=function(P){return arguments.length?(n=P==null?[]:Array.from(P),A):n.slice()},A.tickValues=function(P){return arguments.length?(i=P==null?null:Array.from(P),A):i&&i.slice()},A.tickFormat=function(P){return arguments.length?(o=P,A):o},A.tickSize=function(P){return arguments.length?(u=h=+P,A):u},A.tickSizeInner=function(P){return arguments.length?(u=+P,A):u},A.tickSizeOuter=function(P){return arguments.length?(h=+P,A):h},A.tickPadding=function(P){return arguments.length?(c=+P,A):c},A.offset=function(P){return arguments.length?(b=+P,A):b},A}function fL(t){return dL(oL,t)}var pL={value:()=>{}};function Z4(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new a_(n)}function a_(t){this._=t}function mL(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",o=n.indexOf(".");if(o>=0&&(i=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}a_.prototype=Z4.prototype={constructor:a_,on:function(t,e){var n=this._,i=mL(t+"",n),o,u=-1,h=i.length;if(arguments.length<2){for(;++u<h;)if((o=(t=i[u]).type)&&(o=_L(n[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++u<h;)if(o=(t=i[u]).type)n[o]=u3(n[o],t.name,e);else if(e==null)for(o in n)n[o]=u3(n[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new a_(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var n=new Array(o),i=0,o,u;i<o;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(u=this._[t],i=0,o=u.length;i<o;++i)u[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],o=0,u=i.length;o<u;++o)i[o].value.apply(e,n)}};function _L(t,e){for(var n=0,i=t.length,o;n<i;++n)if((o=t[n]).name===e)return o.value}function u3(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=pL,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var Hb="http://www.w3.org/1999/xhtml";const Qd={svg:"http://www.w3.org/2000/svg",xhtml:Hb,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Q1(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Qd.hasOwnProperty(e)?{space:Qd[e],local:t}:t}function gL(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Hb&&e.documentElement.namespaceURI===Hb?e.createElement(t):e.createElementNS(n,t)}}function yL(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function $1(t){var e=Q1(t);return(e.local?yL:gL)(e)}function bL(){}function Wv(t){return t==null?bL:function(){return this.querySelector(t)}}function vL(t){typeof t!="function"&&(t=Wv(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var u=e[o],h=u.length,c=i[o]=new Array(h),b,w,S=0;S<h;++S)(b=u[S])&&(w=t.call(b,b.__data__,S,u))&&("__data__"in b&&(w.__data__=b.__data__),c[S]=w);return new Fs(i,this._parents)}function xL(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function wL(){return[]}function G4(t){return t==null?wL:function(){return this.querySelectorAll(t)}}function SL(t){return function(){return xL(t.apply(this,arguments))}}function IL(t){typeof t=="function"?t=SL(t):t=G4(t);for(var e=this._groups,n=e.length,i=[],o=[],u=0;u<n;++u)for(var h=e[u],c=h.length,b,w=0;w<c;++w)(b=h[w])&&(i.push(t.call(b,b.__data__,w,h)),o.push(b));return new Fs(i,o)}function Y4(t){return function(){return this.matches(t)}}function J4(t){return function(e){return e.matches(t)}}var TL=Array.prototype.find;function ML(t){return function(){return TL.call(this.children,t)}}function AL(){return this.firstElementChild}function CL(t){return this.select(t==null?AL:ML(typeof t=="function"?t:J4(t)))}var kL=Array.prototype.filter;function EL(){return Array.from(this.children)}function DL(t){return function(){return kL.call(this.children,t)}}function PL(t){return this.selectAll(t==null?EL:DL(typeof t=="function"?t:J4(t)))}function LL(t){typeof t!="function"&&(t=Y4(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var u=e[o],h=u.length,c=i[o]=[],b,w=0;w<h;++w)(b=u[w])&&t.call(b,b.__data__,w,u)&&c.push(b);return new Fs(i,this._parents)}function K4(t){return new Array(t.length)}function zL(){return new Fs(this._enter||this._groups.map(K4),this._parents)}function W_(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}W_.prototype={constructor:W_,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function BL(t){return function(){return t}}function FL(t,e,n,i,o,u){for(var h=0,c,b=e.length,w=u.length;h<w;++h)(c=e[h])?(c.__data__=u[h],i[h]=c):n[h]=new W_(t,u[h]);for(;h<b;++h)(c=e[h])&&(o[h]=c)}function NL(t,e,n,i,o,u,h){var c,b,w=new Map,S=e.length,M=u.length,A=new Array(S),P;for(c=0;c<S;++c)(b=e[c])&&(A[c]=P=h.call(b,b.__data__,c,e)+"",w.has(P)?o[c]=b:w.set(P,b));for(c=0;c<M;++c)P=h.call(t,u[c],c,u)+"",(b=w.get(P))?(i[c]=b,b.__data__=u[c],w.delete(P)):n[c]=new W_(t,u[c]);for(c=0;c<S;++c)(b=e[c])&&w.get(A[c])===b&&(o[c]=b)}function RL(t){return t.__data__}function OL(t,e){if(!arguments.length)return Array.from(this,RL);var n=e?NL:FL,i=this._parents,o=this._groups;typeof t!="function"&&(t=BL(t));for(var u=o.length,h=new Array(u),c=new Array(u),b=new Array(u),w=0;w<u;++w){var S=i[w],M=o[w],A=M.length,P=UL(t.call(S,S&&S.__data__,w,i)),B=P.length,U=c[w]=new Array(B),J=h[w]=new Array(B),Q=b[w]=new Array(A);n(S,M,U,J,Q,P,e);for(var K=0,le=0,ee,oe;K<B;++K)if(ee=U[K]){for(K>=le&&(le=K+1);!(oe=J[le])&&++le<B;);ee._next=oe||null}}return h=new Fs(h,i),h._enter=c,h._exit=b,h}function UL(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function VL(){return new Fs(this._exit||this._groups.map(K4),this._parents)}function jL(t,e,n){var i=this.enter(),o=this,u=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),n==null?u.remove():n(u),i&&o?i.merge(o).order():o}function qL(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,o=n.length,u=i.length,h=Math.min(o,u),c=new Array(o),b=0;b<h;++b)for(var w=n[b],S=i[b],M=w.length,A=c[b]=new Array(M),P,B=0;B<M;++B)(P=w[B]||S[B])&&(A[B]=P);for(;b<o;++b)c[b]=n[b];return new Fs(c,this._parents)}function HL(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],o=i.length-1,u=i[o],h;--o>=0;)(h=i[o])&&(u&&h.compareDocumentPosition(u)^4&&u.parentNode.insertBefore(h,u),u=h);return this}function WL(t){t||(t=ZL);function e(M,A){return M&&A?t(M.__data__,A.__data__):!M-!A}for(var n=this._groups,i=n.length,o=new Array(i),u=0;u<i;++u){for(var h=n[u],c=h.length,b=o[u]=new Array(c),w,S=0;S<c;++S)(w=h[S])&&(b[S]=w);b.sort(e)}return new Fs(o,this._parents).order()}function ZL(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function GL(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function YL(){return Array.from(this)}function JL(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],o=0,u=i.length;o<u;++o){var h=i[o];if(h)return h}return null}function KL(){let t=0;for(const e of this)++t;return t}function XL(){return!this.node()}function QL(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var o=e[n],u=0,h=o.length,c;u<h;++u)(c=o[u])&&t.call(c,c.__data__,u,o);return this}function $L(t){return function(){this.removeAttribute(t)}}function ez(t){return function(){this.removeAttributeNS(t.space,t.local)}}function tz(t,e){return function(){this.setAttribute(t,e)}}function nz(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function iz(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function rz(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function az(t,e){var n=Q1(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?ez:$L:typeof e=="function"?n.local?rz:iz:n.local?nz:tz)(n,e))}function X4(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function sz(t){return function(){this.style.removeProperty(t)}}function oz(t,e,n){return function(){this.style.setProperty(t,e,n)}}function lz(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function cz(t,e,n){return arguments.length>1?this.each((e==null?sz:typeof e=="function"?lz:oz)(t,e,n??"")):$d(this.node(),t)}function $d(t,e){return t.style.getPropertyValue(e)||X4(t).getComputedStyle(t,null).getPropertyValue(e)}function uz(t){return function(){delete this[t]}}function hz(t,e){return function(){this[t]=e}}function dz(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function fz(t,e){return arguments.length>1?this.each((e==null?uz:typeof e=="function"?dz:hz)(t,e)):this.node()[t]}function Q4(t){return t.trim().split(/^|\s+/)}function Zv(t){return t.classList||new $4(t)}function $4(t){this._node=t,this._names=Q4(t.getAttribute("class")||"")}$4.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function e5(t,e){for(var n=Zv(t),i=-1,o=e.length;++i<o;)n.add(e[i])}function t5(t,e){for(var n=Zv(t),i=-1,o=e.length;++i<o;)n.remove(e[i])}function pz(t){return function(){e5(this,t)}}function mz(t){return function(){t5(this,t)}}function _z(t,e){return function(){(e.apply(this,arguments)?e5:t5)(this,t)}}function gz(t,e){var n=Q4(t+"");if(arguments.length<2){for(var i=Zv(this.node()),o=-1,u=n.length;++o<u;)if(!i.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?_z:e?pz:mz)(n,e))}function yz(){this.textContent=""}function bz(t){return function(){this.textContent=t}}function vz(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function xz(t){return arguments.length?this.each(t==null?yz:(typeof t=="function"?vz:bz)(t)):this.node().textContent}function wz(){this.innerHTML=""}function Sz(t){return function(){this.innerHTML=t}}function Iz(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Tz(t){return arguments.length?this.each(t==null?wz:(typeof t=="function"?Iz:Sz)(t)):this.node().innerHTML}function Mz(){this.nextSibling&&this.parentNode.appendChild(this)}function Az(){return this.each(Mz)}function Cz(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function kz(){return this.each(Cz)}function Ez(t){var e=typeof t=="function"?t:$1(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Dz(){return null}function Pz(t,e){var n=typeof t=="function"?t:$1(t),i=e==null?Dz:typeof e=="function"?e:Wv(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function Lz(){var t=this.parentNode;t&&t.removeChild(this)}function zz(){return this.each(Lz)}function Bz(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Fz(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Nz(t){return this.select(t?Fz:Bz)}function Rz(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Oz(t){return function(e){t.call(this,e,this.__data__)}}function Uz(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Vz(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,o=e.length,u;n<o;++n)u=e[n],(!t.type||u.type===t.type)&&u.name===t.name?this.removeEventListener(u.type,u.listener,u.options):e[++i]=u;++i?e.length=i:delete this.__on}}}function jz(t,e,n){return function(){var i=this.__on,o,u=Oz(e);if(i){for(var h=0,c=i.length;h<c;++h)if((o=i[h]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=u,o.options=n),o.value=e;return}}this.addEventListener(t.type,u,n),o={type:t.type,name:t.name,value:e,listener:u,options:n},i?i.push(o):this.__on=[o]}}function qz(t,e,n){var i=Uz(t+""),o,u=i.length,h;if(arguments.length<2){var c=this.node().__on;if(c){for(var b=0,w=c.length,S;b<w;++b)for(o=0,S=c[b];o<u;++o)if((h=i[o]).type===S.type&&h.name===S.name)return S.value}return}for(c=e?jz:Vz,o=0;o<u;++o)this.each(c(i[o],e,n));return this}function n5(t,e,n){var i=X4(t),o=i.CustomEvent;typeof o=="function"?o=new o(e,n):(o=i.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Hz(t,e){return function(){return n5(this,t,e)}}function Wz(t,e){return function(){return n5(this,t,e.apply(this,arguments))}}function Zz(t,e){return this.each((typeof e=="function"?Wz:Hz)(t,e))}function*Gz(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],o=0,u=i.length,h;o<u;++o)(h=i[o])&&(yield h)}var i5=[null];function Fs(t,e){this._groups=t,this._parents=e}function wm(){return new Fs([[document.documentElement]],i5)}function Yz(){return this}Fs.prototype=wm.prototype={constructor:Fs,select:vL,selectAll:IL,selectChild:CL,selectChildren:PL,filter:LL,data:OL,enter:zL,exit:VL,join:jL,merge:qL,selection:Yz,order:HL,sort:WL,call:GL,nodes:YL,node:JL,size:KL,empty:XL,each:QL,attr:az,style:cz,property:fz,classed:gz,text:xz,html:Tz,raise:Az,lower:kz,append:Ez,insert:Pz,remove:zz,clone:Nz,datum:Rz,on:qz,dispatch:Zz,[Symbol.iterator]:Gz};function Hp(t){return typeof t=="string"?new Fs([[document.querySelector(t)]],[document.documentElement]):new Fs([[t]],i5)}function Jz(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Kz(t,e){if(t=Jz(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}function vf(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Sm(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Pu(){}var Ih=.7,ef=1/Ih,Vd="\\s*([+-]?\\d+)\\s*",Xp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xz=/^#([0-9a-f]{3,8})$/,Qz=new RegExp(`^rgb\\(${Vd},${Vd},${Vd}\\)$`),$z=new RegExp(`^rgb\\(${Tl},${Tl},${Tl}\\)$`),eB=new RegExp(`^rgba\\(${Vd},${Vd},${Vd},${Xp}\\)$`),tB=new RegExp(`^rgba\\(${Tl},${Tl},${Tl},${Xp}\\)$`),nB=new RegExp(`^hsl\\(${Xp},${Tl},${Tl}\\)$`),iB=new RegExp(`^hsla\\(${Xp},${Tl},${Tl},${Xp}\\)$`),h3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};vf(Pu,Th,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:d3,formatHex:d3,formatHex8:rB,formatHsl:aB,formatRgb:f3,toString:f3});function d3(){return this.rgb().formatHex()}function rB(){return this.rgb().formatHex8()}function aB(){return r5(this).formatHsl()}function f3(){return this.rgb().formatRgb()}function Th(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Xz.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?p3(e):n===3?new ha(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?q0(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?q0(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Qz.exec(t))?new ha(e[1],e[2],e[3],1):(e=$z.exec(t))?new ha(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=eB.exec(t))?q0(e[1],e[2],e[3],e[4]):(e=tB.exec(t))?q0(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=nB.exec(t))?g3(e[1],e[2]/100,e[3]/100,1):(e=iB.exec(t))?g3(e[1],e[2]/100,e[3]/100,e[4]):h3.hasOwnProperty(t)?p3(h3[t]):t==="transparent"?new ha(NaN,NaN,NaN,0):null}function p3(t){return new ha(t>>16&255,t>>8&255,t&255,1)}function q0(t,e,n,i){return i<=0&&(t=e=n=NaN),new ha(t,e,n,i)}function Gv(t){return t instanceof Pu||(t=Th(t)),t?(t=t.rgb(),new ha(t.r,t.g,t.b,t.opacity)):new ha}function Iu(t,e,n,i){return arguments.length===1?Gv(t):new ha(t,e,n,i??1)}function ha(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}vf(ha,Iu,Sm(Pu,{brighter(t){return t=t==null?ef:Math.pow(ef,t),new ha(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Ih:Math.pow(Ih,t),new ha(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ha(gh(this.r),gh(this.g),gh(this.b),Z_(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:m3,formatHex:m3,formatHex8:sB,formatRgb:_3,toString:_3}));function m3(){return`#${dh(this.r)}${dh(this.g)}${dh(this.b)}`}function sB(){return`#${dh(this.r)}${dh(this.g)}${dh(this.b)}${dh((isNaN(this.opacity)?1:this.opacity)*255)}`}function _3(){const t=Z_(this.opacity);return`${t===1?"rgb(":"rgba("}${gh(this.r)}, ${gh(this.g)}, ${gh(this.b)}${t===1?")":`, ${t})`}`}function Z_(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function gh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function dh(t){return t=gh(t),(t<16?"0":"")+t.toString(16)}function g3(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new zo(t,e,n,i)}function r5(t){if(t instanceof zo)return new zo(t.h,t.s,t.l,t.opacity);if(t instanceof Pu||(t=Th(t)),!t)return new zo;if(t instanceof zo)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,o=Math.min(e,n,i),u=Math.max(e,n,i),h=NaN,c=u-o,b=(u+o)/2;return c?(e===u?h=(n-i)/c+(n<i)*6:n===u?h=(i-e)/c+2:h=(e-n)/c+4,c/=b<.5?u+o:2-u-o,h*=60):c=b>0&&b<1?0:h,new zo(h,c,b,t.opacity)}function Wb(t,e,n,i){return arguments.length===1?r5(t):new zo(t,e,n,i??1)}function zo(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}vf(zo,Wb,Sm(Pu,{brighter(t){return t=t==null?ef:Math.pow(ef,t),new zo(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ih:Math.pow(Ih,t),new zo(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,o=2*n-i;return new ha(Ny(t>=240?t-240:t+120,o,i),Ny(t,o,i),Ny(t<120?t+240:t-120,o,i),this.opacity)},clamp(){return new zo(y3(this.h),H0(this.s),H0(this.l),Z_(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Z_(this.opacity);return`${t===1?"hsl(":"hsla("}${y3(this.h)}, ${H0(this.s)*100}%, ${H0(this.l)*100}%${t===1?")":`, ${t})`}`}}));function y3(t){return t=(t||0)%360,t<0?t+360:t}function H0(t){return Math.max(0,Math.min(1,t||0))}function Ny(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const a5=Math.PI/180,s5=180/Math.PI,G_=18,o5=.96422,l5=1,c5=.82521,u5=4/29,jd=6/29,h5=3*jd*jd,oB=jd*jd*jd;function d5(t){if(t instanceof Ml)return new Ml(t.l,t.a,t.b,t.opacity);if(t instanceof vc)return f5(t);t instanceof ha||(t=Gv(t));var e=Vy(t.r),n=Vy(t.g),i=Vy(t.b),o=Ry((.2225045*e+.7168786*n+.0606169*i)/l5),u,h;return e===n&&n===i?u=h=o:(u=Ry((.4360747*e+.3850649*n+.1430804*i)/o5),h=Ry((.0139322*e+.0971045*n+.7141733*i)/c5)),new Ml(116*o-16,500*(u-o),200*(o-h),t.opacity)}function Zb(t,e,n,i){return arguments.length===1?d5(t):new Ml(t,e,n,i??1)}function Ml(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}vf(Ml,Zb,Sm(Pu,{brighter(t){return new Ml(this.l+G_*(t??1),this.a,this.b,this.opacity)},darker(t){return new Ml(this.l-G_*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=o5*Oy(e),t=l5*Oy(t),n=c5*Oy(n),new ha(Uy(3.1338561*e-1.6168667*t-.4906146*n),Uy(-.9787684*e+1.9161415*t+.033454*n),Uy(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Ry(t){return t>oB?Math.pow(t,1/3):t/h5+u5}function Oy(t){return t>jd?t*t*t:h5*(t-u5)}function Uy(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Vy(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function lB(t){if(t instanceof vc)return new vc(t.h,t.c,t.l,t.opacity);if(t instanceof Ml||(t=d5(t)),t.a===0&&t.b===0)return new vc(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*s5;return new vc(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Gb(t,e,n,i){return arguments.length===1?lB(t):new vc(t,e,n,i??1)}function vc(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function f5(t){if(isNaN(t.h))return new Ml(t.l,0,0,t.opacity);var e=t.h*a5;return new Ml(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}vf(vc,Gb,Sm(Pu,{brighter(t){return new vc(this.h,this.c,this.l+G_*(t??1),this.opacity)},darker(t){return new vc(this.h,this.c,this.l-G_*(t??1),this.opacity)},rgb(){return f5(this).rgb()}}));var p5=-.14861,Yv=1.78277,Jv=-.29227,eg=-.90649,Qp=1.97294,b3=Qp*eg,v3=Qp*Yv,x3=Yv*Jv-eg*p5;function cB(t){if(t instanceof yh)return new yh(t.h,t.s,t.l,t.opacity);t instanceof ha||(t=Gv(t));var e=t.r/255,n=t.g/255,i=t.b/255,o=(x3*i+b3*e-v3*n)/(x3+b3-v3),u=i-o,h=(Qp*(n-o)-Jv*u)/eg,c=Math.sqrt(h*h+u*u)/(Qp*o*(1-o)),b=c?Math.atan2(h,u)*s5-120:NaN;return new yh(b<0?b+360:b,c,o,t.opacity)}function Pl(t,e,n,i){return arguments.length===1?cB(t):new yh(t,e,n,i??1)}function yh(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}vf(yh,Pl,Sm(Pu,{brighter(t){return t=t==null?ef:Math.pow(ef,t),new yh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Ih:Math.pow(Ih,t),new yh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*a5,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),o=Math.sin(t);return new ha(255*(e+n*(p5*i+Yv*o)),255*(e+n*(Jv*i+eg*o)),255*(e+n*(Qp*i)),this.opacity)}}));function uB(t,e,n,i,o){var u=t*t,h=u*t;return((1-3*t+3*u-h)*e+(4-6*u+3*h)*n+(1+3*t+3*u-3*h)*i+h*o)/6}function hB(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[i],u=t[i+1],h=i>0?t[i-1]:2*o-u,c=i<e-1?t[i+2]:2*u-o;return uB((n-i/e)*e,h,o,u,c)}}const tg=t=>()=>t;function m5(t,e){return function(n){return t+n*e}}function dB(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function Kv(t,e){var n=e-t;return n?m5(t,n>180||n<-180?n-360*Math.round(n/360):n):tg(isNaN(t)?e:t)}function fB(t){return(t=+t)==1?Ba:function(e,n){return n-e?dB(e,n,t):tg(isNaN(e)?n:e)}}function Ba(t,e){var n=e-t;return n?m5(t,n):tg(isNaN(t)?e:t)}const Mh=function t(e){var n=fB(e);function i(o,u){var h=n((o=Iu(o)).r,(u=Iu(u)).r),c=n(o.g,u.g),b=n(o.b,u.b),w=Ba(o.opacity,u.opacity);return function(S){return o.r=h(S),o.g=c(S),o.b=b(S),o.opacity=w(S),o+""}}return i.gamma=t,i}(1);function pB(t){return function(e){var n=e.length,i=new Array(n),o=new Array(n),u=new Array(n),h,c;for(h=0;h<n;++h)c=Iu(e[h]),i[h]=c.r||0,o[h]=c.g||0,u[h]=c.b||0;return i=t(i),o=t(o),u=t(u),c.opacity=1,function(b){return c.r=i(b),c.g=o(b),c.b=u(b),c+""}}}var mB=pB(hB);function _B(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),o;return function(u){for(o=0;o<n;++o)i[o]=t[o]*(1-u)+e[o]*u;return i}}function gB(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function yB(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,o=new Array(i),u=new Array(n),h;for(h=0;h<i;++h)o[h]=Im(t[h],e[h]);for(;h<n;++h)u[h]=e[h];return function(c){for(h=0;h<i;++h)u[h]=o[h](c);return u}}function bB(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function za(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function vB(t,e){var n={},i={},o;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(o in e)o in t?n[o]=Im(t[o],e[o]):i[o]=e[o];return function(u){for(o in n)i[o]=n[o](u);return i}}var Yb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jy=new RegExp(Yb.source,"g");function xB(t){return function(){return t}}function wB(t){return function(e){return t(e)+""}}function _5(t,e){var n=Yb.lastIndex=jy.lastIndex=0,i,o,u,h=-1,c=[],b=[];for(t=t+"",e=e+"";(i=Yb.exec(t))&&(o=jy.exec(e));)(u=o.index)>n&&(u=e.slice(n,u),c[h]?c[h]+=u:c[++h]=u),(i=i[0])===(o=o[0])?c[h]?c[h]+=o:c[++h]=o:(c[++h]=null,b.push({i:h,x:za(i,o)})),n=jy.lastIndex;return n<e.length&&(u=e.slice(n),c[h]?c[h]+=u:c[++h]=u),c.length<2?b[0]?wB(b[0].x):xB(e):(e=b.length,function(w){for(var S=0,M;S<e;++S)c[(M=b[S]).i]=M.x(w);return c.join("")})}function Im(t,e){var n=typeof e,i;return e==null||n==="boolean"?tg(e):(n==="number"?za:n==="string"?(i=Th(e))?(e=i,Mh):_5:e instanceof Th?Mh:e instanceof Date?bB:gB(e)?_B:Array.isArray(e)?yB:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?vB:za)(t,e)}function Xv(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var w3=180/Math.PI,Jb={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function g5(t,e,n,i,o,u){var h,c,b;return(h=Math.sqrt(t*t+e*e))&&(t/=h,e/=h),(b=t*n+e*i)&&(n-=t*b,i-=e*b),(c=Math.sqrt(n*n+i*i))&&(n/=c,i/=c,b/=c),t*i<e*n&&(t=-t,e=-e,b=-b,h=-h),{translateX:o,translateY:u,rotate:Math.atan2(e,t)*w3,skewX:Math.atan(b)*w3,scaleX:h,scaleY:c}}var W0;function SB(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Jb:g5(e.a,e.b,e.c,e.d,e.e,e.f)}function IB(t){return t==null||(W0||(W0=document.createElementNS("http://www.w3.org/2000/svg","g")),W0.setAttribute("transform",t),!(t=W0.transform.baseVal.consolidate()))?Jb:(t=t.matrix,g5(t.a,t.b,t.c,t.d,t.e,t.f))}function y5(t,e,n,i){function o(w){return w.length?w.pop()+" ":""}function u(w,S,M,A,P,B){if(w!==M||S!==A){var U=P.push("translate(",null,e,null,n);B.push({i:U-4,x:za(w,M)},{i:U-2,x:za(S,A)})}else(M||A)&&P.push("translate("+M+e+A+n)}function h(w,S,M,A){w!==S?(w-S>180?S+=360:S-w>180&&(w+=360),A.push({i:M.push(o(M)+"rotate(",null,i)-2,x:za(w,S)})):S&&M.push(o(M)+"rotate("+S+i)}function c(w,S,M,A){w!==S?A.push({i:M.push(o(M)+"skewX(",null,i)-2,x:za(w,S)}):S&&M.push(o(M)+"skewX("+S+i)}function b(w,S,M,A,P,B){if(w!==M||S!==A){var U=P.push(o(P)+"scale(",null,",",null,")");B.push({i:U-4,x:za(w,M)},{i:U-2,x:za(S,A)})}else(M!==1||A!==1)&&P.push(o(P)+"scale("+M+","+A+")")}return function(w,S){var M=[],A=[];return w=t(w),S=t(S),u(w.translateX,w.translateY,S.translateX,S.translateY,M,A),h(w.rotate,S.rotate,M,A),c(w.skewX,S.skewX,M,A),b(w.scaleX,w.scaleY,S.scaleX,S.scaleY,M,A),w=S=null,function(P){for(var B=-1,U=A.length,J;++B<U;)M[(J=A[B]).i]=J.x(P);return M.join("")}}}var TB=y5(SB,"px, ","px)","deg)"),MB=y5(IB,", ",")",")");function AB(t){return function(e,n){var i=t((e=Wb(e)).h,(n=Wb(n)).h),o=Ba(e.s,n.s),u=Ba(e.l,n.l),h=Ba(e.opacity,n.opacity);return function(c){return e.h=i(c),e.s=o(c),e.l=u(c),e.opacity=h(c),e+""}}}const CB=AB(Kv);function kB(t,e){var n=Ba((t=Zb(t)).l,(e=Zb(e)).l),i=Ba(t.a,e.a),o=Ba(t.b,e.b),u=Ba(t.opacity,e.opacity);return function(h){return t.l=n(h),t.a=i(h),t.b=o(h),t.opacity=u(h),t+""}}function EB(t){return function(e,n){var i=t((e=Gb(e)).h,(n=Gb(n)).h),o=Ba(e.c,n.c),u=Ba(e.l,n.l),h=Ba(e.opacity,n.opacity);return function(c){return e.h=i(c),e.c=o(c),e.l=u(c),e.opacity=h(c),e+""}}}const DB=EB(Kv);function b5(t){return function e(n){n=+n;function i(o,u){var h=t((o=Pl(o)).h,(u=Pl(u)).h),c=Ba(o.s,u.s),b=Ba(o.l,u.l),w=Ba(o.opacity,u.opacity);return function(S){return o.h=h(S),o.s=c(S),o.l=b(Math.pow(S,n)),o.opacity=w(S),o+""}}return i.gamma=e,i}(1)}b5(Kv);var Qv=b5(Ba);function ng(t,e){e===void 0&&(e=t,t=Im);for(var n=0,i=e.length-1,o=e[0],u=new Array(i<0?0:i);n<i;)u[n]=t(o,o=e[++n]);return function(h){var c=Math.max(0,Math.min(i-1,Math.floor(h*=i)));return u[c](h-c)}}function Uo(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n}var tf=0,Cp=0,_p=0,v5=1e3,Y_,kp,J_=0,Ah=0,ig=0,$p=typeof performance=="object"&&performance.now?performance:Date,x5=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $v(){return Ah||(x5(PB),Ah=$p.now()+ig)}function PB(){Ah=0}function K_(){this._call=this._time=this._next=null}K_.prototype=w5.prototype={constructor:K_,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?$v():+n)+(e==null?0:+e),!this._next&&kp!==this&&(kp?kp._next=this:Y_=this,kp=this),this._call=t,this._time=n,Kb()},stop:function(){this._call&&(this._call=null,this._time=1/0,Kb())}};function w5(t,e,n){var i=new K_;return i.restart(t,e,n),i}function LB(){$v(),++tf;for(var t=Y_,e;t;)(e=Ah-t._time)>=0&&t._call.call(void 0,e),t=t._next;--tf}function S3(){Ah=(J_=$p.now())+ig,tf=Cp=0;try{LB()}finally{tf=0,BB(),Ah=0}}function zB(){var t=$p.now(),e=t-J_;e>v5&&(ig-=e,J_=t)}function BB(){for(var t,e=Y_,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Y_=n);kp=t,Kb(i)}function Kb(t){if(!tf){Cp&&(Cp=clearTimeout(Cp));var e=t-Ah;e>24?(t<1/0&&(Cp=setTimeout(S3,t-$p.now()-ig)),_p&&(_p=clearInterval(_p))):(_p||(J_=$p.now(),_p=setInterval(zB,v5)),tf=1,x5(S3))}}function I3(t,e,n){var i=new K_;return e=e==null?0:+e,i.restart(o=>{i.stop(),t(o+e)},e,n),i}var FB=Z4("start","end","cancel","interrupt"),NB=[],S5=0,T3=1,Xb=2,s_=3,M3=4,Qb=5,o_=6;function rg(t,e,n,i,o,u){var h=t.__transition;if(!h)t.__transition={};else if(n in h)return;RB(t,n,{name:e,index:i,group:o,on:FB,tween:NB,time:u.time,delay:u.delay,duration:u.duration,ease:u.ease,timer:null,state:S5})}function e2(t,e){var n=Zo(t,e);if(n.state>S5)throw new Error("too late; already scheduled");return n}function Nl(t,e){var n=Zo(t,e);if(n.state>s_)throw new Error("too late; already running");return n}function Zo(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function RB(t,e,n){var i=t.__transition,o;i[e]=n,n.timer=w5(u,0,n.time);function u(w){n.state=T3,n.timer.restart(h,n.delay,n.time),n.delay<=w&&h(w-n.delay)}function h(w){var S,M,A,P;if(n.state!==T3)return b();for(S in i)if(P=i[S],P.name===n.name){if(P.state===s_)return I3(h);P.state===M3?(P.state=o_,P.timer.stop(),P.on.call("interrupt",t,t.__data__,P.index,P.group),delete i[S]):+S<e&&(P.state=o_,P.timer.stop(),P.on.call("cancel",t,t.__data__,P.index,P.group),delete i[S])}if(I3(function(){n.state===s_&&(n.state=M3,n.timer.restart(c,n.delay,n.time),c(w))}),n.state=Xb,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Xb){for(n.state=s_,o=new Array(A=n.tween.length),S=0,M=-1;S<A;++S)(P=n.tween[S].value.call(t,t.__data__,n.index,n.group))&&(o[++M]=P);o.length=M+1}}function c(w){for(var S=w<n.duration?n.ease.call(null,w/n.duration):(n.timer.restart(b),n.state=Qb,1),M=-1,A=o.length;++M<A;)o[M].call(t,S);n.state===Qb&&(n.on.call("end",t,t.__data__,n.index,n.group),b())}function b(){n.state=o_,n.timer.stop(),delete i[e];for(var w in i)return;delete t.__transition}}function OB(t,e){var n=t.__transition,i,o,u=!0,h;if(n){e=e==null?null:e+"";for(h in n){if((i=n[h]).name!==e){u=!1;continue}o=i.state>Xb&&i.state<Qb,i.state=o_,i.timer.stop(),i.on.call(o?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[h]}u&&delete t.__transition}}function UB(t){return this.each(function(){OB(this,t)})}function VB(t,e){var n,i;return function(){var o=Nl(this,t),u=o.tween;if(u!==n){i=n=u;for(var h=0,c=i.length;h<c;++h)if(i[h].name===e){i=i.slice(),i.splice(h,1);break}}o.tween=i}}function jB(t,e,n){var i,o;if(typeof n!="function")throw new Error;return function(){var u=Nl(this,t),h=u.tween;if(h!==i){o=(i=h).slice();for(var c={name:e,value:n},b=0,w=o.length;b<w;++b)if(o[b].name===e){o[b]=c;break}b===w&&o.push(c)}u.tween=o}}function qB(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=Zo(this.node(),n).tween,o=0,u=i.length,h;o<u;++o)if((h=i[o]).name===t)return h.value;return null}return this.each((e==null?VB:jB)(n,t,e))}function t2(t,e,n){var i=t._id;return t.each(function(){var o=Nl(this,i);(o.value||(o.value={}))[e]=n.apply(this,arguments)}),function(o){return Zo(o,i).value[e]}}function I5(t,e){var n;return(typeof e=="number"?za:e instanceof Th?Mh:(n=Th(e))?(e=n,Mh):_5)(t,e)}function HB(t){return function(){this.removeAttribute(t)}}function WB(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ZB(t,e,n){var i,o=n+"",u;return function(){var h=this.getAttribute(t);return h===o?null:h===i?u:u=e(i=h,n)}}function GB(t,e,n){var i,o=n+"",u;return function(){var h=this.getAttributeNS(t.space,t.local);return h===o?null:h===i?u:u=e(i=h,n)}}function YB(t,e,n){var i,o,u;return function(){var h,c=n(this),b;return c==null?void this.removeAttribute(t):(h=this.getAttribute(t),b=c+"",h===b?null:h===i&&b===o?u:(o=b,u=e(i=h,c)))}}function JB(t,e,n){var i,o,u;return function(){var h,c=n(this),b;return c==null?void this.removeAttributeNS(t.space,t.local):(h=this.getAttributeNS(t.space,t.local),b=c+"",h===b?null:h===i&&b===o?u:(o=b,u=e(i=h,c)))}}function KB(t,e){var n=Q1(t),i=n==="transform"?MB:I5;return this.attrTween(t,typeof e=="function"?(n.local?JB:YB)(n,i,t2(this,"attr."+t,e)):e==null?(n.local?WB:HB)(n):(n.local?GB:ZB)(n,i,e))}function XB(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function QB(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function $B(t,e){var n,i;function o(){var u=e.apply(this,arguments);return u!==i&&(n=(i=u)&&QB(t,u)),n}return o._value=e,o}function eF(t,e){var n,i;function o(){var u=e.apply(this,arguments);return u!==i&&(n=(i=u)&&XB(t,u)),n}return o._value=e,o}function tF(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=Q1(t);return this.tween(n,(i.local?$B:eF)(i,e))}function nF(t,e){return function(){e2(this,t).delay=+e.apply(this,arguments)}}function iF(t,e){return e=+e,function(){e2(this,t).delay=e}}function rF(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?nF:iF)(e,t)):Zo(this.node(),e).delay}function aF(t,e){return function(){Nl(this,t).duration=+e.apply(this,arguments)}}function sF(t,e){return e=+e,function(){Nl(this,t).duration=e}}function oF(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?aF:sF)(e,t)):Zo(this.node(),e).duration}function lF(t,e){if(typeof e!="function")throw new Error;return function(){Nl(this,t).ease=e}}function cF(t){var e=this._id;return arguments.length?this.each(lF(e,t)):Zo(this.node(),e).ease}function uF(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Nl(this,t).ease=n}}function hF(t){if(typeof t!="function")throw new Error;return this.each(uF(this._id,t))}function dF(t){typeof t!="function"&&(t=Y4(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var u=e[o],h=u.length,c=i[o]=[],b,w=0;w<h;++w)(b=u[w])&&t.call(b,b.__data__,w,u)&&c.push(b);return new Mc(i,this._parents,this._name,this._id)}function fF(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,o=n.length,u=Math.min(i,o),h=new Array(i),c=0;c<u;++c)for(var b=e[c],w=n[c],S=b.length,M=h[c]=new Array(S),A,P=0;P<S;++P)(A=b[P]||w[P])&&(M[P]=A);for(;c<i;++c)h[c]=e[c];return new Mc(h,this._parents,this._name,this._id)}function pF(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function mF(t,e,n){var i,o,u=pF(e)?e2:Nl;return function(){var h=u(this,t),c=h.on;c!==i&&(o=(i=c).copy()).on(e,n),h.on=o}}function _F(t,e){var n=this._id;return arguments.length<2?Zo(this.node(),n).on.on(t):this.each(mF(n,t,e))}function gF(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function yF(){return this.on("end.remove",gF(this._id))}function bF(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Wv(t));for(var i=this._groups,o=i.length,u=new Array(o),h=0;h<o;++h)for(var c=i[h],b=c.length,w=u[h]=new Array(b),S,M,A=0;A<b;++A)(S=c[A])&&(M=t.call(S,S.__data__,A,c))&&("__data__"in S&&(M.__data__=S.__data__),w[A]=M,rg(w[A],e,n,A,w,Zo(S,n)));return new Mc(u,this._parents,e,n)}function vF(t){var e=this._name,n=this._id;typeof t!="function"&&(t=G4(t));for(var i=this._groups,o=i.length,u=[],h=[],c=0;c<o;++c)for(var b=i[c],w=b.length,S,M=0;M<w;++M)if(S=b[M]){for(var A=t.call(S,S.__data__,M,b),P,B=Zo(S,n),U=0,J=A.length;U<J;++U)(P=A[U])&&rg(P,e,n,U,A,B);u.push(A),h.push(S)}return new Mc(u,h,e,n)}var xF=wm.prototype.constructor;function wF(){return new xF(this._groups,this._parents)}function SF(t,e){var n,i,o;return function(){var u=$d(this,t),h=(this.style.removeProperty(t),$d(this,t));return u===h?null:u===n&&h===i?o:o=e(n=u,i=h)}}function T5(t){return function(){this.style.removeProperty(t)}}function IF(t,e,n){var i,o=n+"",u;return function(){var h=$d(this,t);return h===o?null:h===i?u:u=e(i=h,n)}}function TF(t,e,n){var i,o,u;return function(){var h=$d(this,t),c=n(this),b=c+"";return c==null&&(b=c=(this.style.removeProperty(t),$d(this,t))),h===b?null:h===i&&b===o?u:(o=b,u=e(i=h,c))}}function MF(t,e){var n,i,o,u="style."+e,h="end."+u,c;return function(){var b=Nl(this,t),w=b.on,S=b.value[u]==null?c||(c=T5(e)):void 0;(w!==n||o!==S)&&(i=(n=w).copy()).on(h,o=S),b.on=i}}function AF(t,e,n){var i=(t+="")=="transform"?TB:I5;return e==null?this.styleTween(t,SF(t,i)).on("end.style."+t,T5(t)):typeof e=="function"?this.styleTween(t,TF(t,i,t2(this,"style."+t,e))).each(MF(this._id,t)):this.styleTween(t,IF(t,i,e),n).on("end.style."+t,null)}function CF(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function kF(t,e,n){var i,o;function u(){var h=e.apply(this,arguments);return h!==o&&(i=(o=h)&&CF(t,h,n)),i}return u._value=e,u}function EF(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,kF(t,e,n??""))}function DF(t){return function(){this.textContent=t}}function PF(t){return function(){var e=t(this);this.textContent=e??""}}function LF(t){return this.tween("text",typeof t=="function"?PF(t2(this,"text",t)):DF(t==null?"":t+""))}function zF(t){return function(e){this.textContent=t.call(this,e)}}function BF(t){var e,n;function i(){var o=t.apply(this,arguments);return o!==n&&(e=(n=o)&&zF(o)),e}return i._value=t,i}function FF(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,BF(t))}function NF(){for(var t=this._name,e=this._id,n=M5(),i=this._groups,o=i.length,u=0;u<o;++u)for(var h=i[u],c=h.length,b,w=0;w<c;++w)if(b=h[w]){var S=Zo(b,e);rg(b,t,n,w,h,{time:S.time+S.delay+S.duration,delay:0,duration:S.duration,ease:S.ease})}return new Mc(i,this._parents,t,n)}function RF(){var t,e,n=this,i=n._id,o=n.size();return new Promise(function(u,h){var c={value:h},b={value:function(){--o===0&&u()}};n.each(function(){var w=Nl(this,i),S=w.on;S!==t&&(e=(t=S).copy(),e._.cancel.push(c),e._.interrupt.push(c),e._.end.push(b)),w.on=e}),o===0&&u()})}var OF=0;function Mc(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function M5(){return++OF}var sc=wm.prototype;Mc.prototype={constructor:Mc,select:bF,selectAll:vF,selectChild:sc.selectChild,selectChildren:sc.selectChildren,filter:dF,merge:fF,selection:wF,transition:NF,call:sc.call,nodes:sc.nodes,node:sc.node,size:sc.size,empty:sc.empty,each:sc.each,on:_F,attr:KB,attrTween:tF,style:AF,styleTween:EF,text:LF,textTween:FF,remove:yF,tween:qB,delay:rF,duration:oF,ease:cF,easeVarying:hF,end:RF,[Symbol.iterator]:sc[Symbol.iterator]};function UF(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var VF={time:null,delay:0,duration:250,ease:UF};function jF(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function qF(t){var e,n;t instanceof Mc?(e=t._id,t=t._name):(e=M5(),(n=VF).time=$v(),t=t==null?null:t+"");for(var i=this._groups,o=i.length,u=0;u<o;++u)for(var h=i[u],c=h.length,b,w=0;w<c;++w)(b=h[w])&&rg(b,t,e,w,h,n||jF(b,e));return new Mc(i,this._parents,t,e)}wm.prototype.interrupt=UB;wm.prototype.transition=qF;const $b=Math.PI,ev=2*$b,uh=1e-6,HF=ev-uh;function A5(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function WF(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return A5;const n=10**e;return function(i){this._+=i[0];for(let o=1,u=i.length;o<u;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}class C5{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?A5:WF(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,o){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+o}`}bezierCurveTo(e,n,i,o,u,h){this._append`C${+e},${+n},${+i},${+o},${this._x1=+u},${this._y1=+h}`}arcTo(e,n,i,o,u){if(e=+e,n=+n,i=+i,o=+o,u=+u,u<0)throw new Error(`negative radius: ${u}`);let h=this._x1,c=this._y1,b=i-e,w=o-n,S=h-e,M=c-n,A=S*S+M*M;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(A>uh)if(!(Math.abs(M*b-w*S)>uh)||!u)this._append`L${this._x1=e},${this._y1=n}`;else{let P=i-h,B=o-c,U=b*b+w*w,J=P*P+B*B,Q=Math.sqrt(U),K=Math.sqrt(A),le=u*Math.tan(($b-Math.acos((U+A-J)/(2*Q*K)))/2),ee=le/K,oe=le/Q;Math.abs(ee-1)>uh&&this._append`L${e+ee*S},${n+ee*M}`,this._append`A${u},${u},0,0,${+(M*P>S*B)},${this._x1=e+oe*b},${this._y1=n+oe*w}`}}arc(e,n,i,o,u,h){if(e=+e,n=+n,i=+i,h=!!h,i<0)throw new Error(`negative radius: ${i}`);let c=i*Math.cos(o),b=i*Math.sin(o),w=e+c,S=n+b,M=1^h,A=h?o-u:u-o;this._x1===null?this._append`M${w},${S}`:(Math.abs(this._x1-w)>uh||Math.abs(this._y1-S)>uh)&&this._append`L${w},${S}`,i&&(A<0&&(A=A%ev+ev),A>HF?this._append`A${i},${i},0,1,${M},${e-c},${n-b}A${i},${i},0,1,${M},${this._x1=w},${this._y1=S}`:A>uh&&this._append`A${i},${i},0,${+(A>=$b)},${M},${this._x1=e+i*Math.cos(u)},${this._y1=n+i*Math.sin(u)}`)}rect(e,n,i,o){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+o}h${-i}Z`}toString(){return this._}}function fh(t=3){return new C5(+t)}function ZF(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function X_(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function nf(t){return t=X_(Math.abs(t)),t?t[1]:NaN}function GF(t,e){return function(n,i){for(var o=n.length,u=[],h=0,c=t[0],b=0;o>0&&c>0&&(b+c+1>i&&(c=Math.max(1,i-b)),u.push(n.substring(o-=c,o+c)),!((b+=c+1)>i));)c=t[h=(h+1)%t.length];return u.reverse().join(e)}}function YF(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var JF=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function em(t){if(!(e=JF.exec(t)))throw new Error("invalid format: "+t);var e;return new n2({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}em.prototype=n2.prototype;function n2(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}n2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function KF(t){e:for(var e=t.length,n=1,i=-1,o;n<e;++n)switch(t[n]){case".":i=o=n;break;case"0":i===0&&(i=n),o=n;break;default:if(!+t[n])break e;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(o+1):t}var k5;function XF(t,e){var n=X_(t,e);if(!n)return t+"";var i=n[0],o=n[1],u=o-(k5=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,h=i.length;return u===h?i:u>h?i+new Array(u-h+1).join("0"):u>0?i.slice(0,u)+"."+i.slice(u):"0."+new Array(1-u).join("0")+X_(t,Math.max(0,e+u-1))[0]}function A3(t,e){var n=X_(t,e);if(!n)return t+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")}const C3={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:ZF,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>A3(t*100,e),r:A3,s:XF,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function k3(t){return t}var E3=Array.prototype.map,D3=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function QF(t){var e=t.grouping===void 0||t.thousands===void 0?k3:GF(E3.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",o=t.decimal===void 0?".":t.decimal+"",u=t.numerals===void 0?k3:YF(E3.call(t.numerals,String)),h=t.percent===void 0?"%":t.percent+"",c=t.minus===void 0?"−":t.minus+"",b=t.nan===void 0?"NaN":t.nan+"";function w(M){M=em(M);var A=M.fill,P=M.align,B=M.sign,U=M.symbol,J=M.zero,Q=M.width,K=M.comma,le=M.precision,ee=M.trim,oe=M.type;oe==="n"?(K=!0,oe="g"):C3[oe]||(le===void 0&&(le=12),ee=!0,oe="g"),(J||A==="0"&&P==="=")&&(J=!0,A="0",P="=");var Z=U==="$"?n:U==="#"&&/[boxX]/.test(oe)?"0"+oe.toLowerCase():"",ne=U==="$"?i:/[%p]/.test(oe)?h:"",be=C3[oe],me=/[defgprs%]/.test(oe);le=le===void 0?6:/[gprs]/.test(oe)?Math.max(1,Math.min(21,le)):Math.max(0,Math.min(20,le));function Te(Y){var ye=Z,qe=ne,He,Be,lt;if(oe==="c")qe=be(Y)+qe,Y="";else{Y=+Y;var Ge=Y<0||1/Y<0;if(Y=isNaN(Y)?b:be(Math.abs(Y),le),ee&&(Y=KF(Y)),Ge&&+Y==0&&B!=="+"&&(Ge=!1),ye=(Ge?B==="("?B:c:B==="-"||B==="("?"":B)+ye,qe=(oe==="s"?D3[8+k5/3]:"")+qe+(Ge&&B==="("?")":""),me){for(He=-1,Be=Y.length;++He<Be;)if(lt=Y.charCodeAt(He),48>lt||lt>57){qe=(lt===46?o+Y.slice(He+1):Y.slice(He))+qe,Y=Y.slice(0,He);break}}}K&&!J&&(Y=e(Y,1/0));var ot=ye.length+Y.length+qe.length,je=ot<Q?new Array(Q-ot+1).join(A):"";switch(K&&J&&(Y=e(je+Y,je.length?Q-qe.length:1/0),je=""),P){case"<":Y=ye+Y+qe+je;break;case"=":Y=ye+je+Y+qe;break;case"^":Y=je.slice(0,ot=je.length>>1)+ye+Y+qe+je.slice(ot);break;default:Y=je+ye+Y+qe;break}return u(Y)}return Te.toString=function(){return M+""},Te}function S(M,A){var P=w((M=em(M),M.type="f",M)),B=Math.max(-8,Math.min(8,Math.floor(nf(A)/3)))*3,U=Math.pow(10,-B),J=D3[8+B/3];return function(Q){return P(U*Q)+J}}return{format:w,formatPrefix:S}}var Z0,xf,E5;$F({thousands:",",grouping:[3],currency:["$",""]});function $F(t){return Z0=QF(t),xf=Z0.format,E5=Z0.formatPrefix,Z0}function eN(t){return Math.max(0,-nf(Math.abs(t)))}function tN(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(nf(e)/3)))*3-nf(Math.abs(t)))}function nN(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,nf(e)-nf(t))+1}function Rl(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ag(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const tv=Symbol("implicit");function i2(){var t=new Gp,e=[],n=[],i=tv;function o(u){let h=t.get(u);if(h===void 0){if(i!==tv)return i;t.set(u,h=e.push(u)-1)}return n[h%n.length]}return o.domain=function(u){if(!arguments.length)return e.slice();e=[],t=new Gp;for(const h of u)t.has(h)||t.set(h,e.push(h)-1);return o},o.range=function(u){return arguments.length?(n=Array.from(u),o):n.slice()},o.unknown=function(u){return arguments.length?(i=u,o):i},o.copy=function(){return i2(e,n).unknown(i)},Rl.apply(o,arguments),o}function sg(){var t=i2().unknown(void 0),e=t.domain,n=t.range,i=0,o=1,u,h,c=!1,b=0,w=0,S=.5;delete t.unknown;function M(){var A=e().length,P=o<i,B=P?o:i,U=P?i:o;u=(U-B)/Math.max(1,A-b+w*2),c&&(u=Math.floor(u)),B+=(U-B-u*(A-b))*S,h=u*(1-b),c&&(B=Math.round(B),h=Math.round(h));var J=Ab(A).map(function(Q){return B+u*Q});return n(P?J.reverse():J)}return t.domain=function(A){return arguments.length?(e(A),M()):e()},t.range=function(A){return arguments.length?([i,o]=A,i=+i,o=+o,M()):[i,o]},t.rangeRound=function(A){return[i,o]=A,i=+i,o=+o,c=!0,M()},t.bandwidth=function(){return h},t.step=function(){return u},t.round=function(A){return arguments.length?(c=!!A,M()):c},t.padding=function(A){return arguments.length?(b=Math.min(1,w=+A),M()):b},t.paddingInner=function(A){return arguments.length?(b=Math.min(1,A),M()):b},t.paddingOuter=function(A){return arguments.length?(w=+A,M()):w},t.align=function(A){return arguments.length?(S=Math.max(0,Math.min(1,A)),M()):S},t.copy=function(){return sg(e(),[i,o]).round(c).paddingInner(b).paddingOuter(w).align(S)},Rl.apply(M(),arguments)}function D5(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return D5(e())},t}function iN(){return D5(sg.apply(null,arguments).paddingInner(1))}function rN(t){return function(){return t}}function nv(t){return+t}var P3=[0,1];function ao(t){return t}function iv(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:rN(isNaN(e)?NaN:.5)}function aN(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function sN(t,e,n){var i=t[0],o=t[1],u=e[0],h=e[1];return o<i?(i=iv(o,i),u=n(h,u)):(i=iv(i,o),u=n(u,h)),function(c){return u(i(c))}}function oN(t,e,n){var i=Math.min(t.length,e.length)-1,o=new Array(i),u=new Array(i),h=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++h<i;)o[h]=iv(t[h],t[h+1]),u[h]=n(e[h],e[h+1]);return function(c){var b=Nv(t,c,1,i)-1;return u[b](o[b](c))}}function Tm(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function og(){var t=P3,e=P3,n=Im,i,o,u,h=ao,c,b,w;function S(){var A=Math.min(t.length,e.length);return h!==ao&&(h=aN(t[0],t[A-1])),c=A>2?oN:sN,b=w=null,M}function M(A){return A==null||isNaN(A=+A)?u:(b||(b=c(t.map(i),e,n)))(i(h(A)))}return M.invert=function(A){return h(o((w||(w=c(e,t.map(i),za)))(A)))},M.domain=function(A){return arguments.length?(t=Array.from(A,nv),S()):t.slice()},M.range=function(A){return arguments.length?(e=Array.from(A),S()):e.slice()},M.rangeRound=function(A){return e=Array.from(A),n=Xv,S()},M.clamp=function(A){return arguments.length?(h=A?!0:ao,S()):h!==ao},M.interpolate=function(A){return arguments.length?(n=A,S()):n},M.unknown=function(A){return arguments.length?(u=A,M):u},function(A,P){return i=A,o=P,S()}}function P5(){return og()(ao,ao)}function lN(t,e,n,i){var o=Tb(t,e,n),u;switch(i=em(i??",f"),i.type){case"s":{var h=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(u=tN(o,h))&&(i.precision=u),E5(i,h)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(u=nN(o,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=u-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(u=eN(o))&&(i.precision=u-(i.type==="%")*2);break}}return xf(i)}function Mm(t){var e=t.domain;return t.ticks=function(n){var i=e();return E_(i[0],i[i.length-1],n??10)},t.tickFormat=function(n,i){var o=e();return lN(o[0],o[o.length-1],n??10,i)},t.nice=function(n){n==null&&(n=10);var i=e(),o=0,u=i.length-1,h=i[o],c=i[u],b,w,S=10;for(c<h&&(w=h,h=c,c=w,w=o,o=u,u=w);S-- >0;){if(w=Ib(h,c,n),w===b)return i[o]=h,i[u]=c,e(i);if(w>0)h=Math.floor(h/w)*w,c=Math.ceil(c/w)*w;else if(w<0)h=Math.ceil(h*w)/w,c=Math.floor(c*w)/w;else break;b=w}return t},t}function r2(){var t=P5();return t.copy=function(){return Tm(t,r2())},Rl.apply(t,arguments),Mm(t)}function L5(t){var e;function n(i){return i==null||isNaN(i=+i)?e:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(t=Array.from(i,nv),n):t.slice()},n.unknown=function(i){return arguments.length?(e=i,n):e},n.copy=function(){return L5(t).unknown(e)},t=arguments.length?Array.from(t,nv):[0,1],Mm(n)}function z5(t,e){t=t.slice();var n=0,i=t.length-1,o=t[n],u=t[i],h;return u<o&&(h=n,n=i,i=h,h=o,o=u,u=h),t[n]=e.floor(o),t[i]=e.ceil(u),t}function L3(t){return Math.log(t)}function z3(t){return Math.exp(t)}function cN(t){return-Math.log(-t)}function uN(t){return-Math.exp(-t)}function hN(t){return isFinite(t)?+("1e"+t):t<0?0:t}function dN(t){return t===10?hN:t===Math.E?Math.exp:e=>Math.pow(t,e)}function fN(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function B3(t){return(e,n)=>-t(-e,n)}function B5(t){const e=t(L3,z3),n=e.domain;let i=10,o,u;function h(){return o=fN(i),u=dN(i),n()[0]<0?(o=B3(o),u=B3(u),t(cN,uN)):t(L3,z3),e}return e.base=function(c){return arguments.length?(i=+c,h()):i},e.domain=function(c){return arguments.length?(n(c),h()):n()},e.ticks=c=>{const b=n();let w=b[0],S=b[b.length-1];const M=S<w;M&&([w,S]=[S,w]);let A=o(w),P=o(S),B,U;const J=c==null?10:+c;let Q=[];if(!(i%1)&&P-A<J){if(A=Math.floor(A),P=Math.ceil(P),w>0){for(;A<=P;++A)for(B=1;B<i;++B)if(U=A<0?B/u(-A):B*u(A),!(U<w)){if(U>S)break;Q.push(U)}}else for(;A<=P;++A)for(B=i-1;B>=1;--B)if(U=A>0?B/u(-A):B*u(A),!(U<w)){if(U>S)break;Q.push(U)}Q.length*2<J&&(Q=E_(w,S,J))}else Q=E_(A,P,Math.min(P-A,J)).map(u);return M?Q.reverse():Q},e.tickFormat=(c,b)=>{if(c==null&&(c=10),b==null&&(b=i===10?"s":","),typeof b!="function"&&(!(i%1)&&(b=em(b)).precision==null&&(b.trim=!0),b=xf(b)),c===1/0)return b;const w=Math.max(1,i*c/e.ticks().length);return S=>{let M=S/u(Math.round(o(S)));return M*i<i-.5&&(M*=i),M<=w?b(S):""}},e.nice=()=>n(z5(n(),{floor:c=>u(Math.floor(o(c))),ceil:c=>u(Math.ceil(o(c)))})),e}function F5(){const t=B5(og()).domain([1,10]);return t.copy=()=>Tm(t,F5()).base(t.base()),Rl.apply(t,arguments),t}function F3(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function N3(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function N5(t){var e=1,n=t(F3(e),N3(e));return n.constant=function(i){return arguments.length?t(F3(e=+i),N3(e)):e},Mm(n)}function R5(){var t=N5(og());return t.copy=function(){return Tm(t,R5()).constant(t.constant())},Rl.apply(t,arguments)}function R3(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function pN(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function mN(t){return t<0?-t*t:t*t}function O5(t){var e=t(ao,ao),n=1;function i(){return n===1?t(ao,ao):n===.5?t(pN,mN):t(R3(n),R3(1/n))}return e.exponent=function(o){return arguments.length?(n=+o,i()):n},Mm(e)}function U5(){var t=O5(og());return t.copy=function(){return Tm(t,U5()).exponent(t.exponent())},Rl.apply(t,arguments),t}function V5(){var t=[],e=[],n=[],i;function o(){var h=0,c=Math.max(1,e.length);for(n=new Array(c-1);++h<c;)n[h-1]=JD(t,h/c);return u}function u(h){return h==null||isNaN(h=+h)?i:e[Nv(n,h)]}return u.invertExtent=function(h){var c=e.indexOf(h);return c<0?[NaN,NaN]:[c>0?n[c-1]:t[0],c<n.length?n[c]:t[t.length-1]]},u.domain=function(h){if(!arguments.length)return t.slice();t=[];for(let c of h)c!=null&&!isNaN(c=+c)&&t.push(c);return t.sort(gu),o()},u.range=function(h){return arguments.length?(e=Array.from(h),o()):e.slice()},u.unknown=function(h){return arguments.length?(i=h,u):i},u.quantiles=function(){return n.slice()},u.copy=function(){return V5().domain(t).range(e).unknown(i)},Rl.apply(u,arguments)}function j5(){var t=[.5],e=[0,1],n,i=1;function o(u){return u!=null&&u<=u?e[Nv(t,u,0,i)]:n}return o.domain=function(u){return arguments.length?(t=Array.from(u),i=Math.min(t.length,e.length-1),o):t.slice()},o.range=function(u){return arguments.length?(e=Array.from(u),i=Math.min(t.length,e.length-1),o):e.slice()},o.invertExtent=function(u){var h=e.indexOf(u);return[t[h-1],t[h]]},o.unknown=function(u){return arguments.length?(n=u,o):n},o.copy=function(){return j5().domain(t).range(e).unknown(n)},Rl.apply(o,arguments)}const qy=new Date,Hy=new Date;function Jr(t,e,n,i){function o(u){return t(u=arguments.length===0?new Date:new Date(+u)),u}return o.floor=u=>(t(u=new Date(+u)),u),o.ceil=u=>(t(u=new Date(u-1)),e(u,1),t(u),u),o.round=u=>{const h=o(u),c=o.ceil(u);return u-h<c-u?h:c},o.offset=(u,h)=>(e(u=new Date(+u),h==null?1:Math.floor(h)),u),o.range=(u,h,c)=>{const b=[];if(u=o.ceil(u),c=c==null?1:Math.floor(c),!(u<h)||!(c>0))return b;let w;do b.push(w=new Date(+u)),e(u,c),t(u);while(w<u&&u<h);return b},o.filter=u=>Jr(h=>{if(h>=h)for(;t(h),!u(h);)h.setTime(h-1)},(h,c)=>{if(h>=h)if(c<0)for(;++c<=0;)for(;e(h,-1),!u(h););else for(;--c>=0;)for(;e(h,1),!u(h););}),n&&(o.count=(u,h)=>(qy.setTime(+u),Hy.setTime(+h),t(qy),t(Hy),Math.floor(n(qy,Hy))),o.every=u=>(u=Math.floor(u),!isFinite(u)||!(u>0)?null:u>1?o.filter(i?h=>i(h)%u===0:h=>o.count(0,h)%u===0):o)),o}const Q_=Jr(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Q_.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Jr(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Q_);Q_.range;const xc=1e3,so=xc*60,wc=so*60,Ac=wc*24,a2=Ac*7,O3=Ac*30,Wy=Ac*365,No=Jr(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*xc)},(t,e)=>(e-t)/xc,t=>t.getUTCSeconds());No.range;const Am=Jr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*xc)},(t,e)=>{t.setTime(+t+e*so)},(t,e)=>(e-t)/so,t=>t.getMinutes());Am.range;const Cm=Jr(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*so)},(t,e)=>(e-t)/so,t=>t.getUTCMinutes());Cm.range;const km=Jr(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*xc-t.getMinutes()*so)},(t,e)=>{t.setTime(+t+e*wc)},(t,e)=>(e-t)/wc,t=>t.getHours());km.range;const Em=Jr(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*wc)},(t,e)=>(e-t)/wc,t=>t.getUTCHours());Em.range;const Lh=Jr(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*so)/Ac,t=>t.getDate()-1);Lh.range;const lg=Jr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ac,t=>t.getUTCDate()-1);lg.range;const cg=Jr(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ac,t=>Math.floor(t/Ac));cg.range;function zh(t){return Jr(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*so)/a2)}const rf=zh(0),tm=zh(1),q5=zh(2),H5=zh(3),Ch=zh(4),W5=zh(5),Z5=zh(6);rf.range;tm.range;q5.range;H5.range;Ch.range;W5.range;Z5.range;function Bh(t){return Jr(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/a2)}const af=Bh(0),nm=Bh(1),G5=Bh(2),Y5=Bh(3),kh=Bh(4),J5=Bh(5),K5=Bh(6);af.range;nm.range;G5.range;Y5.range;kh.range;J5.range;K5.range;const Dm=Jr(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Dm.range;const Pm=Jr(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());Pm.range;const Vo=Jr(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Vo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Jr(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Vo.range;const jo=Jr(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());jo.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Jr(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});jo.range;function X5(t,e,n,i,o,u){const h=[[No,1,xc],[No,5,5*xc],[No,15,15*xc],[No,30,30*xc],[u,1,so],[u,5,5*so],[u,15,15*so],[u,30,30*so],[o,1,wc],[o,3,3*wc],[o,6,6*wc],[o,12,12*wc],[i,1,Ac],[i,2,2*Ac],[n,1,a2],[e,1,O3],[e,3,3*O3],[t,1,Wy]];function c(w,S,M){const A=S<w;A&&([w,S]=[S,w]);const P=M&&typeof M.range=="function"?M:b(w,S,M),B=P?P.range(w,+S+1):[];return A?B.reverse():B}function b(w,S,M){const A=Math.abs(S-w)/M,P=G1(([,,J])=>J).right(h,A);if(P===h.length)return t.every(Tb(w/Wy,S/Wy,M));if(P===0)return Q_.every(Math.max(Tb(w,S,M),1));const[B,U]=h[A/h[P-1][2]<h[P][2]/A?P-1:P];return B.every(U)}return[c,b]}const[_N,gN]=X5(jo,Pm,af,cg,Em,Cm),[yN,bN]=X5(Vo,Dm,rf,Lh,km,Am);function Zy(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Gy(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function gp(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function vN(t){var e=t.dateTime,n=t.date,i=t.time,o=t.periods,u=t.days,h=t.shortDays,c=t.months,b=t.shortMonths,w=yp(o),S=bp(o),M=yp(u),A=bp(u),P=yp(h),B=bp(h),U=yp(c),J=bp(c),Q=yp(b),K=bp(b),le={a:Ge,A:ot,b:je,B:Ve,c:null,d:W3,e:W3,f:qN,g:$N,G:tR,H:UN,I:VN,j:jN,L:Q5,m:HN,M:WN,p:$e,q:st,Q:Y3,s:J3,S:ZN,u:GN,U:YN,V:JN,w:KN,W:XN,x:null,X:null,y:QN,Y:eR,Z:nR,"%":G3},ee={a:ct,A:Pt,b:Ut,B:Lt,c:null,d:Z3,e:Z3,f:sR,g:_R,G:yR,H:iR,I:rR,j:aR,L:eS,m:oR,M:lR,p:gt,q:Bt,Q:Y3,s:J3,S:cR,u:uR,U:hR,V:dR,w:fR,W:pR,x:null,X:null,y:mR,Y:gR,Z:bR,"%":G3},oe={a:Te,A:Y,b:ye,B:qe,c:He,d:q3,e:q3,f:FN,g:j3,G:V3,H:H3,I:H3,j:PN,L:BN,m:DN,M:LN,p:me,q:EN,Q:RN,s:ON,S:zN,u:TN,U:MN,V:AN,w:IN,W:CN,x:Be,X:lt,y:j3,Y:V3,Z:kN,"%":NN};le.x=Z(n,le),le.X=Z(i,le),le.c=Z(e,le),ee.x=Z(n,ee),ee.X=Z(i,ee),ee.c=Z(e,ee);function Z(tt,Le){return function(ut){var Re=[],Ke=-1,Ee=0,wt=tt.length,De,wn,Wn;for(ut instanceof Date||(ut=new Date(+ut));++Ke<wt;)tt.charCodeAt(Ke)===37&&(Re.push(tt.slice(Ee,Ke)),(wn=U3[De=tt.charAt(++Ke)])!=null?De=tt.charAt(++Ke):wn=De==="e"?" ":"0",(Wn=Le[De])&&(De=Wn(ut,wn)),Re.push(De),Ee=Ke+1);return Re.push(tt.slice(Ee,Ke)),Re.join("")}}function ne(tt,Le){return function(ut){var Re=gp(1900,void 0,1),Ke=be(Re,tt,ut+="",0),Ee,wt;if(Ke!=ut.length)return null;if("Q"in Re)return new Date(Re.Q);if("s"in Re)return new Date(Re.s*1e3+("L"in Re?Re.L:0));if(Le&&!("Z"in Re)&&(Re.Z=0),"p"in Re&&(Re.H=Re.H%12+Re.p*12),Re.m===void 0&&(Re.m="q"in Re?Re.q:0),"V"in Re){if(Re.V<1||Re.V>53)return null;"w"in Re||(Re.w=1),"Z"in Re?(Ee=Gy(gp(Re.y,0,1)),wt=Ee.getUTCDay(),Ee=wt>4||wt===0?nm.ceil(Ee):nm(Ee),Ee=lg.offset(Ee,(Re.V-1)*7),Re.y=Ee.getUTCFullYear(),Re.m=Ee.getUTCMonth(),Re.d=Ee.getUTCDate()+(Re.w+6)%7):(Ee=Zy(gp(Re.y,0,1)),wt=Ee.getDay(),Ee=wt>4||wt===0?tm.ceil(Ee):tm(Ee),Ee=Lh.offset(Ee,(Re.V-1)*7),Re.y=Ee.getFullYear(),Re.m=Ee.getMonth(),Re.d=Ee.getDate()+(Re.w+6)%7)}else("W"in Re||"U"in Re)&&("w"in Re||(Re.w="u"in Re?Re.u%7:"W"in Re?1:0),wt="Z"in Re?Gy(gp(Re.y,0,1)).getUTCDay():Zy(gp(Re.y,0,1)).getDay(),Re.m=0,Re.d="W"in Re?(Re.w+6)%7+Re.W*7-(wt+5)%7:Re.w+Re.U*7-(wt+6)%7);return"Z"in Re?(Re.H+=Re.Z/100|0,Re.M+=Re.Z%100,Gy(Re)):Zy(Re)}}function be(tt,Le,ut,Re){for(var Ke=0,Ee=Le.length,wt=ut.length,De,wn;Ke<Ee;){if(Re>=wt)return-1;if(De=Le.charCodeAt(Ke++),De===37){if(De=Le.charAt(Ke++),wn=oe[De in U3?Le.charAt(Ke++):De],!wn||(Re=wn(tt,ut,Re))<0)return-1}else if(De!=ut.charCodeAt(Re++))return-1}return Re}function me(tt,Le,ut){var Re=w.exec(Le.slice(ut));return Re?(tt.p=S.get(Re[0].toLowerCase()),ut+Re[0].length):-1}function Te(tt,Le,ut){var Re=P.exec(Le.slice(ut));return Re?(tt.w=B.get(Re[0].toLowerCase()),ut+Re[0].length):-1}function Y(tt,Le,ut){var Re=M.exec(Le.slice(ut));return Re?(tt.w=A.get(Re[0].toLowerCase()),ut+Re[0].length):-1}function ye(tt,Le,ut){var Re=Q.exec(Le.slice(ut));return Re?(tt.m=K.get(Re[0].toLowerCase()),ut+Re[0].length):-1}function qe(tt,Le,ut){var Re=U.exec(Le.slice(ut));return Re?(tt.m=J.get(Re[0].toLowerCase()),ut+Re[0].length):-1}function He(tt,Le,ut){return be(tt,e,Le,ut)}function Be(tt,Le,ut){return be(tt,n,Le,ut)}function lt(tt,Le,ut){return be(tt,i,Le,ut)}function Ge(tt){return h[tt.getDay()]}function ot(tt){return u[tt.getDay()]}function je(tt){return b[tt.getMonth()]}function Ve(tt){return c[tt.getMonth()]}function $e(tt){return o[+(tt.getHours()>=12)]}function st(tt){return 1+~~(tt.getMonth()/3)}function ct(tt){return h[tt.getUTCDay()]}function Pt(tt){return u[tt.getUTCDay()]}function Ut(tt){return b[tt.getUTCMonth()]}function Lt(tt){return c[tt.getUTCMonth()]}function gt(tt){return o[+(tt.getUTCHours()>=12)]}function Bt(tt){return 1+~~(tt.getUTCMonth()/3)}return{format:function(tt){var Le=Z(tt+="",le);return Le.toString=function(){return tt},Le},parse:function(tt){var Le=ne(tt+="",!1);return Le.toString=function(){return tt},Le},utcFormat:function(tt){var Le=Z(tt+="",ee);return Le.toString=function(){return tt},Le},utcParse:function(tt){var Le=ne(tt+="",!0);return Le.toString=function(){return tt},Le}}}var U3={"-":"",_:" ",0:"0"},da=/^\s*\d+/,xN=/^%/,wN=/[\\^$*+?|[\]().{}]/g;function li(t,e,n){var i=t<0?"-":"",o=(i?-t:t)+"",u=o.length;return i+(u<n?new Array(n-u+1).join(e)+o:o)}function SN(t){return t.replace(wN,"\\$&")}function yp(t){return new RegExp("^(?:"+t.map(SN).join("|")+")","i")}function bp(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function IN(t,e,n){var i=da.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function TN(t,e,n){var i=da.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function MN(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function AN(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function CN(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function V3(t,e,n){var i=da.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function j3(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function kN(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function EN(t,e,n){var i=da.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function DN(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function q3(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function PN(t,e,n){var i=da.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function H3(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function LN(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function zN(t,e,n){var i=da.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function BN(t,e,n){var i=da.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function FN(t,e,n){var i=da.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function NN(t,e,n){var i=xN.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function RN(t,e,n){var i=da.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function ON(t,e,n){var i=da.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function W3(t,e){return li(t.getDate(),e,2)}function UN(t,e){return li(t.getHours(),e,2)}function VN(t,e){return li(t.getHours()%12||12,e,2)}function jN(t,e){return li(1+Lh.count(Vo(t),t),e,3)}function Q5(t,e){return li(t.getMilliseconds(),e,3)}function qN(t,e){return Q5(t,e)+"000"}function HN(t,e){return li(t.getMonth()+1,e,2)}function WN(t,e){return li(t.getMinutes(),e,2)}function ZN(t,e){return li(t.getSeconds(),e,2)}function GN(t){var e=t.getDay();return e===0?7:e}function YN(t,e){return li(rf.count(Vo(t)-1,t),e,2)}function $5(t){var e=t.getDay();return e>=4||e===0?Ch(t):Ch.ceil(t)}function JN(t,e){return t=$5(t),li(Ch.count(Vo(t),t)+(Vo(t).getDay()===4),e,2)}function KN(t){return t.getDay()}function XN(t,e){return li(tm.count(Vo(t)-1,t),e,2)}function QN(t,e){return li(t.getFullYear()%100,e,2)}function $N(t,e){return t=$5(t),li(t.getFullYear()%100,e,2)}function eR(t,e){return li(t.getFullYear()%1e4,e,4)}function tR(t,e){var n=t.getDay();return t=n>=4||n===0?Ch(t):Ch.ceil(t),li(t.getFullYear()%1e4,e,4)}function nR(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+li(e/60|0,"0",2)+li(e%60,"0",2)}function Z3(t,e){return li(t.getUTCDate(),e,2)}function iR(t,e){return li(t.getUTCHours(),e,2)}function rR(t,e){return li(t.getUTCHours()%12||12,e,2)}function aR(t,e){return li(1+lg.count(jo(t),t),e,3)}function eS(t,e){return li(t.getUTCMilliseconds(),e,3)}function sR(t,e){return eS(t,e)+"000"}function oR(t,e){return li(t.getUTCMonth()+1,e,2)}function lR(t,e){return li(t.getUTCMinutes(),e,2)}function cR(t,e){return li(t.getUTCSeconds(),e,2)}function uR(t){var e=t.getUTCDay();return e===0?7:e}function hR(t,e){return li(af.count(jo(t)-1,t),e,2)}function tS(t){var e=t.getUTCDay();return e>=4||e===0?kh(t):kh.ceil(t)}function dR(t,e){return t=tS(t),li(kh.count(jo(t),t)+(jo(t).getUTCDay()===4),e,2)}function fR(t){return t.getUTCDay()}function pR(t,e){return li(nm.count(jo(t)-1,t),e,2)}function mR(t,e){return li(t.getUTCFullYear()%100,e,2)}function _R(t,e){return t=tS(t),li(t.getUTCFullYear()%100,e,2)}function gR(t,e){return li(t.getUTCFullYear()%1e4,e,4)}function yR(t,e){var n=t.getUTCDay();return t=n>=4||n===0?kh(t):kh.ceil(t),li(t.getUTCFullYear()%1e4,e,4)}function bR(){return"+0000"}function G3(){return"%"}function Y3(t){return+t}function J3(t){return Math.floor(+t/1e3)}var Sd,s2,Lm;vR({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function vR(t){return Sd=vN(t),s2=Sd.format,Sd.parse,Lm=Sd.utcFormat,Sd.utcParse,Sd}function xR(t){return new Date(t)}function wR(t){return t instanceof Date?+t:+new Date(+t)}function o2(t,e,n,i,o,u,h,c,b,w){var S=P5(),M=S.invert,A=S.domain,P=w(".%L"),B=w(":%S"),U=w("%I:%M"),J=w("%I %p"),Q=w("%a %d"),K=w("%b %d"),le=w("%B"),ee=w("%Y");function oe(Z){return(b(Z)<Z?P:c(Z)<Z?B:h(Z)<Z?U:u(Z)<Z?J:i(Z)<Z?o(Z)<Z?Q:K:n(Z)<Z?le:ee)(Z)}return S.invert=function(Z){return new Date(M(Z))},S.domain=function(Z){return arguments.length?A(Array.from(Z,wR)):A().map(xR)},S.ticks=function(Z){var ne=A();return t(ne[0],ne[ne.length-1],Z??10)},S.tickFormat=function(Z,ne){return ne==null?oe:w(ne)},S.nice=function(Z){var ne=A();return(!Z||typeof Z.range!="function")&&(Z=e(ne[0],ne[ne.length-1],Z??10)),Z?A(z5(ne,Z)):S},S.copy=function(){return Tm(S,o2(t,e,n,i,o,u,h,c,b,w))},S}function SR(){return Rl.apply(o2(yN,bN,Vo,Dm,rf,Lh,km,Am,No,s2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IR(){return Rl.apply(o2(_N,gN,jo,Pm,af,lg,Em,Cm,No,Lm).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ug(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function hg(){var t=0,e=.5,n=1,i=1,o,u,h,c,b,w=ao,S,M=!1,A;function P(U){return isNaN(U=+U)?A:(U=.5+((U=+S(U))-u)*(i*U<i*u?c:b),w(M?Math.max(0,Math.min(1,U)):U))}P.domain=function(U){return arguments.length?([t,e,n]=U,o=S(t=+t),u=S(e=+e),h=S(n=+n),c=o===u?0:.5/(u-o),b=u===h?0:.5/(h-u),i=u<o?-1:1,P):[t,e,n]},P.clamp=function(U){return arguments.length?(M=!!U,P):M},P.interpolator=function(U){return arguments.length?(w=U,P):w};function B(U){return function(J){var Q,K,le;return arguments.length?([Q,K,le]=J,w=ng(U,[Q,K,le]),P):[w(0),w(.5),w(1)]}}return P.range=B(Im),P.rangeRound=B(Xv),P.unknown=function(U){return arguments.length?(A=U,P):A},function(U){return S=U,o=U(t),u=U(e),h=U(n),c=o===u?0:.5/(u-o),b=u===h?0:.5/(h-u),i=u<o?-1:1,P}}function nS(){var t=Mm(hg()(ao));return t.copy=function(){return ug(t,nS())},ag.apply(t,arguments)}function iS(){var t=B5(hg()).domain([.1,1,10]);return t.copy=function(){return ug(t,iS()).base(t.base())},ag.apply(t,arguments)}function rS(){var t=N5(hg());return t.copy=function(){return ug(t,rS()).constant(t.constant())},ag.apply(t,arguments)}function aS(){var t=O5(hg());return t.copy=function(){return ug(t,aS()).exponent(t.exponent())},ag.apply(t,arguments)}function En(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}const TR=En("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),MR=En("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),AR=En("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),CR=En("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),kR=En("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),ER=En("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),DR=En("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),PR=En("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),LR=En("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),zR=En("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),BR=En("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Ri=t=>mB(t[t.length-1]);var sS=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(En);const oS=Ri(sS);var lS=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(En);const cS=Ri(lS);var uS=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(En);const hS=Ri(uS);var dS=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(En);const fS=Ri(dS);var rv=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(En);const $_=Ri(rv);var pS=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(En);const mS=Ri(pS);var av=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(En);const e1=Ri(av);var _S=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(En);const gS=Ri(_S);var yS=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(En);const bS=Ri(yS);var vS=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(En);const xS=Ri(vS);var wS=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(En);const SS=Ri(wS);var IS=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(En);const TS=Ri(IS);var MS=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(En);const AS=Ri(MS);var CS=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(En);const kS=Ri(CS);var ES=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(En);const DS=Ri(ES);var PS=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(En);const LS=Ri(PS);var zS=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(En);const BS=Ri(zS);var FS=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(En);const NS=Ri(FS);var RS=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(En);const OS=Ri(RS);var US=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(En);const VS=Ri(US);var jS=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(En);const qS=Ri(jS);var HS=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(En);const WS=Ri(HS);var ZS=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(En);const GS=Ri(ZS);var YS=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(En);const JS=Ri(YS);var KS=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(En);const XS=Ri(KS);var QS=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(En);const $S=Ri(QS);var eI=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(En);const tI=Ri(eI);function nI(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-t*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-t*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-t*2475.67)))))))+")"}const iI=Qv(Pl(300,.5,0),Pl(-240,.5,1));var rI=Qv(Pl(-100,.75,.35),Pl(80,1.5,.8)),aI=Qv(Pl(260,.75,.35),Pl(80,1.5,.8)),G0=Pl();function sI(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return G0.h=360*t-100,G0.s=1.5-1.5*e,G0.l=.8-.9*e,G0+""}var Y0=Iu(),FR=Math.PI/3,NR=Math.PI*2/3;function oI(t){var e;return t=(.5-t)*Math.PI,Y0.r=255*(e=Math.sin(t))*e,Y0.g=255*(e=Math.sin(t+FR))*e,Y0.b=255*(e=Math.sin(t+NR))*e,Y0+""}function lI(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-t*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+t*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-t*6838.66)))))))+")"}function dg(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const cI=dg(En("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var uI=dg(En("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),hI=dg(En("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),dI=dg(En("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Id(t){return function(){return t}}const fI=Math.cos,l2=Math.min,t1=Math.sin,Kr=Math.sqrt,K3=1e-12,n1=Math.PI,fg=2*n1;function RR(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return t},()=>new C5(e)}function OR(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function pI(t){this._context=t}pI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function pg(t){return new pI(t)}function UR(t){return t[0]}function VR(t){return t[1]}function jR(t,e){var n=Id(!0),i=null,o=pg,u=null,h=RR(c);t=typeof t=="function"?t:t===void 0?UR:Id(t),e=typeof e=="function"?e:e===void 0?VR:Id(e);function c(b){var w,S=(b=OR(b)).length,M,A=!1,P;for(i==null&&(u=o(P=h())),w=0;w<=S;++w)!(w<S&&n(M=b[w],w,b))===A&&((A=!A)?u.lineStart():u.lineEnd()),A&&u.point(+t(M,w,b),+e(M,w,b));if(P)return u=null,P+""||null}return c.x=function(b){return arguments.length?(t=typeof b=="function"?b:Id(+b),c):t},c.y=function(b){return arguments.length?(e=typeof b=="function"?b:Id(+b),c):e},c.defined=function(b){return arguments.length?(n=typeof b=="function"?b:Id(!!b),c):n},c.curve=function(b){return arguments.length?(o=b,i!=null&&(u=o(i)),c):o},c.context=function(b){return arguments.length?(b==null?i=u=null:u=o(i=b),c):i},c}class mI{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function qR(t){return new mI(t,!0)}function HR(t){return new mI(t,!1)}const WR=Kr(3),_I={draw(t,e){const n=Kr(e+l2(e/28,.75))*.59436,i=n/2,o=i*WR;t.moveTo(0,n),t.lineTo(0,-n),t.moveTo(-o,-i),t.lineTo(o,i),t.moveTo(-o,i),t.lineTo(o,-i)}},im={draw(t,e){const n=Kr(e/n1);t.moveTo(n,0),t.arc(0,0,n,0,fg)}},gI={draw(t,e){const n=Kr(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},yI=Kr(1/3),ZR=yI*2,bI={draw(t,e){const n=Kr(e/ZR),i=n*yI;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}},vI={draw(t,e){const n=Kr(e)*.62625;t.moveTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.lineTo(-n,0),t.closePath()}},xI={draw(t,e){const n=Kr(e-l2(e/7,2))*.87559;t.moveTo(-n,0),t.lineTo(n,0),t.moveTo(0,n),t.lineTo(0,-n)}},wI={draw(t,e){const n=Kr(e),i=-n/2;t.rect(i,i,n,n)}},SI={draw(t,e){const n=Kr(e)*.4431;t.moveTo(n,n),t.lineTo(n,-n),t.lineTo(-n,-n),t.lineTo(-n,n),t.closePath()}},GR=.8908130915292852,II=t1(n1/10)/t1(7*n1/10),YR=t1(fg/10)*II,JR=-fI(fg/10)*II,TI={draw(t,e){const n=Kr(e*GR),i=YR*n,o=JR*n;t.moveTo(0,-n),t.lineTo(i,o);for(let u=1;u<5;++u){const h=fg*u/5,c=fI(h),b=t1(h);t.lineTo(b*n,-c*n),t.lineTo(c*i-b*o,b*i+c*o)}t.closePath()}},Yy=Kr(3),MI={draw(t,e){const n=-Kr(e/(Yy*3));t.moveTo(0,n*2),t.lineTo(-Yy*n,-n),t.lineTo(Yy*n,-n),t.closePath()}},KR=Kr(3),AI={draw(t,e){const n=Kr(e)*.6824,i=n/2,o=n*KR/2;t.moveTo(0,-n),t.lineTo(o,i),t.lineTo(-o,i),t.closePath()}},Ys=-.5,Js=Kr(3)/2,sv=1/Kr(12),XR=(sv/2+1)*3,CI={draw(t,e){const n=Kr(e/XR),i=n/2,o=n*sv,u=i,h=n*sv+n,c=-u,b=h;t.moveTo(i,o),t.lineTo(u,h),t.lineTo(c,b),t.lineTo(Ys*i-Js*o,Js*i+Ys*o),t.lineTo(Ys*u-Js*h,Js*u+Ys*h),t.lineTo(Ys*c-Js*b,Js*c+Ys*b),t.lineTo(Ys*i+Js*o,Ys*o-Js*i),t.lineTo(Ys*u+Js*h,Ys*h-Js*u),t.lineTo(Ys*c+Js*b,Ys*b-Js*c),t.closePath()}},kI={draw(t,e){const n=Kr(e-l2(e/6,1.7))*.6189;t.moveTo(-n,-n),t.lineTo(n,n),t.moveTo(-n,n),t.lineTo(n,-n)}},QR=[im,gI,bI,wI,TI,MI,CI],$R=[im,xI,kI,AI,_I,SI,vI];function Tu(){}function i1(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function mg(t){this._context=t}mg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:i1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:i1(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function eO(t){return new mg(t)}function EI(t){this._context=t}EI.prototype={areaStart:Tu,areaEnd:Tu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:i1(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function tO(t){return new EI(t)}function DI(t){this._context=t}DI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:i1(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function nO(t){return new DI(t)}function PI(t,e){this._basis=new mg(t),this._beta=e}PI.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i=t[0],o=e[0],u=t[n]-i,h=e[n]-o,c=-1,b;++c<=n;)b=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+b*u),this._beta*e[c]+(1-this._beta)*(o+b*h));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const iO=function t(e){function n(i){return e===1?new mg(i):new PI(i,e)}return n.beta=function(i){return t(+i)},n}(.85);function r1(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function c2(t,e){this._context=t,this._k=(1-e)/6}c2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:r1(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:r1(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const rO=function t(e){function n(i){return new c2(i,e)}return n.tension=function(i){return t(+i)},n}(0);function u2(t,e){this._context=t,this._k=(1-e)/6}u2.prototype={areaStart:Tu,areaEnd:Tu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:r1(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const aO=function t(e){function n(i){return new u2(i,e)}return n.tension=function(i){return t(+i)},n}(0);function h2(t,e){this._context=t,this._k=(1-e)/6}h2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:r1(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const sO=function t(e){function n(i){return new h2(i,e)}return n.tension=function(i){return t(+i)},n}(0);function d2(t,e,n){var i=t._x1,o=t._y1,u=t._x2,h=t._y2;if(t._l01_a>K3){var c=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,b=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*c-t._x0*t._l12_2a+t._x2*t._l01_2a)/b,o=(o*c-t._y0*t._l12_2a+t._y2*t._l01_2a)/b}if(t._l23_a>K3){var w=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,S=3*t._l23_a*(t._l23_a+t._l12_a);u=(u*w+t._x1*t._l23_2a-e*t._l12_2a)/S,h=(h*w+t._y1*t._l23_2a-n*t._l12_2a)/S}t._context.bezierCurveTo(i,o,u,h,t._x2,t._y2)}function LI(t,e){this._context=t,this._alpha=e}LI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:d2(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oO=function t(e){function n(i){return e?new LI(i,e):new c2(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function zI(t,e){this._context=t,this._alpha=e}zI.prototype={areaStart:Tu,areaEnd:Tu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:d2(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const lO=function t(e){function n(i){return e?new zI(i,e):new u2(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function BI(t,e){this._context=t,this._alpha=e}BI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:d2(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cO=function t(e){function n(i){return e?new BI(i,e):new h2(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function FI(t){this._context=t}FI.prototype={areaStart:Tu,areaEnd:Tu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function uO(t){return new FI(t)}function X3(t){return t<0?-1:1}function Q3(t,e,n){var i=t._x1-t._x0,o=e-t._x1,u=(t._y1-t._y0)/(i||o<0&&-0),h=(n-t._y1)/(o||i<0&&-0),c=(u*o+h*i)/(i+o);return(X3(u)+X3(h))*Math.min(Math.abs(u),Math.abs(h),.5*Math.abs(c))||0}function $3(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Jy(t,e,n){var i=t._x0,o=t._y0,u=t._x1,h=t._y1,c=(u-i)/3;t._context.bezierCurveTo(i+c,o+c*e,u-c,h-c*n,u,h)}function a1(t){this._context=t}a1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Jy(this,this._t0,$3(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Jy(this,$3(this,n=Q3(this,t,e)),n);break;default:Jy(this,this._t0,n=Q3(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function NI(t){this._context=new RI(t)}(NI.prototype=Object.create(a1.prototype)).point=function(t,e){a1.prototype.point.call(this,e,t)};function RI(t){this._context=t}RI.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,o,u){this._context.bezierCurveTo(e,t,i,n,u,o)}};function hO(t){return new a1(t)}function dO(t){return new NI(t)}function OI(t){this._context=t}OI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var i=e6(t),o=e6(e),u=0,h=1;h<n;++u,++h)this._context.bezierCurveTo(i[0][u],o[0][u],i[1][u],o[1][u],t[h],e[h]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function e6(t){var e,n=t.length-1,i,o=new Array(n),u=new Array(n),h=new Array(n);for(o[0]=0,u[0]=2,h[0]=t[0]+2*t[1],e=1;e<n-1;++e)o[e]=1,u[e]=4,h[e]=4*t[e]+2*t[e+1];for(o[n-1]=2,u[n-1]=7,h[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)i=o[e]/u[e-1],u[e]-=i,h[e]-=i*h[e-1];for(o[n-1]=h[n-1]/u[n-1],e=n-2;e>=0;--e)o[e]=(h[e]-o[e+1])/u[e];for(u[n-1]=(t[n]+o[n-1])/2,e=0;e<n-1;++e)u[e]=2*t[e+1]-o[e+1];return[o,u]}function fO(t){return new OI(t)}function _g(t,e){this._context=t,this._t=e}_g.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function pO(t){return new _g(t,.5)}function mO(t){return new _g(t,0)}function _O(t){return new _g(t,1)}function Ep(t,e,n){this.k=t,this.x=e,this.y=n}Ep.prototype={constructor:Ep,scale:function(t){return t===1?this:new Ep(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Ep(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ep.prototype;function Mu(t){return t!=null&&!Number.isNaN(t)}function sf(t,e){return+Mu(e)-+Mu(t)||gu(t,e)}function ov(t,e){return+Mu(e)-+Mu(t)||bm(t,e)}function f2(t){return t!=null&&`${t}`!=""}function UI(t){return isFinite(t)?t:NaN}function gg(t){return t>0&&isFinite(t)?t:NaN}function p2(t){return t<0&&isFinite(t)?t:NaN}function lv(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return typeof e=="function"?e(t):e;const n=t.getUTCHours(),i=t.getUTCMinutes(),o=t.getUTCSeconds(),u=t.getUTCMilliseconds();return`${gO(t.getUTCFullYear())}-${_c(t.getUTCMonth()+1,2)}-${_c(t.getUTCDate(),2)}${n||i||o||u?`T${_c(n,2)}:${_c(i,2)}${o||u?`:${_c(o,2)}${u?`.${_c(u,3)}`:""}`:""}Z`:""}`}function gO(t){return t<0?`-${_c(-t,6)}`:t>9999?`+${_c(t,6)}`:_c(t,4)}function _c(t,e){return`${t}`.padStart(e,"0")}const yO=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function VI(t,e){return yO.test(t+="")?new Date(t):typeof e=="function"?e(t):e}function of(t){if(t==null)return;const e=t[0],n=t[t.length-1];return bm(e,n)}const Nd=1e3,fu=Nd*60,pu=fu*60,Ll=pu*24,fl=Ll*7,bh=Ll*30,cu=Ll*365,Ky=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",Nd],["5 seconds",5*Nd],["15 seconds",15*Nd],["30 seconds",30*Nd],["minute",fu],["5 minutes",5*fu],["15 minutes",15*fu],["30 minutes",30*fu],["hour",pu],["3 hours",3*pu],["6 hours",6*pu],["12 hours",12*pu],["day",Ll],["2 days",2*Ll],["week",fl],["2 weeks",2*fl],["month",bh],["3 months",3*bh],["6 months",6*bh],["year",cu],["2 years",2*cu],["5 years",5*cu],["10 years",10*cu],["20 years",20*cu],["50 years",50*cu],["100 years",100*cu]],m2=new Map([["second",Nd],["minute",fu],["hour",pu],["day",Ll],["monday",fl],["tuesday",fl],["wednesday",fl],["thursday",fl],["friday",fl],["saturday",fl],["sunday",fl],["week",fl],["month",bh],["year",cu]]),jI=new Map([["second",No],["minute",Am],["hour",km],["day",Lh],["monday",tm],["tuesday",q5],["wednesday",H5],["thursday",Ch],["friday",W5],["saturday",Z5],["sunday",rf],["week",rf],["month",Dm],["year",Vo]]),_2=new Map([["second",No],["minute",Cm],["hour",Em],["day",cg],["monday",nm],["tuesday",G5],["wednesday",Y5],["thursday",kh],["friday",J5],["saturday",K5],["sunday",af],["week",af],["month",Pm],["year",jo]]),zm=Symbol("intervalDuration"),yg=Symbol("intervalType");for(const[t,e]of jI)e[zm]=m2.get(t),e[yg]="time";for(const[t,e]of _2)e[zm]=m2.get(t),e[yg]="utc";const Dp=[["year",jo,"utc"],["month",Pm,"utc"],["day",cg,"utc",6*bh],["hour",Em,"utc",3*Ll],["minute",Cm,"utc",6*pu],["second",No,"utc",30*fu]],l_=[["year",Vo,"time"],["month",Dm,"time"],["day",Lh,"time",6*bh],["hour",km,"time",3*Ll],["minute",Am,"time",6*pu],["second",No,"time",30*fu]],bO=[Dp[0],l_[0],Dp[1],l_[1],Dp[2],l_[2],...Dp.slice(3)];function qI(t){let e=`${t}`.toLowerCase();e.endsWith("s")&&(e=e.slice(0,-1));let n=1;const i=/^(?:(\d+)\s+)/.exec(e);switch(i&&(e=e.slice(i[0].length),n=+i[1]),e){case"quarter":e="month",n*=3;break;case"half":e="month",n*=6;break}let o=_2.get(e);if(!o)throw new Error(`unknown interval: ${t}`);if(n>1&&!o.every)throw new Error(`non-periodic interval: ${e}`);return[e,n]}function HI(t){return ZI(qI(t),"time")}function WI(t){return ZI(qI(t),"utc")}function ZI([t,e],n){let i=(n==="time"?jI:_2).get(t);return e>1&&(i=i.every(e),i[zm]=m2.get(t)*e,i[yg]=n),i}function t6(t,e){if(!(e>1))return;const n=t[zm];if(!Ky.some(([,o])=>o===n)||n%Ll===0&&Ll<n&&n<bh)return;const[i]=Ky[G1(([,o])=>Math.log(o)).center(Ky,Math.log(n*e))];return(t[yg]==="time"?HI:WI)(i)}function n6(t,e,n){const i=e==="time"?s2:Lm;if(n==null)return i(t==="year"?"%Y":t==="month"?"%Y-%m":t==="day"?"%Y-%m-%d":t==="hour"||t==="minute"?"%Y-%m-%dT%H:%M":t==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const o=vO(n);switch(t){case"millisecond":return Td(i(".%L"),i(":%M:%S"),o);case"second":return Td(i(":%S"),i("%-I:%M"),o);case"minute":return Td(i("%-I:%M"),i("%p"),o);case"hour":return Td(i("%-I %p"),i("%b %-d"),o);case"day":return Td(i("%-d"),i("%b"),o);case"month":return Td(i("%b"),i("%Y"),o);case"year":return i("%Y")}throw new Error("unable to format time ticks")}function vO(t){return t==="left"||t==="right"?(e,n)=>`
${e}
${n}`:t==="top"?(e,n)=>`${n}
${e}`:(e,n)=>`${e}
${n}`}function xO(t){return t==="time"?l_:t==="utc"?Dp:bO}function wO(t,e,n){const i=Dl($D(e,(o,u)=>Math.abs(u-o)));if(i<1e3)return n6("millisecond","utc",n);for(const[o,u,h,c]of xO(t)){if(i>c||o==="hour"&&!i)break;if(e.every(b=>u.floor(b)>=b))return n6(o,h,n)}}function Td(t,e,n){return(i,o,u)=>{const h=t(i,o),c=e(i,o),b=o-of(u);return o!==b&&u[b]!==void 0&&c===e(u[b],b)?h:n(h,c)}}const rm=Object.getPrototypeOf(Uint8Array),SO=Object.prototype.toString,IO=Symbol("reindex");function Au(t,e,n){const i=typeof e;return i==="string"?i6(t,AO(e),n):i==="function"?i6(t,e,n):i==="number"||e instanceof Date||i==="boolean"?ts(t,Bm(e),n):typeof(e==null?void 0:e.transform)=="function"?r6(e.transform(t),n):TO(r6(e,n),t==null?void 0:t[IO])}function TO(t,e){return e?y2(t,e):t}function i6(t,e,n){return ts(t,(n==null?void 0:n.prototype)instanceof rm?MO(e):e,n)}function r6(t,e){return e===void 0?Ns(t):t instanceof e?t:e.prototype instanceof rm&&!(t instanceof rm)?e.from(t,g2):e.from(t)}function MO(t){return(e,n)=>g2(t(e,n))}const c_=[null],AO=t=>e=>e[t],CO={transform:Fm},Ec={transform:t=>t},kO=()=>!0,Xa=t=>t==null?t:`${t}`,pr=t=>t==null?t:+t,GI=t=>t?t[0]:void 0,EO=t=>t?t[1]:void 0,Bm=t=>()=>t;function DO(t){const e=+`${t}`.slice(1)/100;return(n,i)=>D_(n,e,i)}function s1(t){return t instanceof rm?t:ts(t,g2,Float64Array)}function g2(t){return t==null?NaN:Number(t)}function PO(t){return ts(t,LO)}function LO(t){return t instanceof Date&&!isNaN(t)?t:typeof t=="string"?VI(t):t==null||isNaN(t=+t)?void 0:new Date(t)}function Eh(t,e){return t===void 0&&(t=e),t===null?[void 0,"none"]:Sg(t)?[void 0,t]:[t,void 0]}function $a(t,e){return t===void 0&&(t=e),t===null||typeof t=="number"?[void 0,t]:[t,void 0]}function YI(t,e,n){if(t!=null)return Go(t,e,n)}function Go(t,e,n){const i=`${t}`.toLowerCase();if(!n.includes(i))throw new Error(`invalid ${e}: ${t}`);return i}function Ns(t){return t==null||t instanceof Array||t instanceof rm?t:Array.from(t)}function ts(t,e,n=Array){return t==null?t:t instanceof n?t.map(e):n.from(t,e)}function cv(t,e=Array){return t instanceof e?t.slice():e.from(t)}function Fh(t){return(t==null?void 0:t.toString)===SO}function uv(t){return Fh(t)&&(t.type!==void 0||t.domain!==void 0)}function bg(t){return Fh(t)&&typeof t.transform!="function"}function lf(t){return bg(t)&&t.value===void 0&&t.channel===void 0}function vg(t,e){return t===void 0&&e===void 0?[GI,EO]:[t,e]}function zO({z:t,fill:e,stroke:n}={}){return t===void 0&&([t]=Eh(e)),t===void 0&&([t]=Eh(n)),t}function Fm(t){const e=t.length,n=new Uint32Array(e);for(let i=0;i<e;++i)n[i]=i;return n}function y2(t,e){return ts(e,n=>t[n],t.constructor)}function BO(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function ph(t){return t!==null&&typeof t=="object"?t.valueOf():t}function xg(t,e){return typeof t=="string"?t:t&&t.label!==void 0?t.label:e}function FO(t,e){const n=b2(t,e);return n&&(i=>Mu(i)?n.floor(i):i)}function b2(t,e){if(t!=null){if(typeof t=="number"){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:i=>Math.floor(i*n)/n,offset:i=>(i*n+1)/n,range:(i,o)=>Ab(Math.ceil(i*n),o*n).map(u=>u/n)}:{floor:i=>Math.floor(i/n)*n,offset:i=>i+n,range:(i,o)=>Ab(Math.ceil(i/n),o/n).map(u=>u*n)}}if(typeof t=="string")return(e==="time"?HI:WI)(t);if(typeof t.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof t.offset!="function")throw new Error("invalid interval; missing offset method");return t}}function Nm(t,e){if(t=b2(t,e),t&&typeof t.range!="function")throw new Error("invalid interval: missing range method");return t}function NO(t,e){if(t=Nm(t,e),t&&typeof t.ceil!="function")throw new Error("invalid interval: missing ceil method");return t}function RO(t){return typeof(t==null?void 0:t.range)=="function"}function wg(t){return t===void 0||bg(t)?t:{value:t}}function OO(t){return t==null?null:{transform:e=>Au(e,t,Float64Array),label:xg(t)}}function Nh(t){return t&&typeof t[Symbol.iterator]=="function"}function JI(t){for(const e of t)if(e!=null)return typeof e!="object"||e instanceof Date}function a6(t){for(const e of t){if(e==null)continue;const n=typeof e;return n==="string"||n==="boolean"}}function zl(t){for(const e of t)if(e!=null)return e instanceof Date}function UO(t){for(const e of t)if(e!=null)return typeof e=="string"&&isNaN(e)&&VI(e)}function VO(t){for(const e of t)if(e!=null){if(typeof e!="string")return!1;if(e.trim())return!isNaN(e)}}function jO(t){for(const e of t)if(e!=null)return typeof e=="number"}function Xy(t,e){let n;for(const i of t)if(i!=null){if(!e(i))return!1;n=!0}return n}const qO=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function Sg(t){return typeof t!="string"?!1:(t=t.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(t)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(t)||qO.has(t))}function HO(t){return typeof t=="number"&&(0<=t&&t<=1||isNaN(t))}function us(t){return t==null||am(t)}function am(t){return/^\s*none\s*$/i.test(t)}function WO(t){return/^\s*round\s*$/i.test(t)}function hv(t,e){return YI(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Ig(t="middle"){return hv(t,"frameAnchor")}function ZO(t={},...e){let n=t;for(const i of e)for(const o in i)if(n[o]===void 0){const u=i[o];n===t?n={...n,[o]:u}:n[o]=u}return n}function GO(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,n=>{const{name:i}=n;if(i==null)throw new Error("missing name");const o=`${i}`;if(o==="__proto__")throw new Error(`illegal name: ${o}`);if(e.has(o))throw new Error(`duplicate name: ${o}`);return e.add(o),[i,n]}))}function KI(t){return Nh(t)?GO(t):t}function XI(t){return t===!0?t="frame":t===!1?t=null:t!=null&&(t=Go(t,"clip",["frame","sphere"])),t}const wl=Symbol("position"),Dc=Symbol("color"),Rm=Symbol("radius"),Om=Symbol("length"),Um=Symbol("opacity"),Tg=Symbol("symbol"),QI=Symbol("projection"),_r=new Map([["x",wl],["y",wl],["fx",wl],["fy",wl],["r",Rm],["color",Dc],["opacity",Um],["symbol",Tg],["length",Om],["projection",QI]]);function YO(t){return t===wl||t===QI}function JO(t){return t===wl||t===Rm||t===Om||t===Um}const KO=Math.sqrt(3),XO=2/KO,QO={draw(t,e){const n=Math.sqrt(e/Math.PI),i=n*XO,o=i/2;t.moveTo(0,i),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-i),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},v2=new Map([["asterisk",_I],["circle",im],["cross",gI],["diamond",bI],["diamond2",vI],["hexagon",QO],["plus",xI],["square",wI],["square2",SI],["star",TI],["times",kI],["triangle",MI],["triangle2",AI],["wye",CI]]);function x2(t){return t&&typeof t.draw=="function"}function $O(t){return x2(t)?!0:typeof t!="string"?!1:v2.has(t.toLowerCase())}function w2(t){if(t==null||x2(t))return t;const e=v2.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function eU(t){if(t==null||x2(t))return[void 0,t];if(typeof t=="string"){const e=v2.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}function $I({filter:t,sort:e,reverse:n,transform:i,initializer:o,...u}={},h){if(i===void 0&&(t!=null&&(i=eT(t)),e!=null&&!lf(e)&&(i=Qy(i,S2(e))),n&&(i=Qy(i,tT))),h!=null&&o!=null)throw new Error("transforms cannot be applied after initializers");return{...u,...(e===null||lf(e))&&{sort:e},transform:Qy(i,h)}}function cf({filter:t,sort:e,reverse:n,initializer:i,...o}={},u){return i===void 0&&(t!=null&&(i=eT(t)),e!=null&&!lf(e)&&(i=$y(i,S2(e))),n&&(i=$y(i,tT))),{...o,...(e===null||lf(e))&&{sort:e},initializer:$y(i,u)}}function Qy(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,i,o){return{data:n,facets:i}=t.call(this,n,i,o),e.call(this,Ns(n),i,o)}}function $y(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,i,o,...u){let h,c,b,w,S,M;return{data:c=n,facets:b=i,channels:h}=t.call(this,n,i,o,...u),{data:S=c,facets:M=b,channels:w}=e.call(this,c,b,{...o,...h},...u),{data:S,facets:M,channels:{...h,...w}}}}function tU(t,e){return(t.initializer!=null?cf:$I)(t,e)}function eT(t){return(e,n)=>{const i=Au(e,t);return{data:e,facets:n.map(o=>o.filter(u=>i[u]))}}}function tT(t,e){return{data:t,facets:e.map(n=>n.slice().reverse())}}function nU(t,{sort:e,...n}={}){return{...(bg(t)&&t.channel!==void 0?cf:tU)(n,S2(t)),sort:lf(e)?e:null}}function S2(t){return(typeof t=="function"&&t.length!==1?iU:rU)(t)}function iU(t){return(e,n)=>{const i=(o,u)=>t(e[o],e[u]);return{data:e,facets:n.map(o=>o.slice().sort(i))}}}function rU(t){let e,n;({channel:e,value:t,order:n}={...wg(t)});const i=e==null?void 0:e.startsWith("-");if(i&&(e=e.slice(1)),n===void 0&&(n=i?ov:sf),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=sf;break;case"descending":n=ov;break;default:throw new Error(`invalid order: ${n}`)}return(o,u,h)=>{let c;if(e===void 0)c=Au(o,t);else{if(h===void 0)throw new Error("channel sort requires an initializer");if(c=h[e],!c)return{};c=c.value}const b=(w,S)=>n(c[w],c[S]);return{data:o,facets:u.map(w=>w.slice().sort(b))}}}function aU(t,e,n=sU){if(t==null)return n(t);if(typeof t.reduceIndex=="function")return t;if(typeof t.reduce=="function"&&Fh(t))return oU(t);if(typeof t=="function")return lU(t);if(/^p\d{2}$/i.test(t))return uc(DO(t));switch(`${t}`.toLowerCase()){case"first":return uU;case"last":return hU;case"identity":return cU;case"count":return o6;case"distinct":return dU;case"sum":return e==null?o6:fU;case"proportion":return l6(e,"data");case"proportion-facet":return l6(e,"facet");case"deviation":return uc(OD);case"min":return uc(Yp);case"min-index":return uc(YD);case"max":return uc(Dl);case"max-index":return uc(GD);case"mean":return s6(KD);case"median":return s6(Mb);case"variance":return uc(i4);case"mode":return uc(QD)}return n(t)}function sU(t){throw new Error(`invalid reduce: ${t}`)}function oU(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}function lU(t){return{reduceIndex(e,n,i){return t(y2(n,e),i)}}}function uc(t){return{reduceIndex(e,n){return t(e,i=>n[i])}}}function s6(t){return{reduceIndex(e,n){const i=t(e,o=>n[o]);return zl(n)?new Date(i):i}}}const cU={reduceIndex(t,e){return y2(e,t)}},uU={reduceIndex(t,e){return e[t[0]]}},hU={reduceIndex(t,e){return e[t[t.length-1]]}},o6={label:"Frequency",reduceIndex(t){return t.length}},dU={label:"Distinct",reduceIndex(t,e){const n=new Y1;for(const i of t)n.add(e[i]);return n.size}},fU=uc(Ov);function l6(t,e){return t==null?{scope:e,label:"Frequency",reduceIndex:(n,i,o=1)=>n.length/o}:{scope:e,reduceIndex:(n,i,o=1)=>Ov(n,u=>i[u])/o}}function sm(t,{scale:e,type:n,value:i,filter:o,hint:u,label:h=xg(i)},c){return u===void 0&&typeof(i==null?void 0:i.transform)=="function"&&(u=i.hint),nT(c,{scale:e,type:n,value:Au(t,i),label:h,filter:o,hint:u})}function pU(t,e){return Object.fromEntries(Object.entries(t).map(([n,i])=>[n,sm(e,i,n)]))}function mU(t,e){const n=Object.fromEntries(Object.entries(t).map(([i,{scale:o,value:u}])=>{const h=o==null?null:e[o];return[i,h==null?u:ts(u,h)]}));return n.channels=t,n}function nT(t,e){const{scale:n,value:i}=e;if(n===!0||n==="auto")switch(t){case"fill":case"stroke":case"color":e.scale=n!==!0&&Xy(i,Sg)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=n!==!0&&Xy(i,HO)?null:"opacity";break;case"symbol":n!==!0&&Xy(i,$O)?(e.scale=null,e.value=ts(i,w2)):e.scale="symbol";break;default:e.scale=_r.has(t)?t:null;break}else if(n===!1)e.scale=null;else if(n!=null&&!_r.has(n))throw new Error(`unknown scale: ${n}`);return e}function _U(t,e,n,i,o){const{order:u,reverse:h,reduce:c=!0,limit:b}=o;for(const w in o){if(!_r.has(w))continue;let{value:S,order:M=u,reverse:A=h,reduce:P=c,limit:B=b}=wg(o[w]);const U=S==null?void 0:S.startsWith("-");if(U&&(S=S.slice(1)),M=M===void 0?U!==(S==="width"||S==="height")?rT:iT:bU(M),P==null||P===!1)continue;const J=w==="fx"||w==="fy"?yU(e,i[w]):gU(n,w);if(!J)throw new Error(`missing channel for scale: ${w}`);const Q=J.value,[K=0,le=1/0]=Nh(B)?B:B<0?[B]:[0,B];if(S==null)J.domain=()=>{let ee=Array.from(new Y1(Q));return A&&(ee=ee.reverse()),(K!==0||le!==1/0)&&(ee=ee.slice(K,le)),ee};else{const ee=S==="data"?t:S==="height"?c6(n,"y1","y2"):S==="width"?c6(n,"x1","x2"):dv(n,S,S==="y"?"y2":S==="x"?"x2":void 0),oe=aU(P===!0?"max":P,ee);J.domain=()=>{let Z=VD(Fm(Q),ne=>oe.reduceIndex(ne,ee),ne=>Q[ne]);return M&&Z.sort(M),A&&Z.reverse(),(K!==0||le!==1/0)&&(Z=Z.slice(K,le)),Z.map(GI)}}}}function gU(t,e){for(const n in t){const i=t[n];if(i.scale===e)return i}}function yU(t,e){const n=t.original;if(n===t)return e;const i=e.value,o=e.value=[];for(let u=0;u<n.length;++u){const h=i[n[u][0]];for(const c of t[u])o[c]=h}return e}function c6(t,e,n){const i=dv(t,e),o=dv(t,n);return ts(o,(u,h)=>Math.abs(u-i[h]),Float64Array)}function dv(t,e,n){let i=t[e];if(!i&&n!==void 0&&(i=t[n]),i)return i.value;throw new Error(`missing channel: ${e}`)}function bU(t){if(t==null||typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"ascending":return iT;case"descending":return rT}throw new Error(`invalid order: ${t}`)}function iT([t,e],[n,i]){return sf(e,i)||sf(t,n)}function rT([t,e],[n,i]){return ov(e,i)||sf(t,n)}function u6(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}function I2(t={}){const{document:e=typeof window<"u"?window.document:void 0,clip:n}=t;return{document:e,clip:XI(n)}}function Ia(t,{document:e}){return Hp($1(t).call(e.documentElement))}let fv=0,pv;function vU(){const t=fv;return fv=0,pv=void 0,t}function bu(t){t!==pv&&(pv=t,console.warn(t),++fv)}const aT=Math.PI,oc=2*aT,h6=.618;function xU({projection:t,inset:e=0,insetTop:n=e,insetRight:i=e,insetBottom:o=e,insetLeft:u=e}={},h){if(t==null)return;if(typeof t.stream=="function")return t;let c,b,w="frame";if(Fh(t)){let oe;if({type:t,domain:b,inset:oe,insetTop:n=oe!==void 0?oe:n,insetRight:i=oe!==void 0?oe:i,insetBottom:o=oe!==void 0?oe:o,insetLeft:u=oe!==void 0?oe:u,clip:w=w,...c}=t,t==null)return}typeof t!="function"&&({type:t}=sT(t));const{width:S,height:M,marginLeft:A,marginRight:P,marginTop:B,marginBottom:U}=h,J=S-A-P-u-i,Q=M-B-U-n-o;if(t=t==null?void 0:t({width:J,height:Q,clip:w,...c}),t==null)return;w=wU(w,A,B,S-P,M-U);let K=A+u,le=B+n,ee;if(b!=null){const[[oe,Z],[ne,be]]=Vv(t).bounds(b),me=Math.min(J/(ne-oe),Q/(be-Z));me>0?(K-=(me*(oe+ne)-J)/2,le-=(me*(Z+be)-Q)/2,ee=jb({point(Te,Y){this.stream.point(Te*me+K,Y*me+le)}})):bu("Warning: the projection could not be fit to the specified domain; using the default scale.")}return ee??(ee=K===0&&le===0?oT():jb({point(oe,Z){this.stream.point(oe+K,Z+le)}})),{stream:oe=>t.stream(ee.stream(w(oe)))}}function sT(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Do(DP,.7463,.4673);case"albers":return J0(L4,.7463,.4673);case"azimuthal-equal-area":return Do(PP,4,4);case"azimuthal-equidistant":return Do(LP,oc,oc);case"conic-conformal":return J0(FP,oc,oc);case"conic-equal-area":return J0(j_,6.1702,2.9781);case"conic-equidistant":return J0(OP,7.312,3.6282);case"equal-earth":return Do(VP,5.4133,2.6347);case"equirectangular":return Do(NP,oc,aT);case"gnomonic":return Do(jP,3.4641,3.4641);case"identity":return{type:oT};case"reflect-y":return{type:SU};case"mercator":return Do(zP,oc,oc);case"orthographic":return Do(qP,2,2);case"stereographic":return Do(HP,2,2);case"transverse-mercator":return Do(WP,oc,oc);default:throw new Error(`unknown projection type: ${t}`)}}function wU(t,e,n,i,o){if(t===!1||t==null||typeof t=="number")return u=>u;switch(t===!0&&(t="frame"),`${t}`.toLowerCase()){case"frame":return g4(e,n,i,o);default:throw new Error(`unknown projection clip type: ${t}`)}}function Do(t,e,n){return{type:({width:i,height:o,rotate:u,precision:h=.15,clip:c})=>{var w,S,M;const b=t();return h!=null&&((w=b.precision)==null||w.call(b,h)),u!=null&&((S=b.rotate)==null||S.call(b,u)),typeof c=="number"&&((M=b.clipAngle)==null||M.call(b,c)),b.scale(Math.min(i/e,o/n)),b.translate([i/2,o/2]),b},aspectRatio:n/e}}function J0(t,e,n){const{type:i,aspectRatio:o}=Do(t,e,n);return{type:u=>{const{parallels:h,domain:c,width:b,height:w}=u,S=i(u);return h!=null&&(S.parallels(h),c===void 0&&S.fitSize([b,w],{type:"Sphere"})),S},aspectRatio:o}}const oT=Bm({stream:t=>t}),SU=Bm(jb({point(t,e){this.stream.point(t,-e)}}));function IU(t,e,n,i){const o=n[t],u=n[e],h=o.length,c=n[t]=new Float64Array(h).fill(NaN),b=n[e]=new Float64Array(h).fill(NaN);let w;const S=i.stream({point(M,A){c[w]=M,b[w]=A}});for(w=0;w<h;++w)S.point(o[w],u[w])}function TU({projection:t}={}){return t==null?!1:typeof t.stream=="function"?!0:(Fh(t)&&(t=t.type),t!=null)}function MU(t){if(typeof(t==null?void 0:t.stream)=="function")return h6;if(Fh(t)&&(t=t.type),t!=null){if(typeof t!="function"){const{aspectRatio:e}=sT(t);if(e)return e}return h6}}function AU(t){const e=[],n=[],i={scale:"x",value:e},o={scale:"y",value:n},u={point(h,c){e.push(h),n.push(c)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const h of t.value)hh(h,u);return[i,o]}const lT=new Map([["accent",MR],["category10",TR],["dark2",AR],["observable10",CR],["paired",kR],["pastel1",ER],["pastel2",DR],["set1",PR],["set2",LR],["set3",zR],["tableau10",BR]]);function CU(t){return t!=null&&lT.has(`${t}`.toLowerCase())}const d6=new Map([...lT,["brbg",lc(sS,oS)],["prgn",lc(lS,cS)],["piyg",lc(uS,hS)],["puor",lc(dS,fS)],["rdbu",lc(rv,$_)],["rdgy",lc(pS,mS)],["rdylbu",lc(av,e1)],["rdylgn",lc(_S,gS)],["spectral",lc(yS,bS)],["burd",f6(rv,$_)],["buylrd",f6(av,e1)],["blues",ca(HS,WS)],["greens",ca(ZS,GS)],["greys",ca(YS,JS)],["oranges",ca(eI,tI)],["purples",ca(KS,XS)],["reds",ca(QS,$S)],["turbo",cc(lI)],["viridis",cc(cI)],["magma",cc(uI)],["inferno",cc(hI)],["plasma",cc(dI)],["cividis",cc(nI)],["cubehelix",cc(iI)],["warm",cc(rI)],["cool",cc(aI)],["bugn",ca(vS,xS)],["bupu",ca(wS,SS)],["gnbu",ca(IS,TS)],["orrd",ca(MS,AS)],["pubu",ca(ES,DS)],["pubugn",ca(CS,kS)],["purd",ca(PS,LS)],["rdpu",ca(zS,BS)],["ylgn",ca(RS,OS)],["ylgnbu",ca(FS,NS)],["ylorbr",ca(US,VS)],["ylorrd",ca(jS,qS)],["rainbow",p6(sI)],["sinebow",p6(oI)]]);function ca(t,e){return({length:n})=>n===1?[t[3][1]]:n===2?[t[3][1],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?Uo(e,n):t[n])}function lc(t,e){return({length:n})=>n===2?[t[3][0],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?Uo(e,n):t[n])}function f6(t,e){return({length:n})=>n===2?[t[3][2],t[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?Uo(i=>e(1-i),n):t[n].slice().reverse())}function cc(t){return({length:e})=>Uo(t,Math.max(2,Math.floor(e)))}function p6(t){return({length:e})=>Uo(t,Math.floor(e)+1).slice(0,-1)}function cT(t){const e=`${t}`.toLowerCase();if(!d6.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return d6.get(e)}function Mg(t,e){const n=cT(t),i=typeof n=="function"?n({length:e}):n;return i.length!==e?i.slice(0,e):i}function kU(t,e="greys"){const n=new Set,[i,o]=Mg(e,2);for(const u of t)if(u!=null)if(u===!0)n.add(o);else if(u===!1)n.add(i);else return;return[...n]}const m6=new Map([["brbg",oS],["prgn",cS],["piyg",hS],["puor",fS],["rdbu",$_],["rdgy",mS],["rdylbu",e1],["rdylgn",gS],["spectral",bS],["burd",t=>$_(1-t)],["buylrd",t=>e1(1-t)],["blues",WS],["greens",GS],["greys",JS],["purples",XS],["reds",$S],["oranges",tI],["turbo",lI],["viridis",cI],["magma",uI],["inferno",hI],["plasma",dI],["cividis",nI],["cubehelix",iI],["warm",rI],["cool",aI],["bugn",xS],["bupu",SS],["gnbu",TS],["orrd",AS],["pubugn",kS],["pubu",DS],["purd",LS],["rdpu",BS],["ylgnbu",NS],["ylgn",OS],["ylorbr",VS],["ylorrd",qS],["rainbow",sI],["sinebow",oI]]);function T2(t){const e=`${t}`.toLowerCase();if(!m6.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return m6.get(e)}const EU=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function DU(t){return t!=null&&EU.has(`${t}`.toLowerCase())}const uT=t=>e=>t(1-e),eb=[0,1],_6=new Map([["number",za],["rgb",Mh],["hsl",CB],["hcl",DB],["lab",kB]]);function hT(t){const e=`${t}`.toLowerCase();if(!_6.has(e))throw new Error(`unknown interpolator: ${e}`);return _6.get(e)}function Vm(t,e,n,{type:i,nice:o,clamp:u,zero:h,domain:c=fT(t,n),unknown:b,round:w,scheme:S,interval:M,range:A=_r.get(t)===Rm?jU(n,c):_r.get(t)===Om?qU(n,c):_r.get(t)===Um?eb:void 0,interpolate:P=_r.get(t)===Dc?S==null&&A!==void 0?Mh:T2(S!==void 0?S:i==="cyclical"?"rainbow":"turbo"):w?Xv:za,reverse:B}){if(M=Nm(M,i),(i==="cyclical"||i==="sequential")&&(i="linear"),typeof P!="function"&&(P=hT(P)),B=!!B,A!==void 0){const U=(c=Ns(c)).length,J=(A=Ns(A)).length;if(U!==J){if(P.length===1)throw new Error("invalid piecewise interpolator");P=ng(P,A),A=void 0}}if(P.length===1?(B&&(P=uT(P),B=!1),A===void 0&&(A=Float64Array.from(c,(U,J)=>J/(c.length-1)),A.length===2&&(A=eb)),e.interpolate((A===eb?Bm:A2)(P))):e.interpolate(P),h){const[U,J]=yu(c);(U>0||J<0)&&(c=cv(c),of(c)!==Math.sign(U)?c[c.length-1]=0:c[0]=0)}return B&&(c=P_(c)),e.domain(c).unknown(b),o&&(e.nice(PU(o,i)),c=e.domain()),A!==void 0&&e.range(A),u&&e.clamp(u),{type:i,domain:c,range:A,scale:e,interpolate:P,interval:M}}function PU(t,e){return t===!0?void 0:typeof t=="number"?t:NO(t,e)}function LU(t,e,n){return Vm(t,r2(),e,n)}function zU(t,e,n){return dT(t,e,{...n,exponent:.5})}function dT(t,e,{exponent:n=1,...i}){return Vm(t,U5().exponent(n),e,{...i,type:"pow"})}function BU(t,e,{base:n=10,domain:i=HU(e),...o}){return Vm(t,F5().base(n),e,{...o,domain:i})}function FU(t,e,{constant:n=1,...i}){return Vm(t,R5().constant(n),e,i)}function NU(t,e,{range:n,quantiles:i=n===void 0?5:(n=[...n]).length,n:o=i,scheme:u="rdylbu",domain:h=WU(e),unknown:c,interpolate:b,reverse:w}){return n===void 0&&(n=b!==void 0?Uo(b,o):_r.get(t)===Dc?Mg(u,o):void 0),h.length>0&&(h=V5(h,n===void 0?{length:o}:n).quantiles()),M2(t,e,{domain:h,range:n,reverse:w,unknown:c})}function RU(t,e,{range:n,n:i=n===void 0?5:(n=[...n]).length,scheme:o="rdylbu",domain:u=fT(t,e),unknown:h,interpolate:c,reverse:b}){const[w,S]=yu(u);let M;return n===void 0?(M=E_(w,S,i),M[0]<=w&&M.splice(0,1),M[M.length-1]>=S&&M.pop(),i=M.length+1,n=c!==void 0?Uo(c,i):_r.get(t)===Dc?Mg(o,i):void 0):(M=Uo(za(w,S),i+1).slice(1,-1),w instanceof Date&&(M=M.map(A=>new Date(A)))),of(Ns(u))<0&&M.reverse(),M2(t,e,{domain:M,range:n,reverse:b,unknown:h})}function M2(t,e,{domain:n=[0],unknown:i,scheme:o="rdylbu",interpolate:u,range:h=u!==void 0?Uo(u,n.length+1):_r.get(t)===Dc?Mg(o,n.length+1):void 0,reverse:c}){n=Ns(n);const b=of(n);if(!isNaN(b)&&!OU(n,b))throw new Error(`the ${t} scale has a non-monotonic domain`);return c&&(h=P_(h)),{type:"threshold",scale:j5(b<0?P_(n):n,h===void 0?[]:h).unknown(i),domain:n,range:h}}function OU(t,e){for(let n=1,i=t.length,o=t[0];n<i;++n){const u=bm(o,o=t[n]);if(u!==0&&u!==e)return!1}return!0}function UU(t){return{type:"identity",scale:JO(_r.get(t))?L5():e=>e}}function om(t,e=UI){return t.length?[Yp(t,({value:n})=>n===void 0?n:Yp(n,e)),Dl(t,({value:n})=>n===void 0?n:Dl(n,e))]:[0,1]}function fT(t,e){const n=_r.get(t);return(n===Rm||n===Um||n===Om?VU:om)(e)}function VU(t){return[0,t.length?Dl(t,({value:e})=>e===void 0?e:Dl(e,UI)):1]}function jU(t,e){const n=t.find(({radius:h})=>h!==void 0);if(n!==void 0)return[0,n.radius];const i=D_(t,.5,({value:h})=>h===void 0?NaN:D_(h,.25,gg)),o=e.map(h=>3*Math.sqrt(h/i)),u=30/Dl(o);return u<1?o.map(h=>h*u):o}function qU(t,e){const n=Mb(t,({value:u})=>u===void 0?NaN:Mb(u,Math.abs)),i=e.map(u=>12*u/n),o=60/Dl(i);return o<1?i.map(u=>u*o):i}function HU(t){for(const{value:e}of t)if(e!==void 0)for(let n of e){if(n>0)return om(t,gg);if(n<0)return om(t,p2)}return[1,10]}function WU(t){const e=[];for(const{value:n}of t)if(n!==void 0)for(const i of n)e.push(i);return e}function A2(t){return(e,n)=>i=>t(e+i*(n-e))}function Ag(t,e,n,i,{type:o,nice:u,clamp:h,domain:c=om(i),unknown:b,pivot:w=0,scheme:S,range:M,symmetric:A=!0,interpolate:P=_r.get(t)===Dc?S==null&&M!==void 0?Mh:T2(S!==void 0?S:"rdbu"):za,reverse:B}){w=+w,c=Ns(c);let[U,J]=c;if(c.length>2&&bu(`Warning: the diverging ${t} scale domain contains extra elements.`),bm(U,J)<0&&([U,J]=[J,U],B=!B),U=Math.min(U,w),J=Math.max(J,w),typeof P!="function"&&(P=hT(P)),M!==void 0&&(P=P.length===1?A2(P)(...M):ng(P,M)),B&&(P=uT(P)),A){const Q=n.apply(w),K=Q-n.apply(U),le=n.apply(J)-Q;K<le?U=n.invert(Q-le):K>le&&(J=n.invert(Q+K))}return e.domain([U,w,J]).unknown(b).interpolator(P),h&&e.clamp(h),u&&e.nice(u),{type:o,domain:[U,J],pivot:w,interpolate:P,scale:e}}function ZU(t,e,n){return Ag(t,nS(),KU,e,n)}function GU(t,e,n){return pT(t,e,{...n,exponent:.5})}function pT(t,e,{exponent:n=1,...i}){return Ag(t,aS().exponent(n=+n),$U(n),e,{...i,type:"diverging-pow"})}function YU(t,e,{base:n=10,pivot:i=1,domain:o=om(e,i<0?p2:gg),...u}){return Ag(t,iS().base(n=+n),XU,e,{domain:o,pivot:i,...u})}function JU(t,e,{constant:n=1,...i}){return Ag(t,rS().constant(n=+n),eV(n),e,i)}const KU={apply(t){return t},invert(t){return t}},XU={apply:Math.log,invert:Math.exp},QU={apply(t){return Math.sign(t)*Math.sqrt(Math.abs(t))},invert(t){return Math.sign(t)*(t*t)}};function $U(t){return t===.5?QU:{apply(e){return Math.sign(e)*Math.pow(Math.abs(e),t)},invert(e){return Math.sign(e)*Math.pow(Math.abs(e),1/t)}}}function eV(t){return{apply(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))},invert(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}}function mT(t,e,n,i){return Vm(t,e,n,i)}function tV(t,e,n){return mT(t,SR(),e,n)}function nV(t,e,n){return mT(t,IR(),e,n)}const jm=Symbol("ordinal");function _T(t,e,n,{type:i,interval:o,domain:u,range:h,reverse:c,hint:b}){return o=Nm(o,i),u===void 0&&(u=yT(n,o,t)),(i==="categorical"||i===jm)&&(i="ordinal"),c&&(u=P_(u)),u=e.domain(u).domain(),h!==void 0&&(typeof h=="function"&&(h=h(u)),e.range(h)),{type:i,domain:u,range:h,scale:e,hint:b,interval:o}}function iV(t,e,{type:n,interval:i,domain:o,range:u,scheme:h,unknown:c,...b}){i=Nm(i,n),o===void 0&&(o=yT(e,i,t));let w;if(_r.get(t)===Tg)w=sV(e),u=u===void 0?oV(w):ts(u,w2);else if(_r.get(t)===Dc&&(u===void 0&&(n==="ordinal"||n===jm)&&(u=kU(o,h),u!==void 0&&(h=void 0)),h===void 0&&u===void 0&&(h=n==="ordinal"?"turbo":"observable10"),h!==void 0))if(u!==void 0){const S=T2(h),M=u[0],A=u[1]-u[0];u=({length:P})=>Uo(B=>S(M+A*B),P)}else u=cT(h);if(c===tv)throw new Error(`implicit unknown on ${t} scale is not supported`);return _T(t,i2().unknown(c),e,{...b,type:n,domain:o,range:u,hint:w})}function rV(t,e,{align:n=.5,padding:i=.5,...o}){return gT(iN().align(n).padding(i),e,o,t)}function aV(t,e,{align:n=.5,padding:i=.1,paddingInner:o=i,paddingOuter:u=t==="fx"||t==="fy"?0:i,...h}){return gT(sg().align(n).paddingInner(o).paddingOuter(u),e,h,t)}function gT(t,e,n,i){let{round:o}=n;return o!==void 0&&t.round(o=!!o),t=_T(i,t,e,n),t.round=o,t}function yT(t,e,n){const i=new Y1;for(const{value:o,domain:u}of t){if(u!==void 0)return u();if(o!==void 0)for(const h of o)i.add(h)}if(e!==void 0){const[o,u]=yu(i).map(e.floor,e);return e.range(o,e.offset(u))}if(i.size>1e4&&_r.get(n)===wl)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return qD(i,sf)}function g6(t,e){let n;for(const{hint:i}of t){const o=i==null?void 0:i[e];if(o!==void 0){if(n===void 0)n=o;else if(n!==o)return}}return n}function sV(t){return{fill:g6(t,"fill"),stroke:g6(t,"stroke")}}function oV(t){return us(t.fill)?$R:QR}function mv(t,{label:e,inset:n=0,insetTop:i=n,insetRight:o=n,insetBottom:u=n,insetLeft:h=n,round:c,nice:b,clamp:w,zero:S,align:M,padding:A,projection:P,facet:{label:B=e}={},...U}={}){const J={};for(const[Q,K]of t){const le=U[Q],ee=dV(Q,K,{round:_r.get(Q)===wl?c:void 0,nice:b,clamp:w,zero:S,align:M,padding:A,projection:P,...le});if(ee){let{label:oe=Q==="fx"||Q==="fy"?B:e,percent:Z,transform:ne,inset:be,insetTop:me=be!==void 0?be:Q==="y"?i:0,insetRight:Te=be!==void 0?be:Q==="x"?o:0,insetBottom:Y=be!==void 0?be:Q==="y"?u:0,insetLeft:ye=be!==void 0?be:Q==="x"?h:0}=le||{};if(ne==null)ne=void 0;else if(typeof ne!="function")throw new Error("invalid scale transform; not a function");ee.percent=!!Z,ee.label=oe===void 0?cV(K,ee):oe,ee.transform=ne,Q==="x"||Q==="fx"?(ee.insetLeft=+ye,ee.insetRight=+Te):(Q==="y"||Q==="fy")&&(ee.insetTop=+me,ee.insetBottom=+Y),J[Q]=ee}}return J}function y6(t){const e={},n={scales:e};for(const[i,o]of Object.entries(t)){const{scale:u,type:h,interval:c,label:b}=o;e[i]=gV(o),n[i]=u,u.type=h,c!=null&&(u.interval=c),b!=null&&(u.label=b)}return n}function lV(t,e){const{x:n,y:i,fx:o,fy:u}=t,h=o||u?C2(e):e;o&&b6(o,h),u&&v6(u,h);const c=o||u?bT(t,e):e;n&&b6(n,c),i&&v6(i,c)}function cV(t=[],e){let n;for(const{label:i}of t)if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}if(n!==void 0)return!Rh(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function uV(t){return Math.sign(of(t.domain()))*Math.sign(of(t.range()))}function C2(t){const{marginTop:e,marginRight:n,marginBottom:i,marginLeft:o,width:u,height:h,facet:{marginTop:c,marginRight:b,marginBottom:w,marginLeft:S}}=t;return{marginTop:Math.max(e,c),marginRight:Math.max(n,b),marginBottom:Math.max(i,w),marginLeft:Math.max(o,S),width:u,height:h}}function bT({fx:t,fy:e},n){const{marginTop:i,marginRight:o,marginBottom:u,marginLeft:h,width:c,height:b}=C2(n);return{marginTop:i,marginRight:o,marginBottom:u,marginLeft:h,width:t?t.scale.bandwidth()+h+o:c,height:e?e.scale.bandwidth()+i+u:b,facet:{width:c,height:b}}}function b6(t,e){if(t.range===void 0){const{insetLeft:n,insetRight:i}=t,{width:o,marginLeft:u=0,marginRight:h=0}=e,c=u+n,b=o-h-i;t.range=[c,Math.max(c,b)],Rh(t)||(t.range=xT(t)),t.scale.range(t.range)}vT(t)}function v6(t,e){if(t.range===void 0){const{insetTop:n,insetBottom:i}=t,{height:o,marginTop:u=0,marginBottom:h=0}=e,c=u+n,b=o-h-i;t.range=[Math.max(c,b),c],Rh(t)?t.range.reverse():t.range=xT(t),t.scale.range(t.range)}vT(t)}function vT(t){t.round===void 0&&pV(t)&&hV(t)<=30&&t.scale.round(!0)}function hV({scale:t}){const e=t.domain().length,[n,i]=t.range(),o=t.paddingInner?t.paddingInner():1,u=t.paddingOuter?t.paddingOuter():t.padding(),h=e-o,c=Math.abs(i-n)/Math.max(1,h+u*2);return(c-Math.floor(c))*h}function xT(t){const e=t.scale.domain().length+wT(t);if(!(e>2))return t.range;const[n,i]=t.range;return Array.from({length:e},(o,u)=>n+u/(e-1)*(i-n))}function dV(t,e=[],n={}){const i=fV(t,e,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&t!=="fx"&&t!=="fy"&&Rh({type:i})){const o=e.map(({value:u})=>u).filter(u=>u!==void 0);o.some(zl)?bu(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Md(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Md(i)}".`):o.some(UO)?bu(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Md(i)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Md(i)}".`):o.some(VO)&&bu(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Md(i)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Md(i)}".`)}switch(n.type=i,i){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=K0(e,n,s1);break;case"identity":switch(_r.get(t)){case wl:n=K0(e,n,s1);break;case Tg:n=K0(e,n,mV);break}break;case"utc":case"time":n=K0(e,n,PO);break}switch(i){case"diverging":return ZU(t,e,n);case"diverging-sqrt":return GU(t,e,n);case"diverging-pow":return pT(t,e,n);case"diverging-log":return YU(t,e,n);case"diverging-symlog":return JU(t,e,n);case"categorical":case"ordinal":case jm:return iV(t,e,n);case"cyclical":case"sequential":case"linear":return LU(t,e,n);case"sqrt":return zU(t,e,n);case"threshold":return M2(t,e,n);case"quantile":return NU(t,e,n);case"quantize":return RU(t,e,n);case"pow":return dT(t,e,n);case"log":return BU(t,e,n);case"symlog":return FU(t,e,n);case"utc":return nV(t,e,n);case"time":return tV(t,e,n);case"point":return rV(t,e,n);case"band":return aV(t,e,n);case"identity":return UU(t);case void 0:return;default:throw new Error(`unknown scale type: ${i}`)}}function Md(t){return typeof t=="symbol"?t.description:t}function x6(t){return typeof t=="string"?`${t}`.toLowerCase():t}const w6={toString:()=>"projection"};function fV(t,e,{type:n,domain:i,range:o,scheme:u,pivot:h,projection:c}){if(n=x6(n),t==="fx"||t==="fy")return"band";(t==="x"||t==="y")&&c!=null&&(n=w6);for(const w of e){const S=x6(w.type);if(S!==void 0){if(n===void 0)n=S;else if(n!==S)throw new Error(`scale incompatible with channel: ${n} !== ${S}`)}}if(n===w6)return;if(n!==void 0)return n;if(i===void 0&&!e.some(({value:w})=>w!==void 0))return;const b=_r.get(t);if(b===Rm)return"sqrt";if(b===Um||b===Om)return"linear";if(b===Tg)return"ordinal";if((i||o||[]).length>2)return tb(b);if(i!==void 0){if(a6(i))return tb(b);if(zl(i))return"utc"}else{const w=e.map(({value:S})=>S).filter(S=>S!==void 0);if(w.some(a6))return tb(b);if(w.some(zl))return"utc"}if(b===Dc){if(h!=null||DU(u))return"diverging";if(CU(u))return"categorical"}return"linear"}function tb(t){switch(t){case wl:return"point";case Dc:return jm;default:return"ordinal"}}function Rh({type:t}){return t==="ordinal"||t==="point"||t==="band"||t===jm}function wT({type:t}){return t==="threshold"}function pV({type:t}){return t==="point"||t==="band"}function mu(t){if(t===void 0)return!0;const e=t.domain(),n=t(e[0]);for(let i=1,o=e.length;i<o;++i)if(t(e[i])-n)return!1;return!0}function K0(t,{domain:e,...n},i){var o;for(const u of t)u.value!==void 0&&(e===void 0&&(e=(o=u.value)==null?void 0:o.domain),u.value=i(u.value));return{domain:e===void 0?e:i(e),...n}}function mV(t){return ts(t,w2)}function _V(t){return e=>{if(!_r.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return t[e]}}function gV({scale:t,type:e,domain:n,range:i,interpolate:o,interval:u,transform:h,percent:c,pivot:b}){if(e==="identity")return{type:"identity",apply:S=>S,invert:S=>S};const w=t.unknown?t.unknown():void 0;return{type:e,domain:cv(n),...i!==void 0&&{range:cv(i)},...h!==void 0&&{transform:h},...c&&{percent:c},...w!==void 0&&{unknown:w},...u!==void 0&&{interval:u},...o!==void 0&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...b!==void 0&&{pivot:b,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:S=>t(S),...t.invert&&{invert:S=>t.invert(S)}}}function yV(t){let e,n;return(...i)=>(((n==null?void 0:n.length)!==i.length||n.some((o,u)=>o!==i[u]))&&(n=i,e=t(...i)),e)}const bV=yV(t=>new Intl.NumberFormat(t));function vV(t="en-US"){const e=bV(t);return n=>n!=null&&!isNaN(n)?e.format(n):void 0}function xV(t){return lv(t,"Invalid Date")}function wV(t="en-US"){const e=vV(t);return n=>(n instanceof Date?xV:typeof n=="number"?e:Xa)(n)}const Dh=wV(),Ps=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let SV=0;function S6(){return`plot-clip-${++SV}`}function IV(t,{title:e,href:n,ariaLabel:i,ariaDescription:o,ariaHidden:u,target:h,fill:c,fillOpacity:b,stroke:w,strokeWidth:S,strokeOpacity:M,strokeLinejoin:A,strokeLinecap:P,strokeMiterlimit:B,strokeDasharray:U,strokeDashoffset:J,opacity:Q,mixBlendMode:K,imageFilter:le,paintOrder:ee,pointerEvents:oe,shapeRendering:Z,channels:ne},{ariaLabel:be,fill:me="currentColor",fillOpacity:Te,stroke:Y="none",strokeOpacity:ye,strokeWidth:qe,strokeLinecap:He,strokeLinejoin:Be,strokeMiterlimit:lt,paintOrder:Ge}){me===null&&(c=null,b=null),Y===null&&(w=null,M=null),us(me)?!us(Y)&&(!us(c)||ne!=null&&ne.fill)&&(Y="none"):us(Y)&&(!us(w)||ne!=null&&ne.stroke)&&(me="none");const[ot,je]=Eh(c,me),[Ve,$e]=$a(b,Te),[st,ct]=Eh(w,Y),[Pt,Ut]=$a(M,ye),[Lt,gt]=$a(Q);am(ct)||(S===void 0&&(S=qe),P===void 0&&(P=He),A===void 0&&(A=Be),B===void 0&&!WO(A)&&(B=lt),!am(je)&&ee===void 0&&(ee=Ge));const[Bt,tt]=$a(S);return me!==null&&(t.fill=xa(je,"currentColor"),t.fillOpacity=vp($e,1)),Y!==null&&(t.stroke=xa(ct,"none"),t.strokeWidth=vp(tt,1),t.strokeOpacity=vp(Ut,1),t.strokeLinejoin=xa(A,"miter"),t.strokeLinecap=xa(P,"butt"),t.strokeMiterlimit=vp(B,4),t.strokeDasharray=xa(U,"none"),t.strokeDashoffset=xa(J,"0")),t.target=Xa(h),t.ariaLabel=Xa(be),t.ariaDescription=Xa(o),t.ariaHidden=Xa(u),t.opacity=vp(gt,1),t.mixBlendMode=xa(K,"normal"),t.imageFilter=xa(le,"none"),t.paintOrder=xa(ee,"normal"),t.pointerEvents=xa(oe,"auto"),t.shapeRendering=xa(Z,"auto"),{title:{value:e,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:i,optional:!0,filter:null},fill:{value:ot,scale:"auto",optional:!0},fillOpacity:{value:Ve,scale:"auto",optional:!0},stroke:{value:st,scale:"auto",optional:!0},strokeOpacity:{value:Pt,scale:"auto",optional:!0},strokeWidth:{value:Bt,optional:!0},opacity:{value:Lt,scale:"auto",optional:!0}}}function TV(t,e){e&&t.filter(n=>f2(e[n])).append("title").call(AV,e)}function MV(t,e){e&&t.filter(([n])=>f2(e[n])).append("title").call(CV,e)}function AV(t,e){e&&t.text(n=>Dh(e[n]))}function CV(t,e){e&&t.text(([n])=>Dh(e[n]))}function Oh(t,{target:e,tip:n},{ariaLabel:i,title:o,fill:u,fillOpacity:h,stroke:c,strokeOpacity:b,strokeWidth:w,opacity:S,href:M}){i&&Cn(t,"aria-label",A=>i[A]),u&&Cn(t,"fill",A=>u[A]),h&&Cn(t,"fill-opacity",A=>h[A]),c&&Cn(t,"stroke",A=>c[A]),b&&Cn(t,"stroke-opacity",A=>b[A]),w&&Cn(t,"stroke-width",A=>w[A]),S&&Cn(t,"opacity",A=>S[A]),M&&ST(t,A=>M[A],e),n||TV(t,o)}function kV(t,{target:e,tip:n},{ariaLabel:i,title:o,fill:u,fillOpacity:h,stroke:c,strokeOpacity:b,strokeWidth:w,opacity:S,href:M}){i&&Cn(t,"aria-label",([A])=>i[A]),u&&Cn(t,"fill",([A])=>u[A]),h&&Cn(t,"fill-opacity",([A])=>h[A]),c&&Cn(t,"stroke",([A])=>c[A]),b&&Cn(t,"stroke-opacity",([A])=>b[A]),w&&Cn(t,"stroke-width",([A])=>w[A]),S&&Cn(t,"opacity",([A])=>S[A]),M&&ST(t,([A])=>M[A],e),n||MV(t,o)}function EV({ariaLabel:t,title:e,fill:n,fillOpacity:i,stroke:o,strokeOpacity:u,strokeWidth:h,opacity:c,href:b},{tip:w}){return[t,w?void 0:e,n,i,o,u,h,c,b].filter(S=>S!==void 0)}function DV(t,e,n){const i=UD(t,o=>e[o]);return n===void 0&&i.size>1+t.length>>1&&bu("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),i.values()}function*PV(t,e,n,i){const{z:o}=n,{z:u}=i,h=EV(i,n),c=[...e,...h];for(const b of u?DV(t,u,o):[t]){let w,S;e:for(const M of b){for(const A of c)if(!Mu(A[M])){S&&S.push(-1);continue e}if(w===void 0){S&&(yield S),w=h.map(A=>ph(A[M])),S=[M];continue}S.push(M);for(let A=0;A<h.length;++A)if(ph(h[A][M])!==w[A]){yield S,w=h.map(B=>ph(B[M])),S=[M];continue e}}S&&(yield S)}}function LV(t,e,n,i){let o;const{clip:u=i.clip}=e;switch(u){case"frame":{const{width:h,height:c,marginLeft:b,marginRight:w,marginTop:S,marginBottom:M}=n,A=S6();o=`url(#${A})`,t=Ia("svg:g",i).call(P=>P.append("svg:clipPath").attr("id",A).append("rect").attr("x",b).attr("y",S).attr("width",h-w-b).attr("height",c-S-M)).each(function(){this.appendChild(t.node()),t.node=()=>this});break}case"sphere":{const{projection:h}=i;if(!h)throw new Error('the "sphere" clip option requires a projection');const c=S6();o=`url(#${c})`,t.append("clipPath").attr("id",c).append("path").attr("d",Vv(h)({type:"Sphere"}));break}}Cn(t,"aria-label",e.ariaLabel),Cn(t,"aria-description",e.ariaDescription),Cn(t,"aria-hidden",e.ariaHidden),Cn(t,"clip-path",o)}function Pc(t,e,n,i){LV(t,e,n,i),Cn(t,"fill",e.fill),Cn(t,"fill-opacity",e.fillOpacity),Cn(t,"stroke",e.stroke),Cn(t,"stroke-width",e.strokeWidth),Cn(t,"stroke-opacity",e.strokeOpacity),Cn(t,"stroke-linejoin",e.strokeLinejoin),Cn(t,"stroke-linecap",e.strokeLinecap),Cn(t,"stroke-miterlimit",e.strokeMiterlimit),Cn(t,"stroke-dasharray",e.strokeDasharray),Cn(t,"stroke-dashoffset",e.strokeDashoffset),Cn(t,"shape-rendering",e.shapeRendering),Cn(t,"filter",e.imageFilter),Cn(t,"paint-order",e.paintOrder);const{pointerEvents:o=i.pointerSticky===!1?"none":void 0}=e;Cn(t,"pointer-events",o)}function Lc(t,e){zV(t,"mix-blend-mode",e.mixBlendMode),Cn(t,"opacity",e.opacity)}function ST(t,e,n){t.each(function(i){const o=e(i);if(o!=null){const u=this.ownerDocument.createElementNS(Qd.svg,"a");u.setAttribute("fill","inherit"),u.setAttributeNS(Qd.xlink,"href",o),n!=null&&u.setAttribute("target",n),this.parentNode.insertBefore(u,this).appendChild(this)}})}function Cn(t,e,n){n!=null&&t.attr(e,n)}function zV(t,e,n){n!=null&&t.style(e,n)}function zc(t,e,{x:n,y:i},o=Ps,u=Ps){o+=e.dx,u+=e.dy,n!=null&&n.bandwidth&&(o+=n.bandwidth()/2),i!=null&&i.bandwidth&&(u+=i.bandwidth()/2),(o||u)&&t.attr("transform",`translate(${o},${u})`)}function xa(t,e){if((t=Xa(t))!==e)return t}function vp(t,e){if((t=pr(t))!==e)return t}const BV=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function k2(t){if(t===void 0)return"plot-d6a7b5";if(t=`${t}`,!BV.test(t))throw new Error(`invalid class name: ${t}`);return t}function E2(t,e){if(typeof e=="string")t.property("style",e);else if(e!=null)for(const n of t)Object.assign(n.style,e)}function qm({frameAnchor:t},{width:e,height:n,marginTop:i,marginRight:o,marginBottom:u,marginLeft:h}){return[/left$/.test(t)?h:/right$/.test(t)?e-o:(h+e-o)/2,/^top/.test(t)?i:/^bottom/.test(t)?n-u:(i+n-u)/2]}function FV(t,e,n={}){let i=.5-Ps,o=.5+Ps,u=.5+Ps,h=.5-Ps;for(const{marginTop:U,marginRight:J,marginBottom:Q,marginLeft:K}of e)U>i&&(i=U),J>o&&(o=J),Q>u&&(u=Q),K>h&&(h=K);let{margin:c,marginTop:b=c!==void 0?c:i,marginRight:w=c!==void 0?c:o,marginBottom:S=c!==void 0?c:u,marginLeft:M=c!==void 0?c:h}=n;b=+b,w=+w,S=+S,M=+M;let{width:A=640,height:P=NV(t,n,{width:A,marginTopDefault:i,marginRightDefault:o,marginBottomDefault:u,marginLeftDefault:h})+Math.max(0,b-i+S-u)}=n;A=+A,P=+P;const B={width:A,height:P,marginTop:b,marginRight:w,marginBottom:S,marginLeft:M};if(t.fx||t.fy){let{margin:U,marginTop:J=U!==void 0?U:b,marginRight:Q=U!==void 0?U:w,marginBottom:K=U!==void 0?U:S,marginLeft:le=U!==void 0?U:M}=n.facet??{};J=+J,Q=+Q,K=+K,le=+le,B.facet={marginTop:J,marginRight:Q,marginBottom:K,marginLeft:le}}return B}function NV({x:t,y:e,fy:n,fx:i},{projection:o,aspectRatio:u},{width:h,marginTopDefault:c,marginRightDefault:b,marginBottomDefault:w,marginLeftDefault:S}){const M=n?n.scale.domain().length:1,A=MU(o);if(A){const B=i?i.scale.domain().length:1,U=(1.1*M-.1)/(1.1*B-.1)*A,J=Math.max(.1,Math.min(10,U));return Math.round((h-S-b)*J+c+w)}const P=e?Rh(e)?e.scale.domain().length:Math.max(7,17/M):1;if(u!=null){if(u=+u,!(isFinite(u)&&u>0))throw new Error(`invalid aspectRatio: ${u}`);const B=I6("y",e)/(I6("x",t)*u),U=i?i.scale.bandwidth():1,J=n?n.scale.bandwidth():1,Q=U*(h-S-b)-t.insetLeft-t.insetRight;return(B*Q+e.insetTop+e.insetBottom)/J+c+w}return!!(e||n)*Math.max(1,Math.min(60,P*M))*20+!!i*30+60}function I6(t,e){if(!e)throw new Error(`aspectRatio requires ${t} scale`);const{type:n,domain:i}=e;let o;switch(n){case"linear":case"utc":case"time":o=Number;break;case"pow":{const c=e.scale.exponent();o=b=>Math.pow(b,c);break}case"log":o=Math.log;break;case"point":case"band":return i.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${n}`)}const[u,h]=yu(i);return Math.abs(o(h)-o(u))}function RV(t,e){const{fx:n,fy:i}=mv(t,e),o=n==null?void 0:n.scale.domain(),u=i==null?void 0:i.scale.domain();return o&&u?RD(o,u).map(([h,c],b)=>({x:h,y:c,i:b})):o?o.map((h,c)=>({x:h,i:c})):u?u.map((h,c)=>({y:h,i:c})):void 0}function OV(t,{x:e,y:n}){return e&&(e=_v(e)),n&&(n=_v(n)),t.filter(e&&n?i=>e.has(i.x)&&n.has(i.y):e?i=>e.has(i.x):i=>n.has(i.y)).sort(e&&n?(i,o)=>e.get(i.x)-e.get(o.x)||n.get(i.y)-n.get(o.y):e?(i,o)=>e.get(i.x)-e.get(o.x):(i,o)=>n.get(i.y)-n.get(o.y))}function D2(t,{fx:e,fy:n}){const i=Fm(t),o=e==null?void 0:e.value,u=n==null?void 0:n.value;return e&&n?Dy(i,h=>(h.fx=o[h[0]],h.fy=u[h[0]],h),h=>o[h],h=>u[h]):e?Dy(i,h=>(h.fx=o[h[0]],h),h=>o[h]):Dy(i,h=>(h.fy=u[h[0]],h),h=>u[h])}function UV(t,e,{marginTop:n,marginLeft:i}){return t&&e?({x:o,y:u})=>`translate(${t(o)-i},${e(u)-n})`:t?({x:o})=>`translate(${t(o)-i},0)`:({y:o})=>`translate(0,${e(o)-n})`}function VV(t){const e=[],n=new Uint32Array(Ov(t,i=>i.length));for(const i of t){let o=0;for(const u of t)i!==u&&(n.set(u,o),o+=u.length);e.push(n.slice(0,o))}return e}const jV=new Map([["top",nb],["right",ab],["bottom",ib],["left",rb],["top-left",X0(nb,rb)],["top-right",X0(nb,ab)],["bottom-left",X0(ib,rb)],["bottom-right",X0(ib,ab)],["top-empty",WV],["right-empty",YV],["bottom-empty",ZV],["left-empty",GV],["empty",JV]]);function qV(t){if(t==null)return null;const e=jV.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}const T6=new WeakMap;function _v(t){let e=T6.get(t);return e||T6.set(t,e=new Gp(ts(t,(n,i)=>[n,i]))),e}function Lu(t,e){return _v(t).get(e)}function HV(t,e,n){return e=ph(e),n=ph(n),t.find(i=>Object.is(ph(i.x),e)&&Object.is(ph(i.y),n))}function Cg(t,e,n){var i;return(i=HV(t,e,n))==null?void 0:i.empty}function nb(t,{y:e},{y:n}){return e?Lu(e,n)===0:!0}function ib(t,{y:e},{y:n}){return e?Lu(e,n)===e.length-1:!0}function rb(t,{x:e},{x:n}){return e?Lu(e,n)===0:!0}function ab(t,{x:e},{x:n}){return e?Lu(e,n)===e.length-1:!0}function WV(t,{y:e},{x:n,y:i,empty:o}){if(o)return!1;if(!e)return;const u=Lu(e,i);if(u>0)return Cg(t,n,e[u-1])}function ZV(t,{y:e},{x:n,y:i,empty:o}){if(o)return!1;if(!e)return;const u=Lu(e,i);if(u<e.length-1)return Cg(t,n,e[u+1])}function GV(t,{x:e},{x:n,y:i,empty:o}){if(o)return!1;if(!e)return;const u=Lu(e,n);if(u>0)return Cg(t,e[u-1],i)}function YV(t,{x:e},{x:n,y:i,empty:o}){if(o)return!1;if(!e)return;const u=Lu(e,n);if(u<e.length-1)return Cg(t,e[u+1],i)}function JV(t,e,{empty:n}){return n}function X0(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function sb(t,{channels:{fx:e,fy:n},groups:i}){return e&&n?t.map(({x:o,y:u})=>{var h;return((h=i.get(o))==null?void 0:h.get(u))??[]}):e?t.map(({x:o})=>i.get(o)??[]):t.map(({y:o})=>i.get(o)??[])}class co{constructor(e,n={},i={},o){const{facet:u="auto",facetAnchor:h,fx:c,fy:b,sort:w,dx:S=0,dy:M=0,margin:A=0,marginTop:P=A,marginRight:B=A,marginBottom:U=A,marginLeft:J=A,clip:Q=o==null?void 0:o.clip,channels:K,tip:le,render:ee}=i;if(this.data=e,this.sort=lf(w)?w:null,this.initializer=cf(i).initializer,this.transform=this.initializer?i.transform:$I(i).transform,u===null||u===!1?this.facet=null:(this.facet=Go(u===!0?"include":u,"facet",["auto","include","exclude","super"]),this.fx=e===c_&&typeof c=="string"?[c]:c,this.fy=e===c_&&typeof b=="string"?[b]:b),this.facetAnchor=qV(h),n=KI(n),K!==void 0&&(n={...KV(K),...n}),o!==void 0&&(n={...IV(this,i,o),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([oe,Z])=>{if(bg(Z.value)){const{value:ne,label:be=Z.label,scale:me=Z.scale}=Z.value;Z={...Z,label:be,scale:me,value:ne}}if(e===c_&&typeof Z.value=="string"){const{value:ne}=Z;Z={...Z,value:[ne]}}return[oe,Z]}).filter(([oe,{value:Z,optional:ne}])=>{if(Z!=null)return!0;if(ne)return!1;throw new Error(`missing channel value: ${oe}`)})),this.dx=+S,this.dy=+M,this.marginTop=+P,this.marginRight=+B,this.marginBottom=+U,this.marginLeft=+J,this.clip=XI(Q),this.tip=XV(le),this.facet==="super"){if(c||b)throw new Error("super-faceting cannot use fx or fy");for(const oe in this.channels){const{scale:Z}=n[oe];if(!(Z!=="x"&&Z!=="y"))throw new Error("super-faceting cannot use x or y")}}ee!=null&&(this.render=TT(ee,this.render))}initialize(e,n,i){let o=Ns(this.data);e===void 0&&o!=null&&(e=[Fm(o)]);const u=e;this.transform!=null&&({facets:e,data:o}=this.transform(o,e,i),o=Ns(o)),e!==void 0&&(e.original=u);const h=pU(this.channels,o);return this.sort!=null&&_U(o,e,h,n,this.sort),{data:o,facets:e,channels:h}}filter(e,n,i){for(const o in n){const{filter:u=Mu}=n[o];if(u!==null){const h=i[o];e=e.filter(c=>u(h[c]))}}return e}project(e,n,i){for(const o in e)if(e[o].scale==="x"&&/^x|x$/.test(o)){const u=o.replace(/^x|x$/,"y");u in e&&e[u].scale==="y"&&IU(o,u,n,i.projection)}}scale(e,n,i){const o=mU(e,n);return i.projection&&this.project(e,o,i),o}}function IT(...t){return t.plot=co.prototype.plot,t}function TT(t,e){if(t==null)return e===null?void 0:e;if(e==null)return t===null?void 0:t;if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);return function(n,i,o,u,h,c){return t.call(this,n,i,o,u,h,(b,w,S,M,A)=>e.call(this,b,w,S,M,A,c))}}function KV(t){return Object.fromEntries(Object.entries(KI(t)).map(([e,n])=>(n=typeof n=="string"?{value:n,label:e}:wg(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[e,n])))}function XV(t){return t===!0?"xy":t===!1||t==null?null:typeof t=="string"?Go(t,"tip",["x","y","xy"]):t}function MT(t,e){return(t==null?void 0:t.tip)===!0?{...t,tip:e}:Fh(t==null?void 0:t.tip)&&t.tip.pointer===void 0?{...t,tip:{...t.tip,pointer:e}}:t}const M6=new WeakMap;function P2(t,e,{x:n,y:i,px:o,py:u,maxRadius:h=40,channels:c,render:b,...w}={}){return h=+h,o!=null&&(n??(n=null),c={...c,px:{value:o,scale:"x"}}),u!=null&&(i??(i=null),c={...c,py:{value:u,scale:"y"}}),{x:n,y:i,channels:c,...w,render:TT(function(S,M,A,P,B,U){B={...B,pointerSticky:!1};const J=B.ownerSVGElement,{data:Q}=B.getMarkState(this);let K=M6.get(J);K||M6.set(J,K={sticky:!1,roots:[],renders:[]});let le=K.renders.push(ct)-1;const{x:ee,y:oe,fx:Z,fy:ne}=M;let be=Z?Z(S.fx)-P.marginLeft:0,me=ne?ne(S.fy)-P.marginTop:0;ee!=null&&ee.bandwidth&&(be+=ee.bandwidth()/2),oe!=null&&oe.bandwidth&&(me+=oe.bandwidth()/2);const Te=S.fi!=null;let Y;if(Te){let gt=K.facetStates;gt||(K.facetStates=gt=new Map),Y=gt.get(this),Y||gt.set(this,Y=new Map)}const[ye,qe]=qm(this,P),{px:He,py:Be}=A,lt=He?gt=>He[gt]:CT(A,ye),Ge=Be?gt=>Be[gt]:kT(A,qe);let ot,je,Ve,$e;function st(gt,Bt){if(Te)if($e&&($e=cancelAnimationFrame($e)),gt==null)Y.delete(S.fi);else{Y.set(S.fi,Bt),$e=requestAnimationFrame(()=>{$e=null;for(const[tt,Le]of Y)if(Le<Bt||Le===Bt&&tt<S.fi){gt=null;break}ct(gt)});return}ct(gt)}function ct(gt){if(ot===gt&&Ve===K.sticky)return;ot=gt,Ve=B.pointerSticky=K.sticky;const Bt=ot==null?[]:[ot];Te&&(Bt.fx=S.fx,Bt.fy=S.fy,Bt.fi=S.fi);const tt=U(Bt,M,A,P,B);if(je){if(Te){const Le=je.parentNode,ut=je.getAttribute("transform"),Re=tt.getAttribute("transform");ut?tt.setAttribute("transform",ut):tt.removeAttribute("transform"),Re?Le.setAttribute("transform",Re):Le.removeAttribute("transform"),tt.removeAttribute("aria-label"),tt.removeAttribute("aria-description"),tt.removeAttribute("aria-hidden")}je.replaceWith(tt)}return K.roots[le]=je=tt,ot==null&&(Y==null?void 0:Y.size)>1||B.dispatchValue(ot==null?null:Q[ot]),tt}function Pt(gt){if(K.sticky||gt.pointerType==="mouse"&&gt.buttons===1)return;let[Bt,tt]=Kz(gt);Bt-=be,tt-=me;const Le=Bt<P.marginLeft||Bt>P.width-P.marginRight?1:t,ut=tt<P.marginTop||tt>P.height-P.marginBottom?1:e;let Re=null,Ke=h*h;for(const Ee of S){const wt=Le*(lt(Ee)-Bt),De=ut*(Ge(Ee)-tt),wn=wt*wt+De*De;wn<=Ke&&(Re=Ee,Ke=wn)}if(Re!=null&&(t!==1||e!==1)){const Ee=lt(Re)-Bt,wt=Ge(Re)-tt;Ke=Ee*Ee+wt*wt}st(Re,Ke)}function Ut(gt){gt.pointerType==="mouse"&&ot!=null&&(K.sticky&&K.roots.some(Bt=>Bt==null?void 0:Bt.contains(gt.target))||(K.sticky?(K.sticky=!1,K.renders.forEach(Bt=>Bt(null))):(K.sticky=!0,ct(ot)),gt.stopImmediatePropagation()))}function Lt(gt){gt.pointerType==="mouse"&&(K.sticky||st(null))}return J.addEventListener("pointerenter",Pt),J.addEventListener("pointermove",Pt),J.addEventListener("pointerdown",Ut),J.addEventListener("pointerleave",Lt),ct(null)},b)}}function QV(t){return P2(1,1,t)}function AT(t){return P2(1,.01,t)}function A6(t){return P2(.01,1,t)}function CT({x1:t,x2:e,x:n=t},i){return t&&e?o=>(t[o]+e[o])/2:n?o=>n[o]:()=>i}function kT({y1:t,y2:e,y:n=t},i){return t&&e?o=>(t[o]+e[o])/2:n?o=>n[o]:()=>i}function ET(t){return Rh(t)&&t.interval===void 0?void 0:"tabular-nums"}function $V(t,e){let{label:n=t.label,tickSize:i=6,width:o=240,height:u=44+i,marginTop:h=18,marginRight:c=0,marginBottom:b=16+i,marginLeft:w=0,style:S,ticks:M=(o-w-c)/64,tickFormat:A,fontVariant:P=ET(t),round:B=!0,opacity:U,className:J}=e;const Q=I2(e);J=k2(J),U=$a(U)[1],A===null&&(A=()=>null);const K=Ia("svg",Q).attr("class",`${J}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",u).attr("viewBox",`0 0 ${o} ${u}`).call(ye=>ye.append("style").text(`:where(.${J}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${J}-ramp text) {
  white-space: pre;
}`)).call(E2,S);let le=ye=>ye.selectAll(".tick line").attr("y1",h+b-u),ee;const oe=B?(ye,qe)=>ye.rangeRound(qe):(ye,qe)=>ye.range(qe),{type:Z,domain:ne,range:be,interpolate:me,scale:Te,pivot:Y}=t;if(me){const ye=be===void 0?me:ng(me.length===1?A2(me):me,be);ee=oe(Te.copy(),Uo(za(w,o-c),Math.min(ne.length+(Y!==void 0),be===void 0?1/0:be.length)));const qe=256,He=Q.document.createElement("canvas");He.width=qe,He.height=1;const Be=He.getContext("2d");for(let lt=0,Ge=qe-1;lt<qe;++lt)Be.fillStyle=ye(lt/Ge),Be.fillRect(lt,0,1,1);K.append("image").attr("opacity",U).attr("x",w).attr("y",h).attr("width",o-w-c).attr("height",u-h-b).attr("preserveAspectRatio","none").attr("xlink:href",He.toDataURL())}else if(Z==="threshold"){const ye=ne,qe=A===void 0?He=>He:typeof A=="string"?xf(A):A;ee=oe(r2().domain([-1,be.length-1]),[w,o-c]),K.append("g").attr("fill-opacity",U).selectAll().data(be).enter().append("rect").attr("x",(He,Be)=>ee(Be-1)).attr("y",h).attr("width",(He,Be)=>ee(Be)-ee(Be-1)).attr("height",u-h-b).attr("fill",He=>He),M=ts(ye,(He,Be)=>Be),A=He=>qe(ye[He],He)}else ee=oe(sg().domain(ne),[w,o-c]),K.append("g").attr("fill-opacity",U).selectAll().data(ne).enter().append("rect").attr("x",ee).attr("y",h).attr("width",Math.max(0,ee.bandwidth()-1)).attr("height",u-h-b).attr("fill",Te),le=()=>{};return K.append("g").attr("transform",`translate(0,${u-b})`).call(fL(ee).ticks(Array.isArray(M)?null:M,typeof A=="string"?A:void 0).tickFormat(typeof A=="function"?A:void 0).tickSize(i).tickValues(Array.isArray(M)?M:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",xa(P,"normal")).call(le).call(ye=>ye.select(".domain").remove()),n!==void 0&&K.append("text").attr("x",w).attr("y",h-6).attr("fill","currentColor").attr("font-weight","bold").text(n),K.node()}const DT=Math.PI/180;function L2(t,{marker:e,markerStart:n=e,markerMid:i=e,markerEnd:o=e}={}){t.markerStart=ob(n),t.markerMid=ob(i),t.markerEnd=ob(o)}function ob(t){if(t==null||t===!1)return null;if(t===!0)return k6;if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return C6("auto");case"arrow-reverse":return C6("auto-start-reverse");case"dot":return ej;case"circle":case"circle-fill":return k6;case"circle-stroke":return tj;case"tick":return lb("auto");case"tick-x":return lb(90);case"tick-y":return lb(0)}throw new Error(`invalid marker: ${t}`)}function C6(t){return(e,n)=>Ia("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(i=>i.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function ej(t,e){return Ia("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function k6(t,e){return Ia("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function tj(t,e){return Ia("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",t).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function lb(t){return(e,n)=>Ia("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",t).attr("stroke",e).call(i=>i.append("path").attr("d","M0,-3v6")).node()}let nj=0;function PT(t,e,{stroke:n},i){return LT(t,e,n&&(o=>n[o]),i)}function ij(t,e,{stroke:n},i){return LT(t,e,n&&(([o])=>n[o]),i)}function LT(t,{markerStart:e,markerMid:n,markerEnd:i,stroke:o},u=()=>o,h){const c=new Map;function b(w){return function(S){const M=u(S);let A=c.get(w);A||c.set(w,A=new Map);let P=A.get(M);if(!P){const B=this.parentNode.insertBefore(w(M,h),this),U=`plot-marker-${++nj}`;B.setAttribute("id",U),A.set(M,P=`url(#${U})`)}return P}}e&&t.attr("marker-start",b(e)),n&&t.attr("marker-mid",b(n)),i&&t.attr("marker-end",b(i))}function z2({inset:t,insetLeft:e,insetRight:n,...i}={}){return[e,n]=zT(t,e,n),{inset:t,insetLeft:e,insetRight:n,...i}}function B2({inset:t,insetTop:e,insetBottom:n,...i}={}){return[e,n]=zT(t,e,n),{inset:t,insetTop:e,insetBottom:n,...i}}function zT(t,e,n){return t===void 0&&e===void 0&&n===void 0?Ps?[1,0]:[.5,.5]:[e,n]}function BT(t,{interval:e}){return t={...wg(t)},t.interval=b2(t.interval===void 0?e:t.interval),t}function kg(t,e,n,i){const{[t]:o,[`${t}1`]:u,[`${t}2`]:h}=n,{value:c,interval:b}=BT(o,n);if(c==null||b==null&&!i)return n;const w=xg(o);if(b==null){let P;const B={transform:U=>P||(P=Au(U,c)),label:w};return{...n,[t]:void 0,[`${t}1`]:u===void 0?B:u,[`${t}2`]:h===void 0&&!(u===h&&i)?B:h}}let S,M;function A(P){return M!==void 0&&P===S?M:M=ts(Au(S=P,c),B=>b.floor(B))}return e({...n,[t]:void 0,[`${t}1`]:u===void 0?{transform:A,label:w}:u,[`${t}2`]:h===void 0?{transform:P=>A(P).map(B=>b.offset(B)),label:w}:h})}function FT(t,e,n){const{[t]:i}=n,{value:o,interval:u}=BT(i,n);return o==null||u==null?n:e({...n,[t]:{label:xg(i),transform:h=>{const c=ts(Au(h,o),w=>u.floor(w)),b=c.map(w=>u.offset(w));return c.map(zl(c)?(w,S)=>w==null||isNaN(w=+w)||(S=b[S],S==null)||isNaN(S=+S)?void 0:new Date((w+S)/2):(w,S)=>w==null||(S=b[S],S==null)?NaN:(+w+ +S)/2)}}})}function rj(t={}){return kg("x",z2,t,!0)}function aj(t={}){return kg("y",B2,t,!0)}function sj(t={}){return kg("x",z2,t)}function oj(t={}){return kg("y",B2,t)}function lj(t={}){return FT("x",z2,t)}function cj(t={}){return FT("y",B2,t)}const NT={ariaLabel:"rule",fill:null,stroke:"currentColor"};class uj extends co{constructor(e,n={}){const{x:i,y1:o,y2:u,inset:h=0,insetTop:c=h,insetBottom:b=h}=n;super(e,{x:{value:i,scale:"x",optional:!0},y1:{value:o,scale:"y",optional:!0},y2:{value:u,scale:"y",optional:!0}},MT(n,"x"),NT),this.insetTop=pr(c),this.insetBottom=pr(b),L2(this,n)}render(e,n,i,o,u){const{x:h,y:c}=n,{x:b,y1:w,y2:S}=i,{width:M,height:A,marginTop:P,marginRight:B,marginLeft:U,marginBottom:J}=o,{insetTop:Q,insetBottom:K}=this;return Ia("svg:g",u).call(Pc,this,o,u).call(zc,this,{x:b&&h},Ps,0).call(le=>le.selectAll().data(e).enter().append("line").call(Lc,this).attr("x1",b?ee=>b[ee]:(U+M-B)/2).attr("x2",b?ee=>b[ee]:(U+M-B)/2).attr("y1",w&&!mu(c)?ee=>w[ee]+Q:P+Q).attr("y2",S&&!mu(c)?c.bandwidth?ee=>S[ee]+c.bandwidth()-K:ee=>S[ee]-K:A-J-K).call(Oh,this,i).call(PT,this,i,u)).node()}}class hj extends co{constructor(e,n={}){const{x1:i,x2:o,y:u,inset:h=0,insetRight:c=h,insetLeft:b=h}=n;super(e,{y:{value:u,scale:"y",optional:!0},x1:{value:i,scale:"x",optional:!0},x2:{value:o,scale:"x",optional:!0}},MT(n,"y"),NT),this.insetRight=pr(c),this.insetLeft=pr(b),L2(this,n)}render(e,n,i,o,u){const{x:h,y:c}=n,{y:b,x1:w,x2:S}=i,{width:M,height:A,marginTop:P,marginRight:B,marginLeft:U,marginBottom:J}=o,{insetLeft:Q,insetRight:K}=this;return Ia("svg:g",u).call(Pc,this,o,u).call(zc,this,{y:b&&c},0,Ps).call(le=>le.selectAll().data(e).enter().append("line").call(Lc,this).attr("x1",w&&!mu(h)?ee=>w[ee]+Q:U+Q).attr("x2",S&&!mu(h)?h.bandwidth?ee=>S[ee]+h.bandwidth()-K:ee=>S[ee]-K:M-B-K).attr("y1",b?ee=>b[ee]:(P+A-J)/2).attr("y2",b?ee=>b[ee]:(P+A-J)/2).call(Oh,this,i).call(PT,this,i,u)).node()}}function RT(t,e){let{x:n=Ec,y:i,y1:o,y2:u,...h}=oj(e);return[o,u]=OT(i,o,u),new uj(t,{...h,x:n,y1:o,y2:u})}function u_(t,e){let{y:n=Ec,x:i,x1:o,x2:u,...h}=sj(e);return[o,u]=OT(i,o,u),new hj(t,{...h,y:n,x1:o,x2:u})}function OT(t,e,n){if(t==null){if(e===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,e]}else{if(e===void 0)return n===void 0?[0,t]:[t,n];if(n===void 0)return[t,e]}return[e,n]}function F2(t,...e){let n=e.length;for(let i=0,o=!0;i<n;++i)typeof e[i]!="function"&&(o&&(t=t.slice(),o=!1),t.splice(i,2,t[i]+e[i]+t[i+1]),e.splice(i,1),--i,--n);return i=>{let o=t[0];for(let u=0;u<n;++u)o+=e[u](i)+t[u+1];return o}}const dj={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},UT="­";class N2 extends co{constructor(e,n={}){const{x:i,y:o,text:u=Nh(e)&&JI(e)?Ec:CO,frameAnchor:h,textAnchor:c=/right$/i.test(h)?"end":/left$/i.test(h)?"start":"middle",lineAnchor:b=/^top/i.test(h)?"top":/^bottom/i.test(h)?"bottom":"middle",lineHeight:w=1,lineWidth:S=1/0,textOverflow:M,monospace:A,fontFamily:P=A?"ui-monospace, monospace":void 0,fontSize:B,fontStyle:U,fontVariant:J,fontWeight:Q,rotate:K}=n,[le,ee]=$a(K,0),[oe,Z]=yj(B);if(super(e,{x:{value:i,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},fontSize:{value:oe,optional:!0},rotate:{value:OO(le),optional:!0},text:{value:u,filter:f2,optional:!0}},n,dj),this.rotate=ee,this.textAnchor=xa(c,"middle"),this.lineAnchor=Go(b,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+w,this.lineWidth=+S,this.textOverflow=VT(M),this.monospace=!!A,this.fontFamily=Xa(P),this.fontSize=Z,this.fontStyle=Xa(U),this.fontVariant=Xa(J),this.fontWeight=Xa(Q),this.frameAnchor=Ig(h),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${S}`);this.splitLines=HT(this),this.clipLine=WT(this)}render(e,n,i,o,u){const{x:h,y:c}=n,{x:b,y:w,rotate:S,text:M,title:A,fontSize:P}=i,{rotate:B}=this,[U,J]=qm(this,o);return Ia("svg:g",u).call(Pc,this,o,u).call(qT,this,M,o).call(zc,this,{x:b&&h,y:w&&c}).call(Q=>Q.selectAll().data(e).enter().append("text").call(Lc,this).call(fj,this,M,A).attr("transform",F2`translate(${b?K=>b[K]:U},${w?K=>w[K]:J})${S?K=>` rotate(${S[K]})`:B?` rotate(${B})`:""}`).call(Cn,"font-size",P&&(K=>P[K])).call(Oh,this,i)).node()}}function VT(t){return t==null?null:Go(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function fj(t,e,n,i){if(!n)return;const{lineAnchor:o,lineHeight:u,textOverflow:h,splitLines:c,clipLine:b}=e;t.each(function(w){const S=c(Dh(n[w])??"").map(b),M=S.length,A=o==="top"?.71:o==="bottom"?1-M:(164-M*100)/200;if(M>1){let P=0;for(let B=0;B<M;++B){if(++P,!S[B])continue;const U=this.ownerDocument.createElementNS(Qd.svg,"tspan");U.setAttribute("x",0),B===P-1?U.setAttribute("y",`${(A+B)*u}em`):U.setAttribute("dy",`${P*u}em`),U.textContent=S[B],this.appendChild(U),P=0}}else A&&this.setAttribute("y",`${A*u}em`),this.textContent=S[0];if(h&&!i&&S[0]!==n[w]){const P=this.ownerDocument.createElementNS(Qd.svg,"title");P.textContent=n[w],this.appendChild(P)}})}function jT(t,{x:e,y:n,...i}={}){return i.frameAnchor===void 0&&([e,n]=vg(e,n)),new N2(t,{...i,x:e,y:n})}function pj(t,{x:e=Ec,...n}={}){return new N2(t,cj({...n,x:e}))}function mj(t,{y:e=Ec,...n}={}){return new N2(t,lj({...n,y:e}))}function qT(t,e,n){Cn(t,"text-anchor",e.textAnchor),Cn(t,"font-family",e.fontFamily),Cn(t,"font-size",e.fontSize),Cn(t,"font-style",e.fontStyle),Cn(t,"font-variant",e.fontVariant===void 0?_j(n):e.fontVariant),Cn(t,"font-weight",e.fontWeight)}function _j(t){return t&&(jO(t)||zl(t))?"tabular-nums":void 0}const gj=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function yj(t){return t==null||typeof t=="number"?[void 0,t]:typeof t!="string"?[t,void 0]:(t=t.trim().toLowerCase(),gj.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}function bj(t,e,n){const i=[];let o,u=0;for(const[h,c,b]of vj(t)){if(o===void 0&&(o=h),u>o&&n(t,o,c)>e&&(i.push(t.slice(o,u)+(t[u-1]===UT?"-":"")),o=h),b){i.push(t.slice(o,c)),o=void 0;continue}u=c}return i}function*vj(t){let e=0,n=0;const i=t.length;for(;n<i;){let o=1;switch(t[n]){case UT:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];t[++n]===" ";);e=n;break;case"\r":t[n+1]===`
`&&++o;case`
`:yield[e,n,!0],n+=o,e=n;break;default:++n;break}}yield[e,n,!0]}const E6={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function R2(t,e=0,n=t.length){let i=0;for(let o=e;o<n;o=wf(t,o))i+=E6[t[o]]??(GT(t,o)?120:E6.e);return i}function O2(t,e=0,n=t.length){let i=0;for(let o=e;o<n;o=wf(t,o))i+=GT(t,o)?126:63;return i}function HT({monospace:t,lineWidth:e,textOverflow:n}){if(n!=null||e==1/0)return u=>u.split(/\r\n?|\n/g);const i=t?O2:R2,o=e*100;return u=>bj(u,o,i)}function WT({monospace:t,lineWidth:e,textOverflow:n}){if(n==null||e==1/0)return u=>u;const i=t?O2:R2,o=e*100;switch(n){case"clip-start":return u=>P6(u,o,i,"");case"clip-end":return u=>D6(u,o,i,"");case"ellipsis-start":return u=>P6(u,o,i,qd);case"ellipsis-middle":return u=>xj(u,o,i,qd);case"ellipsis-end":return u=>D6(u,o,i,qd)}}const qd="…";function uf(t,e,n,i){const o=[];let u=0;for(let h=0,c=0,b=t.length;h<b;h=c){c=wf(t,h);const w=n(t,h,c);if(u+w>e){for(u+=i;u>e&&h>0;)c=h,h=o.pop(),u-=n(t,h,c);return[h,e-u]}u+=w,o.push(h)}return[-1,0]}function D6(t,e,n,i){t=t.trim();const o=n(i),[u]=uf(t,e,n,o);return u<0?t:t.slice(0,u).trimEnd()+i}function xj(t,e,n,i){t=t.trim();const o=n(t);if(o<=e)return t;const u=n(i)/2,[h,c]=uf(t,e/2,n,u),[b]=uf(t,o-e/2-c+u,n,-u);return b<0?i:t.slice(0,h).trimEnd()+i+t.slice(wf(t,b)).trimStart()}function P6(t,e,n,i){t=t.trim();const o=n(t);if(o<=e)return t;const u=n(i),[h]=uf(t,o-e+u,n,-u);return h<0?i:i+t.slice(wf(t,h)).trimStart()}const gv=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,L6=new RegExp("\\p{Extended_Pictographic}","uy");function wf(t,e){return e+=wj(t,e)?2:1,Ij(t,e)&&(e=gv.lastIndex),Sj(t,e)?wf(t,e+1):e}function ZT(t,e){return t.charCodeAt(e)<128}function wj(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const i=t.charCodeAt(e+1);return i>=56320&&i<57344}return!1}function Sj(t,e){return t.charCodeAt(e)===8205}function Ij(t,e){return ZT(t,e)?!1:(gv.lastIndex=e,gv.test(t))}function GT(t,e){return ZT(t,e)?!1:(L6.lastIndex=e,L6.test(t))}const Tj={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},YT=3.5,Mj=YT*5,JT={draw(t,e,n){const i=e*n/Mj;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-i,i-e),t.lineTo(0,-e),t.lineTo(i,i-e)}},Aj={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},Cj=new Map([["arrow",JT],["spike",Aj]]);function kj(t){return t&&typeof t.draw=="function"}function Ej(t){if(kj(t))return t;const e=Cj.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}let KT=class extends co{constructor(e,n={}){const{x:i,y:o,r:u=YT,length:h,rotate:c,shape:b=JT,anchor:w="middle",frameAnchor:S}=n,[M,A]=$a(h,12),[P,B]=$a(c,0);super(e,{x:{value:i,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},length:{value:M,scale:"length",optional:!0},rotate:{value:P,optional:!0}},n,Tj),this.r=+u,this.length=A,this.rotate=B,this.shape=Ej(b),this.anchor=Go(w,"anchor",["start","middle","end"]),this.frameAnchor=Ig(S)}render(e,n,i,o,u){const{x:h,y:c}=n,{x:b,y:w,length:S,rotate:M}=i,{length:A,rotate:P,anchor:B,shape:U,r:J}=this,[Q,K]=qm(this,o);return Ia("svg:g",u).call(Pc,this,o,u).call(zc,this,{x:b&&h,y:w&&c}).call(le=>le.selectAll().data(e).enter().append("path").call(Lc,this).attr("transform",F2`translate(${b?ee=>b[ee]:Q},${w?ee=>w[ee]:K})${M?ee=>` rotate(${M[ee]})`:P?` rotate(${P})`:""}${B==="start"?"":B==="end"?S?ee=>` translate(0,${S[ee]})`:` translate(0,${A})`:S?ee=>` translate(0,${S[ee]/2})`:` translate(0,${A/2})`}`).attr("d",S?ee=>{const oe=fh();return U.draw(oe,S[ee],J),oe}:(()=>{const ee=fh();return U.draw(ee,A,J),ee})()).call(Oh,this,i)).node()}};function Dj(t,e={}){const{x:n=Ec,...i}=e;return new KT(t,{...i,x:n})}function Pj(t,e={}){const{y:n=Ec,...i}=e;return new KT(t,{...i,y:n})}function zu(t,e){return arguments.length<2&&!Nh(t)&&(e=t,t=null),e===void 0&&(e={}),[t,e]}function Eg({anchor:t}={},e){return t===void 0?e[0]:Go(t,"anchor",e)}function XT(t){return Eg(t,["left","right"])}function QT(t){return Eg(t,["right","left"])}function $T(t){return Eg(t,["bottom","top"])}function eM(t){return Eg(t,["top","bottom"])}function o1(){const[t,e]=zu(...arguments);return nM("y",XT(e),t,e)}function Lj(){const[t,e]=zu(...arguments);return nM("fy",QT(e),t,e)}function tM(){const[t,e]=zu(...arguments);return iM("x",$T(e),t,e)}function zj(){const[t,e]=zu(...arguments);return iM("fx",eM(e),t,e)}function nM(t,e,n,{color:i="currentColor",opacity:o=1,stroke:u=i,strokeOpacity:h=o,strokeWidth:c=1,fill:b=i,fillOpacity:w=o,textAnchor:S,textStroke:M,textStrokeOpacity:A,textStrokeWidth:P,tickSize:B=t==="y"?6:0,tickPadding:U,tickRotate:J,x:Q,margin:K,marginTop:le=K===void 0?20:K,marginRight:ee=K===void 0?e==="right"?40:0:K,marginBottom:oe=K===void 0?20:K,marginLeft:Z=K===void 0?e==="left"?40:0:K,label:ne,labelAnchor:be,labelArrow:me,labelOffset:Te,...Y}){return B=pr(B),U=pr(U),J=pr(J),be!==void 0&&(be=Go(be,"labelAnchor",["center","top","bottom"])),me=hM(me),IT(B&&!us(u)?Bj(t,e,n,{stroke:u,strokeOpacity:h,strokeWidth:c,tickSize:B,tickPadding:U,tickRotate:J,x:Q,...Y}):null,us(b)?null:Nj(t,e,n,{fill:b,fillOpacity:w,stroke:M,strokeOpacity:A,strokeWidth:P,textAnchor:S,tickSize:B,tickPadding:U,tickRotate:J,x:Q,marginTop:le,marginRight:ee,marginBottom:oe,marginLeft:Z,...Y}),!us(b)&&ne!==null?jT([],oM({fill:b,fillOpacity:w,...Y},function(ye,qe,He,Be,lt){const Ge=Be[t],{marginTop:ot,marginRight:je,marginBottom:Ve,marginLeft:$e}=t==="y"&&lt.inset||lt,st=be??(Ge.bandwidth?"center":"top"),ct=Te??(e==="right"?je:$e)-3;return st==="center"?(this.textAnchor=void 0,this.lineAnchor=e==="right"?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor=e==="right"?"end":"start",this.lineAnchor=st,this.frameAnchor=`${st}-${e}`,this.rotate=0),this.dy=st==="top"?3-ot:st==="bottom"?Ve-3:0,this.dx=e==="right"?ct:-ct,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[uM(t,Ge,{anchor:e,label:ne,labelAnchor:st,labelArrow:me})]}}}})):null)}function iM(t,e,n,{color:i="currentColor",opacity:o=1,stroke:u=i,strokeOpacity:h=o,strokeWidth:c=1,fill:b=i,fillOpacity:w=o,textAnchor:S,textStroke:M,textStrokeOpacity:A,textStrokeWidth:P,tickSize:B=t==="x"?6:0,tickPadding:U,tickRotate:J,y:Q,margin:K,marginTop:le=K===void 0?e==="top"?30:0:K,marginRight:ee=K===void 0?20:K,marginBottom:oe=K===void 0?e==="bottom"?30:0:K,marginLeft:Z=K===void 0?20:K,label:ne,labelAnchor:be,labelArrow:me,labelOffset:Te,...Y}){return B=pr(B),U=pr(U),J=pr(J),be!==void 0&&(be=Go(be,"labelAnchor",["center","left","right"])),me=hM(me),IT(B&&!us(u)?Fj(t,e,n,{stroke:u,strokeOpacity:h,strokeWidth:c,tickSize:B,tickPadding:U,tickRotate:J,y:Q,...Y}):null,us(b)?null:Rj(t,e,n,{fill:b,fillOpacity:w,stroke:M,strokeOpacity:A,strokeWidth:P,textAnchor:S,tickSize:B,tickPadding:U,tickRotate:J,y:Q,marginTop:le,marginRight:ee,marginBottom:oe,marginLeft:Z,...Y}),!us(b)&&ne!==null?jT([],oM({fill:b,fillOpacity:w,...Y},function(ye,qe,He,Be,lt){const Ge=Be[t],{marginTop:ot,marginRight:je,marginBottom:Ve,marginLeft:$e}=t==="x"&&lt.inset||lt,st=be??(Ge.bandwidth?"center":"right"),ct=Te??(e==="top"?ot:Ve)-3;return st==="center"?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${st}`,this.textAnchor=st==="right"?"end":"start"),this.lineAnchor=e,this.dy=e==="top"?-ct:ct,this.dx=st==="right"?je-3:st==="left"?3-$e:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[uM(t,Ge,{anchor:e,label:ne,labelAnchor:st,labelArrow:me})]}}}})):null)}function Bj(t,e,n,{strokeWidth:i=1,strokeLinecap:o=null,strokeLinejoin:u=null,facetAnchor:h=e+(t==="y"?"-empty":""),frameAnchor:c=e,tickSize:b,inset:w=0,insetLeft:S=w,insetRight:M=w,dx:A=0,y:P=t==="y"?void 0:null,...B}){return Sf(Pj,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:i,strokeLinecap:o,strokeLinejoin:u,facetAnchor:h,frameAnchor:c,y:P,...B,dx:e==="left"?+A-Ps+ +S:+A+Ps-M,anchor:"start",length:b,shape:e==="left"?Zj:Gj})}function Fj(t,e,n,{strokeWidth:i=1,strokeLinecap:o=null,strokeLinejoin:u=null,facetAnchor:h=e+(t==="x"?"-empty":""),frameAnchor:c=e,tickSize:b,inset:w=0,insetTop:S=w,insetBottom:M=w,dy:A=0,x:P=t==="x"?void 0:null,...B}){return Sf(Dj,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:i,strokeLinejoin:u,strokeLinecap:o,facetAnchor:h,frameAnchor:c,x:P,...B,dy:e==="bottom"?+A-Ps-M:+A+Ps+ +S,anchor:"start",length:b,shape:e==="bottom"?Hj:Wj})}function Nj(t,e,n,{facetAnchor:i=e+(t==="y"?"-empty":""),frameAnchor:o=e,tickSize:u,tickRotate:h=0,tickPadding:c=Math.max(3,9-u)+(Math.abs(h)>60?4*Math.cos(h*DT):0),text:b,textAnchor:w=Math.abs(h)>60?"middle":e==="left"?"end":"start",lineAnchor:S=h>60?"top":h<-60?"bottom":"middle",fontVariant:M,inset:A=0,insetLeft:P=A,insetRight:B=A,dx:U=0,y:J=t==="y"?void 0:null,...Q}){return Sf(mj,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:i,frameAnchor:o,text:b,textAnchor:w,lineAnchor:S,fontVariant:M,rotate:h,y:J,...Q,dx:e==="left"?+U-u-c+ +P:+U+ +u+ +c-B},function(K,le,ee,oe,Z){M===void 0&&(this.fontVariant=cM(K)),b===void 0&&(Z.text=lM(K,le,ee,oe,e))})}function Rj(t,e,n,{facetAnchor:i=e+(t==="x"?"-empty":""),frameAnchor:o=e,tickSize:u,tickRotate:h=0,tickPadding:c=Math.max(3,9-u)+(Math.abs(h)>=10?4*Math.cos(h*DT):0),text:b,textAnchor:w=Math.abs(h)>=10?h<0^e==="bottom"?"start":"end":"middle",lineAnchor:S=Math.abs(h)>=10?"middle":e==="bottom"?"top":"bottom",fontVariant:M,inset:A=0,insetTop:P=A,insetBottom:B=A,dy:U=0,x:J=t==="x"?void 0:null,...Q}){return Sf(pj,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:i,frameAnchor:o,text:b===void 0?null:b,textAnchor:w,lineAnchor:S,fontVariant:M,rotate:h,x:J,...Q,dy:e==="bottom"?+U+ +u+ +c-B:+U-u-c+ +P},function(K,le,ee,oe,Z){M===void 0&&(this.fontVariant=cM(K)),b===void 0&&(Z.text=lM(K,le,ee,oe,e))})}function Oj(){const[t,e]=zu(...arguments);return rM("y",XT(e),t,e)}function Uj(){const[t,e]=zu(...arguments);return rM("fy",QT(e),t,e)}function Vj(){const[t,e]=zu(...arguments);return aM("x",$T(e),t,e)}function jj(){const[t,e]=zu(...arguments);return aM("fx",eM(e),t,e)}function rM(t,e,n,{y:i=t==="y"?void 0:null,x:o=null,x1:u=e==="left"?o:null,x2:h=e==="right"?o:null,...c}){return Sf(u_,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{y:i,x1:u,x2:h,...sM(c)})}function aM(t,e,n,{x:i=t==="x"?void 0:null,y:o=null,y1:u=e==="top"?o:null,y2:h=e==="bottom"?o:null,...c}){return Sf(RT,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{x:i,y1:u,y2:h,...sM(c)})}function sM({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:i=e,strokeWidth:o=1,...u}){return{stroke:n,strokeOpacity:i,strokeWidth:o,...u}}function oM({fill:t,fillOpacity:e,fontFamily:n,fontSize:i,fontStyle:o,fontVariant:u,fontWeight:h,monospace:c,pointerEvents:b,shapeRendering:w,clip:S=!1},M){return[,t]=Eh(t),[,e]=$a(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:i,fontStyle:o,fontVariant:u,fontWeight:h,monospace:c,pointerEvents:b,shapeRendering:w,clip:S,initializer:M}}function Sf(t,e,n,i,o,u){let h;function c(S,M,A,P,B,U){const J=S==null&&(e==="fx"||e==="fy"),{[e]:Q}=P;if(!Q)throw new Error(`missing scale: ${e}`);const K=Q.domain();let{interval:le,ticks:ee,tickFormat:oe,tickSpacing:Z=e==="x"?80:35}=o;if(typeof ee=="string"&&dM(Q)&&(le=ee,ee=void 0),ee===void 0&&(ee=Nm(le,Q.type)??qj(Q,Z)),S==null){if(Nh(ee))S=Ns(ee);else if(RO(ee))S=cb(ee,...yu(K));else if(Q.interval){let be=Q.interval;if(Q.ticks){const[me,Te]=yu(K),Y=(Te-me)/be[zm];be=t6(be,Y/ee)??be,S=cb(be,me,Te)}else{S=K;const me=S.length;be=t6(be,me/ee)??be,be!==Q.interval&&(S=cb(be,...yu(S)))}if(be===Q.interval){const me=Math.round(S.length/ee);me>1&&(S=S.filter((Te,Y)=>Y%me===0))}}else Q.ticks?S=Q.ticks(ee):S=K;if(!Q.ticks&&S.length&&S!==K){const be=new Y1(K);S=S.filter(me=>be.has(me)),S.length||bu(`Warning: the ${e}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}e==="y"||e==="x"?M=[Fm(S)]:h[e]={scale:e,value:Ec}}u==null||u.call(this,Q,S,ee,oe,h);const ne=Object.fromEntries(Object.entries(h).map(([be,me])=>[be,{...me,value:Au(S,me.value)}]));return J&&(M=U.filterFacets(S,ne)),{data:S,facets:M,channels:ne}}const b=cf(o).initializer,w=t(n,cf({...o,initializer:c},b));return n==null?(h=w.channels,w.channels={}):h={},i!==void 0&&Object.assign(w,i),w.clip===void 0&&(w.clip=!1),w}function qj(t,e){const[n,i]=yu(t.range());return(i-n)/e}function lM(t,e,n,i,o){return{value:U2(t,e,n,i,o)}}function U2(t,e,n,i,o){return typeof i=="function"?i:i===void 0&&e&&zl(e)?wO(t.type,e,o)??Dh:t.tickFormat?t.tickFormat(typeof n=="number"?n:null,i):i===void 0?Dh:typeof i=="string"?(zl(t.domain())?Lm:xf)(i):Bm(i)}function cb(t,e,n){return t.range(e,t.offset(t.floor(n)))}const Hj={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},Wj={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},Zj={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},Gj={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function cM(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function uM(t,e,{anchor:n,label:i=e.label,labelAnchor:o,labelArrow:u}={}){if(!(i==null||i.inferred&&dM(e)&&/^(date|time|year)$/i.test(i))){if(i=String(i),u==="auto"&&(u=(!e.bandwidth||e.interval)&&!/[↑↓→←]/.test(i)),!u)return i;if(u===!0){const h=uV(e);h&&(u=/x$/.test(t)||o==="center"?/x$/.test(t)===h<0?"left":"right":h<0?"up":"down")}switch(u){case"left":return`← ${i}`;case"right":return`${i} →`;case"up":return n==="right"?`${i} ↑`:`↑ ${i}`;case"down":return n==="right"?`${i} ↓`:`↓ ${i}`}return i}}function hM(t="auto"){return us(t)?!1:typeof t=="boolean"?t:Go(t,"labelArrow",["auto","up","right","down","left"])}function dM(t){return zl(t.domain())}function z6(t,e){if(e==null)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function Yj(t,{opacity:e,...n}={}){if(!Rh(t)&&!wT(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return fM(t,n,(i,o,u,h)=>i.append("svg").attr("width",u).attr("height",h).attr("fill",o.scale).attr("fill-opacity",$a(e)[1]).append("rect").attr("width","100%").attr("height","100%"))}function Jj(t,{fill:e=(w=>(w=t.hint)==null?void 0:w.fill)()!==void 0?t.hint.fill:"none",fillOpacity:n=1,stroke:i=(S=>(S=t.hint)==null?void 0:S.stroke)()!==void 0?t.hint.stroke:us(e)?"currentColor":"none",strokeOpacity:o=1,strokeWidth:u=1.5,r:h=4.5,...c}={},b){const[M,A]=Eh(e),[P,B]=Eh(i),U=z6(b,M),J=z6(b,P),Q=h*h*Math.PI;return n=$a(n)[1],o=$a(o)[1],u=$a(u)[1],fM(t,c,(K,le,ee,oe)=>K.append("svg").attr("viewBox","-8 -8 16 16").attr("width",ee).attr("height",oe).attr("fill",M==="color"?Z=>U.scale(Z):A).attr("fill-opacity",n).attr("stroke",P==="color"?Z=>J.scale(Z):B).attr("stroke-opacity",o).attr("stroke-width",u).append("path").attr("d",Z=>{const ne=fh();return t.scale(Z).draw(ne,Q),ne}))}function fM(t,e={},n){let{columns:i,tickFormat:o,fontVariant:u=ET(t),swatchSize:h=15,swatchWidth:c=h,swatchHeight:b=h,marginLeft:w=0,className:S,style:M,width:A}=e;const P=I2(e);S=k2(S),o=U2(t.scale,t.domain,void 0,o);const B=Ia("div",P).attr("class",`${S}-swatches ${S}-swatches-${i!=null?"columns":"wrap"}`);let U;return i!=null?(U=`:where(.${S}-swatches-columns .${S}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${S}-swatches-columns .${S}-swatch::before) {
  flex-shrink: 0;
}
:where(.${S}-swatches-columns .${S}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,B.style("columns",i).selectAll().data(t.domain).enter().append("div").attr("class",`${S}-swatch`).call(n,t,c,b).call(J=>J.append("div").attr("class",`${S}-swatch-label`).attr("title",o).text(o))):(U=`:where(.${S}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${S}-swatches-wrap .${S}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,B.selectAll().data(t.domain).enter().append("span").attr("class",`${S}-swatch`).call(n,t,c,b).append(function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))})),B.call(J=>J.insert("style","*").text(`:where(.${S}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${S}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${U}`)).style("margin-left",w?`${+w}px`:null).style("width",A===void 0?null:`${+A}px`).style("font-variant",xa(u,"normal")).call(E2,M).node()}const yv=new Map([["symbol",Jj],["color",mM],["opacity",Xj]]);function Kj(t,e,n={}){return(i,o)=>{if(!yv.has(i))throw new Error(`unknown legend type: ${i}`);if(i in t)return yv.get(i)(t[i],pM(e,n[i],o),u=>t[u])}}function pM({className:t,...e},{label:n,ticks:i,tickFormat:o}={},u){return ZO(u,{className:t,...e},{label:n,ticks:i,tickFormat:o})}function mM(t,{legend:e=!0,...n}){if(e===!0&&(e=t.type==="ordinal"?"swatches":"ramp"),t.domain!==void 0)switch(`${e}`.toLowerCase()){case"swatches":return Yj(t,n);case"ramp":return $V(t,n);default:throw new Error(`unknown legend type: ${e}`)}}function Xj({type:t,interpolate:e,...n},{legend:i=!0,color:o=Iu(0,0,0),...u}){if(!e)throw new Error(`${t} opacity scales are not supported`);if(i===!0&&(i="ramp"),`${i}`.toLowerCase()!=="ramp")throw new Error(`${i} opacity legends are not supported`);return mM({type:t,...n,interpolate:Qj(o)},{legend:i,...u})}function Qj(t){const{r:e,g:n,b:i}=Iu(t)||Iu(0,0,0);return o=>`rgba(${e},${n},${i},${o})`}function $j(t,e,n){const i=[];for(const[o,u]of yv){const h=n[o];if(h!=null&&h.legend&&o in t){const c=u(t[o],pM(e,t[o],h),b=>t[b]);c!=null&&i.push(c)}}return i}const eq={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},tq={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class nq extends co{constructor(e={}){const{anchor:n=null,inset:i=0,insetTop:o=i,insetRight:u=i,insetBottom:h=i,insetLeft:c=i,rx:b,ry:w}=e;super(c_,void 0,e,n==null?eq:tq),this.anchor=YI(n,"anchor",["top","right","bottom","left"]),this.insetTop=pr(o),this.insetRight=pr(u),this.insetBottom=pr(h),this.insetLeft=pr(c),this.rx=pr(b),this.ry=pr(w)}render(e,n,i,o,u){const{marginTop:h,marginRight:c,marginBottom:b,marginLeft:w,width:S,height:M}=o,{anchor:A,insetTop:P,insetRight:B,insetBottom:U,insetLeft:J,rx:Q,ry:K}=this,le=w+J,ee=S-c-B,oe=h+P,Z=M-b-U;return Ia(A?"svg:line":"svg:rect",u).datum(0).call(Pc,this,o,u).call(Lc,this).call(Oh,this,i).call(zc,this,{}).call(A==="left"?ne=>ne.attr("x1",le).attr("x2",le).attr("y1",oe).attr("y2",Z):A==="right"?ne=>ne.attr("x1",ee).attr("x2",ee).attr("y1",oe).attr("y2",Z):A==="top"?ne=>ne.attr("x1",le).attr("x2",ee).attr("y1",oe).attr("y2",oe):A==="bottom"?ne=>ne.attr("x1",le).attr("x2",ee).attr("y1",Z).attr("y2",Z):ne=>ne.attr("x",le).attr("y",oe).attr("width",ee-le).attr("height",Z-oe).attr("rx",Q).attr("ry",K)).node()}}function iq(t){return new nq(t)}const ub={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},rq=new Set(["geometry","href","src","ariaLabel","scales"]);class aq extends co{constructor(e,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&Nh(e)&&JI(e)&&(n={...n,title:Ec});const{x:i,y:o,x1:u,x2:h,y1:c,y2:b,anchor:w,preferredAnchor:S="bottom",monospace:M,fontFamily:A=M?"ui-monospace, monospace":void 0,fontSize:P,fontStyle:B,fontVariant:U,fontWeight:J,lineHeight:Q=1,lineWidth:K=20,frameAnchor:le,format:ee,textAnchor:oe="start",textOverflow:Z,textPadding:ne=8,title:be,pointerSize:me=12,pathFilter:Te="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(e,{x:{value:u!=null&&h!=null?null:i,scale:"x",optional:!0},y:{value:c!=null&&b!=null?null:o,scale:"y",optional:!0},x1:{value:u,scale:"x",optional:h==null},y1:{value:c,scale:"y",optional:b==null},x2:{value:h,scale:"x",optional:u==null},y2:{value:b,scale:"y",optional:c==null},title:{value:be,optional:!0}},n,ub),this.anchor=hv(w,"anchor"),this.preferredAnchor=hv(S,"preferredAnchor"),this.frameAnchor=Ig(le),this.textAnchor=xa(oe,"middle"),this.textPadding=+ne,this.pointerSize=+me,this.pathFilter=Xa(Te),this.lineHeight=+Q,this.lineWidth=+K,this.textOverflow=VT(Z),this.monospace=!!M,this.fontFamily=Xa(A),this.fontSize=pr(P),this.fontStyle=Xa(B),this.fontVariant=Xa(U),this.fontWeight=Xa(J);for(const Y in ub)Y in this.channels&&(this[Y]=ub[Y]);this.splitLines=HT(this),this.clipLine=WT(this),this.format={...ee}}render(e,n,i,o,u){const h=this,{x:c,y:b,fx:w,fy:S}=n,{ownerSVGElement:M,document:A}=u,{anchor:P,monospace:B,lineHeight:U,lineWidth:J}=this,{textPadding:Q,pointerSize:K,pathFilter:le}=this,{marginTop:ee,marginLeft:oe}=o,{x1:Z,y1:ne,x2:be,y2:me,x:Te=Z??be,y:Y=ne??me}=i,ye=w?w(e.fx)-oe:0,qe=S?S(e.fy)-ee:0,[He,Be]=qm(this,o),lt=CT(i,He),Ge=kT(i,Be),ot=B?O2:R2,je=ot(qd);let Ve,$e;"title"in i?(Ve=i.channels,$e=hq):(Ve=uq.call(this,i,n),$e=dq);const st=Ia("svg:g",u).call(Pc,this,o,u).call(qT,this).call(zc,this,{x:Te&&c,y:Y&&b}).call(Ut=>Ut.selectAll().data(e).enter().append("g").attr("transform",Lt=>`translate(${Math.round(lt(Lt))},${Math.round(Ge(Lt))})`).call(Lc,this).call(Lt=>Lt.append("path").attr("filter",le)).call(Lt=>Lt.append("text").each(function(gt){const Bt=Hp(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const tt=$e.call(h,gt,e,Ve,n,i);if(typeof tt=="string")for(const Le of h.splitLines(tt))ct(Bt,{value:h.clipLine(Le)});else{const Le=new Set;for(const ut of tt){const{label:Re=""}=ut;Re&&Le.has(Re)||(Le.add(Re),ct(Bt,ut))}}})));function ct(Ut,{label:Lt,value:gt,color:Bt,opacity:tt}){Lt??(Lt=""),gt??(gt="");const Le=Bt!=null||tt!=null;let ut,Re=J*100;const[Ke]=uf(Lt,Re,ot,je);if(Ke>=0)Lt=Lt.slice(0,Ke).trimEnd()+qd,ut=gt.trim(),gt="";else{(Lt||!gt&&!Le)&&(gt=" "+gt);const[wt]=uf(gt,Re-ot(Lt),ot,je);wt>=0&&(ut=gt.trim(),gt=gt.slice(0,wt).trimEnd()+qd)}const Ee=Ut.append("tspan").attr("x",0).attr("dy",`${U}em`).text("​");Lt&&Ee.append("tspan").attr("font-weight","bold").text(Lt),gt&&Ee.append(()=>A.createTextNode(gt)),Le&&Ee.append("tspan").text(" ■").attr("fill",Bt).attr("fill-opacity",tt).style("user-select","none"),ut&&Ee.append("title").text(ut)}function Pt(){const{width:Ut,height:Lt}=o.facet??o;st.selectChildren().each(function(gt){let{x:Bt,width:tt,height:Le}=this.getBBox();tt=Math.round(tt),Le=Math.round(Le);let ut=P;if(ut===void 0){const Ee=lt(gt)+ye,wt=Ge(gt)+qe,De=Ee+tt+K+Q*2<Ut,wn=Ee-tt-K-Q*2>0,Wn=wt+Le+K+Q*2<Lt,on=wt-Le-K-Q*2>0;ut=De&&wn?Wn&&on?h.preferredAnchor:on?"bottom":"top":Wn&&on?De?"left":"right":(De||wn)&&(Wn||on)?`${on?"bottom":"top"}-${De?"left":"right"}`:h.preferredAnchor}const Re=this.firstChild,Ke=this.lastChild;if(Re.setAttribute("d",cq(ut,K,Q,tt,Le)),Bt)for(const Ee of Ke.childNodes)Ee.setAttribute("x",-Bt);Ke.setAttribute("y",`${+oq(ut,Ke.childNodes.length,U).toFixed(6)}em`),Ke.setAttribute("transform",`translate(${lq(ut,K,Q,tt,Le)})`)}),st.attr("visibility",null)}return e.length&&(st.attr("visibility","hidden"),M.isConnected?Promise.resolve().then(Pt):typeof requestAnimationFrame<"u"&&requestAnimationFrame(Pt)),st.node()}}function sq(t,{x:e,y:n,...i}={}){return i.frameAnchor===void 0&&([e,n]=vg(e,n)),new aq(t,{...i,x:e,y:n})}function oq(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}function lq(t,e,n,i,o){switch(t){case"middle":return[-i/2,o/2];case"top-left":return[n,e+n];case"top":return[-i/2,e/2+n];case"top-right":return[-i-n,e+n];case"right":return[-e/2-i-n,o/2];case"bottom-left":return[n,-e-n];case"bottom":return[-i/2,-e/2-n];case"bottom-right":return[-i-n,-e-n];case"left":return[n+e/2,o/2]}}function cq(t,e,n,i,o){const u=i+n*2,h=o+n*2;switch(t){case"middle":return`M${-u/2},${-h/2}h${u}v${h}h${-u}z`;case"top-left":return`M0,0l${e},${e}h${u-e}v${h}h${-u}z`;case"top":return`M0,0l${e/2},${e/2}h${(u-e)/2}v${h}h${-u}v${-h}h${(u-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-u}v${h}h${u}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-h/2}h${-u}v${h}h${u}v${e/2-h/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${u-e}v${-h}h${-u}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(u-e)/2}v${-h}h${-u}v${h}h${(u-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-u}v${-h}h${u}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-h/2}h${u}v${h}h${-u}v${e/2-h/2}z`}}function uq({channels:t},e){var o,u;const n={};let i=this.format;i=B6(i,t,"x"),i=B6(i,t,"y"),this.format=i;for(const h in i){const c=i[h];if(!(c===null||c===!1))if(h==="fx"||h==="fy")n[h]=!0;else{const b=u6(t,h);b&&(n[h]=b)}}for(const h in t){if(h in n||h in i||rq.has(h))continue;const c=u6(t,h);c&&(n[h]=c)}this.facet&&(e.fx&&!("fx"in i)&&(n.fx=!0),e.fy&&!("fy"in i)&&(n.fy=!0));for(const h in n){const c=this.format[h];if(typeof c=="string"){const b=((o=n[h])==null?void 0:o.value)??((u=e[h])==null?void 0:u.domain())??[];this.format[h]=(zl(b)?Lm:xf)(c)}else if(c===void 0||c===!0){const b=e[h];this.format[h]=b!=null&&b.bandwidth?U2(b,b.domain()):Dh}}return n}function B6(t,e,n){if(!(n in t))return t;const i=`${n}1`,o=`${n}2`;if((i in t||!(i in e))&&(o in t||!(o in e)))return t;const u=Object.entries(t),h=t[n];return u.splice(u.findIndex(([c])=>c===n)+1,0,[i,h],[o,h]),Object.fromEntries(u)}function hq(t,e,{title:n}){return Dh(n.value[t],t)}function*dq(t,e,n,i,o){for(const u in n){if(u==="fx"||u==="fy"){yield{label:l1(i,n,u),value:this.format[u](e[u],t)};continue}if(u==="x1"&&"x2"in n||u==="y1"&&"y2"in n)continue;const h=n[u];if(u==="x2"&&"x1"in n)yield{label:N6(i,n,"x"),value:F6(this.format.x2,n.x1,h,t)};else if(u==="y2"&&"y1"in n)yield{label:N6(i,n,"y"),value:F6(this.format.y2,n.y1,h,t)};else{const c=h.value[t],b=h.scale;if(!Mu(c)&&b==null)continue;yield{label:l1(i,n,u),value:this.format[u](c,t),color:b==="color"?o[u][t]:null,opacity:b==="opacity"?o[u][t]:null}}}}function F6(t,e,n,i){var o;return(o=n.hint)!=null&&o.length?`${t(n.value[i]-e.value[i],i)}`:`${t(e.value[i],i)}–${t(n.value[i],i)}`}function N6(t,e,n){const i=l1(t,e,`${n}1`,n),o=l1(t,e,`${n}2`,n);return i===o?i:`${i}–${o}`}function l1(t,e,n,i=n){const o=e[n],u=t[(o==null?void 0:o.scale)??n];return String((u==null?void 0:u.label)??(o==null?void 0:o.label)??i)}function h_(t={}){var je;const{facet:e,style:n,title:i,subtitle:o,caption:u,ariaLabel:h,ariaDescription:c}=t,b=k2(t.className),w=t.marks===void 0?[]:O6(t.marks);w.push(...vq(w));const S=yq(e,t),M=new Map;for(const Ve of w){const $e=U6(Ve,S,t);$e&&M.set(Ve,$e)}const A=new Map;S&&xp(A,[S],t),xp(A,M,t);const P=O6(xq(w,A,t));for(const Ve of P){const $e=U6(Ve,S,t);$e&&M.set(Ve,$e)}w.unshift(...P);let B=RV(A,t);if(B!==void 0){const Ve=S?sb(B,S):void 0;for(const st of w){if(st.facet===null||st.facet==="super")continue;const ct=M.get(st);ct!==void 0&&(ct.facetsIndex=st.fx!=null||st.fy!=null?sb(B,ct):Ve)}const $e=new Set;for(const{facetsIndex:st}of M.values())st==null||st.forEach((ct,Pt)=>{(ct==null?void 0:ct.length)>0&&$e.add(Pt)});B.forEach(0<$e.size&&$e.size<B.length?(st,ct)=>st.empty=!$e.has(ct):st=>st.empty=!1);for(const st of w)if(st.facet==="exclude"){const ct=M.get(st);ct!==void 0&&(ct.facetsIndex=VV(ct.facetsIndex))}}for(const Ve of _r.keys())uv(t[Ve])&&Ve!=="fx"&&Ve!=="fy"&&A.set(Ve,[]);const U=new Map;for(const Ve of w){if(U.has(Ve))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:$e,channels:st}=M.get(Ve)??{},{data:ct,facets:Pt,channels:Ut}=Ve.initialize($e,st,t);V2(Ut,t),U.set(Ve,{data:ct,facets:Pt,channels:Ut})}const J=mv(xp(A,U,t),t),Q=FV(J,w,t);lV(J,Q);const K=y6(J),{fx:le,fy:ee}=K,oe=le||ee?bT(J,Q):Q,Z=le||ee?Cq(K,Q):Q,ne=I2(t),be=ne.document,me=$1("svg").call(be.documentElement);let Te=me;ne.ownerSVGElement=me,ne.className=b,ne.projection=xU(t,oe),ne.filterFacets=(Ve,$e)=>sb(B,{channels:$e,groups:D2(Ve,$e)}),ne.getMarkState=Ve=>{const $e=U.get(Ve),st=M.get(Ve);return{...$e,channels:{...$e.channels,...st==null?void 0:st.channels}}},ne.dispatchValue=Ve=>{Te.value!==Ve&&(Te.value=Ve,Te.dispatchEvent(new Event("input",{bubbles:!0})))};const Y=new Set;for(const[Ve,$e]of U)if(Ve.initializer!=null){const st=Ve.facet==="super"?Z:oe,ct=Ve.initializer($e.data,$e.facets,$e.channels,K,st,ne);if(ct.data!==void 0&&($e.data=ct.data),ct.facets!==void 0&&($e.facets=ct.facets),ct.channels!==void 0){const{fx:Pt,fy:Ut,...Lt}=ct.channels;gq(Lt),Object.assign($e.channels,Lt);for(const gt of Object.values(Lt)){const{scale:Bt}=gt;Bt!=null&&!YO(_r.get(Bt))&&(_M(gt,t),Y.add(Bt))}(Pt!=null||Ut!=null)&&M.set(Ve,!0)}}if(Y.size){const Ve=new Map;xp(Ve,U,t,Pt=>Y.has(Pt)),xp(A,U,t,Pt=>Y.has(Pt));const $e=Aq(mv(Ve,t),J),{scales:st,...ct}=y6($e);Object.assign(J,$e),Object.assign(K,ct),Object.assign(K.scales,st)}let ye,qe;B!==void 0&&(ye={x:le==null?void 0:le.domain(),y:ee==null?void 0:ee.domain()},B=OV(B,ye),qe=UV(le,ee,Q));for(const[Ve,$e]of U)$e.values=Ve.scale($e.channels,K,ne);const{width:He,height:Be}=Q;Hp(me).attr("class",b).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",He).attr("height",Be).attr("viewBox",`0 0 ${He} ${Be}`).attr("aria-label",h).attr("aria-description",c).call(Ve=>Ve.append("style").text(`:where(.${b}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${b} text),
:where(.${b} tspan) {
  white-space: pre;
}`)).call(E2,n);for(const Ve of w){const{channels:$e,values:st,facets:ct}=U.get(Ve);if(B===void 0||Ve.facet==="super"){let Pt=null;if(ct&&(Pt=ct[0],Pt=Ve.filter(Pt,$e,st),Pt.length===0))continue;const Ut=Ve.render(Pt,K,st,Z,ne);if(Ut==null)continue;me.appendChild(Ut)}else{let Pt;for(const Ut of B){if(!(((je=Ve.facetAnchor)==null?void 0:je.call(Ve,B,ye,Ut))??!Ut.empty))continue;let Lt=null;if(ct){const Bt=M.has(Ve);if(Lt=ct[Bt?Ut.i:0],Lt=Ve.filter(Lt,$e,st),Lt.length===0)continue;!Bt&&Lt===ct[0]&&(Lt=BO(Lt)),Lt.fx=Ut.x,Lt.fy=Ut.y,Lt.fi=Ut.i}const gt=Ve.render(Lt,K,st,oe,ne);if(gt!=null){(Pt??(Pt=Hp(me).append("g"))).append(()=>gt).datum(Ut);for(const Bt of["aria-label","aria-description","aria-hidden","transform"])gt.hasAttribute(Bt)&&(Pt.attr(Bt,gt.getAttribute(Bt)),gt.removeAttribute(Bt))}}Pt==null||Pt.selectChildren().attr("transform",qe)}}const lt=$j(J,ne,t),{figure:Ge=i!=null||o!=null||u!=null||lt.length>0}=t;Ge&&(Te=be.createElement("figure"),Te.className=`${b}-figure`,Te.style.maxWidth="initial",i!=null&&Te.append(R6(be,i,"h2")),o!=null&&Te.append(R6(be,o,"h3")),Te.append(...lt,me),u!=null&&Te.append(fq(be,u))),Te.scale=_V(K.scales),Te.legend=Kj(J,ne,t);const ot=vU();return ot>0&&Hp(me).append("text").attr("x",He).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${ot.toLocaleString("en-US")} warning${ot===1?"":"s"}. Please check the console.`),Te}function R6(t,e,n){if(e.ownerDocument)return e;const i=t.createElement(n);return i.append(e),i}function fq(t,e){const n=t.createElement("figcaption");return n.append(e),n}function pq({marks:t=[],...e}={}){return h_({...e,marks:[...t,this]})}co.prototype.plot=pq;function O6(t){return t.flat(1/0).filter(e=>e!=null).map(mq)}function mq(t){return typeof t.render=="function"?t:new _q(t)}class _q extends co{constructor(e){if(typeof e!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=e}render(){}}function V2(t,e){for(const n in t)_M(t[n],e);return t}function _M(t,e){const{scale:n,transform:i=!0}=t;if(n==null||!i)return;const{type:o,percent:u,interval:h,transform:c=u?b=>b*100:FO(h,o)}=e[n]??{};c!=null&&(t.value=ts(t.value,c),t.transform=!1)}function gq(t){for(const e in t)nT(e,t[e])}function xp(t,e,n,i=kO){var o,u;for(const{channels:h}of e.values())for(const c in h){const b=h[c],{scale:w}=b;if(w!=null&&i(w))if(w==="projection"){if(!TU(n)){const S=((o=n.x)==null?void 0:o.domain)===void 0,M=((u=n.y)==null?void 0:u.domain)===void 0;if(S||M){const[A,P]=AU(b);S&&hb(t,"x",A),M&&hb(t,"y",P)}}}else hb(t,w,b)}return t}function hb(t,e,n){const i=t.get(e);i!==void 0?i.push(n):t.set(e,[n])}function yq(t,e){if(t==null)return;const{x:n,y:i}=t;if(n==null&&i==null)return;const o=Ns(t.data);if(o==null)throw new Error("missing facet data");const u={};n!=null&&(u.fx=sm(o,{value:n,scale:"fx"})),i!=null&&(u.fy=sm(o,{value:i,scale:"fy"})),V2(u,e);const h=D2(o,u);return{channels:u,groups:h,data:t.data}}function U6(t,e,n){var b;if(t.facet===null||t.facet==="super")return;const{fx:i,fy:o}=t;if(i!=null||o!=null){const w=Ns(t.data??i??o);if(w===void 0)throw new Error(`missing facet data in ${t.ariaLabel}`);if(w===null)return;const S={};return i!=null&&(S.fx=sm(w,{value:i,scale:"fx"})),o!=null&&(S.fy=sm(w,{value:o,scale:"fy"})),V2(S,n),{channels:S,groups:D2(w,S)}}if(e===void 0)return;const{channels:u,groups:h,data:c}=e;if(t.facet!=="auto"||t.data===c)return{channels:u,groups:h};c.length>0&&(h.size>1||h.size===1&&u.fx&&u.fy&&[...h][0][1].size>1)&&((b=Ns(t.data))==null?void 0:b.length)===c.length&&bu(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function bq(t,e={}){return cf({...e,x:null,y:null},(n,i,o,u,h,c)=>c.getMarkState(t))}function vq(t){const e=[];for(const n of t){let i=n.tip;if(i){i===!0?i={}:typeof i=="string"&&(i={pointer:i});let{pointer:o,preferredAnchor:u}=i;o=/^x$/i.test(o)?AT:/^y$/i.test(o)?A6:QV,i=o(bq(n,i)),i.title=null,u===void 0&&(i.preferredAnchor=o===A6?"left":"bottom");const h=sq(n.data,i);h.facet=n.facet,h.facetAnchor=n.facetAnchor,e.push(h)}}return e}function xq(t,e,n){let{projection:i,x:o={},y:u={},fx:h={},fy:c={},axis:b,grid:w,facet:S={},facet:{axis:M=b,grid:A}=S,x:{axis:P=b,grid:B=P===null?null:w}=o,y:{axis:U=b,grid:J=U===null?null:w}=u,fx:{axis:Q=M,grid:K=Q===null?null:A}=h,fy:{axis:le=M,grid:ee=le===null?null:A}=c}=n;(i||!uv(o)&&!V6("x",t))&&(P=B=null),(i||!uv(u)&&!V6("y",t))&&(U=J=null),e.has("fx")||(Q=K=null),e.has("fy")||(le=ee=null),P===void 0&&(P=!e_(t,"x")),U===void 0&&(U=!e_(t,"y")),Q===void 0&&(Q=!e_(t,"fx")),le===void 0&&(le=!e_(t,"fy")),P===!0&&(P="bottom"),U===!0&&(U="left"),Q===!0&&(Q=P==="top"||P===null?"bottom":"top"),le===!0&&(le=U==="right"||U===null?"left":"right");const oe=[];return $0(oe,ee,Uj,c),Q0(oe,le,Lj,"right","left",S,c),$0(oe,K,jj,h),Q0(oe,Q,zj,"top","bottom",S,h),$0(oe,J,Oj,u),Q0(oe,U,o1,"left","right",n,u),$0(oe,B,Vj,o),Q0(oe,P,tM,"bottom","top",n,o),oe}function Q0(t,e,n,i,o,u,h){if(!e)return;const c=wq(e);h=Sq(c?i:e,u,h);const{line:b}=h;(n===o1||n===tM)&&b&&!am(b)&&t.push(iq(Iq(h))),t.push(n(h)),c&&t.push(n({...h,anchor:o,label:null}))}function $0(t,e,n,i){!e||am(e)||t.push(n(Tq(e,i)))}function wq(t){return/^\s*both\s*$/i.test(t)}function Sq(t,e,{line:n=e.line,ticks:i,tickSize:o,tickSpacing:u,tickPadding:h,tickFormat:c,tickRotate:b,fontVariant:w,ariaLabel:S,ariaDescription:M,label:A=e.label,labelAnchor:P,labelArrow:B=e.labelArrow,labelOffset:U}){return{anchor:t,line:n,ticks:i,tickSize:o,tickSpacing:u,tickPadding:h,tickFormat:c,tickRotate:b,fontVariant:w,ariaLabel:S,ariaDescription:M,label:A,labelAnchor:P,labelArrow:B,labelOffset:U}}function Iq(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:n===!0?void 0:n}}function Tq(t,{stroke:e=Sg(t)?t:void 0,ticks:n=Mq(t)?t:void 0,tickSpacing:i,ariaLabel:o,ariaDescription:u}){return{stroke:e,ticks:n,tickSpacing:i,ariaLabel:o,ariaDescription:u}}function Mq(t){switch(typeof t){case"number":return!0;case"string":return!Sg(t)}return Nh(t)||typeof(t==null?void 0:t.range)=="function"}function e_(t,e){const n=`${e}-axis `;return t.some(i=>{var o;return(o=i.ariaLabel)==null?void 0:o.startsWith(n)})}function V6(t,e){for(const n of e)for(const i in n.channels){const{scale:o}=n.channels[i];if(o===t||o==="projection")return!0}return!1}function Aq(t,e){for(const n in t){const i=t[n],o=e[n];i.label===void 0&&o&&(i.label=o.label)}return t}function Cq({fx:t,fy:e},n){const{marginTop:i,marginRight:o,marginBottom:u,marginLeft:h,width:c,height:b}=C2(n),w=t&&j6(t),S=e&&j6(e);return{marginTop:e?S[0]:i,marginRight:t?c-w[1]:o,marginBottom:e?b-S[1]:u,marginLeft:t?w[0]:h,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:c,height:b}}function j6(t){const e=t.domain();let n=t(e[0]),i=t(e[e.length-1]);return i<n&&([n,i]=[i,n]),[n,i+t.bandwidth()]}const kq=new Map([["basis",eO],["basis-closed",tO],["basis-open",nO],["bundle",iO],["bump-x",qR],["bump-y",HR],["cardinal",rO],["cardinal-closed",aO],["cardinal-open",sO],["catmull-rom",oO],["catmull-rom-closed",lO],["catmull-rom-open",cO],["linear",pg],["linear-closed",uO],["monotone-x",hO],["monotone-y",dO],["natural",fO],["step",pO],["step-after",_O],["step-before",mO]]);function Eq(t=pg,e){if(typeof t=="function")return t;const n=kq.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${t}`);if(e!==void 0){if("beta"in n)return n.beta(e);if("tension"in n)return n.tension(e);if("alpha"in n)return n.alpha(e)}return n}function Dq(t=c1,e){return typeof t!="function"&&`${t}`.toLowerCase()==="auto"?c1:Eq(t,e)}function c1(t){return pg(t)}const Pq={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Lq(t){return t.sort===void 0&&t.reverse===void 0?nU({channel:"-r"},t):t}class zq extends co{constructor(e,n={}){const{x:i,y:o,r:u,rotate:h,symbol:c=im,frameAnchor:b}=n,[w,S]=$a(h,0),[M,A]=eU(c),[P,B]=$a(u,M==null?3:4.5);super(e,{x:{value:i,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:P,scale:"r",filter:gg,optional:!0},rotate:{value:w,optional:!0},symbol:{value:M,scale:"auto",optional:!0}},Lq(n),Pq),this.r=B,this.rotate=S,this.symbol=A,this.frameAnchor=Ig(b);const{channels:U}=this,{symbol:J}=U;if(J){const{fill:Q,stroke:K}=U;J.hint={fill:Q?Q.value===J.value?"color":"currentColor":this.fill??"currentColor",stroke:K?K.value===J.value?"color":"currentColor":this.stroke??"none"}}}render(e,n,i,o,u){const{x:h,y:c}=n,{x:b,y:w,r:S,rotate:M,symbol:A}=i,{r:P,rotate:B,symbol:U}=this,[J,Q]=qm(this,o),K=U===im,le=S?void 0:P*P*Math.PI;return p2(P)&&(e=[]),Ia("svg:g",u).call(Pc,this,o,u).call(zc,this,{x:b&&h,y:w&&c}).call(ee=>ee.selectAll().data(e).enter().append(K?"circle":"path").call(Lc,this).call(K?oe=>{oe.attr("cx",b?Z=>b[Z]:J).attr("cy",w?Z=>w[Z]:Q).attr("r",S?Z=>S[Z]:P)}:oe=>{oe.attr("transform",F2`translate(${b?Z=>b[Z]:J},${w?Z=>w[Z]:Q})${M?Z=>` rotate(${M[Z]})`:B?` rotate(${B})`:""}`).attr("d",S&&A?Z=>{const ne=fh();return A[Z].draw(ne,S[Z]*S[Z]*Math.PI),ne}:S?Z=>{const ne=fh();return U.draw(ne,S[Z]*S[Z]*Math.PI),ne}:A?Z=>{const ne=fh();return A[Z].draw(ne,le),ne}:(()=>{const Z=fh();return U.draw(Z,le),Z})())}).call(Oh,this,i)).node()}}function db(t,{x:e,y:n,...i}={}){return i.frameAnchor===void 0&&([e,n]=vg(e,n)),new zq(t,{...i,x:e,y:n})}const Bq={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Fq extends co{constructor(e,n={}){const{x:i,y:o,z:u,curve:h,tension:c}=n;super(e,{x:{value:i,scale:"x"},y:{value:o,scale:"y"},z:{value:zO(n),optional:!0}},n,Bq),this.z=u,this.curve=Dq(h,c),L2(this,n)}filter(e){return e}project(e,n,i){this.curve!==c1&&super.project(e,n,i)}render(e,n,i,o,u){const{x:h,y:c}=i,{curve:b}=this;return Ia("svg:g",u).call(Pc,this,o,u).call(zc,this,n).call(w=>w.selectAll().data(PV(e,[h,c],this,i)).enter().append("path").call(Lc,this).call(kV,this,i).call(ij,this,i,u).attr("d",b===c1&&u.projection?Nq(u.projection,h,c):jR().curve(b).defined(S=>S>=0).x(S=>h[S]).y(S=>c[S]))).node()}}function Nq(t,e,n){const i=Vv(t);return e=s1(e),n=s1(n),o=>{let u=[];const h=[u];for(const c of o)c===-1?(u=[],h.push(u)):u.push([e[c],n[c]]);return i({type:"MultiLineString",coordinates:h})}}function fb(t,{x:e,y:n,...i}={}){return[e,n]=vg(e,n),new Fq(t,{...i,x:e,y:n})}const Rq={ariaLabel:"rect"};class Oq extends co{constructor(e,n={}){const{x1:i,y1:o,x2:u,y2:h,inset:c=0,insetTop:b=c,insetRight:w=c,insetBottom:S=c,insetLeft:M=c,rx:A,ry:P}=n;super(e,{x1:{value:i,scale:"x",type:i!=null&&u==null?"band":void 0,optional:!0},y1:{value:o,scale:"y",type:o!=null&&h==null?"band":void 0,optional:!0},x2:{value:u,scale:"x",optional:!0},y2:{value:h,scale:"y",optional:!0}},n,Rq),this.insetTop=pr(b),this.insetRight=pr(w),this.insetBottom=pr(S),this.insetLeft=pr(M),this.rx=xa(A,"auto"),this.ry=xa(P,"auto")}render(e,n,i,o,u){const{x:h,y:c}=n,{x1:b,y1:w,x2:S,y2:M}=i,{marginTop:A,marginRight:P,marginBottom:B,marginLeft:U,width:J,height:Q}=o,{projection:K}=u,{insetTop:le,insetRight:ee,insetBottom:oe,insetLeft:Z,rx:ne,ry:be}=this,me=(h!=null&&h.bandwidth?h.bandwidth():0)-Z-ee,Te=(c!=null&&c.bandwidth?c.bandwidth():0)-le-oe;return Ia("svg:g",u).call(Pc,this,o,u).call(zc,this,{},0,0).call(Y=>Y.selectAll().data(e).enter().append("rect").call(Lc,this).attr("x",b&&(K||!mu(h))?S?ye=>Math.min(b[ye],S[ye])+Z:ye=>b[ye]+Z:U+Z).attr("y",w&&(K||!mu(c))?M?ye=>Math.min(w[ye],M[ye])+le:ye=>w[ye]+le:A+le).attr("width",b&&(K||!mu(h))?S?ye=>Math.max(0,Math.abs(S[ye]-b[ye])+me):me:J-P-U-ee-Z).attr("height",w&&(K||!mu(c))?M?ye=>Math.max(0,Math.abs(w[ye]-M[ye])+Te):Te:Q-A-B-le-oe).call(Cn,"rx",ne).call(Cn,"ry",be).call(Oh,this,i)).node()}}function Uq(t,e){return new Oq(t,rj(aj(e)))}function In(t,e,n,i){function o(u){return u instanceof n?u:new n(function(h){h(u)})}return new(n||(n=Promise))(function(u,h){function c(S){try{w(i.next(S))}catch(M){h(M)}}function b(S){try{w(i.throw(S))}catch(M){h(M)}}function w(S){S.done?u(S.value):o(S.value).then(c,b)}w((i=i.apply(t,e||[])).next())})}function q6(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Pn(t){return this instanceof Pn?(this.v=t,this):new Pn(t)}function Sl(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),o,u=[];return o={},h("next"),h("throw"),h("return"),o[Symbol.asyncIterator]=function(){return this},o;function h(A){i[A]&&(o[A]=function(P){return new Promise(function(B,U){u.push([A,P,B,U])>1||c(A,P)})})}function c(A,P){try{b(i[A](P))}catch(B){M(u[0][3],B)}}function b(A){A.value instanceof Pn?Promise.resolve(A.value.v).then(w,S):M(u[0][2],A)}function w(A){c("next",A)}function S(A){c("throw",A)}function M(A,P){A(P),u.shift(),u.length&&c(u[0][0],u[0][1])}}function d_(t){var e,n;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,u){e[o]=t[o]?function(h){return(n=!n)?{value:Pn(t[o](h)),done:!1}:u?u(h):h}:u}}function Hd(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof q6=="function"?q6(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(u){n[u]=t[u]&&function(h){return new Promise(function(c,b){h=t[u](h),o(c,b,h.done,h.value)})}}function o(u,h,c,b){Promise.resolve(b).then(function(w){u({value:w,done:c})},h)}}const Vq=new TextDecoder("utf-8"),bv=t=>Vq.decode(t),jq=new TextEncoder,j2=t=>jq.encode(t),qq=t=>typeof t=="number",Hq=t=>typeof t=="boolean",Ka=t=>typeof t=="function",qo=t=>t!=null&&Object(t)===t,lm=t=>qo(t)&&Ka(t.then),Dg=t=>qo(t)&&Ka(t[Symbol.iterator]),q2=t=>qo(t)&&Ka(t[Symbol.asyncIterator]),vv=t=>qo(t)&&qo(t.schema),gM=t=>qo(t)&&"done"in t&&"value"in t,yM=t=>qo(t)&&Ka(t.stat)&&qq(t.fd),bM=t=>qo(t)&&H2(t.body),vM=t=>"_getDOMStream"in t&&"_getNodeStream"in t,H2=t=>qo(t)&&Ka(t.cancel)&&Ka(t.getReader)&&!vM(t),xM=t=>qo(t)&&Ka(t.read)&&Ka(t.pipe)&&Hq(t.readable)&&!vM(t),Wq=t=>qo(t)&&Ka(t.clear)&&Ka(t.bytes)&&Ka(t.position)&&Ka(t.setPosition)&&Ka(t.capacity)&&Ka(t.getBufferIdentifier)&&Ka(t.createLong),W2=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function Zq(t){const e=t[0]?[t[0]]:[];let n,i,o,u;for(let h,c,b=0,w=0,S=t.length;++b<S;){if(h=e[w],c=t[b],!h||!c||h.buffer!==c.buffer||c.byteOffset<h.byteOffset){c&&(e[++w]=c);continue}if({byteOffset:n,byteLength:o}=h,{byteOffset:i,byteLength:u}=c,n+o<i||i+u<n){c&&(e[++w]=c);continue}e[w]=new Uint8Array(h.buffer,n,i-n+u)}return e}function H6(t,e,n=0,i=e.byteLength){const o=t.byteLength,u=new Uint8Array(t.buffer,t.byteOffset,o),h=new Uint8Array(e.buffer,e.byteOffset,Math.min(i,o));return u.set(h,n),t}function Bl(t,e){const n=Zq(t),i=n.reduce((S,M)=>S+M.byteLength,0);let o,u,h,c=0,b=-1;const w=Math.min(e||Number.POSITIVE_INFINITY,i);for(const S=n.length;++b<S;){if(o=n[b],u=o.subarray(0,Math.min(o.length,w-c)),w<=c+u.length){u.length<o.length?n[b]=o.subarray(u.length):u.length===o.length&&b++,h?H6(h,u,c):h=u;break}H6(h||(h=new Uint8Array(w)),u,c),c+=u.length}return[h||new Uint8Array(0),n.slice(b),i-(h?h.byteLength:0)]}function Ti(t,e){let n=gM(e)?e.value:e;return n instanceof t?t===Uint8Array?new t(n.buffer,n.byteOffset,n.byteLength):n:n?(typeof n=="string"&&(n=j2(n)),n instanceof ArrayBuffer?new t(n):n instanceof W2?new t(n):Wq(n)?Ti(t,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new t(0):new t(n.buffer,n.byteOffset,n.byteLength/t.BYTES_PER_ELEMENT):t.from(n)):new t(0)}const wp=t=>Ti(Int32Array,t),W6=t=>Ti(BigInt64Array,t),ei=t=>Ti(Uint8Array,t),xv=t=>(t.next(),t);function*Gq(t,e){const n=function*(o){yield o},i=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof W2?n(e):Dg(e)?e:n(e);return yield*xv(function*(o){let u=null;do u=o.next(yield Ti(t,u));while(!u.done)}(i[Symbol.iterator]())),new t}const Yq=t=>Gq(Uint8Array,t);function wM(t,e){return Sl(this,arguments,function*(){if(lm(e))return yield Pn(yield Pn(yield*d_(Hd(wM(t,yield Pn(e))))));const i=function(h){return Sl(this,arguments,function*(){yield yield Pn(yield Pn(h))})},o=function(h){return Sl(this,arguments,function*(){yield Pn(yield*d_(Hd(xv(function*(c){let b=null;do b=c.next(yield b==null?void 0:b.value);while(!b.done)}(h[Symbol.iterator]())))))})},u=typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof W2?i(e):Dg(e)?o(e):q2(e)?e:i(e);return yield Pn(yield*d_(Hd(xv(function(h){return Sl(this,arguments,function*(){let c=null;do c=yield Pn(h.next(yield yield Pn(Ti(t,c))));while(!c.done)})}(u[Symbol.asyncIterator]()))))),yield Pn(new t)})}const Jq=t=>wM(Uint8Array,t);function Kq(t,e){let n=0;const i=t.length;if(i!==e.length)return!1;if(i>0)do if(t[n]!==e[n])return!1;while(++n<i);return!0}const Xs={fromIterable(t){return t_(Xq(t))},fromAsyncIterable(t){return t_(Qq(t))},fromDOMStream(t){return t_($q(t))},fromNodeStream(t){return t_(tH(t))},toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},t_=t=>(t.next(),t);function*Xq(t){let e,n=!1,i=[],o,u,h,c=0;function b(){return u==="peek"?Bl(i,h)[0]:([o,i,c]=Bl(i,h),o)}({cmd:u,size:h}=(yield null)||{cmd:"read",size:0});const w=Yq(t)[Symbol.iterator]();try{do if({done:e,value:o}=Number.isNaN(h-c)?w.next():w.next(h-c),!e&&o.byteLength>0&&(i.push(o),c+=o.byteLength),e||h<=c)do({cmd:u,size:h}=yield b());while(h<c);while(!e)}catch(S){(n=!0)&&typeof w.throw=="function"&&w.throw(S)}finally{n===!1&&typeof w.return=="function"&&w.return(null)}return null}function Qq(t){return Sl(this,arguments,function*(){let n,i=!1,o=[],u,h,c,b=0;function w(){return h==="peek"?Bl(o,c)[0]:([u,o,b]=Bl(o,c),u)}({cmd:h,size:c}=(yield yield Pn(null))||{cmd:"read",size:0});const S=Jq(t)[Symbol.asyncIterator]();try{do if({done:n,value:u}=Number.isNaN(c-b)?yield Pn(S.next()):yield Pn(S.next(c-b)),!n&&u.byteLength>0&&(o.push(u),b+=u.byteLength),n||c<=b)do({cmd:h,size:c}=yield yield Pn(w()));while(c<b);while(!n)}catch(M){(i=!0)&&typeof S.throw=="function"&&(yield Pn(S.throw(M)))}finally{i===!1&&typeof S.return=="function"&&(yield Pn(S.return(new Uint8Array(0))))}return yield Pn(null)})}function $q(t){return Sl(this,arguments,function*(){let n=!1,i=!1,o=[],u,h,c,b=0;function w(){return h==="peek"?Bl(o,c)[0]:([u,o,b]=Bl(o,c),u)}({cmd:h,size:c}=(yield yield Pn(null))||{cmd:"read",size:0});const S=new eH(t);try{do if({done:n,value:u}=Number.isNaN(c-b)?yield Pn(S.read()):yield Pn(S.read(c-b)),!n&&u.byteLength>0&&(o.push(ei(u)),b+=u.byteLength),n||c<=b)do({cmd:h,size:c}=yield yield Pn(w()));while(c<b);while(!n)}catch(M){(i=!0)&&(yield Pn(S.cancel(M)))}finally{i===!1?yield Pn(S.cancel()):t.locked&&S.releaseLock()}return yield Pn(null)})}class eH{constructor(e){this.source=e,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(e){return In(this,void 0,void 0,function*(){const{reader:n,source:i}=this;n&&(yield n.cancel(e).catch(()=>{})),i&&i.locked&&this.releaseLock()})}read(e){return In(this,void 0,void 0,function*(){if(e===0)return{done:this.reader==null,value:new Uint8Array(0)};const n=yield this.reader.read();return!n.done&&(n.value=ei(n)),n})}}const pb=(t,e)=>{const n=o=>i([e,o]);let i;return[e,n,new Promise(o=>(i=o)&&t.once(e,n))]};function tH(t){return Sl(this,arguments,function*(){const n=[];let i="error",o=!1,u=null,h,c,b=0,w=[],S;function M(){return h==="peek"?Bl(w,c)[0]:([S,w,b]=Bl(w,c),S)}if({cmd:h,size:c}=(yield yield Pn(null))||{cmd:"read",size:0},t.isTTY)return yield yield Pn(new Uint8Array(0)),yield Pn(null);try{n[0]=pb(t,"end"),n[1]=pb(t,"error");do{if(n[2]=pb(t,"readable"),[i,u]=yield Pn(Promise.race(n.map(P=>P[2]))),i==="error")break;if((o=i==="end")||(Number.isFinite(c-b)?(S=ei(t.read(c-b)),S.byteLength<c-b&&(S=ei(t.read()))):S=ei(t.read()),S.byteLength>0&&(w.push(S),b+=S.byteLength)),o||c<=b)do({cmd:h,size:c}=yield yield Pn(M()));while(c<b)}while(!o)}finally{yield Pn(A(n,i==="error"?u:null))}return yield Pn(null);function A(P,B){return S=w=null,new Promise((U,J)=>{for(const[Q,K]of P)t.off(Q,K);try{const Q=t.destroy;Q&&Q.call(t,B),B=void 0}catch(Q){B=Q||B}finally{B!=null?J(B):U()}})}})}var Nr;(function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"})(Nr||(Nr={}));var ds;(function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"})(ds||(ds={}));var Fa;(function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"})(Fa||(Fa={}));var Ho;(function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"})(Ho||(Ho={}));var fn;(function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"})(fn||(fn={}));var Fl;(function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Fl||(Fl={}));const mb=2,yl=4,yc=4,bi=4,hu=new Int32Array(2),Z6=new Float32Array(hu.buffer),G6=new Float64Array(hu.buffer),n_=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var wv;(function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"})(wv||(wv={}));let hf=class SM{constructor(e){this.bytes_=e,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(e){return new SM(new Uint8Array(e))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return BigInt.asIntN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readUint64(e){return BigInt.asUintN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readFloat32(e){return hu[0]=this.readInt32(e),Z6[0]}readFloat64(e){return hu[n_?0:1]=this.readInt32(e),hu[n_?1:0]=this.readInt32(e+4),G6[0]}writeInt8(e,n){this.bytes_[e]=n}writeUint8(e,n){this.bytes_[e]=n}writeInt16(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8}writeUint16(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8}writeInt32(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8,this.bytes_[e+2]=n>>16,this.bytes_[e+3]=n>>24}writeUint32(e,n){this.bytes_[e]=n,this.bytes_[e+1]=n>>8,this.bytes_[e+2]=n>>16,this.bytes_[e+3]=n>>24}writeInt64(e,n){this.writeInt32(e,Number(BigInt.asIntN(32,n))),this.writeInt32(e+4,Number(BigInt.asIntN(32,n>>BigInt(32))))}writeUint64(e,n){this.writeUint32(e,Number(BigInt.asUintN(32,n))),this.writeUint32(e+4,Number(BigInt.asUintN(32,n>>BigInt(32))))}writeFloat32(e,n){Z6[0]=n,this.writeInt32(e,hu[0])}writeFloat64(e,n){G6[0]=n,this.writeInt32(e,hu[n_?0:1]),this.writeInt32(e+4,hu[n_?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+yl+yc)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let n=0;n<yc;n++)e+=String.fromCharCode(this.readInt8(this.position_+yl+n));return e}__offset(e,n){const i=e-this.readInt32(e);return n<this.readInt16(i)?this.readInt16(i+n):0}__union(e,n){return e.bb_pos=n+this.readInt32(n),e.bb=this,e}__string(e,n){e+=this.readInt32(e);const i=this.readInt32(e);e+=yl;const o=this.bytes_.subarray(e,e+i);return n===wv.UTF8_BYTES?o:this.text_decoder_.decode(o)}__union_with_string(e,n){return typeof e=="string"?this.__string(n):this.__union(e,n)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+yl}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(e.length!=yc)throw new Error("FlatBuffers: file identifier must be length "+yc);for(let n=0;n<yc;n++)if(e.charCodeAt(n)!=this.readInt8(this.position()+yl+n))return!1;return!0}createScalarList(e,n){const i=[];for(let o=0;o<n;++o){const u=e(o);u!==null&&i.push(u)}return i}createObjList(e,n){const i=[];for(let o=0;o<n;++o){const u=e(o);u!==null&&i.push(u.unpack())}return i}},IM=class TM{constructor(e){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let n;e?n=e:n=1024,this.bb=hf.allocate(n),this.space=n}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(e,n){e>this.minalign&&(this.minalign=e);const i=~(this.bb.capacity()-this.space+n)+1&e-1;for(;this.space<i+e+n;){const o=this.bb.capacity();this.bb=TM.growByteBuffer(this.bb),this.space+=this.bb.capacity()-o}this.pad(i)}pad(e){for(let n=0;n<e;n++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,n,i){(this.force_defaults||n!=i)&&(this.addInt8(n),this.slot(e))}addFieldInt16(e,n,i){(this.force_defaults||n!=i)&&(this.addInt16(n),this.slot(e))}addFieldInt32(e,n,i){(this.force_defaults||n!=i)&&(this.addInt32(n),this.slot(e))}addFieldInt64(e,n,i){(this.force_defaults||n!==i)&&(this.addInt64(n),this.slot(e))}addFieldFloat32(e,n,i){(this.force_defaults||n!=i)&&(this.addFloat32(n),this.slot(e))}addFieldFloat64(e,n,i){(this.force_defaults||n!=i)&&(this.addFloat64(n),this.slot(e))}addFieldOffset(e,n,i){(this.force_defaults||n!=i)&&(this.addOffset(n),this.slot(e))}addFieldStruct(e,n,i){n!=i&&(this.nested(n),this.slot(e))}nested(e){if(e!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(e){this.vtable!==null&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){const n=e.capacity();if(n&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const i=n<<1,o=hf.allocate(i);return o.setPosition(i-n),o.bytes().set(e.bytes(),i-n),o}addOffset(e){this.prep(yl,0),this.writeInt32(this.offset()-e+yl)}startObject(e){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=e;for(let n=0;n<e;n++)this.vtable[n]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const e=this.offset();let n=this.vtable_in_use-1;for(;n>=0&&this.vtable[n]==0;n--);const i=n+1;for(;n>=0;n--)this.addInt16(this.vtable[n]!=0?e-this.vtable[n]:0);const o=2;this.addInt16(e-this.object_start);const u=(i+o)*mb;this.addInt16(u);let h=0;const c=this.space;e:for(n=0;n<this.vtables.length;n++){const b=this.bb.capacity()-this.vtables[n];if(u==this.bb.readInt16(b)){for(let w=mb;w<u;w+=mb)if(this.bb.readInt16(c+w)!=this.bb.readInt16(b+w))continue e;h=this.vtables[n];break}}return h?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,h-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,n,i){const o=i?bi:0;if(n){const u=n;if(this.prep(this.minalign,yl+yc+o),u.length!=yc)throw new TypeError("FlatBuffers: file identifier must be length "+yc);for(let h=yc-1;h>=0;h--)this.writeInt8(u.charCodeAt(h))}this.prep(this.minalign,yl+o),this.addOffset(e),o&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,n){this.finish(e,n,!0)}requiredField(e,n){const i=this.bb.capacity()-e,o=i-this.bb.readInt32(i);if(!(n<this.bb.readInt16(o)&&this.bb.readInt16(o+n)!=0))throw new TypeError("FlatBuffers: field "+n+" must be set")}startVector(e,n,i){this.notNested(),this.vector_num_elems=n,this.prep(yl,e*n),this.prep(i,e*n)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);const n=this.createString(e);return this.string_maps.set(e,n),n}createString(e){if(e==null)return 0;let n;e instanceof Uint8Array?n=e:n=this.text_encoder.encode(e),this.addInt8(0),this.startVector(1,n.length,1),this.bb.setPosition(this.space-=n.length);for(let i=0,o=this.space,u=this.bb.bytes();i<n.length;i++)u[o++]=n[i];return this.endVector()}createObjectOffset(e){return e===null?0:typeof e=="string"?this.createString(e):e.pack(this)}createObjectOffsetList(e){const n=[];for(let i=0;i<e.length;++i){const o=e[i];if(o!==null)n.push(this.createObjectOffset(o));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return n}createStructOffsetList(e,n){return n(this,e.length),this.createObjectOffsetList(e.slice().reverse()),this.endVector()}};var u1;(function(t){t[t.BUFFER=0]="BUFFER"})(u1||(u1={}));var h1;(function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"})(h1||(h1={}));class du{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsBodyCompression(e,n){return(n||new du).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBodyCompression(e,n){return e.setPosition(e.position()+bi),(n||new du).__init(e.readInt32(e.position())+e.position(),e)}codec(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):h1.LZ4_FRAME}method(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt8(this.bb_pos+e):u1.BUFFER}static startBodyCompression(e){e.startObject(2)}static addCodec(e,n){e.addFieldInt8(0,n,h1.LZ4_FRAME)}static addMethod(e,n){e.addFieldInt8(1,n,u1.BUFFER)}static endBodyCompression(e){return e.endObject()}static createBodyCompression(e,n,i){return du.startBodyCompression(e),du.addCodec(e,n),du.addMethod(e,i),du.endBodyCompression(e)}}class MM{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(e,n,i){return e.prep(8,16),e.writeInt64(BigInt(i??0)),e.writeInt64(BigInt(n??0)),e.offset()}}let AM=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(e,n,i){return e.prep(8,16),e.writeInt64(BigInt(i??0)),e.writeInt64(BigInt(n??0)),e.offset()}},dc=class Sv{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsRecordBatch(e,n){return(n||new Sv).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsRecordBatch(e,n){return e.setPosition(e.position()+bi),(n||new Sv).__init(e.readInt32(e.position())+e.position(),e)}length(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}nodes(e,n){const i=this.bb.__offset(this.bb_pos,6);return i?(n||new AM).__init(this.bb.__vector(this.bb_pos+i)+e*16,this.bb):null}nodesLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,n){const i=this.bb.__offset(this.bb_pos,8);return i?(n||new MM).__init(this.bb.__vector(this.bb_pos+i)+e*16,this.bb):null}buffersLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}compression(e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new du).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}static startRecordBatch(e){e.startObject(4)}static addLength(e,n){e.addFieldInt64(0,n,BigInt("0"))}static addNodes(e,n){e.addFieldOffset(1,n,0)}static startNodesVector(e,n){e.startVector(16,n,8)}static addBuffers(e,n){e.addFieldOffset(2,n,0)}static startBuffersVector(e,n){e.startVector(16,n,8)}static addCompression(e,n){e.addFieldOffset(3,n,0)}static endRecordBatch(e){return e.endObject()}},Cd=class Iv{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDictionaryBatch(e,n){return(n||new Iv).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryBatch(e,n){return e.setPosition(e.position()+bi),(n||new Iv).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}data(e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new dc).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isDelta(){const e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startDictionaryBatch(e){e.startObject(3)}static addId(e,n){e.addFieldInt64(0,n,BigInt("0"))}static addData(e,n){e.addFieldOffset(1,n,0)}static addIsDelta(e,n){e.addFieldInt8(2,+n,0)}static endDictionaryBatch(e){return e.endObject()}};var df;(function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"})(df||(df={}));var d1;(function(t){t[t.DenseArray=0]="DenseArray"})(d1||(d1={}));class Ds{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsInt(e,n){return(n||new Ds).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInt(e,n){return e.setPosition(e.position()+bi),(n||new Ds).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){const e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startInt(e){e.startObject(2)}static addBitWidth(e,n){e.addFieldInt32(0,n,0)}static addIsSigned(e,n){e.addFieldInt8(1,+n,0)}static endInt(e){return e.endObject()}static createInt(e,n,i){return Ds.startInt(e),Ds.addBitWidth(e,n),Ds.addIsSigned(e,i),Ds.endInt(e)}}class bc{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDictionaryEncoding(e,n){return(n||new bc).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryEncoding(e,n){return e.setPosition(e.position()+bi),(n||new bc).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}indexType(e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Ds).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isOrdered(){const e=this.bb.__offset(this.bb_pos,8);return e?!!this.bb.readInt8(this.bb_pos+e):!1}dictionaryKind(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt16(this.bb_pos+e):d1.DenseArray}static startDictionaryEncoding(e){e.startObject(4)}static addId(e,n){e.addFieldInt64(0,n,BigInt("0"))}static addIndexType(e,n){e.addFieldOffset(1,n,0)}static addIsOrdered(e,n){e.addFieldInt8(2,+n,0)}static addDictionaryKind(e,n){e.addFieldInt16(3,n,d1.DenseArray)}static endDictionaryEncoding(e){return e.endObject()}}class Yr{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsKeyValue(e,n){return(n||new Yr).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKeyValue(e,n){return e.setPosition(e.position()+bi),(n||new Yr).__init(e.readInt32(e.position())+e.position(),e)}key(e){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,e):null}value(e){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,n){e.addFieldOffset(0,n,0)}static addValue(e,n){e.addFieldOffset(1,n,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,n,i){return Yr.startKeyValue(e),Yr.addKey(e,n),Yr.addValue(e,i),Yr.endKeyValue(e)}}let Y6=class Pp{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsBinary(e,n){return(n||new Pp).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBinary(e,n){return e.setPosition(e.position()+bi),(n||new Pp).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(e){return Pp.startBinary(e),Pp.endBinary(e)}},J6=class Lp{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsBool(e,n){return(n||new Lp).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBool(e,n){return e.setPosition(e.position()+bi),(n||new Lp).__init(e.readInt32(e.position())+e.position(),e)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(e){return Lp.startBool(e),Lp.endBool(e)}},f_=class kd{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDate(e,n){return(n||new kd).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDate(e,n){return e.setPosition(e.position()+bi),(n||new kd).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Ho.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(e,n){e.addFieldInt16(0,n,Ho.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(e,n){return kd.startDate(e),kd.addUnit(e,n),kd.endDate(e)}},Ed=class uu{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDecimal(e,n){return(n||new uu).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDecimal(e,n){return e.setPosition(e.position()+bi),(n||new uu).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}bitWidth(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):128}static startDecimal(e){e.startObject(3)}static addPrecision(e,n){e.addFieldInt32(0,n,0)}static addScale(e,n){e.addFieldInt32(1,n,0)}static addBitWidth(e,n){e.addFieldInt32(2,n,128)}static endDecimal(e){return e.endObject()}static createDecimal(e,n,i,o){return uu.startDecimal(e),uu.addPrecision(e,n),uu.addScale(e,i),uu.addBitWidth(e,o),uu.endDecimal(e)}},p_=class Dd{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsDuration(e,n){return(n||new Dd).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDuration(e,n){return e.setPosition(e.position()+bi),(n||new Dd).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):fn.MILLISECOND}static startDuration(e){e.startObject(1)}static addUnit(e,n){e.addFieldInt16(0,n,fn.MILLISECOND)}static endDuration(e){return e.endObject()}static createDuration(e,n){return Dd.startDuration(e),Dd.addUnit(e,n),Dd.endDuration(e)}},m_=class Pd{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFixedSizeBinary(e,n){return(n||new Pd).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeBinary(e,n){return e.setPosition(e.position()+bi),(n||new Pd).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,n){e.addFieldInt32(0,n,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(e,n){return Pd.startFixedSizeBinary(e),Pd.addByteWidth(e,n),Pd.endFixedSizeBinary(e)}},__=class Ld{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFixedSizeList(e,n){return(n||new Ld).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFixedSizeList(e,n){return e.setPosition(e.position()+bi),(n||new Ld).__init(e.readInt32(e.position())+e.position(),e)}listSize(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,n){e.addFieldInt32(0,n,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(e,n){return Ld.startFixedSizeList(e),Ld.addListSize(e,n),Ld.endFixedSizeList(e)}};class bl{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFloatingPoint(e,n){return(n||new bl).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFloatingPoint(e,n){return e.setPosition(e.position()+bi),(n||new bl).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Fa.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(e,n){e.addFieldInt16(0,n,Fa.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,n){return bl.startFloatingPoint(e),bl.addPrecision(e,n),bl.endFloatingPoint(e)}}class vl{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsInterval(e,n){return(n||new vl).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInterval(e,n){return e.setPosition(e.position()+bi),(n||new vl).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Fl.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(e,n){e.addFieldInt16(0,n,Fl.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,n){return vl.startInterval(e),vl.addUnit(e,n),vl.endInterval(e)}}let K6=class zp{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsLargeBinary(e,n){return(n||new zp).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsLargeBinary(e,n){return e.setPosition(e.position()+bi),(n||new zp).__init(e.readInt32(e.position())+e.position(),e)}static startLargeBinary(e){e.startObject(0)}static endLargeBinary(e){return e.endObject()}static createLargeBinary(e){return zp.startLargeBinary(e),zp.endLargeBinary(e)}},X6=class Bp{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsLargeUtf8(e,n){return(n||new Bp).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsLargeUtf8(e,n){return e.setPosition(e.position()+bi),(n||new Bp).__init(e.readInt32(e.position())+e.position(),e)}static startLargeUtf8(e){e.startObject(0)}static endLargeUtf8(e){return e.endObject()}static createLargeUtf8(e){return Bp.startLargeUtf8(e),Bp.endLargeUtf8(e)}},Q6=class Fp{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsList(e,n){return(n||new Fp).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsList(e,n){return e.setPosition(e.position()+bi),(n||new Fp).__init(e.readInt32(e.position())+e.position(),e)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(e){return Fp.startList(e),Fp.endList(e)}},g_=class zd{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsMap(e,n){return(n||new zd).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMap(e,n){return e.setPosition(e.position()+bi),(n||new zd).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){const e=this.bb.__offset(this.bb_pos,4);return e?!!this.bb.readInt8(this.bb_pos+e):!1}static startMap(e){e.startObject(1)}static addKeysSorted(e,n){e.addFieldInt8(0,+n,0)}static endMap(e){return e.endObject()}static createMap(e,n){return zd.startMap(e),zd.addKeysSorted(e,n),zd.endMap(e)}},$6=class Np{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsNull(e,n){return(n||new Np).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsNull(e,n){return e.setPosition(e.position()+bi),(n||new Np).__init(e.readInt32(e.position())+e.position(),e)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(e){return Np.startNull(e),Np.endNull(e)}};class mh{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsStruct_(e,n){return(n||new mh).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsStruct_(e,n){return e.setPosition(e.position()+bi),(n||new mh).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return mh.startStruct_(e),mh.endStruct_(e)}}class $s{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsTime(e,n){return(n||new $s).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTime(e,n){return e.setPosition(e.position()+bi),(n||new $s).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):fn.MILLISECOND}bitWidth(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(e,n){e.addFieldInt16(0,n,fn.MILLISECOND)}static addBitWidth(e,n){e.addFieldInt32(1,n,32)}static endTime(e){return e.endObject()}static createTime(e,n,i){return $s.startTime(e),$s.addUnit(e,n),$s.addBitWidth(e,i),$s.endTime(e)}}class eo{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsTimestamp(e,n){return(n||new eo).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTimestamp(e,n){return e.setPosition(e.position()+bi),(n||new eo).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):fn.SECOND}timezone(e){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(e,n){e.addFieldInt16(0,n,fn.SECOND)}static addTimezone(e,n){e.addFieldOffset(1,n,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,n,i){return eo.startTimestamp(e),eo.addUnit(e,n),eo.addTimezone(e,i),eo.endTimestamp(e)}}class cs{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsUnion(e,n){return(n||new cs).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUnion(e,n){return e.setPosition(e.position()+bi),(n||new cs).__init(e.readInt32(e.position())+e.position(),e)}mode(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):ds.Sparse}typeIds(e){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readInt32(this.bb.__vector(this.bb_pos+n)+e*4):0}typeIdsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(e,n){e.addFieldInt16(0,n,ds.Sparse)}static addTypeIds(e,n){e.addFieldOffset(1,n,0)}static createTypeIdsVector(e,n){e.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)e.addInt32(n[i]);return e.endVector()}static startTypeIdsVector(e,n){e.startVector(4,n,4)}static endUnion(e){return e.endObject()}static createUnion(e,n,i){return cs.startUnion(e),cs.addMode(e,n),cs.addTypeIds(e,i),cs.endUnion(e)}}let e9=class Rp{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsUtf8(e,n){return(n||new Rp).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUtf8(e,n){return e.setPosition(e.position()+bi),(n||new Rp).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(e){return Rp.startUtf8(e),Rp.endUtf8(e)}};var Vi;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList",t[t.RunEndEncoded=22]="RunEndEncoded"})(Vi||(Vi={}));let Ks=class y_{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsField(e,n){return(n||new y_).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsField(e,n){return e.setPosition(e.position()+bi),(n||new y_).__init(e.readInt32(e.position())+e.position(),e)}name(e){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,e):null}nullable(){const e=this.bb.__offset(this.bb_pos,6);return e?!!this.bb.readInt8(this.bb_pos+e):!1}typeType(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):Vi.NONE}type(e){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.__union(e,this.bb_pos+n):null}dictionary(e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new bc).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}children(e,n){const i=this.bb.__offset(this.bb_pos,14);return i?(n||new y_).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}childrenLength(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,n){const i=this.bb.__offset(this.bb_pos,16);return i?(n||new Yr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,n){e.addFieldOffset(0,n,0)}static addNullable(e,n){e.addFieldInt8(1,+n,0)}static addTypeType(e,n){e.addFieldInt8(2,n,Vi.NONE)}static addType(e,n){e.addFieldOffset(3,n,0)}static addDictionary(e,n){e.addFieldOffset(4,n,0)}static addChildren(e,n){e.addFieldOffset(5,n,0)}static createChildrenVector(e,n){e.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)e.addOffset(n[i]);return e.endVector()}static startChildrenVector(e,n){e.startVector(4,n,4)}static addCustomMetadata(e,n){e.addFieldOffset(6,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)e.addOffset(n[i]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static endField(e){return e.endObject()}},pl=class hc{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsSchema(e,n){return(n||new hc).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsSchema(e,n){return e.setPosition(e.position()+bi),(n||new hc).__init(e.readInt32(e.position())+e.position(),e)}endianness(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):df.Little}fields(e,n){const i=this.bb.__offset(this.bb_pos,6);return i?(n||new Ks).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}fieldsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,n){const i=this.bb.__offset(this.bb_pos,8);return i?(n||new Yr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}features(e){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readInt64(this.bb.__vector(this.bb_pos+n)+e*8):BigInt(0)}featuresLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(4)}static addEndianness(e,n){e.addFieldInt16(0,n,df.Little)}static addFields(e,n){e.addFieldOffset(1,n,0)}static createFieldsVector(e,n){e.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)e.addOffset(n[i]);return e.endVector()}static startFieldsVector(e,n){e.startVector(4,n,4)}static addCustomMetadata(e,n){e.addFieldOffset(2,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)e.addOffset(n[i]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static addFeatures(e,n){e.addFieldOffset(3,n,0)}static createFeaturesVector(e,n){e.startVector(8,n.length,8);for(let i=n.length-1;i>=0;i--)e.addInt64(n[i]);return e.endVector()}static startFeaturesVector(e,n){e.startVector(8,n,8)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,n){e.finish(n)}static finishSizePrefixedSchemaBuffer(e,n){e.finish(n,void 0,!0)}static createSchema(e,n,i,o,u){return hc.startSchema(e),hc.addEndianness(e,n),hc.addFields(e,i),hc.addCustomMetadata(e,o),hc.addFeatures(e,u),hc.endSchema(e)}};var gi;(function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"})(gi||(gi={}));var Ae;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t[t.DurationSecond=-27]="DurationSecond",t[t.DurationMillisecond=-28]="DurationMillisecond",t[t.DurationMicrosecond=-29]="DurationMicrosecond",t[t.DurationNanosecond=-30]="DurationNanosecond"})(Ae||(Ae={}));var fc;(function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"})(fc||(fc={}));const nH=void 0;function cm(t){if(t===null)return"null";if(t===nH)return"undefined";switch(typeof t){case"number":return`${t}`;case"bigint":return`${t}`;case"string":return`"${t}"`}return typeof t[Symbol.toPrimitive]=="function"?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map(e=>cm(e))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,(e,n)=>typeof n=="bigint"?`${n}`:n)}const iH=Symbol.for("isArrowBigNum");function Yo(t,...e){return e.length===0?Object.setPrototypeOf(Ti(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}Yo.prototype[iH]=!0;Yo.prototype.toJSON=function(){return`"${hm(this)}"`};Yo.prototype.valueOf=function(){return CM(this)};Yo.prototype.toString=function(){return hm(this)};Yo.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return CM(this);case"string":return hm(this);case"default":return rH(this)}return hm(this)};function Wd(...t){return Yo.apply(this,t)}function Zd(...t){return Yo.apply(this,t)}function um(...t){return Yo.apply(this,t)}Object.setPrototypeOf(Wd.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Zd.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(um.prototype,Object.create(Uint32Array.prototype));Object.assign(Wd.prototype,Yo.prototype,{constructor:Wd,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(Zd.prototype,Yo.prototype,{constructor:Zd,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(um.prototype,Yo.prototype,{constructor:um,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});function CM(t){const{buffer:e,byteOffset:n,length:i,signed:o}=t,u=new BigUint64Array(e,n,i),h=o&&u.at(-1)&BigInt(1)<<BigInt(63);let c=BigInt(h?1:0),b=BigInt(0);if(h){for(const w of u)c+=~w*(BigInt(1)<<BigInt(32)*b++);c*=BigInt(-1)}else for(const w of u)c+=w*(BigInt(1)<<BigInt(32)*b++);return c}const hm=t=>{if(t.byteLength===8)return`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`;if(!t.signed)return _b(t);let e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);if(new Int16Array([e.at(-1)])[0]>=0)return _b(t);e=e.slice();let i=1;for(let u=0;u<e.length;u++){const h=e[u],c=~h+i;e[u]=c,i&=h===0?1:0}return`-${_b(e)}`},rH=t=>t.byteLength===8?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:hm(t);function _b(t){let e="";const n=new Uint32Array(2);let i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const o=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let u=-1;const h=i.length-1;do{for(n[0]=i[u=0];u<h;)i[u++]=n[1]=n[0]/10,n[0]=(n[0]-n[1]*10<<16)+i[u];i[u]=n[1]=n[0]/10,n[0]=n[0]-n[1]*10,e=`${n[0]}${e}`}while(o[0]||o[1]||o[2]||o[3]);return e??"0"}class Z2{static new(e,n){switch(n){case!0:return new Wd(e);case!1:return new Zd(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new Wd(e)}return e.byteLength===16?new um(e):new Zd(e)}static signed(e){return new Wd(e)}static unsigned(e){return new Zd(e)}static decimal(e){return new um(e)}constructor(e,n){return Z2.new(e,n)}}function es(t){if(typeof t=="bigint"&&(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER))throw new TypeError(`${t} is not safe to convert to a number.`);return Number(t)}var kM,EM,DM,PM,LM,zM,BM,FM,NM,RM,OM,UM,VM,jM,qM,HM,WM,ZM,GM,YM,JM,KM;class an{static isNull(e){return(e==null?void 0:e.typeId)===Ae.Null}static isInt(e){return(e==null?void 0:e.typeId)===Ae.Int}static isFloat(e){return(e==null?void 0:e.typeId)===Ae.Float}static isBinary(e){return(e==null?void 0:e.typeId)===Ae.Binary}static isLargeBinary(e){return(e==null?void 0:e.typeId)===Ae.LargeBinary}static isUtf8(e){return(e==null?void 0:e.typeId)===Ae.Utf8}static isLargeUtf8(e){return(e==null?void 0:e.typeId)===Ae.LargeUtf8}static isBool(e){return(e==null?void 0:e.typeId)===Ae.Bool}static isDecimal(e){return(e==null?void 0:e.typeId)===Ae.Decimal}static isDate(e){return(e==null?void 0:e.typeId)===Ae.Date}static isTime(e){return(e==null?void 0:e.typeId)===Ae.Time}static isTimestamp(e){return(e==null?void 0:e.typeId)===Ae.Timestamp}static isInterval(e){return(e==null?void 0:e.typeId)===Ae.Interval}static isDuration(e){return(e==null?void 0:e.typeId)===Ae.Duration}static isList(e){return(e==null?void 0:e.typeId)===Ae.List}static isStruct(e){return(e==null?void 0:e.typeId)===Ae.Struct}static isUnion(e){return(e==null?void 0:e.typeId)===Ae.Union}static isFixedSizeBinary(e){return(e==null?void 0:e.typeId)===Ae.FixedSizeBinary}static isFixedSizeList(e){return(e==null?void 0:e.typeId)===Ae.FixedSizeList}static isMap(e){return(e==null?void 0:e.typeId)===Ae.Map}static isDictionary(e){return(e==null?void 0:e.typeId)===Ae.Dictionary}static isDenseUnion(e){return an.isUnion(e)&&e.mode===ds.Dense}static isSparseUnion(e){return an.isUnion(e)&&e.mode===ds.Sparse}constructor(e){this.typeId=e}}kM=Symbol.toStringTag;an[kM]=(t=>(t.children=null,t.ArrayType=Array,t.OffsetArrayType=Int32Array,t[Symbol.toStringTag]="DataType"))(an.prototype);class Cu extends an{constructor(){super(Ae.Null)}toString(){return"Null"}}EM=Symbol.toStringTag;Cu[EM]=(t=>t[Symbol.toStringTag]="Null")(Cu.prototype);class ku extends an{constructor(e,n){super(Ae.Int),this.isSigned=e,this.bitWidth=n}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}DM=Symbol.toStringTag;ku[DM]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(ku.prototype);class dm extends ku{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(dm.prototype,"ArrayType",{value:Int32Array});class fm extends an{constructor(e){super(Ae.Float),this.precision=e}get ArrayType(){switch(this.precision){case Fa.HALF:return Uint16Array;case Fa.SINGLE:return Float32Array;case Fa.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}PM=Symbol.toStringTag;fm[PM]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(fm.prototype);class f1 extends an{constructor(){super(Ae.Binary)}toString(){return"Binary"}}LM=Symbol.toStringTag;f1[LM]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(f1.prototype);class p1 extends an{constructor(){super(Ae.LargeBinary)}toString(){return"LargeBinary"}}zM=Symbol.toStringTag;p1[zM]=(t=>(t.ArrayType=Uint8Array,t.OffsetArrayType=BigInt64Array,t[Symbol.toStringTag]="LargeBinary"))(p1.prototype);class m1 extends an{constructor(){super(Ae.Utf8)}toString(){return"Utf8"}}BM=Symbol.toStringTag;m1[BM]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(m1.prototype);class _1 extends an{constructor(){super(Ae.LargeUtf8)}toString(){return"LargeUtf8"}}FM=Symbol.toStringTag;_1[FM]=(t=>(t.ArrayType=Uint8Array,t.OffsetArrayType=BigInt64Array,t[Symbol.toStringTag]="LargeUtf8"))(_1.prototype);class g1 extends an{constructor(){super(Ae.Bool)}toString(){return"Bool"}}NM=Symbol.toStringTag;g1[NM]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(g1.prototype);class y1 extends an{constructor(e,n,i=128){super(Ae.Decimal),this.scale=e,this.precision=n,this.bitWidth=i}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}RM=Symbol.toStringTag;y1[RM]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(y1.prototype);class b1 extends an{constructor(e){super(Ae.Date),this.unit=e}toString(){return`Date${(this.unit+1)*32}<${Ho[this.unit]}>`}}OM=Symbol.toStringTag;b1[OM]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(b1.prototype);class pm extends an{constructor(e,n){super(Ae.Time),this.unit=e,this.bitWidth=n}toString(){return`Time${this.bitWidth}<${fn[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}UM=Symbol.toStringTag;pm[UM]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(pm.prototype);class v1 extends an{constructor(e,n){super(Ae.Timestamp),this.unit=e,this.timezone=n}toString(){return`Timestamp<${fn[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}VM=Symbol.toStringTag;v1[VM]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(v1.prototype);class x1 extends an{constructor(e){super(Ae.Interval),this.unit=e}toString(){return`Interval<${Fl[this.unit]}>`}}jM=Symbol.toStringTag;x1[jM]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(x1.prototype);class w1 extends an{constructor(e){super(Ae.Duration),this.unit=e}toString(){return`Duration<${fn[this.unit]}>`}}qM=Symbol.toStringTag;w1[qM]=(t=>(t.unit=null,t.ArrayType=BigInt64Array,t[Symbol.toStringTag]="Duration"))(w1.prototype);class S1 extends an{constructor(e){super(Ae.List),this.children=[e]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}HM=Symbol.toStringTag;S1[HM]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(S1.prototype);class Qa extends an{constructor(e){super(Ae.Struct),this.children=e}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}WM=Symbol.toStringTag;Qa[WM]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(Qa.prototype);class I1 extends an{constructor(e,n,i){super(Ae.Union),this.mode=e,this.children=i,this.typeIds=n=Int32Array.from(n),this.typeIdToChildIndex=n.reduce((o,u,h)=>(o[u]=h)&&o||o,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}}ZM=Symbol.toStringTag;I1[ZM]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(I1.prototype);class T1 extends an{constructor(e){super(Ae.FixedSizeBinary),this.byteWidth=e}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}GM=Symbol.toStringTag;T1[GM]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(T1.prototype);class M1 extends an{constructor(e,n){super(Ae.FixedSizeList),this.listSize=e,this.children=[n]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}YM=Symbol.toStringTag;M1[YM]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(M1.prototype);class A1 extends an{constructor(e,n=!1){var i,o,u;if(super(Ae.Map),this.children=[e],this.keysSorted=n,e&&(e.name="entries",!((i=e==null?void 0:e.type)===null||i===void 0)&&i.children)){const h=(o=e==null?void 0:e.type)===null||o===void 0?void 0:o.children[0];h&&(h.name="key");const c=(u=e==null?void 0:e.type)===null||u===void 0?void 0:u.children[1];c&&(c.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}JM=Symbol.toStringTag;A1[JM]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(A1.prototype);const aH=(t=>()=>++t)(-1);class ff extends an{constructor(e,n,i,o){super(Ae.Dictionary),this.indices=n,this.dictionary=e,this.isOrdered=o||!1,this.id=i==null?aH():es(i)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}KM=Symbol.toStringTag;ff[KM]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(ff.prototype);function pc(t){const e=t;switch(t.typeId){case Ae.Decimal:return t.bitWidth/32;case Ae.Timestamp:return 2;case Ae.Date:return 1+e.unit;case Ae.Interval:return 1+e.unit;case Ae.FixedSizeList:return e.listSize;case Ae.FixedSizeBinary:return e.byteWidth;default:return 1}}class Hn{visitMany(e,...n){return e.map((i,o)=>this.visit(i,...n.map(u=>u[o])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,n=!0){return sH(this,e,n)}getVisitFnByTypeId(e,n=!0){return Bd(this,e,n)}visitNull(e,...n){return null}visitBool(e,...n){return null}visitInt(e,...n){return null}visitFloat(e,...n){return null}visitUtf8(e,...n){return null}visitLargeUtf8(e,...n){return null}visitBinary(e,...n){return null}visitLargeBinary(e,...n){return null}visitFixedSizeBinary(e,...n){return null}visitDate(e,...n){return null}visitTimestamp(e,...n){return null}visitTime(e,...n){return null}visitDecimal(e,...n){return null}visitList(e,...n){return null}visitStruct(e,...n){return null}visitUnion(e,...n){return null}visitDictionary(e,...n){return null}visitInterval(e,...n){return null}visitDuration(e,...n){return null}visitFixedSizeList(e,...n){return null}visitMap(e,...n){return null}}function sH(t,e,n=!0){return typeof e=="number"?Bd(t,e,n):typeof e=="string"&&e in Ae?Bd(t,Ae[e],n):e&&e instanceof an?Bd(t,t9(e),n):e!=null&&e.type&&e.type instanceof an?Bd(t,t9(e.type),n):Bd(t,Ae.NONE,n)}function Bd(t,e,n=!0){let i=null;switch(e){case Ae.Null:i=t.visitNull;break;case Ae.Bool:i=t.visitBool;break;case Ae.Int:i=t.visitInt;break;case Ae.Int8:i=t.visitInt8||t.visitInt;break;case Ae.Int16:i=t.visitInt16||t.visitInt;break;case Ae.Int32:i=t.visitInt32||t.visitInt;break;case Ae.Int64:i=t.visitInt64||t.visitInt;break;case Ae.Uint8:i=t.visitUint8||t.visitInt;break;case Ae.Uint16:i=t.visitUint16||t.visitInt;break;case Ae.Uint32:i=t.visitUint32||t.visitInt;break;case Ae.Uint64:i=t.visitUint64||t.visitInt;break;case Ae.Float:i=t.visitFloat;break;case Ae.Float16:i=t.visitFloat16||t.visitFloat;break;case Ae.Float32:i=t.visitFloat32||t.visitFloat;break;case Ae.Float64:i=t.visitFloat64||t.visitFloat;break;case Ae.Utf8:i=t.visitUtf8;break;case Ae.LargeUtf8:i=t.visitLargeUtf8;break;case Ae.Binary:i=t.visitBinary;break;case Ae.LargeBinary:i=t.visitLargeBinary;break;case Ae.FixedSizeBinary:i=t.visitFixedSizeBinary;break;case Ae.Date:i=t.visitDate;break;case Ae.DateDay:i=t.visitDateDay||t.visitDate;break;case Ae.DateMillisecond:i=t.visitDateMillisecond||t.visitDate;break;case Ae.Timestamp:i=t.visitTimestamp;break;case Ae.TimestampSecond:i=t.visitTimestampSecond||t.visitTimestamp;break;case Ae.TimestampMillisecond:i=t.visitTimestampMillisecond||t.visitTimestamp;break;case Ae.TimestampMicrosecond:i=t.visitTimestampMicrosecond||t.visitTimestamp;break;case Ae.TimestampNanosecond:i=t.visitTimestampNanosecond||t.visitTimestamp;break;case Ae.Time:i=t.visitTime;break;case Ae.TimeSecond:i=t.visitTimeSecond||t.visitTime;break;case Ae.TimeMillisecond:i=t.visitTimeMillisecond||t.visitTime;break;case Ae.TimeMicrosecond:i=t.visitTimeMicrosecond||t.visitTime;break;case Ae.TimeNanosecond:i=t.visitTimeNanosecond||t.visitTime;break;case Ae.Decimal:i=t.visitDecimal;break;case Ae.List:i=t.visitList;break;case Ae.Struct:i=t.visitStruct;break;case Ae.Union:i=t.visitUnion;break;case Ae.DenseUnion:i=t.visitDenseUnion||t.visitUnion;break;case Ae.SparseUnion:i=t.visitSparseUnion||t.visitUnion;break;case Ae.Dictionary:i=t.visitDictionary;break;case Ae.Interval:i=t.visitInterval;break;case Ae.IntervalDayTime:i=t.visitIntervalDayTime||t.visitInterval;break;case Ae.IntervalYearMonth:i=t.visitIntervalYearMonth||t.visitInterval;break;case Ae.Duration:i=t.visitDuration;break;case Ae.DurationSecond:i=t.visitDurationSecond||t.visitDuration;break;case Ae.DurationMillisecond:i=t.visitDurationMillisecond||t.visitDuration;break;case Ae.DurationMicrosecond:i=t.visitDurationMicrosecond||t.visitDuration;break;case Ae.DurationNanosecond:i=t.visitDurationNanosecond||t.visitDuration;break;case Ae.FixedSizeList:i=t.visitFixedSizeList;break;case Ae.Map:i=t.visitMap;break}if(typeof i=="function")return i;if(!n)return()=>null;throw new Error(`Unrecognized type '${Ae[e]}'`)}function t9(t){switch(t.typeId){case Ae.Null:return Ae.Null;case Ae.Int:{const{bitWidth:e,isSigned:n}=t;switch(e){case 8:return n?Ae.Int8:Ae.Uint8;case 16:return n?Ae.Int16:Ae.Uint16;case 32:return n?Ae.Int32:Ae.Uint32;case 64:return n?Ae.Int64:Ae.Uint64}return Ae.Int}case Ae.Float:switch(t.precision){case Fa.HALF:return Ae.Float16;case Fa.SINGLE:return Ae.Float32;case Fa.DOUBLE:return Ae.Float64}return Ae.Float;case Ae.Binary:return Ae.Binary;case Ae.LargeBinary:return Ae.LargeBinary;case Ae.Utf8:return Ae.Utf8;case Ae.LargeUtf8:return Ae.LargeUtf8;case Ae.Bool:return Ae.Bool;case Ae.Decimal:return Ae.Decimal;case Ae.Time:switch(t.unit){case fn.SECOND:return Ae.TimeSecond;case fn.MILLISECOND:return Ae.TimeMillisecond;case fn.MICROSECOND:return Ae.TimeMicrosecond;case fn.NANOSECOND:return Ae.TimeNanosecond}return Ae.Time;case Ae.Timestamp:switch(t.unit){case fn.SECOND:return Ae.TimestampSecond;case fn.MILLISECOND:return Ae.TimestampMillisecond;case fn.MICROSECOND:return Ae.TimestampMicrosecond;case fn.NANOSECOND:return Ae.TimestampNanosecond}return Ae.Timestamp;case Ae.Date:switch(t.unit){case Ho.DAY:return Ae.DateDay;case Ho.MILLISECOND:return Ae.DateMillisecond}return Ae.Date;case Ae.Interval:switch(t.unit){case Fl.DAY_TIME:return Ae.IntervalDayTime;case Fl.YEAR_MONTH:return Ae.IntervalYearMonth}return Ae.Interval;case Ae.Duration:switch(t.unit){case fn.SECOND:return Ae.DurationSecond;case fn.MILLISECOND:return Ae.DurationMillisecond;case fn.MICROSECOND:return Ae.DurationMicrosecond;case fn.NANOSECOND:return Ae.DurationNanosecond}return Ae.Duration;case Ae.Map:return Ae.Map;case Ae.List:return Ae.List;case Ae.Struct:return Ae.Struct;case Ae.Union:switch(t.mode){case ds.Dense:return Ae.DenseUnion;case ds.Sparse:return Ae.SparseUnion}return Ae.Union;case Ae.FixedSizeBinary:return Ae.FixedSizeBinary;case Ae.FixedSizeList:return Ae.FixedSizeList;case Ae.Dictionary:return Ae.Dictionary}throw new Error(`Unrecognized type '${Ae[t.typeId]}'`)}Hn.prototype.visitInt8=null;Hn.prototype.visitInt16=null;Hn.prototype.visitInt32=null;Hn.prototype.visitInt64=null;Hn.prototype.visitUint8=null;Hn.prototype.visitUint16=null;Hn.prototype.visitUint32=null;Hn.prototype.visitUint64=null;Hn.prototype.visitFloat16=null;Hn.prototype.visitFloat32=null;Hn.prototype.visitFloat64=null;Hn.prototype.visitDateDay=null;Hn.prototype.visitDateMillisecond=null;Hn.prototype.visitTimestampSecond=null;Hn.prototype.visitTimestampMillisecond=null;Hn.prototype.visitTimestampMicrosecond=null;Hn.prototype.visitTimestampNanosecond=null;Hn.prototype.visitTimeSecond=null;Hn.prototype.visitTimeMillisecond=null;Hn.prototype.visitTimeMicrosecond=null;Hn.prototype.visitTimeNanosecond=null;Hn.prototype.visitDenseUnion=null;Hn.prototype.visitSparseUnion=null;Hn.prototype.visitIntervalDayTime=null;Hn.prototype.visitIntervalYearMonth=null;Hn.prototype.visitDuration=null;Hn.prototype.visitDurationSecond=null;Hn.prototype.visitDurationMillisecond=null;Hn.prototype.visitDurationMicrosecond=null;Hn.prototype.visitDurationNanosecond=null;const XM=new Float64Array(1),Ad=new Uint32Array(XM.buffer);function QM(t){const e=(t&31744)>>10,n=(t&1023)/1024,i=Math.pow(-1,(t&32768)>>15);switch(e){case 31:return i*(n?Number.NaN:1/0);case 0:return i*(n?6103515625e-14*n:0)}return i*Math.pow(2,e-15)*(1+n)}function oH(t){if(t!==t)return 32256;XM[0]=t;const e=(Ad[1]&2147483648)>>16&65535;let n=Ad[1]&2146435072,i=0;return n>=1089470464?Ad[0]>0?n=31744:(n=(n&2080374784)>>16,i=(Ad[1]&1048575)>>10):n<=1056964608?(i=1048576+(Ad[1]&1048575),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=(Ad[1]&1048575)+512>>10),e|n|i&65535}class pn extends Hn{}function bn(t){return(e,n,i)=>{if(e.setValid(n,i!=null))return t(e,n,i)}}const lH=(t,e,n)=>{t[e]=Math.trunc(n/864e5)},G2=(t,e,n)=>{t[e]=Math.trunc(n%4294967296),t[e+1]=Math.trunc(n/4294967296)},cH=(t,e,n)=>{t[e]=Math.trunc(n*1e3%4294967296),t[e+1]=Math.trunc(n*1e3/4294967296)},uH=(t,e,n)=>{t[e]=Math.trunc(n*1e6%4294967296),t[e+1]=Math.trunc(n*1e6/4294967296)},$M=(t,e,n,i)=>{if(n+1<e.length){const o=es(e[n]),u=es(e[n+1]);t.set(i.subarray(0,u-o),o)}},hH=({offset:t,values:e},n,i)=>{const o=t+n;i?e[o>>3]|=1<<o%8:e[o>>3]&=~(1<<o%8)},Bc=({values:t},e,n)=>{t[e]=n},Y2=({values:t},e,n)=>{t[e]=n},eA=({values:t},e,n)=>{t[e]=oH(n)},dH=(t,e,n)=>{switch(t.type.precision){case Fa.HALF:return eA(t,e,n);case Fa.SINGLE:case Fa.DOUBLE:return Y2(t,e,n)}},tA=({values:t},e,n)=>{lH(t,e,n.valueOf())},nA=({values:t},e,n)=>{G2(t,e*2,n.valueOf())},fH=({stride:t,values:e},n,i)=>{e.set(i.subarray(0,t),t*n)},iA=({values:t,valueOffsets:e},n,i)=>$M(t,e,n,i),rA=({values:t,valueOffsets:e},n,i)=>$M(t,e,n,j2(i)),pH=(t,e,n)=>{t.type.unit===Ho.DAY?tA(t,e,n):nA(t,e,n)},aA=({values:t},e,n)=>G2(t,e*2,n/1e3),sA=({values:t},e,n)=>G2(t,e*2,n),oA=({values:t},e,n)=>cH(t,e*2,n),lA=({values:t},e,n)=>uH(t,e*2,n),mH=(t,e,n)=>{switch(t.type.unit){case fn.SECOND:return aA(t,e,n);case fn.MILLISECOND:return sA(t,e,n);case fn.MICROSECOND:return oA(t,e,n);case fn.NANOSECOND:return lA(t,e,n)}},cA=({values:t},e,n)=>{t[e]=n},uA=({values:t},e,n)=>{t[e]=n},hA=({values:t},e,n)=>{t[e]=n},dA=({values:t},e,n)=>{t[e]=n},_H=(t,e,n)=>{switch(t.type.unit){case fn.SECOND:return cA(t,e,n);case fn.MILLISECOND:return uA(t,e,n);case fn.MICROSECOND:return hA(t,e,n);case fn.NANOSECOND:return dA(t,e,n)}},gH=({values:t,stride:e},n,i)=>{t.set(i.subarray(0,e),e*n)},yH=(t,e,n)=>{const i=t.children[0],o=t.valueOffsets,u=lo.getVisitFn(i);if(Array.isArray(n))for(let h=-1,c=o[e],b=o[e+1];c<b;)u(i,c++,n[++h]);else for(let h=-1,c=o[e],b=o[e+1];c<b;)u(i,c++,n.get(++h))},bH=(t,e,n)=>{const i=t.children[0],{valueOffsets:o}=t,u=lo.getVisitFn(i);let{[e]:h,[e+1]:c}=o;const b=n instanceof Map?n.entries():Object.entries(n);for(const w of b)if(u(i,h,w),++h>=c)break},vH=(t,e)=>(n,i,o,u)=>i&&n(i,t,e[u]),xH=(t,e)=>(n,i,o,u)=>i&&n(i,t,e.get(u)),wH=(t,e)=>(n,i,o,u)=>i&&n(i,t,e.get(o.name)),SH=(t,e)=>(n,i,o,u)=>i&&n(i,t,e[o.name]),IH=(t,e,n)=>{const i=t.type.children.map(u=>lo.getVisitFn(u.type)),o=n instanceof Map?wH(e,n):n instanceof zi?xH(e,n):Array.isArray(n)?vH(e,n):SH(e,n);t.type.children.forEach((u,h)=>o(i[h],t.children[h],u,h))},TH=(t,e,n)=>{t.type.mode===ds.Dense?fA(t,e,n):pA(t,e,n)},fA=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],o=t.children[i];lo.visit(o,t.valueOffsets[e],n)},pA=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],o=t.children[i];lo.visit(o,e,n)},MH=(t,e,n)=>{var i;(i=t.dictionary)===null||i===void 0||i.set(t.values[e],n)},AH=(t,e,n)=>{t.type.unit===Fl.DAY_TIME?mA(t,e,n):_A(t,e,n)},mA=({values:t},e,n)=>{t.set(n.subarray(0,2),2*e)},_A=({values:t},e,n)=>{t[e]=n[0]*12+n[1]%12},gA=({values:t},e,n)=>{t[e]=n},yA=({values:t},e,n)=>{t[e]=n},bA=({values:t},e,n)=>{t[e]=n},vA=({values:t},e,n)=>{t[e]=n},CH=(t,e,n)=>{switch(t.type.unit){case fn.SECOND:return gA(t,e,n);case fn.MILLISECOND:return yA(t,e,n);case fn.MICROSECOND:return bA(t,e,n);case fn.NANOSECOND:return vA(t,e,n)}},kH=(t,e,n)=>{const{stride:i}=t,o=t.children[0],u=lo.getVisitFn(o);if(Array.isArray(n))for(let h=-1,c=e*i;++h<i;)u(o,c+h,n[h]);else for(let h=-1,c=e*i;++h<i;)u(o,c+h,n.get(h))};pn.prototype.visitBool=bn(hH);pn.prototype.visitInt=bn(Bc);pn.prototype.visitInt8=bn(Bc);pn.prototype.visitInt16=bn(Bc);pn.prototype.visitInt32=bn(Bc);pn.prototype.visitInt64=bn(Bc);pn.prototype.visitUint8=bn(Bc);pn.prototype.visitUint16=bn(Bc);pn.prototype.visitUint32=bn(Bc);pn.prototype.visitUint64=bn(Bc);pn.prototype.visitFloat=bn(dH);pn.prototype.visitFloat16=bn(eA);pn.prototype.visitFloat32=bn(Y2);pn.prototype.visitFloat64=bn(Y2);pn.prototype.visitUtf8=bn(rA);pn.prototype.visitLargeUtf8=bn(rA);pn.prototype.visitBinary=bn(iA);pn.prototype.visitLargeBinary=bn(iA);pn.prototype.visitFixedSizeBinary=bn(fH);pn.prototype.visitDate=bn(pH);pn.prototype.visitDateDay=bn(tA);pn.prototype.visitDateMillisecond=bn(nA);pn.prototype.visitTimestamp=bn(mH);pn.prototype.visitTimestampSecond=bn(aA);pn.prototype.visitTimestampMillisecond=bn(sA);pn.prototype.visitTimestampMicrosecond=bn(oA);pn.prototype.visitTimestampNanosecond=bn(lA);pn.prototype.visitTime=bn(_H);pn.prototype.visitTimeSecond=bn(cA);pn.prototype.visitTimeMillisecond=bn(uA);pn.prototype.visitTimeMicrosecond=bn(hA);pn.prototype.visitTimeNanosecond=bn(dA);pn.prototype.visitDecimal=bn(gH);pn.prototype.visitList=bn(yH);pn.prototype.visitStruct=bn(IH);pn.prototype.visitUnion=bn(TH);pn.prototype.visitDenseUnion=bn(fA);pn.prototype.visitSparseUnion=bn(pA);pn.prototype.visitDictionary=bn(MH);pn.prototype.visitInterval=bn(AH);pn.prototype.visitIntervalDayTime=bn(mA);pn.prototype.visitIntervalYearMonth=bn(_A);pn.prototype.visitDuration=bn(CH);pn.prototype.visitDurationSecond=bn(gA);pn.prototype.visitDurationMillisecond=bn(yA);pn.prototype.visitDurationMicrosecond=bn(bA);pn.prototype.visitDurationNanosecond=bn(vA);pn.prototype.visitFixedSizeList=bn(kH);pn.prototype.visitMap=bn(bH);const lo=new pn,Po=Symbol.for("parent"),Gd=Symbol.for("rowIndex");class J2{constructor(e,n){return this[Po]=e,this[Gd]=n,new Proxy(this,new DH)}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[Gd],n=this[Po],i=n.type.children,o={};for(let u=-1,h=i.length;++u<h;)o[i[u].name]=fs.visit(n.children[u],e);return o}toString(){return`{${[...this].map(([e,n])=>`${cm(e)}: ${cm(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new EH(this[Po],this[Gd])}}class EH{constructor(e,n){this.childIndex=0,this.children=e.children,this.rowIndex=n,this.childFields=e.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const e=this.childIndex;return e<this.numChildren?(this.childIndex=e+1,{done:!1,value:[this.childFields[e].name,fs.visit(this.children[e],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(J2.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Po]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Gd]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class DH{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[Po].type.children.map(n=>n.name)}has(e,n){return e[Po].type.children.findIndex(i=>i.name===n)!==-1}getOwnPropertyDescriptor(e,n){if(e[Po].type.children.findIndex(i=>i.name===n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(e,n){if(Reflect.has(e,n))return e[n];const i=e[Po].type.children.findIndex(o=>o.name===n);if(i!==-1){const o=fs.visit(e[Po].children[i],e[Gd]);return Reflect.set(e,n,o),o}}set(e,n,i){const o=e[Po].type.children.findIndex(u=>u.name===n);return o!==-1?(lo.visit(e[Po].children[o],e[Gd],i),Reflect.set(e,n,i)):Reflect.has(e,n)||typeof n=="symbol"?Reflect.set(e,n,i):!1}}class ln extends Hn{}function mn(t){return(e,n)=>e.getValid(n)?t(e,n):null}const PH=(t,e)=>864e5*t[e],K2=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),LH=(t,e)=>4294967296*(t[e+1]/1e3)+(t[e]>>>0)/1e3,zH=(t,e)=>4294967296*(t[e+1]/1e6)+(t[e]>>>0)/1e6,xA=t=>new Date(t),BH=(t,e)=>xA(PH(t,e)),FH=(t,e)=>xA(K2(t,e)),NH=(t,e)=>null,wA=(t,e,n)=>{if(n+1>=e.length)return null;const i=es(e[n]),o=es(e[n+1]);return t.subarray(i,o)},RH=({offset:t,values:e},n)=>{const i=t+n;return(e[i>>3]&1<<i%8)!==0},SA=({values:t},e)=>BH(t,e),IA=({values:t},e)=>FH(t,e*2),Bu=({stride:t,values:e},n)=>e[t*n],OH=({stride:t,values:e},n)=>QM(e[t*n]),TA=({values:t},e)=>t[e],UH=({stride:t,values:e},n)=>e.subarray(t*n,t*(n+1)),MA=({values:t,valueOffsets:e},n)=>wA(t,e,n),AA=({values:t,valueOffsets:e},n)=>{const i=wA(t,e,n);return i!==null?bv(i):null},VH=({values:t},e)=>t[e],jH=({type:t,values:e},n)=>t.precision!==Fa.HALF?e[n]:QM(e[n]),qH=(t,e)=>t.type.unit===Ho.DAY?SA(t,e):IA(t,e),CA=({values:t},e)=>1e3*K2(t,e*2),kA=({values:t},e)=>K2(t,e*2),EA=({values:t},e)=>LH(t,e*2),DA=({values:t},e)=>zH(t,e*2),HH=(t,e)=>{switch(t.type.unit){case fn.SECOND:return CA(t,e);case fn.MILLISECOND:return kA(t,e);case fn.MICROSECOND:return EA(t,e);case fn.NANOSECOND:return DA(t,e)}},PA=({values:t},e)=>t[e],LA=({values:t},e)=>t[e],zA=({values:t},e)=>t[e],BA=({values:t},e)=>t[e],WH=(t,e)=>{switch(t.type.unit){case fn.SECOND:return PA(t,e);case fn.MILLISECOND:return LA(t,e);case fn.MICROSECOND:return zA(t,e);case fn.NANOSECOND:return BA(t,e)}},ZH=({values:t,stride:e},n)=>Z2.decimal(t.subarray(e*n,e*(n+1))),GH=(t,e)=>{const{valueOffsets:n,stride:i,children:o}=t,{[e*i]:u,[e*i+1]:h}=n,b=o[0].slice(u,h-u);return new zi([b])},YH=(t,e)=>{const{valueOffsets:n,children:i}=t,{[e]:o,[e+1]:u}=n,h=i[0];return new X2(h.slice(o,u-o))},JH=(t,e)=>new J2(t,e),KH=(t,e)=>t.type.mode===ds.Dense?FA(t,e):NA(t,e),FA=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return fs.visit(i,t.valueOffsets[e])},NA=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return fs.visit(i,e)},XH=(t,e)=>{var n;return(n=t.dictionary)===null||n===void 0?void 0:n.get(t.values[e])},QH=(t,e)=>t.type.unit===Fl.DAY_TIME?RA(t,e):OA(t,e),RA=({values:t},e)=>t.subarray(2*e,2*(e+1)),OA=({values:t},e)=>{const n=t[e],i=new Int32Array(2);return i[0]=Math.trunc(n/12),i[1]=Math.trunc(n%12),i},UA=({values:t},e)=>t[e],VA=({values:t},e)=>t[e],jA=({values:t},e)=>t[e],qA=({values:t},e)=>t[e],$H=(t,e)=>{switch(t.type.unit){case fn.SECOND:return UA(t,e);case fn.MILLISECOND:return VA(t,e);case fn.MICROSECOND:return jA(t,e);case fn.NANOSECOND:return qA(t,e)}},eW=(t,e)=>{const{stride:n,children:i}=t,u=i[0].slice(e*n,n);return new zi([u])};ln.prototype.visitNull=mn(NH);ln.prototype.visitBool=mn(RH);ln.prototype.visitInt=mn(VH);ln.prototype.visitInt8=mn(Bu);ln.prototype.visitInt16=mn(Bu);ln.prototype.visitInt32=mn(Bu);ln.prototype.visitInt64=mn(TA);ln.prototype.visitUint8=mn(Bu);ln.prototype.visitUint16=mn(Bu);ln.prototype.visitUint32=mn(Bu);ln.prototype.visitUint64=mn(TA);ln.prototype.visitFloat=mn(jH);ln.prototype.visitFloat16=mn(OH);ln.prototype.visitFloat32=mn(Bu);ln.prototype.visitFloat64=mn(Bu);ln.prototype.visitUtf8=mn(AA);ln.prototype.visitLargeUtf8=mn(AA);ln.prototype.visitBinary=mn(MA);ln.prototype.visitLargeBinary=mn(MA);ln.prototype.visitFixedSizeBinary=mn(UH);ln.prototype.visitDate=mn(qH);ln.prototype.visitDateDay=mn(SA);ln.prototype.visitDateMillisecond=mn(IA);ln.prototype.visitTimestamp=mn(HH);ln.prototype.visitTimestampSecond=mn(CA);ln.prototype.visitTimestampMillisecond=mn(kA);ln.prototype.visitTimestampMicrosecond=mn(EA);ln.prototype.visitTimestampNanosecond=mn(DA);ln.prototype.visitTime=mn(WH);ln.prototype.visitTimeSecond=mn(PA);ln.prototype.visitTimeMillisecond=mn(LA);ln.prototype.visitTimeMicrosecond=mn(zA);ln.prototype.visitTimeNanosecond=mn(BA);ln.prototype.visitDecimal=mn(ZH);ln.prototype.visitList=mn(GH);ln.prototype.visitStruct=mn(JH);ln.prototype.visitUnion=mn(KH);ln.prototype.visitDenseUnion=mn(FA);ln.prototype.visitSparseUnion=mn(NA);ln.prototype.visitDictionary=mn(XH);ln.prototype.visitInterval=mn(QH);ln.prototype.visitIntervalDayTime=mn(RA);ln.prototype.visitIntervalYearMonth=mn(OA);ln.prototype.visitDuration=mn($H);ln.prototype.visitDurationSecond=mn(UA);ln.prototype.visitDurationMillisecond=mn(VA);ln.prototype.visitDurationMicrosecond=mn(jA);ln.prototype.visitDurationNanosecond=mn(qA);ln.prototype.visitFixedSizeList=mn(eW);ln.prototype.visitMap=mn(YH);const fs=new ln,xl=Symbol.for("keys"),Yd=Symbol.for("vals");class X2{constructor(e){return this[xl]=new zi([e.children[0]]).memoize(),this[Yd]=e.children[1],new Proxy(this,new nW)}[Symbol.iterator](){return new tW(this[xl],this[Yd])}get size(){return this[xl].length}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[xl],n=this[Yd],i={};for(let o=-1,u=e.length;++o<u;)i[e.get(o)]=fs.visit(n,o);return i}toString(){return`{${[...this].map(([e,n])=>`${cm(e)}: ${cm(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class tW{constructor(e,n){this.keys=e,this.vals=n,this.keyIndex=0,this.numKeys=e.length}[Symbol.iterator](){return this}next(){const e=this.keyIndex;return e===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(e),fs.visit(this.vals,e)]})}}class nW{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[xl].toArray().map(String)}has(e,n){return e[xl].includes(n)}getOwnPropertyDescriptor(e,n){if(e[xl].indexOf(n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(e,n){if(Reflect.has(e,n))return e[n];const i=e[xl].indexOf(n);if(i!==-1){const o=fs.visit(Reflect.get(e,Yd),i);return Reflect.set(e,n,o),o}}set(e,n,i){const o=e[xl].indexOf(n);return o!==-1?(lo.visit(Reflect.get(e,Yd),o,i),Reflect.set(e,n,i)):Reflect.has(e,n)?Reflect.set(e,n,i):!1}}Object.defineProperties(X2.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[xl]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Yd]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let n9;function HA(t,e,n,i){const{length:o=0}=t;let u=typeof e!="number"?0:e,h=typeof n!="number"?o:n;return u<0&&(u=(u%o+o)%o),h<0&&(h=(h%o+o)%o),h<u&&(n9=u,u=h,h=n9),h>o&&(h=o),i?i(t,u,h):[u,h]}const i9=t=>t!==t;function If(t){if(typeof t!=="object"||t===null)return i9(t)?i9:n=>n===t;if(t instanceof Date){const n=t.valueOf();return i=>i instanceof Date?i.valueOf()===n:!1}return ArrayBuffer.isView(t)?n=>n?Kq(t,n):!1:t instanceof Map?rW(t):Array.isArray(t)?iW(t):t instanceof zi?aW(t):sW(t,!0)}function iW(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=If(t[n]);return Pg(e)}function rW(t){let e=-1;const n=[];for(const i of t.values())n[++e]=If(i);return Pg(n)}function aW(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=If(t.get(n));return Pg(e)}function sW(t,e=!1){const n=Object.keys(t);if(!e&&n.length===0)return()=>!1;const i=[];for(let o=-1,u=n.length;++o<u;)i[o]=If(t[n[o]]);return Pg(i,n)}function Pg(t,e){return n=>{if(!n||typeof n!="object")return!1;switch(n.constructor){case Array:return oW(t,n);case Map:return r9(t,n,n.keys());case X2:case J2:case Object:case void 0:return r9(t,n,e||Object.keys(n))}return n instanceof zi?lW(t,n):!1}}function oW(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e[i]))return!1;return!0}function lW(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e.get(i)))return!1;return!0}function r9(t,e,n){const i=n[Symbol.iterator](),o=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),u=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let h=0;const c=t.length;let b=u.next(),w=i.next(),S=o.next();for(;h<c&&!w.done&&!S.done&&!b.done&&!(w.value!==S.value||!t[h](b.value));++h,w=i.next(),S=o.next(),b=u.next());return h===c&&w.done&&S.done&&b.done?!0:(i.return&&i.return(),o.return&&o.return(),u.return&&u.return(),!1)}function WA(t,e,n,i){return(n&1<<i)!==0}function cW(t,e,n,i){return(n&1<<i)>>i}function a9(t,e,n){const i=n.byteLength+7&-8;if(t>0||n.byteLength<i){const o=new Uint8Array(i);return o.set(t%8===0?n.subarray(t>>3):Tv(new Q2(n,t,e,null,WA)).subarray(0,i)),o}return n}function Tv(t){const e=[];let n=0,i=0,o=0;for(const h of t)h&&(o|=1<<i),++i===8&&(e[n++]=o,o=i=0);(n===0||i>0)&&(e[n++]=o);const u=new Uint8Array(e.length+7&-8);return u.set(e),u}class Q2{constructor(e,n,i,o,u){this.bytes=e,this.length=i,this.context=o,this.get=u,this.bit=n%8,this.byteIndex=n>>3,this.byte=e[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Mv(t,e,n){if(n-e<=0)return 0;if(n-e<8){let u=0;for(const h of new Q2(t,e,n-e,t,cW))u+=h;return u}const i=n>>3<<3,o=e+(e%8===0?0:8-e%8);return Mv(t,e,o)+Mv(t,i,n)+uW(t,o>>3,i-o>>3)}function uW(t,e,n){let i=0,o=Math.trunc(e);const u=new DataView(t.buffer,t.byteOffset,t.byteLength),h=n===void 0?t.byteLength:o+n;for(;h-o>=4;)i+=gb(u.getUint32(o)),o+=4;for(;h-o>=2;)i+=gb(u.getUint16(o)),o+=2;for(;h-o>=1;)i+=gb(u.getUint8(o)),o+=1;return i}function gb(t){let e=Math.trunc(t);return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),(e+(e>>>4)&252645135)*16843009>>>24}const hW=-1;class Si{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){const{type:e}=this;return an.isSparseUnion(e)?this.children.some(n=>n.nullable):an.isDenseUnion(e)?this.children.some(n=>n.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let e=0;const{valueOffsets:n,values:i,nullBitmap:o,typeIds:u}=this;return n&&(e+=n.byteLength),i&&(e+=i.byteLength),o&&(e+=o.byteLength),u&&(e+=u.byteLength),this.children.reduce((h,c)=>h+c.byteLength,e)}get nullCount(){if(an.isUnion(this.type))return this.children.reduce((i,o)=>i+o.nullCount,0);let e=this._nullCount,n;return e<=hW&&(n=this.nullBitmap)&&(this._nullCount=e=this.length-Mv(n,this.offset,this.offset+this.length)),e}constructor(e,n,i,o,u,h=[],c){this.type=e,this.children=h,this.dictionary=c,this.offset=Math.floor(Math.max(n||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(o||0,-1));let b;u instanceof Si?(this.stride=u.stride,this.values=u.values,this.typeIds=u.typeIds,this.nullBitmap=u.nullBitmap,this.valueOffsets=u.valueOffsets):(this.stride=pc(e),u&&((b=u[0])&&(this.valueOffsets=b),(b=u[1])&&(this.values=b),(b=u[2])&&(this.nullBitmap=b),(b=u[3])&&(this.typeIds=b)))}getValid(e){const{type:n}=this;if(an.isUnion(n)){const i=n,o=this.children[i.typeIdToChildIndex[this.typeIds[e]]],u=i.mode===ds.Dense?this.valueOffsets[e]:e;return o.getValid(u)}if(this.nullable&&this.nullCount>0){const i=this.offset+e;return(this.nullBitmap[i>>3]&1<<i%8)!==0}return!0}setValid(e,n){let i;const{type:o}=this;if(an.isUnion(o)){const u=o,h=this.children[u.typeIdToChildIndex[this.typeIds[e]]],c=u.mode===ds.Dense?this.valueOffsets[e]:e;i=h.getValid(c),h.setValid(c,n)}else{let{nullBitmap:u}=this;const{offset:h,length:c}=this,b=h+e,w=1<<b%8,S=b>>3;(!u||u.byteLength<=S)&&(u=new Uint8Array((h+c+63&-64)>>3).fill(255),this.nullCount>0&&u.set(a9(h,c,this.nullBitmap),0),Object.assign(this,{nullBitmap:u,_nullCount:-1}));const M=u[S];i=(M&w)!==0,n?u[S]=M|w:u[S]=M&~w}return i!==!!n&&(this._nullCount=this.nullCount+(n?-1:1)),n}clone(e=this.type,n=this.offset,i=this.length,o=this._nullCount,u=this,h=this.children){return new Si(e,n,i,o,u,h,this.dictionary)}slice(e,n){const{stride:i,typeId:o,children:u}=this,h=+(this._nullCount===0)-1,c=o===16?i:1,b=this._sliceBuffers(e,n,i,o);return this.clone(this.type,this.offset+e,n,h,b,u.length===0||this.valueOffsets?u:this._sliceChildren(u,c*e,c*n))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===Ae.Null)return this.clone(this.type,0,e,0);const{length:n,nullCount:i}=this,o=new Uint8Array((e+63&-64)>>3).fill(255,0,n>>3);o[n>>3]=(1<<n-(n&-8))-1,i>0&&o.set(a9(this.offset,n,this.nullBitmap),0);const u=this.buffers;return u[fc.VALIDITY]=o,this.clone(this.type,0,e,i+(e-n),u)}_sliceBuffers(e,n,i,o){let u;const{buffers:h}=this;return(u=h[fc.TYPE])&&(h[fc.TYPE]=u.subarray(e,e+n)),(u=h[fc.OFFSET])&&(h[fc.OFFSET]=u.subarray(e,e+n+1))||(u=h[fc.DATA])&&(h[fc.DATA]=o===6?u:u.subarray(i*e,i*(e+n))),h}_sliceChildren(e,n,i){return e.map(o=>o.slice(n,i))}}Si.prototype.children=Object.freeze([]);class Wp extends Hn{visit(e){return this.getVisitFn(e.type).call(this,e)}visitNull(e){const{["type"]:n,["offset"]:i=0,["length"]:o=0}=e;return new Si(n,i,o,o)}visitBool(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length>>3,["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitInt(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length,["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitFloat(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length,["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitUtf8(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.data),u=ei(e.nullBitmap),h=wp(e.valueOffsets),{["length"]:c=h.length-1,["nullCount"]:b=e.nullBitmap?-1:0}=e;return new Si(n,i,c,b,[h,o,u])}visitLargeUtf8(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.data),u=ei(e.nullBitmap),h=W6(e.valueOffsets),{["length"]:c=h.length-1,["nullCount"]:b=e.nullBitmap?-1:0}=e;return new Si(n,i,c,b,[h,o,u])}visitBinary(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.data),u=ei(e.nullBitmap),h=wp(e.valueOffsets),{["length"]:c=h.length-1,["nullCount"]:b=e.nullBitmap?-1:0}=e;return new Si(n,i,c,b,[h,o,u])}visitLargeBinary(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.data),u=ei(e.nullBitmap),h=W6(e.valueOffsets),{["length"]:c=h.length-1,["nullCount"]:b=e.nullBitmap?-1:0}=e;return new Si(n,i,c,b,[h,o,u])}visitFixedSizeBinary(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length/pc(n),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitDate(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length/pc(n),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitTimestamp(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length/pc(n),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitTime(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length/pc(n),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitDecimal(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length/pc(n),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitList(e){const{["type"]:n,["offset"]:i=0,["child"]:o}=e,u=ei(e.nullBitmap),h=wp(e.valueOffsets),{["length"]:c=h.length-1,["nullCount"]:b=e.nullBitmap?-1:0}=e;return new Si(n,i,c,b,[h,void 0,u],[o])}visitStruct(e){const{["type"]:n,["offset"]:i=0,["children"]:o=[]}=e,u=ei(e.nullBitmap),{length:h=o.reduce((b,{length:w})=>Math.max(b,w),0),nullCount:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,void 0,u],o)}visitUnion(e){const{["type"]:n,["offset"]:i=0,["children"]:o=[]}=e,u=Ti(n.ArrayType,e.typeIds),{["length"]:h=u.length,["nullCount"]:c=-1}=e;if(an.isSparseUnion(n))return new Si(n,i,h,c,[void 0,void 0,void 0,u],o);const b=wp(e.valueOffsets);return new Si(n,i,h,c,[b,void 0,void 0,u],o)}visitDictionary(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.indices.ArrayType,e.data),{["dictionary"]:h=new zi([new Wp().visit({type:n.dictionary})])}=e,{["length"]:c=u.length,["nullCount"]:b=e.nullBitmap?-1:0}=e;return new Si(n,i,c,b,[void 0,u,o],[],h)}visitInterval(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length/pc(n),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitDuration(e){const{["type"]:n,["offset"]:i=0}=e,o=ei(e.nullBitmap),u=Ti(n.ArrayType,e.data),{["length"]:h=u.length,["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,u,o])}visitFixedSizeList(e){const{["type"]:n,["offset"]:i=0,["child"]:o=new Wp().visit({type:n.valueType})}=e,u=ei(e.nullBitmap),{["length"]:h=o.length/pc(n),["nullCount"]:c=e.nullBitmap?-1:0}=e;return new Si(n,i,h,c,[void 0,void 0,u],[o])}visitMap(e){const{["type"]:n,["offset"]:i=0,["child"]:o=new Wp().visit({type:n.childType})}=e,u=ei(e.nullBitmap),h=wp(e.valueOffsets),{["length"]:c=h.length-1,["nullCount"]:b=e.nullBitmap?-1:0}=e;return new Si(n,i,c,b,[h,void 0,u],[o])}}const dW=new Wp;function jn(t){return dW.visit(t)}class s9{constructor(e=0,n){this.numChunks=e,this.getChunkIterator=n,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const e=this.chunkIterator.next();if(!e.done)return e;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function fW(t){return t.some(e=>e.nullable)}function ZA(t){return t.reduce((e,n)=>e+n.nullCount,0)}function GA(t){return t.reduce((e,n,i)=>(e[i+1]=e[i]+n.length,e),new Uint32Array(t.length+1))}function YA(t,e,n,i){const o=[];for(let u=-1,h=t.length;++u<h;){const c=t[u],b=e[u],{length:w}=c;if(b>=i)break;if(n>=b+w)continue;if(b>=n&&b+w<=i){o.push(c);continue}const S=Math.max(0,n-b),M=Math.min(i-b,w);o.push(c.slice(S,M-S))}return o.length===0&&o.push(t[0].slice(0,0)),o}function $2(t,e,n,i){let o=0,u=0,h=e.length-1;do{if(o>=h-1)return n<e[h]?i(t,o,n-e[o]):null;u=o+Math.trunc((h-o)*.5),n<e[u]?h=u:o=u}while(o<h)}function ex(t,e){return t.getValid(e)}function C1(t){function e(n,i,o){return t(n[i],o)}return function(n){const i=this.data;return $2(i,this._offsets,n,e)}}function JA(t){let e;function n(i,o,u){return t(i[o],u,e)}return function(i,o){const u=this.data;e=o;const h=$2(u,this._offsets,i,n);return e=void 0,h}}function KA(t){let e;function n(i,o,u){let h=u,c=0,b=0;for(let w=o-1,S=i.length;++w<S;){const M=i[w];if(~(c=t(M,e,h)))return b+c;h=0,b+=M.length}return-1}return function(i,o){e=i;const u=this.data,h=typeof o!="number"?n(u,0,0):$2(u,this._offsets,o,n);return e=void 0,h}}class cn extends Hn{}function pW(t,e){return e===null&&t.length>0?0:-1}function mW(t,e){const{nullBitmap:n}=t;if(!n||t.nullCount<=0)return-1;let i=0;for(const o of new Q2(n,t.offset+(e||0),t.length,n,WA)){if(!o)return i;++i}return-1}function vn(t,e,n){if(e===void 0)return-1;if(e===null)switch(t.typeId){case Ae.Union:break;case Ae.Dictionary:break;default:return mW(t,n)}const i=fs.getVisitFn(t),o=If(e);for(let u=(n||0)-1,h=t.length;++u<h;)if(o(i(t,u)))return u;return-1}function XA(t,e,n){const i=fs.getVisitFn(t),o=If(e);for(let u=(n||0)-1,h=t.length;++u<h;)if(o(i(t,u)))return u;return-1}cn.prototype.visitNull=pW;cn.prototype.visitBool=vn;cn.prototype.visitInt=vn;cn.prototype.visitInt8=vn;cn.prototype.visitInt16=vn;cn.prototype.visitInt32=vn;cn.prototype.visitInt64=vn;cn.prototype.visitUint8=vn;cn.prototype.visitUint16=vn;cn.prototype.visitUint32=vn;cn.prototype.visitUint64=vn;cn.prototype.visitFloat=vn;cn.prototype.visitFloat16=vn;cn.prototype.visitFloat32=vn;cn.prototype.visitFloat64=vn;cn.prototype.visitUtf8=vn;cn.prototype.visitLargeUtf8=vn;cn.prototype.visitBinary=vn;cn.prototype.visitLargeBinary=vn;cn.prototype.visitFixedSizeBinary=vn;cn.prototype.visitDate=vn;cn.prototype.visitDateDay=vn;cn.prototype.visitDateMillisecond=vn;cn.prototype.visitTimestamp=vn;cn.prototype.visitTimestampSecond=vn;cn.prototype.visitTimestampMillisecond=vn;cn.prototype.visitTimestampMicrosecond=vn;cn.prototype.visitTimestampNanosecond=vn;cn.prototype.visitTime=vn;cn.prototype.visitTimeSecond=vn;cn.prototype.visitTimeMillisecond=vn;cn.prototype.visitTimeMicrosecond=vn;cn.prototype.visitTimeNanosecond=vn;cn.prototype.visitDecimal=vn;cn.prototype.visitList=vn;cn.prototype.visitStruct=vn;cn.prototype.visitUnion=vn;cn.prototype.visitDenseUnion=XA;cn.prototype.visitSparseUnion=XA;cn.prototype.visitDictionary=vn;cn.prototype.visitInterval=vn;cn.prototype.visitIntervalDayTime=vn;cn.prototype.visitIntervalYearMonth=vn;cn.prototype.visitDuration=vn;cn.prototype.visitDurationSecond=vn;cn.prototype.visitDurationMillisecond=vn;cn.prototype.visitDurationMicrosecond=vn;cn.prototype.visitDurationNanosecond=vn;cn.prototype.visitFixedSizeList=vn;cn.prototype.visitMap=vn;const k1=new cn;class un extends Hn{}function _n(t){const{type:e}=t;if(t.nullCount===0&&t.stride===1&&(e.typeId===Ae.Timestamp||e instanceof ku&&e.bitWidth!==64||e instanceof pm&&e.bitWidth!==64||e instanceof fm&&e.precision!==Fa.HALF))return new s9(t.data.length,i=>{const o=t.data[i];return o.values.subarray(0,o.length)[Symbol.iterator]()});let n=0;return new s9(t.data.length,i=>{const u=t.data[i].length,h=t.slice(n,n+u);return n+=u,new _W(h)})}class _W{constructor(e){this.vector=e,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}un.prototype.visitNull=_n;un.prototype.visitBool=_n;un.prototype.visitInt=_n;un.prototype.visitInt8=_n;un.prototype.visitInt16=_n;un.prototype.visitInt32=_n;un.prototype.visitInt64=_n;un.prototype.visitUint8=_n;un.prototype.visitUint16=_n;un.prototype.visitUint32=_n;un.prototype.visitUint64=_n;un.prototype.visitFloat=_n;un.prototype.visitFloat16=_n;un.prototype.visitFloat32=_n;un.prototype.visitFloat64=_n;un.prototype.visitUtf8=_n;un.prototype.visitLargeUtf8=_n;un.prototype.visitBinary=_n;un.prototype.visitLargeBinary=_n;un.prototype.visitFixedSizeBinary=_n;un.prototype.visitDate=_n;un.prototype.visitDateDay=_n;un.prototype.visitDateMillisecond=_n;un.prototype.visitTimestamp=_n;un.prototype.visitTimestampSecond=_n;un.prototype.visitTimestampMillisecond=_n;un.prototype.visitTimestampMicrosecond=_n;un.prototype.visitTimestampNanosecond=_n;un.prototype.visitTime=_n;un.prototype.visitTimeSecond=_n;un.prototype.visitTimeMillisecond=_n;un.prototype.visitTimeMicrosecond=_n;un.prototype.visitTimeNanosecond=_n;un.prototype.visitDecimal=_n;un.prototype.visitList=_n;un.prototype.visitStruct=_n;un.prototype.visitUnion=_n;un.prototype.visitDenseUnion=_n;un.prototype.visitSparseUnion=_n;un.prototype.visitDictionary=_n;un.prototype.visitInterval=_n;un.prototype.visitIntervalDayTime=_n;un.prototype.visitIntervalYearMonth=_n;un.prototype.visitDuration=_n;un.prototype.visitDurationSecond=_n;un.prototype.visitDurationMillisecond=_n;un.prototype.visitDurationMicrosecond=_n;un.prototype.visitDurationNanosecond=_n;un.prototype.visitFixedSizeList=_n;un.prototype.visitMap=_n;const tx=new un;var QA;const $A={},eC={};class zi{constructor(e){var n,i,o;const u=e[0]instanceof zi?e.flatMap(c=>c.data):e;if(u.length===0||u.some(c=>!(c instanceof Si)))throw new TypeError("Vector constructor expects an Array of Data instances.");const h=(n=u[0])===null||n===void 0?void 0:n.type;switch(u.length){case 0:this._offsets=[0];break;case 1:{const{get:c,set:b,indexOf:w}=$A[h.typeId],S=u[0];this.isValid=M=>ex(S,M),this.get=M=>c(S,M),this.set=(M,A)=>b(S,M,A),this.indexOf=M=>w(S,M),this._offsets=[0,S.length];break}default:Object.setPrototypeOf(this,eC[h.typeId]),this._offsets=GA(u);break}this.data=u,this.type=h,this.stride=pc(h),this.numChildren=(o=(i=h.children)===null||i===void 0?void 0:i.length)!==null&&o!==void 0?o:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((e,n)=>e+n.byteLength,0)}get nullable(){return fW(this.data)}get nullCount(){return ZA(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Ae[this.type.typeId]}Vector`}isValid(e){return!1}get(e){return null}set(e,n){}indexOf(e,n){return-1}includes(e,n){return this.indexOf(e,n)>-1}[Symbol.iterator](){return tx.visit(this)}concat(...e){return new zi(this.data.concat(e.flatMap(n=>n.data).flat(Number.POSITIVE_INFINITY)))}slice(e,n){return new zi(HA(this,e,n,({data:i,_offsets:o},u,h)=>YA(i,o,u,h)))}toJSON(){return[...this]}toArray(){const{type:e,data:n,length:i,stride:o,ArrayType:u}=this;switch(e.typeId){case Ae.Int:case Ae.Float:case Ae.Decimal:case Ae.Time:case Ae.Timestamp:switch(n.length){case 0:return new u;case 1:return n[0].values.subarray(0,i*o);default:return n.reduce((h,{values:c,length:b})=>(h.array.set(c.subarray(0,b*o),h.offset),h.offset+=b*o,h),{array:new u(i*o),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(e){var n;return this.getChildAt((n=this.type.children)===null||n===void 0?void 0:n.findIndex(i=>i.name===e))}getChildAt(e){return e>-1&&e<this.numChildren?new zi(this.data.map(({children:n})=>n[e])):null}get isMemoized(){return an.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(an.isDictionary(this.type)){const e=new E1(this.data[0].dictionary),n=this.data.map(i=>{const o=i.clone();return o.dictionary=e,o});return new zi(n)}return new E1(this)}unmemoize(){if(an.isDictionary(this.type)&&this.isMemoized){const e=this.data[0].dictionary.unmemoize(),n=this.data.map(i=>{const o=i.clone();return o.dictionary=e,o});return new zi(n)}return this}}QA=Symbol.toStringTag;zi[QA]=(t=>{t.type=an.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(Ae).map(n=>Ae[n]).filter(n=>typeof n=="number"&&n!==Ae.NONE);for(const n of e){const i=fs.getVisitFnByTypeId(n),o=lo.getVisitFnByTypeId(n),u=k1.getVisitFnByTypeId(n);$A[n]={get:i,set:o,indexOf:u},eC[n]=Object.create(t,{isValid:{value:C1(ex)},get:{value:C1(fs.getVisitFnByTypeId(n))},set:{value:JA(lo.getVisitFnByTypeId(n))},indexOf:{value:KA(k1.getVisitFnByTypeId(n))}})}return"Vector"})(zi.prototype);class E1 extends zi{constructor(e){super(e.data);const n=this.get,i=this.set,o=this.slice,u=new Array(this.length);Object.defineProperty(this,"get",{value(h){const c=u[h];if(c!==void 0)return c;const b=n.call(this,h);return u[h]=b,b}}),Object.defineProperty(this,"set",{value(h,c){i.call(this,h,c),u[h]=c}}),Object.defineProperty(this,"slice",{value:(h,c)=>new E1(o.call(this,h,c))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new zi(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class Av{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(e,n,i,o){return e.prep(8,24),e.writeInt64(BigInt(o??0)),e.pad(4),e.writeInt32(i),e.writeInt64(BigInt(n??0)),e.offset()}}class Es{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsFooter(e,n){return(n||new Es).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFooter(e,n){return e.setPosition(e.position()+bi),(n||new Es).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Nr.V1}schema(e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new pl).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}dictionaries(e,n){const i=this.bb.__offset(this.bb_pos,8);return i?(n||new Av).__init(this.bb.__vector(this.bb_pos+i)+e*24,this.bb):null}dictionariesLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(e,n){const i=this.bb.__offset(this.bb_pos,10);return i?(n||new Av).__init(this.bb.__vector(this.bb_pos+i)+e*24,this.bb):null}recordBatchesLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,n){const i=this.bb.__offset(this.bb_pos,12);return i?(n||new Yr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(5)}static addVersion(e,n){e.addFieldInt16(0,n,Nr.V1)}static addSchema(e,n){e.addFieldOffset(1,n,0)}static addDictionaries(e,n){e.addFieldOffset(2,n,0)}static startDictionariesVector(e,n){e.startVector(24,n,8)}static addRecordBatches(e,n){e.addFieldOffset(3,n,0)}static startRecordBatchesVector(e,n){e.startVector(24,n,8)}static addCustomMetadata(e,n){e.addFieldOffset(4,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)e.addOffset(n[i]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,n){e.finish(n)}static finishSizePrefixedFooterBuffer(e,n){e.finish(n,void 0,!0)}}class yi{constructor(e=[],n,i,o=Nr.V5){this.fields=e||[],this.metadata=n||new Map,i||(i=Cv(e)),this.dictionaries=i,this.metadataVersion=o}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(e=>e.name)}toString(){return`Schema<{ ${this.fields.map((e,n)=>`${n}: ${e}`).join(", ")} }>`}select(e){const n=new Set(e),i=this.fields.filter(o=>n.has(o.name));return new yi(i,this.metadata)}selectAt(e){const n=e.map(i=>this.fields[i]).filter(Boolean);return new yi(n,this.metadata)}assign(...e){const n=e[0]instanceof yi?e[0]:Array.isArray(e[0])?new yi(e[0]):new yi(e),i=[...this.fields],o=i_(i_(new Map,this.metadata),n.metadata),u=n.fields.filter(c=>{const b=i.findIndex(w=>w.name===c.name);return~b?(i[b]=c.clone({metadata:i_(i_(new Map,i[b].metadata),c.metadata)}))&&!1:!0}),h=Cv(u,new Map);return new yi([...i,...u],o,new Map([...this.dictionaries,...h]))}}yi.prototype.fields=null;yi.prototype.metadata=null;yi.prototype.dictionaries=null;class Xi{static new(...e){let[n,i,o,u]=e;return e[0]&&typeof e[0]=="object"&&({name:n}=e[0],i===void 0&&(i=e[0].type),o===void 0&&(o=e[0].nullable),u===void 0&&(u=e[0].metadata)),new Xi(`${n}`,i,o,u)}constructor(e,n,i=!1,o){this.name=e,this.type=n,this.nullable=i,this.metadata=o||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...e){let[n,i,o,u]=e;return!e[0]||typeof e[0]!="object"?[n=this.name,i=this.type,o=this.nullable,u=this.metadata]=e:{name:n=this.name,type:i=this.type,nullable:o=this.nullable,metadata:u=this.metadata}=e[0],Xi.new(n,i,o,u)}}Xi.prototype.type=null;Xi.prototype.name=null;Xi.prototype.nullable=null;Xi.prototype.metadata=null;function i_(t,e){return new Map([...t||new Map,...e||new Map])}function Cv(t,e=new Map){for(let n=-1,i=t.length;++n<i;){const u=t[n].type;if(an.isDictionary(u)){if(!e.has(u.id))e.set(u.id,u.dictionary);else if(e.get(u.id)!==u.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}u.children&&u.children.length>0&&Cv(u.children,e)}return e}var gW=IM,yW=hf;class nx{static decode(e){e=new yW(ei(e));const n=Es.getRootAsFooter(e),i=yi.decode(n.schema(),new Map,n.version());return new bW(i,n)}static encode(e){const n=new gW,i=yi.encode(n,e.schema);Es.startRecordBatchesVector(n,e.numRecordBatches);for(const h of[...e.recordBatches()].slice().reverse())pf.encode(n,h);const o=n.endVector();Es.startDictionariesVector(n,e.numDictionaries);for(const h of[...e.dictionaryBatches()].slice().reverse())pf.encode(n,h);const u=n.endVector();return Es.startFooter(n),Es.addSchema(n,i),Es.addVersion(n,Nr.V5),Es.addRecordBatches(n,o),Es.addDictionaries(n,u),Es.finishFooterBuffer(n,Es.endFooter(n)),n.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(e,n=Nr.V5,i,o){this.schema=e,this.version=n,i&&(this._recordBatches=i),o&&(this._dictionaryBatches=o)}*recordBatches(){for(let e,n=-1,i=this.numRecordBatches;++n<i;)(e=this.getRecordBatch(n))&&(yield e)}*dictionaryBatches(){for(let e,n=-1,i=this.numDictionaries;++n<i;)(e=this.getDictionaryBatch(n))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class bW extends nx{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(e,n){super(e,n.version()),this._footer=n}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const n=this._footer.recordBatches(e);if(n)return pf.decode(n)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const n=this._footer.dictionaries(e);if(n)return pf.decode(n)}return null}}class pf{static decode(e){return new pf(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,n){const{metaDataLength:i}=n,o=BigInt(n.offset),u=BigInt(n.bodyLength);return Av.createBlock(e,o,i,u)}constructor(e,n,i){this.metaDataLength=e,this.offset=es(i),this.bodyLength=es(n)}}const rr=Object.freeze({done:!0,value:void 0});class o9{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class tC{tee(){return this._getDOMStream().tee()}pipe(e,n){return this._getNodeStream().pipe(e,n)}pipeTo(e,n){return this._getDOMStream().pipeTo(e,n)}pipeThrough(e,n){return this._getDOMStream().pipeThrough(e,n)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class vW extends tC{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}cancel(e){return In(this,void 0,void 0,function*(){yield this.return(e)})}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(rr);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return Xs.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return Xs.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return In(this,void 0,void 0,function*(){return yield this.abort(e),rr})}return(e){return In(this,void 0,void 0,function*(){return yield this.close(),rr})}read(e){return In(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return In(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((n,i)=>{this.resolvers.push({resolve:n,reject:i})}):Promise.resolve(rr)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class xW extends vW{write(e){if((e=ei(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?bv(this.toUint8Array(!0)):this.toUint8Array(!1).then(bv)}toUint8Array(e=!1){return e?Bl(this._values)[0]:In(this,void 0,void 0,function*(){var n,i,o,u;const h=[];let c=0;try{for(var b=!0,w=Hd(this),S;S=yield w.next(),n=S.done,!n;b=!0){u=S.value,b=!1;const M=u;h.push(M),c+=M.byteLength}}catch(M){i={error:M}}finally{try{!b&&!n&&(o=w.return)&&(yield o.call(w))}finally{if(i)throw i.error}}return Bl(h,c)[0]})}}class D1{constructor(e){e&&(this.source=new wW(Xs.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class mf{constructor(e){e instanceof mf?this.source=e.source:e instanceof xW?this.source=new ch(Xs.fromAsyncIterable(e)):xM(e)?this.source=new ch(Xs.fromNodeStream(e)):H2(e)?this.source=new ch(Xs.fromDOMStream(e)):bM(e)?this.source=new ch(Xs.fromDOMStream(e.body)):Dg(e)?this.source=new ch(Xs.fromIterable(e)):lm(e)?this.source=new ch(Xs.fromAsyncIterable(e)):q2(e)&&(this.source=new ch(Xs.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class wW{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,n="read"){return this.source.next({cmd:n,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||rr)}return(e){return Object.create(this.source.return&&this.source.return(e)||rr)}}class ch{constructor(e){this.source=e,this._closedPromise=new Promise(n=>this._closedPromiseResolve=n)}cancel(e){return In(this,void 0,void 0,function*(){yield this.return(e)})}get closed(){return this._closedPromise}read(e){return In(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return In(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(e,n="read"){return In(this,void 0,void 0,function*(){return yield this.source.next({cmd:n,size:e})})}throw(e){return In(this,void 0,void 0,function*(){const n=this.source.throw&&(yield this.source.throw(e))||rr;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}return(e){return In(this,void 0,void 0,function*(){const n=this.source.return&&(yield this.source.return(e))||rr;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}}class l9 extends D1{constructor(e,n){super(),this.position=0,this.buffer=ei(e),this.size=n===void 0?this.buffer.byteLength:n}readInt32(e){const{buffer:n,byteOffset:i}=this.readAt(e,4);return new DataView(n,i).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){const{buffer:n,size:i,position:o}=this;return n&&o<i?(typeof e!="number"&&(e=Number.POSITIVE_INFINITY),this.position=Math.min(i,o+Math.min(i-o,e)),n.subarray(o,this.position)):null}readAt(e,n){const i=this.buffer,o=Math.min(this.size,e+n);return i?i.subarray(e,o):new Uint8Array(n)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}}class P1 extends mf{constructor(e,n){super(),this.position=0,this._handle=e,typeof n=="number"?this.size=n:this._pending=In(this,void 0,void 0,function*(){this.size=(yield e.stat()).size,delete this._pending})}readInt32(e){return In(this,void 0,void 0,function*(){const{buffer:n,byteOffset:i}=yield this.readAt(e,4);return new DataView(n,i).getInt32(0,!0)})}seek(e){return In(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(e,this.size),e<this.size})}read(e){return In(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:i,position:o}=this;if(n&&o<i){typeof e!="number"&&(e=Number.POSITIVE_INFINITY);let u=o,h=0,c=0;const b=Math.min(i,u+Math.min(i-u,e)),w=new Uint8Array(Math.max(0,(this.position=b)-u));for(;(u+=c)<b&&(h+=c)<w.byteLength;)({bytesRead:c}=yield n.read(w,h,w.byteLength-h,u));return w}return null})}readAt(e,n){return In(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:i,size:o}=this;if(i&&e+n<o){const u=Math.min(o,e+n),h=new Uint8Array(u-e);return(yield i.read(h,0,n,e)).buffer}return new Uint8Array(n)})}close(){return In(this,void 0,void 0,function*(){const e=this._handle;this._handle=null,e&&(yield e.close())})}throw(e){return In(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}return(e){return In(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}}const SW=65536;function Rd(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const _f=8,ix=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class nC{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){const n=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([e.buffer[1]>>>16,e.buffer[1]&65535,e.buffer[0]>>>16,e.buffer[0]&65535]);let o=n[3]*i[3];this.buffer[0]=o&65535;let u=o>>>16;return o=n[2]*i[3],u+=o,o=n[3]*i[2]>>>0,u+=o,this.buffer[0]+=u<<16,this.buffer[1]=u>>>0<o?SW:0,this.buffer[1]+=u>>>16,this.buffer[1]+=n[1]*i[3]+n[2]*i[2]+n[3]*i[1],this.buffer[1]+=n[0]*i[3]+n[1]*i[2]+n[2]*i[1]+n[3]*i[0]<<16,this}_plus(e){const n=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],n<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=n}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${Rd(this.buffer[1])} ${Rd(this.buffer[0])}`}}class Ii extends nC{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,n=new Uint32Array(2)){return Ii.fromString(typeof e=="string"?e:e.toString(),n)}static fromNumber(e,n=new Uint32Array(2)){return Ii.fromString(e.toString(),n)}static fromString(e,n=new Uint32Array(2)){const i=e.length,o=new Ii(n);for(let u=0;u<i;){const h=_f<i-u?_f:i-u,c=new Ii(new Uint32Array([Number.parseInt(e.slice(u,u+h),10),0])),b=new Ii(new Uint32Array([ix[h],0]));o.times(b),o.plus(c),u+=h}return o}static convertArray(e){const n=new Uint32Array(e.length*2);for(let i=-1,o=e.length;++i<o;)Ii.from(e[i],new Uint32Array(n.buffer,n.byteOffset+2*i*4,2));return n}static multiply(e,n){return new Ii(new Uint32Array(e.buffer)).times(n)}static add(e,n){return new Ii(new Uint32Array(e.buffer)).plus(n)}}class ls extends nC{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){const n=this.buffer[1]<<0,i=e.buffer[1]<<0;return n<i||n===i&&this.buffer[0]<e.buffer[0]}static from(e,n=new Uint32Array(2)){return ls.fromString(typeof e=="string"?e:e.toString(),n)}static fromNumber(e,n=new Uint32Array(2)){return ls.fromString(e.toString(),n)}static fromString(e,n=new Uint32Array(2)){const i=e.startsWith("-"),o=e.length,u=new ls(n);for(let h=i?1:0;h<o;){const c=_f<o-h?_f:o-h,b=new ls(new Uint32Array([Number.parseInt(e.slice(h,h+c),10),0])),w=new ls(new Uint32Array([ix[c],0]));u.times(w),u.plus(b),h+=c}return i?u.negate():u}static convertArray(e){const n=new Uint32Array(e.length*2);for(let i=-1,o=e.length;++i<o;)ls.from(e[i],new Uint32Array(n.buffer,n.byteOffset+2*i*4,2));return n}static multiply(e,n){return new ls(new Uint32Array(e.buffer)).times(n)}static add(e,n){return new ls(new Uint32Array(e.buffer)).plus(n)}}class ml{constructor(e){this.buffer=e}high(){return new ls(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new ls(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(e){const n=new Ii(new Uint32Array([this.buffer[3],0])),i=new Ii(new Uint32Array([this.buffer[2],0])),o=new Ii(new Uint32Array([this.buffer[1],0])),u=new Ii(new Uint32Array([this.buffer[0],0])),h=new Ii(new Uint32Array([e.buffer[3],0])),c=new Ii(new Uint32Array([e.buffer[2],0])),b=new Ii(new Uint32Array([e.buffer[1],0])),w=new Ii(new Uint32Array([e.buffer[0],0]));let S=Ii.multiply(u,w);this.buffer[0]=S.low();const M=new Ii(new Uint32Array([S.high(),0]));return S=Ii.multiply(o,w),M.plus(S),S=Ii.multiply(u,b),M.plus(S),this.buffer[1]=M.low(),this.buffer[3]=M.lessThan(S)?1:0,this.buffer[2]=M.high(),new Ii(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Ii.multiply(i,w)).plus(Ii.multiply(o,b)).plus(Ii.multiply(u,c)),this.buffer[3]+=Ii.multiply(n,w).plus(Ii.multiply(i,b)).plus(Ii.multiply(o,c)).plus(Ii.multiply(u,h)).low(),this}plus(e){const n=new Uint32Array(4);return n[3]=this.buffer[3]+e.buffer[3]>>>0,n[2]=this.buffer[2]+e.buffer[2]>>>0,n[1]=this.buffer[1]+e.buffer[1]>>>0,n[0]=this.buffer[0]+e.buffer[0]>>>0,n[0]<this.buffer[0]>>>0&&++n[1],n[1]<this.buffer[1]>>>0&&++n[2],n[2]<this.buffer[2]>>>0&&++n[3],this.buffer[3]=n[3],this.buffer[2]=n[2],this.buffer[1]=n[1],this.buffer[0]=n[0],this}hex(){return`${Rd(this.buffer[3])} ${Rd(this.buffer[2])} ${Rd(this.buffer[1])} ${Rd(this.buffer[0])}`}static multiply(e,n){return new ml(new Uint32Array(e.buffer)).times(n)}static add(e,n){return new ml(new Uint32Array(e.buffer)).plus(n)}static from(e,n=new Uint32Array(4)){return ml.fromString(typeof e=="string"?e:e.toString(),n)}static fromNumber(e,n=new Uint32Array(4)){return ml.fromString(e.toString(),n)}static fromString(e,n=new Uint32Array(4)){const i=e.startsWith("-"),o=e.length,u=new ml(n);for(let h=i?1:0;h<o;){const c=_f<o-h?_f:o-h,b=new ml(new Uint32Array([Number.parseInt(e.slice(h,h+c),10),0,0,0])),w=new ml(new Uint32Array([ix[c],0,0,0]));u.times(w),u.plus(b),h+=c}return i?u.negate():u}static convertArray(e){const n=new Uint32Array(e.length*4);for(let i=-1,o=e.length;++i<o;)ml.from(e[i],new Uint32Array(n.buffer,n.byteOffset+4*4*i,4));return n}}class iC extends Hn{constructor(e,n,i,o,u=Nr.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=n,this.buffers=i,this.dictionaries=o,this.metadataVersion=u}visit(e){return super.visit(e instanceof Xi?e.type:e)}visitNull(e,{length:n}=this.nextFieldNode()){return jn({type:e,length:n})}visitBool(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitInt(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitFloat(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitUtf8(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeUtf8(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitBinary(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeBinary(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitFixedSizeBinary(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDate(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitTimestamp(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitTime(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDecimal(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitList(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}visitStruct(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),children:this.visitMany(e.children)})}visitUnion(e,{length:n,nullCount:i}=this.nextFieldNode()){return this.metadataVersion<Nr.V5&&this.readNullBitmap(e,i),e.mode===ds.Sparse?this.visitSparseUnion(e,{length:n,nullCount:i}):this.visitDenseUnion(e,{length:n,nullCount:i})}visitDenseUnion(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,typeIds:this.readTypeIds(e),valueOffsets:this.readOffsets(e),children:this.visitMany(e.children)})}visitSparseUnion(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,typeIds:this.readTypeIds(e),children:this.visitMany(e.children)})}visitDictionary(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e.indices),dictionary:this.readDictionary(e)})}visitInterval(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitDuration(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),data:this.readData(e)})}visitFixedSizeList(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),child:this.visit(e.children[0])})}visitMap(e,{length:n,nullCount:i}=this.nextFieldNode()){return jn({type:e,length:n,nullCount:i,nullBitmap:this.readNullBitmap(e,i),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,n,i=this.nextBufferRange()){return n>0&&this.readData(e,i)||new Uint8Array(0)}readOffsets(e,n){return this.readData(e,n)}readTypeIds(e,n){return this.readData(e,n)}readData(e,{length:n,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+n)}readDictionary(e){return this.dictionaries.get(e.id)}}class IW extends iC{constructor(e,n,i,o,u){super(new Uint8Array(0),n,i,o,u),this.sources=e}readNullBitmap(e,n,{offset:i}=this.nextBufferRange()){return n<=0?new Uint8Array(0):Tv(this.sources[i])}readOffsets(e,{offset:n}=this.nextBufferRange()){return Ti(Uint8Array,Ti(e.OffsetArrayType,this.sources[n]))}readTypeIds(e,{offset:n}=this.nextBufferRange()){return Ti(Uint8Array,Ti(e.ArrayType,this.sources[n]))}readData(e,{offset:n}=this.nextBufferRange()){const{sources:i}=this;return an.isTimestamp(e)||(an.isInt(e)||an.isTime(e))&&e.bitWidth===64||an.isDuration(e)||an.isDate(e)&&e.unit===Ho.MILLISECOND?Ti(Uint8Array,ls.convertArray(i[n])):an.isDecimal(e)?Ti(Uint8Array,ml.convertArray(i[n])):an.isBinary(e)||an.isLargeBinary(e)||an.isFixedSizeBinary(e)?TW(i[n]):an.isBool(e)?Tv(i[n]):an.isUtf8(e)||an.isLargeUtf8(e)?j2(i[n].join("")):Ti(Uint8Array,Ti(e.ArrayType,i[n].map(o=>+o)))}}function TW(t){const e=t.join(""),n=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)n[i>>1]=Number.parseInt(e.slice(i,i+2),16);return n}class hn extends Hn{compareSchemas(e,n){return e===n||n instanceof e.constructor&&this.compareManyFields(e.fields,n.fields)}compareManyFields(e,n){return e===n||Array.isArray(e)&&Array.isArray(n)&&e.length===n.length&&e.every((i,o)=>this.compareFields(i,n[o]))}compareFields(e,n){return e===n||n instanceof e.constructor&&e.name===n.name&&e.nullable===n.nullable&&this.visit(e.type,n.type)}}function ns(t,e){return e instanceof t.constructor}function Uh(t,e){return t===e||ns(t,e)}function Fc(t,e){return t===e||ns(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function Lg(t,e){return t===e||ns(t,e)&&t.precision===e.precision}function MW(t,e){return t===e||ns(t,e)&&t.byteWidth===e.byteWidth}function rx(t,e){return t===e||ns(t,e)&&t.unit===e.unit}function Hm(t,e){return t===e||ns(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Wm(t,e){return t===e||ns(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function AW(t,e){return t===e||ns(t,e)&&t.children.length===e.children.length&&Eu.compareManyFields(t.children,e.children)}function CW(t,e){return t===e||ns(t,e)&&t.children.length===e.children.length&&Eu.compareManyFields(t.children,e.children)}function ax(t,e){return t===e||ns(t,e)&&t.mode===e.mode&&t.typeIds.every((n,i)=>n===e.typeIds[i])&&Eu.compareManyFields(t.children,e.children)}function kW(t,e){return t===e||ns(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Eu.visit(t.indices,e.indices)&&Eu.visit(t.dictionary,e.dictionary)}function sx(t,e){return t===e||ns(t,e)&&t.unit===e.unit}function Zm(t,e){return t===e||ns(t,e)&&t.unit===e.unit}function EW(t,e){return t===e||ns(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Eu.compareManyFields(t.children,e.children)}function DW(t,e){return t===e||ns(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Eu.compareManyFields(t.children,e.children)}hn.prototype.visitNull=Uh;hn.prototype.visitBool=Uh;hn.prototype.visitInt=Fc;hn.prototype.visitInt8=Fc;hn.prototype.visitInt16=Fc;hn.prototype.visitInt32=Fc;hn.prototype.visitInt64=Fc;hn.prototype.visitUint8=Fc;hn.prototype.visitUint16=Fc;hn.prototype.visitUint32=Fc;hn.prototype.visitUint64=Fc;hn.prototype.visitFloat=Lg;hn.prototype.visitFloat16=Lg;hn.prototype.visitFloat32=Lg;hn.prototype.visitFloat64=Lg;hn.prototype.visitUtf8=Uh;hn.prototype.visitLargeUtf8=Uh;hn.prototype.visitBinary=Uh;hn.prototype.visitLargeBinary=Uh;hn.prototype.visitFixedSizeBinary=MW;hn.prototype.visitDate=rx;hn.prototype.visitDateDay=rx;hn.prototype.visitDateMillisecond=rx;hn.prototype.visitTimestamp=Hm;hn.prototype.visitTimestampSecond=Hm;hn.prototype.visitTimestampMillisecond=Hm;hn.prototype.visitTimestampMicrosecond=Hm;hn.prototype.visitTimestampNanosecond=Hm;hn.prototype.visitTime=Wm;hn.prototype.visitTimeSecond=Wm;hn.prototype.visitTimeMillisecond=Wm;hn.prototype.visitTimeMicrosecond=Wm;hn.prototype.visitTimeNanosecond=Wm;hn.prototype.visitDecimal=Uh;hn.prototype.visitList=AW;hn.prototype.visitStruct=CW;hn.prototype.visitUnion=ax;hn.prototype.visitDenseUnion=ax;hn.prototype.visitSparseUnion=ax;hn.prototype.visitDictionary=kW;hn.prototype.visitInterval=sx;hn.prototype.visitIntervalDayTime=sx;hn.prototype.visitIntervalYearMonth=sx;hn.prototype.visitDuration=Zm;hn.prototype.visitDurationSecond=Zm;hn.prototype.visitDurationMillisecond=Zm;hn.prototype.visitDurationMicrosecond=Zm;hn.prototype.visitDurationNanosecond=Zm;hn.prototype.visitFixedSizeList=EW;hn.prototype.visitMap=DW;const Eu=new hn;function PW(t,e){return Eu.compareSchemas(t,e)}function yb(t,e){return LW(t,e.map(n=>n.data.concat()))}function LW(t,e){const n=[...t.fields],i=[],o={numBatches:e.reduce((M,A)=>Math.max(M,A.length),0)};let u=0,h=0,c=-1;const b=e.length;let w,S=[];for(;o.numBatches-- >0;){for(h=Number.POSITIVE_INFINITY,c=-1;++c<b;)S[c]=w=e[c].shift(),h=Math.min(h,w?w.length:h);Number.isFinite(h)&&(S=zW(n,h,S,e,o),h>0&&(i[u++]=jn({type:new Qa(n),length:h,nullCount:0,children:S.slice()})))}return[t=t.assign(n),i.map(M=>new Lo(t,M))]}function zW(t,e,n,i,o){var u;const h=(e+63&-64)>>3;for(let c=-1,b=i.length;++c<b;){const w=n[c],S=w==null?void 0:w.length;if(S>=e)S===e?n[c]=w:(n[c]=w.slice(0,e),o.numBatches=Math.max(o.numBatches,i[c].unshift(w.slice(e,S-e))));else{const M=t[c];t[c]=M.clone({nullable:!0}),n[c]=(u=w==null?void 0:w._changeLengthAndBackfillNullBitmap(e))!==null&&u!==void 0?u:jn({type:M.type,length:e,nullCount:e,nullBitmap:new Uint8Array(h)})}}return n}var rC;class to{constructor(...e){var n,i;if(e.length===0)return this.batches=[],this.schema=new yi([]),this._offsets=[0],this;let o,u;e[0]instanceof yi&&(o=e.shift()),e.at(-1)instanceof Uint32Array&&(u=e.pop());const h=b=>{if(b){if(b instanceof Lo)return[b];if(b instanceof to)return b.batches;if(b instanceof Si){if(b.type instanceof Qa)return[new Lo(new yi(b.type.children),b)]}else{if(Array.isArray(b))return b.flatMap(w=>h(w));if(typeof b[Symbol.iterator]=="function")return[...b].flatMap(w=>h(w));if(typeof b=="object"){const w=Object.keys(b),S=w.map(P=>new zi([b[P]])),M=o??new yi(w.map((P,B)=>new Xi(String(P),S[B].type,S[B].nullable))),[,A]=yb(M,S);return A.length===0?[new Lo(b)]:A}}}return[]},c=e.flatMap(b=>h(b));if(o=(i=o??((n=c[0])===null||n===void 0?void 0:n.schema))!==null&&i!==void 0?i:new yi([]),!(o instanceof yi))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const b of c){if(!(b instanceof Lo))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!PW(o,b.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=o,this.batches=c,this._offsets=u??GA(this.data)}get data(){return this.batches.map(({data:e})=>e)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((e,n)=>e+n.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=ZA(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}set(e,n){}indexOf(e,n){return-1}[Symbol.iterator](){return this.batches.length>0?tx.visit(new zi(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...e){const n=this.schema,i=this.data.concat(e.flatMap(({data:o})=>o));return new to(n,i.map(o=>new Lo(n,o)))}slice(e,n){const i=this.schema;[e,n]=HA({length:this.numRows},e,n);const o=YA(this.data,this._offsets,e,n);return new to(i,o.map(u=>new Lo(i,u)))}getChild(e){return this.getChildAt(this.schema.fields.findIndex(n=>n.name===e))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){const n=this.data.map(i=>i.children[e]);if(n.length===0){const{type:i}=this.schema.fields[e],o=jn({type:i,length:0,nullCount:0});n.push(o._changeLengthAndBackfillNullBitmap(this.numRows))}return new zi(n)}return null}setChild(e,n){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(o=>o.name===e),n)}setChildAt(e,n){let i=this.schema,o=[...this.batches];if(e>-1&&e<this.numCols){n||(n=new zi([jn({type:new Cu,length:this.numRows})]));const u=i.fields.slice(),h=u[e].clone({type:n.type}),c=this.schema.fields.map((b,w)=>this.getChildAt(w));[u[e],c[e]]=[h,n],[i,o]=yb(i,c)}return new to(i,o)}select(e){const n=this.schema.fields.reduce((i,o,u)=>i.set(o.name,u),new Map);return this.selectAt(e.map(i=>n.get(i)).filter(i=>i>-1))}selectAt(e){const n=this.schema.selectAt(e),i=this.batches.map(o=>o.selectAt(e));return new to(n,i)}assign(e){const n=this.schema.fields,[i,o]=e.schema.fields.reduce((c,b,w)=>{const[S,M]=c,A=n.findIndex(P=>P.name===b.name);return~A?M[A]=w:S.push(w),c},[[],[]]),u=this.schema.assign(e.schema),h=[...n.map((c,b)=>[b,o[b]]).map(([c,b])=>b===void 0?this.getChildAt(c):e.getChildAt(b)),...i.map(c=>e.getChildAt(c))].filter(Boolean);return new to(...yb(u,h))}}rC=Symbol.toStringTag;to[rC]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=C1(ex),t.get=C1(fs.getVisitFn(Ae.Struct)),t.set=JA(lo.getVisitFn(Ae.Struct)),t.indexOf=KA(k1.getVisitFn(Ae.Struct)),"Table"))(to.prototype);var aC;let Lo=class Op{constructor(...e){switch(e.length){case 2:{if([this.schema]=e,!(this.schema instanceof yi))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=jn({nullCount:0,type:new Qa(this.schema.fields),children:this.schema.fields.map(n=>jn({type:n.type,nullCount:0}))})]=e,!(this.data instanceof Si))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=c9(this.schema,this.data.children);break}case 1:{const[n]=e,{fields:i,children:o,length:u}=Object.keys(n).reduce((b,w,S)=>(b.children[S]=n[w],b.length=Math.max(b.length,n[w].length),b.fields[S]=Xi.new({name:w,type:n[w].type,nullable:!0}),b),{length:0,fields:new Array,children:new Array}),h=new yi(i),c=jn({type:new Qa(i),length:u,children:o,nullCount:0});[this.schema,this.data]=c9(h,c.children,u);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=sC(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return fs.visit(this.data,e)}set(e,n){return lo.visit(this.data,e,n)}indexOf(e,n){return k1.visit(this.data,e,n)}[Symbol.iterator](){return tx.visit(new zi([this.data]))}toArray(){return[...this]}concat(...e){return new to(this.schema,[this,...e])}slice(e,n){const[i]=new zi([this.data]).slice(e,n).data;return new Op(this.schema,i)}getChild(e){var n;return this.getChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(i=>i.name===e))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new zi([this.data.children[e]]):null}setChild(e,n){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(o=>o.name===e),n)}setChildAt(e,n){let i=this.schema,o=this.data;if(e>-1&&e<this.numCols){n||(n=new zi([jn({type:new Cu,length:this.numRows})]));const u=i.fields.slice(),h=o.children.slice(),c=u[e].clone({type:n.type});[u[e],h[e]]=[c,n.data[0]],i=new yi(u,new Map(this.schema.metadata)),o=jn({type:new Qa(u),children:h})}return new Op(i,o)}select(e){const n=this.schema.select(e),i=new Qa(n.fields),o=[];for(const u of e){const h=this.schema.fields.findIndex(c=>c.name===u);~h&&(o[h]=this.data.children[h])}return new Op(n,jn({type:i,length:this.numRows,children:o}))}selectAt(e){const n=this.schema.selectAt(e),i=e.map(u=>this.data.children[u]).filter(Boolean),o=jn({type:new Qa(n.fields),length:this.numRows,children:i});return new Op(n,o)}};aC=Symbol.toStringTag;Lo[aC]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Lo.prototype);function c9(t,e,n=e.reduce((i,o)=>Math.max(i,o.length),0)){var i;const o=[...t.fields],u=[...e],h=(n+63&-64)>>3;for(const[c,b]of t.fields.entries()){const w=e[c];(!w||w.length!==n)&&(o[c]=b.clone({nullable:!0}),u[c]=(i=w==null?void 0:w._changeLengthAndBackfillNullBitmap(n))!==null&&i!==void 0?i:jn({type:b.type,length:n,nullCount:n,nullBitmap:new Uint8Array(h)}))}return[t.assign(o),jn({type:new Qa(o),length:n,children:u})]}function sC(t,e,n=new Map){var i,o;if(((i=t==null?void 0:t.length)!==null&&i!==void 0?i:0)>0&&(t==null?void 0:t.length)===(e==null?void 0:e.length))for(let u=-1,h=t.length;++u<h;){const{type:c}=t[u],b=e[u];for(const w of[b,...((o=b==null?void 0:b.dictionary)===null||o===void 0?void 0:o.data)||[]])sC(c.children,w==null?void 0:w.children,n);if(an.isDictionary(c)){const{id:w}=c;if(!n.has(w))b!=null&&b.dictionary&&n.set(w,b.dictionary);else if(n.get(w)!==b.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return n}class oC extends Lo{constructor(e){const n=e.fields.map(o=>jn({type:o.type})),i=jn({type:new Qa(e.fields),nullCount:0,children:n});super(e,i)}}let lu=class dl{constructor(){this.bb=null,this.bb_pos=0}__init(e,n){return this.bb_pos=e,this.bb=n,this}static getRootAsMessage(e,n){return(n||new dl).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsMessage(e,n){return e.setPosition(e.position()+bi),(n||new dl).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):Nr.V1}headerType(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):gi.NONE}header(e){const n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__union(e,this.bb_pos+n):null}bodyLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}customMetadata(e,n){const i=this.bb.__offset(this.bb_pos,12);return i?(n||new Yr).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+e*4),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,n){e.addFieldInt16(0,n,Nr.V1)}static addHeaderType(e,n){e.addFieldInt8(1,n,gi.NONE)}static addHeader(e,n){e.addFieldOffset(2,n,0)}static addBodyLength(e,n){e.addFieldInt64(3,n,BigInt("0"))}static addCustomMetadata(e,n){e.addFieldOffset(4,n,0)}static createCustomMetadataVector(e,n){e.startVector(4,n.length,4);for(let i=n.length-1;i>=0;i--)e.addOffset(n[i]);return e.endVector()}static startCustomMetadataVector(e,n){e.startVector(4,n,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,n){e.finish(n)}static finishSizePrefixedMessageBuffer(e,n){e.finish(n,void 0,!0)}static createMessage(e,n,i,o,u,h){return dl.startMessage(e),dl.addVersion(e,n),dl.addHeaderType(e,i),dl.addHeader(e,o),dl.addBodyLength(e,u),dl.addCustomMetadata(e,h),dl.endMessage(e)}};class BW extends Hn{visit(e,n){return e==null||n==null?void 0:super.visit(e,n)}visitNull(e,n){return $6.startNull(n),$6.endNull(n)}visitInt(e,n){return Ds.startInt(n),Ds.addBitWidth(n,e.bitWidth),Ds.addIsSigned(n,e.isSigned),Ds.endInt(n)}visitFloat(e,n){return bl.startFloatingPoint(n),bl.addPrecision(n,e.precision),bl.endFloatingPoint(n)}visitBinary(e,n){return Y6.startBinary(n),Y6.endBinary(n)}visitLargeBinary(e,n){return K6.startLargeBinary(n),K6.endLargeBinary(n)}visitBool(e,n){return J6.startBool(n),J6.endBool(n)}visitUtf8(e,n){return e9.startUtf8(n),e9.endUtf8(n)}visitLargeUtf8(e,n){return X6.startLargeUtf8(n),X6.endLargeUtf8(n)}visitDecimal(e,n){return Ed.startDecimal(n),Ed.addScale(n,e.scale),Ed.addPrecision(n,e.precision),Ed.addBitWidth(n,e.bitWidth),Ed.endDecimal(n)}visitDate(e,n){return f_.startDate(n),f_.addUnit(n,e.unit),f_.endDate(n)}visitTime(e,n){return $s.startTime(n),$s.addUnit(n,e.unit),$s.addBitWidth(n,e.bitWidth),$s.endTime(n)}visitTimestamp(e,n){const i=e.timezone&&n.createString(e.timezone)||void 0;return eo.startTimestamp(n),eo.addUnit(n,e.unit),i!==void 0&&eo.addTimezone(n,i),eo.endTimestamp(n)}visitInterval(e,n){return vl.startInterval(n),vl.addUnit(n,e.unit),vl.endInterval(n)}visitDuration(e,n){return p_.startDuration(n),p_.addUnit(n,e.unit),p_.endDuration(n)}visitList(e,n){return Q6.startList(n),Q6.endList(n)}visitStruct(e,n){return mh.startStruct_(n),mh.endStruct_(n)}visitUnion(e,n){cs.startTypeIdsVector(n,e.typeIds.length);const i=cs.createTypeIdsVector(n,e.typeIds);return cs.startUnion(n),cs.addMode(n,e.mode),cs.addTypeIds(n,i),cs.endUnion(n)}visitDictionary(e,n){const i=this.visit(e.indices,n);return bc.startDictionaryEncoding(n),bc.addId(n,BigInt(e.id)),bc.addIsOrdered(n,e.isOrdered),i!==void 0&&bc.addIndexType(n,i),bc.endDictionaryEncoding(n)}visitFixedSizeBinary(e,n){return m_.startFixedSizeBinary(n),m_.addByteWidth(n,e.byteWidth),m_.endFixedSizeBinary(n)}visitFixedSizeList(e,n){return __.startFixedSizeList(n),__.addListSize(n,e.listSize),__.endFixedSizeList(n)}visitMap(e,n){return g_.startMap(n),g_.addKeysSorted(n,e.keysSorted),g_.endMap(n)}}const bb=new BW;function FW(t,e=new Map){return new yi(RW(t,e),b_(t.metadata),e)}function lC(t){return new Wo(t.count,cC(t.columns),uC(t.columns))}function NW(t){return new Cc(lC(t.data),t.id,t.isDelta)}function RW(t,e){return(t.fields||[]).filter(Boolean).map(n=>Xi.fromJSON(n,e))}function u9(t,e){return(t.children||[]).filter(Boolean).map(n=>Xi.fromJSON(n,e))}function cC(t){return(t||[]).reduce((e,n)=>[...e,new Tf(n.count,OW(n.VALIDITY)),...cC(n.children)],[])}function uC(t,e=[]){for(let n=-1,i=(t||[]).length;++n<i;){const o=t[n];o.VALIDITY&&e.push(new Sc(e.length,o.VALIDITY.length)),o.TYPE_ID&&e.push(new Sc(e.length,o.TYPE_ID.length)),o.OFFSET&&e.push(new Sc(e.length,o.OFFSET.length)),o.DATA&&e.push(new Sc(e.length,o.DATA.length)),e=uC(o.children,e)}return e}function OW(t){return(t||[]).reduce((e,n)=>e+ +(n===0),0)}function UW(t,e){let n,i,o,u,h,c;return!e||!(u=t.dictionary)?(h=d9(t,u9(t,e)),o=new Xi(t.name,h,t.nullable,b_(t.metadata))):e.has(n=u.id)?(i=(i=u.indexType)?h9(i):new dm,c=new ff(e.get(n),i,n,u.isOrdered),o=new Xi(t.name,c,t.nullable,b_(t.metadata))):(i=(i=u.indexType)?h9(i):new dm,e.set(n,h=d9(t,u9(t,e))),c=new ff(h,i,n,u.isOrdered),o=new Xi(t.name,c,t.nullable,b_(t.metadata))),o||null}function b_(t=[]){return new Map(t.map(({key:e,value:n})=>[e,n]))}function h9(t){return new ku(t.isSigned,t.bitWidth)}function d9(t,e){const n=t.type.name;switch(n){case"NONE":return new Cu;case"null":return new Cu;case"binary":return new f1;case"largebinary":return new p1;case"utf8":return new m1;case"largeutf8":return new _1;case"bool":return new g1;case"list":return new S1((e||[])[0]);case"struct":return new Qa(e||[]);case"struct_":return new Qa(e||[])}switch(n){case"int":{const i=t.type;return new ku(i.isSigned,i.bitWidth)}case"floatingpoint":{const i=t.type;return new fm(Fa[i.precision])}case"decimal":{const i=t.type;return new y1(i.scale,i.precision,i.bitWidth)}case"date":{const i=t.type;return new b1(Ho[i.unit])}case"time":{const i=t.type;return new pm(fn[i.unit],i.bitWidth)}case"timestamp":{const i=t.type;return new v1(fn[i.unit],i.timezone)}case"interval":{const i=t.type;return new x1(Fl[i.unit])}case"duration":{const i=t.type;return new w1(fn[i.unit])}case"union":{const i=t.type,[o,...u]=(i.mode+"").toLowerCase(),h=o.toUpperCase()+u.join("");return new I1(ds[h],i.typeIds||[],e||[])}case"fixedsizebinary":{const i=t.type;return new T1(i.byteWidth)}case"fixedsizelist":{const i=t.type;return new M1(i.listSize,(e||[])[0])}case"map":{const i=t.type;return new A1((e||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var VW=IM,jW=hf;class Bo{static fromJSON(e,n){const i=new Bo(0,Nr.V5,n);return i._createHeader=qW(e,n),i}static decode(e){e=new jW(ei(e));const n=lu.getRootAsMessage(e),i=n.bodyLength(),o=n.version(),u=n.headerType(),h=new Bo(i,o,u);return h._createHeader=HW(n,u),h}static encode(e){const n=new VW;let i=-1;return e.isSchema()?i=yi.encode(n,e.header()):e.isRecordBatch()?i=Wo.encode(n,e.header()):e.isDictionaryBatch()&&(i=Cc.encode(n,e.header())),lu.startMessage(n),lu.addVersion(n,Nr.V5),lu.addHeader(n,i),lu.addHeaderType(n,e.headerType),lu.addBodyLength(n,BigInt(e.bodyLength)),lu.finishMessageBuffer(n,lu.endMessage(n)),n.asUint8Array()}static from(e,n=0){if(e instanceof yi)return new Bo(0,Nr.V5,gi.Schema,e);if(e instanceof Wo)return new Bo(n,Nr.V5,gi.RecordBatch,e);if(e instanceof Cc)return new Bo(n,Nr.V5,gi.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===gi.Schema}isRecordBatch(){return this.headerType===gi.RecordBatch}isDictionaryBatch(){return this.headerType===gi.DictionaryBatch}constructor(e,n,i,o){this._version=n,this._headerType=i,this.body=new Uint8Array(0),o&&(this._createHeader=()=>o),this._bodyLength=es(e)}}class Wo{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(e,n,i){this._nodes=n,this._buffers=i,this._length=es(e)}}class Cc{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(e,n,i=!1){this._data=e,this._isDelta=i,this._id=es(n)}}class Sc{constructor(e,n){this.offset=es(e),this.length=es(n)}}class Tf{constructor(e,n){this.length=es(e),this.nullCount=es(n)}}function qW(t,e){return()=>{switch(e){case gi.Schema:return yi.fromJSON(t);case gi.RecordBatch:return Wo.fromJSON(t);case gi.DictionaryBatch:return Cc.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${gi[e]}, type: ${e} }`)}}function HW(t,e){return()=>{switch(e){case gi.Schema:return yi.decode(t.header(new pl),new Map,t.version());case gi.RecordBatch:return Wo.decode(t.header(new dc),t.version());case gi.DictionaryBatch:return Cc.decode(t.header(new Cd),t.version())}throw new Error(`Unrecognized Message type: { name: ${gi[e]}, type: ${e} }`)}}Xi.encode=tZ;Xi.decode=$W;Xi.fromJSON=UW;yi.encode=eZ;yi.decode=WW;yi.fromJSON=FW;Wo.encode=nZ;Wo.decode=ZW;Wo.fromJSON=lC;Cc.encode=iZ;Cc.decode=GW;Cc.fromJSON=NW;Tf.encode=rZ;Tf.decode=JW;Sc.encode=aZ;Sc.decode=YW;function WW(t,e=new Map,n=Nr.V5){const i=QW(t,e);return new yi(i,v_(t),e,n)}function ZW(t,e=Nr.V5){if(t.compression()!==null)throw new Error("Record batch compression not implemented");return new Wo(t.length(),KW(t),XW(t,e))}function GW(t,e=Nr.V5){return new Cc(Wo.decode(t.data(),e),t.id(),t.isDelta())}function YW(t){return new Sc(t.offset(),t.length())}function JW(t){return new Tf(t.length(),t.nullCount())}function KW(t){const e=[];for(let n,i=-1,o=-1,u=t.nodesLength();++i<u;)(n=t.nodes(i))&&(e[++o]=Tf.decode(n));return e}function XW(t,e){const n=[];for(let i,o=-1,u=-1,h=t.buffersLength();++o<h;)(i=t.buffers(o))&&(e<Nr.V4&&(i.bb_pos+=8*(o+1)),n[++u]=Sc.decode(i));return n}function QW(t,e){const n=[];for(let i,o=-1,u=-1,h=t.fieldsLength();++o<h;)(i=t.fields(o))&&(n[++u]=Xi.decode(i,e));return n}function f9(t,e){const n=[];for(let i,o=-1,u=-1,h=t.childrenLength();++o<h;)(i=t.children(o))&&(n[++u]=Xi.decode(i,e));return n}function $W(t,e){let n,i,o,u,h,c;return!e||!(c=t.dictionary())?(o=m9(t,f9(t,e)),i=new Xi(t.name(),o,t.nullable(),v_(t))):e.has(n=es(c.id()))?(u=(u=c.indexType())?p9(u):new dm,h=new ff(e.get(n),u,n,c.isOrdered()),i=new Xi(t.name(),h,t.nullable(),v_(t))):(u=(u=c.indexType())?p9(u):new dm,e.set(n,o=m9(t,f9(t,e))),h=new ff(o,u,n,c.isOrdered()),i=new Xi(t.name(),h,t.nullable(),v_(t))),i||null}function v_(t){const e=new Map;if(t)for(let n,i,o=-1,u=Math.trunc(t.customMetadataLength());++o<u;)(n=t.customMetadata(o))&&(i=n.key())!=null&&e.set(i,n.value());return e}function p9(t){return new ku(t.isSigned(),t.bitWidth())}function m9(t,e){const n=t.typeType();switch(n){case Vi.NONE:return new Cu;case Vi.Null:return new Cu;case Vi.Binary:return new f1;case Vi.LargeBinary:return new p1;case Vi.Utf8:return new m1;case Vi.LargeUtf8:return new _1;case Vi.Bool:return new g1;case Vi.List:return new S1((e||[])[0]);case Vi.Struct_:return new Qa(e||[])}switch(n){case Vi.Int:{const i=t.type(new Ds);return new ku(i.isSigned(),i.bitWidth())}case Vi.FloatingPoint:{const i=t.type(new bl);return new fm(i.precision())}case Vi.Decimal:{const i=t.type(new Ed);return new y1(i.scale(),i.precision(),i.bitWidth())}case Vi.Date:{const i=t.type(new f_);return new b1(i.unit())}case Vi.Time:{const i=t.type(new $s);return new pm(i.unit(),i.bitWidth())}case Vi.Timestamp:{const i=t.type(new eo);return new v1(i.unit(),i.timezone())}case Vi.Interval:{const i=t.type(new vl);return new x1(i.unit())}case Vi.Duration:{const i=t.type(new p_);return new w1(i.unit())}case Vi.Union:{const i=t.type(new cs);return new I1(i.mode(),i.typeIdsArray()||[],e||[])}case Vi.FixedSizeBinary:{const i=t.type(new m_);return new T1(i.byteWidth())}case Vi.FixedSizeList:{const i=t.type(new __);return new M1(i.listSize(),(e||[])[0])}case Vi.Map:{const i=t.type(new g_);return new A1((e||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${Vi[n]}" (${n})`)}function eZ(t,e){const n=e.fields.map(u=>Xi.encode(t,u));pl.startFieldsVector(t,n.length);const i=pl.createFieldsVector(t,n),o=e.metadata&&e.metadata.size>0?pl.createCustomMetadataVector(t,[...e.metadata].map(([u,h])=>{const c=t.createString(`${u}`),b=t.createString(`${h}`);return Yr.startKeyValue(t),Yr.addKey(t,c),Yr.addValue(t,b),Yr.endKeyValue(t)})):-1;return pl.startSchema(t),pl.addFields(t,i),pl.addEndianness(t,sZ?df.Little:df.Big),o!==-1&&pl.addCustomMetadata(t,o),pl.endSchema(t)}function tZ(t,e){let n=-1,i=-1,o=-1;const u=e.type;let h=e.typeId;an.isDictionary(u)?(h=u.dictionary.typeId,o=bb.visit(u,t),i=bb.visit(u.dictionary,t)):i=bb.visit(u,t);const c=(u.children||[]).map(S=>Xi.encode(t,S)),b=Ks.createChildrenVector(t,c),w=e.metadata&&e.metadata.size>0?Ks.createCustomMetadataVector(t,[...e.metadata].map(([S,M])=>{const A=t.createString(`${S}`),P=t.createString(`${M}`);return Yr.startKeyValue(t),Yr.addKey(t,A),Yr.addValue(t,P),Yr.endKeyValue(t)})):-1;return e.name&&(n=t.createString(e.name)),Ks.startField(t),Ks.addType(t,i),Ks.addTypeType(t,h),Ks.addChildren(t,b),Ks.addNullable(t,!!e.nullable),n!==-1&&Ks.addName(t,n),o!==-1&&Ks.addDictionary(t,o),w!==-1&&Ks.addCustomMetadata(t,w),Ks.endField(t)}function nZ(t,e){const n=e.nodes||[],i=e.buffers||[];dc.startNodesVector(t,n.length);for(const h of n.slice().reverse())Tf.encode(t,h);const o=t.endVector();dc.startBuffersVector(t,i.length);for(const h of i.slice().reverse())Sc.encode(t,h);const u=t.endVector();return dc.startRecordBatch(t),dc.addLength(t,BigInt(e.length)),dc.addNodes(t,o),dc.addBuffers(t,u),dc.endRecordBatch(t)}function iZ(t,e){const n=Wo.encode(t,e.data);return Cd.startDictionaryBatch(t),Cd.addId(t,BigInt(e.id)),Cd.addIsDelta(t,e.isDelta),Cd.addData(t,n),Cd.endDictionaryBatch(t)}function rZ(t,e){return AM.createFieldNode(t,BigInt(e.length),BigInt(e.nullCount))}function aZ(t,e){return MM.createBuffer(t,BigInt(e.offset),BigInt(e.length))}const sZ=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),new Int16Array(t)[0]===256})(),ox=t=>`Expected ${gi[t]} Message in stream, but was null or length 0.`,lx=t=>`Header pointer of flatbuffer-encoded ${gi[t]} Message is null or length 0.`,hC=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,dC=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class fC{constructor(e){this.source=e instanceof D1?e:new D1(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||e.value===-1&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?rr:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let n;if((n=this.next()).done)return null;if(e!=null&&n.value.headerType!==e)throw new Error(ox(e));return n.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);const n=ei(this.source.read(e));if(n.byteLength<e)throw new Error(dC(e,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()}readSchema(e=!1){const n=gi.Schema,i=this.readMessage(n),o=i==null?void 0:i.header();if(e&&!o)throw new Error(lx(n));return o}readMetadataLength(){const e=this.source.read(zg),n=e&&new hf(e),i=(n==null?void 0:n.readInt32(0))||0;return{done:i===0,value:i}}readMetadata(e){const n=this.source.read(e);if(!n)return rr;if(n.byteLength<e)throw new Error(hC(e,n.byteLength));return{done:!1,value:Bo.decode(n)}}}class oZ{constructor(e,n){this.source=e instanceof mf?e:yM(e)?new P1(e,n):new mf(e)}[Symbol.asyncIterator](){return this}next(){return In(this,void 0,void 0,function*(){let e;return(e=yield this.readMetadataLength()).done||e.value===-1&&(e=yield this.readMetadataLength()).done||(e=yield this.readMetadata(e.value)).done?rr:e})}throw(e){return In(this,void 0,void 0,function*(){return yield this.source.throw(e)})}return(e){return In(this,void 0,void 0,function*(){return yield this.source.return(e)})}readMessage(e){return In(this,void 0,void 0,function*(){let n;if((n=yield this.next()).done)return null;if(e!=null&&n.value.headerType!==e)throw new Error(ox(e));return n.value})}readMessageBody(e){return In(this,void 0,void 0,function*(){if(e<=0)return new Uint8Array(0);const n=ei(yield this.source.read(e));if(n.byteLength<e)throw new Error(dC(e,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()})}readSchema(e=!1){return In(this,void 0,void 0,function*(){const n=gi.Schema,i=yield this.readMessage(n),o=i==null?void 0:i.header();if(e&&!o)throw new Error(lx(n));return o})}readMetadataLength(){return In(this,void 0,void 0,function*(){const e=yield this.source.read(zg),n=e&&new hf(e),i=(n==null?void 0:n.readInt32(0))||0;return{done:i===0,value:i}})}readMetadata(e){return In(this,void 0,void 0,function*(){const n=yield this.source.read(e);if(!n)return rr;if(n.byteLength<e)throw new Error(hC(e,n.byteLength));return{done:!1,value:Bo.decode(n)}})}}class lZ extends fC{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof o9?e:new o9(e)}next(){const{_json:e}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Bo.fromJSON(e.schema,gi.Schema)};if(this._dictionaryIndex<e.dictionaries.length){const n=e.dictionaries[this._dictionaryIndex++];return this._body=n.data.columns,{done:!1,value:Bo.fromJSON(n,gi.DictionaryBatch)}}if(this._batchIndex<e.batches.length){const n=e.batches[this._batchIndex++];return this._body=n.columns,{done:!1,value:Bo.fromJSON(n,gi.RecordBatch)}}return this._body=[],rr}readMessageBody(e){return n(this._body);function n(i){return(i||[]).reduce((o,u)=>[...o,...u.VALIDITY&&[u.VALIDITY]||[],...u.TYPE_ID&&[u.TYPE_ID]||[],...u.OFFSET&&[u.OFFSET]||[],...u.DATA&&[u.DATA]||[],...n(u.children)],[])}}readMessage(e){let n;if((n=this.next()).done)return null;if(e!=null&&n.value.headerType!==e)throw new Error(ox(e));return n.value}readSchema(){const e=gi.Schema,n=this.readMessage(e),i=n==null?void 0:n.header();if(!n||!i)throw new Error(lx(e));return i}}const zg=4,kv="ARROW1",L1=new Uint8Array(kv.length);for(let t=0;t<kv.length;t+=1)L1[t]=kv.codePointAt(t);function cx(t,e=0){for(let n=-1,i=L1.length;++n<i;)if(L1[n]!==t[e+n])return!1;return!0}const Gm=L1.length,pC=Gm+zg,cZ=Gm*2+zg;class Ic extends tC{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){const n=this._impl.open(e);return lm(n)?n.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Xs.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Xs.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,n){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof Ic?e:vv(e)?fZ(e):yM(e)?_Z(e):lm(e)?In(this,void 0,void 0,function*(){return yield Ic.from(yield e)}):bM(e)||H2(e)||xM(e)||q2(e)?mZ(new mf(e)):pZ(new D1(e))}static readAll(e){return e instanceof Ic?e.isSync()?_9(e):g9(e):vv(e)||ArrayBuffer.isView(e)||Dg(e)||gM(e)?_9(e):g9(e)}}class z1 extends Ic{constructor(e){super(e),this._impl=e}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Sl(this,arguments,function*(){yield Pn(yield*d_(Hd(this[Symbol.iterator]())))})}}class B1 extends Ic{constructor(e){super(e),this._impl=e}readAll(){var e,n,i,o;return In(this,void 0,void 0,function*(){const u=new Array;try{for(var h=!0,c=Hd(this),b;b=yield c.next(),e=b.done,!e;h=!0){o=b.value,h=!1;const w=o;u.push(w)}}catch(w){n={error:w}}finally{try{!h&&!e&&(i=c.return)&&(yield i.call(c))}finally{if(n)throw n.error}}return u})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class mC extends z1{constructor(e){super(e),this._impl=e}}class uZ extends B1{constructor(e){super(e),this._impl=e}}class _C{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,n){const i=this._loadVectors(e,n,this.schema.fields),o=jn({type:new Qa(this.schema.fields),length:e.length,children:i});return new Lo(this.schema,o)}_loadDictionaryBatch(e,n){const{id:i,isDelta:o}=e,{dictionaries:u,schema:h}=this,c=u.get(i);if(o||!c){const b=h.dictionaries.get(i),w=this._loadVectors(e.data,n,[b]);return(c&&o?c.concat(new zi(w)):new zi(w)).memoize()}return c.memoize()}_loadVectors(e,n,i){return new iC(n,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}}class F1 extends _C{constructor(e,n){super(n),this._reader=vv(e)?new lZ(this._handle=e):new fC(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=yC(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):rr}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):rr}next(){if(this.closed)return rr;let e;const{_reader:n}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;const i=e.header(),o=n.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,o)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;const i=e.header(),o=n.readMessageBody(e.bodyLength),u=this._loadDictionaryBatch(i,o);this.dictionaries.set(i.id,u)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new oC(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}}class N1 extends _C{constructor(e,n){super(n),this._reader=new oZ(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return In(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(e){return In(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=yC(this,e),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(e){return In(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(e):rr})}return(e){return In(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(e):rr})}next(){return In(this,void 0,void 0,function*(){if(this.closed)return rr;let e;const{_reader:n}=this;for(;e=yield this._readNextMessageAndValidate();)if(e.isSchema())yield this.reset(e.header());else if(e.isRecordBatch()){this._recordBatchIndex++;const i=e.header(),o=yield n.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(i,o)}}else if(e.isDictionaryBatch()){this._dictionaryIndex++;const i=e.header(),o=yield n.readMessageBody(e.bodyLength),u=this._loadDictionaryBatch(i,o);this.dictionaries.set(i.id,u)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new oC(this.schema)}):yield this.return()})}_readNextMessageAndValidate(e){return In(this,void 0,void 0,function*(){return yield this._reader.readMessage(e)})}}class gC extends F1{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e,n){super(e instanceof l9?e:new l9(e),n)}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const n of this._footer.dictionaryBatches())n&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){var n;if(this.closed)return null;this._footer||this.open();const i=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(e);if(i&&this._handle.seek(i.offset)){const o=this._reader.readMessage(gi.RecordBatch);if(o!=null&&o.isRecordBatch()){const u=o.header(),h=this._reader.readMessageBody(o.bodyLength);return this._loadRecordBatch(u,h)}}return null}_readDictionaryBatch(e){var n;const i=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(e);if(i&&this._handle.seek(i.offset)){const o=this._reader.readMessage(gi.DictionaryBatch);if(o!=null&&o.isDictionaryBatch()){const u=o.header(),h=this._reader.readMessageBody(o.bodyLength),c=this._loadDictionaryBatch(u,h);this.dictionaries.set(u.id,c)}}}_readFooter(){const{_handle:e}=this,n=e.size-pC,i=e.readInt32(n),o=e.readAt(n-i,i);return nx.decode(o)}_readNextMessageAndValidate(e){var n;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const i=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(e)}return null}}class hZ extends N1{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e,...n){const i=typeof n[0]!="number"?n.shift():void 0,o=n[0]instanceof Map?n.shift():void 0;super(e instanceof P1?e:new P1(e,i),o)}isFile(){return!0}isAsync(){return!0}open(e){const n=Object.create(null,{open:{get:()=>super.open}});return In(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const i of this._footer.dictionaryBatches())i&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield n.open.call(this,e)})}readRecordBatch(e){var n;return In(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());const i=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(e);if(i&&(yield this._handle.seek(i.offset))){const o=yield this._reader.readMessage(gi.RecordBatch);if(o!=null&&o.isRecordBatch()){const u=o.header(),h=yield this._reader.readMessageBody(o.bodyLength);return this._loadRecordBatch(u,h)}}return null})}_readDictionaryBatch(e){var n;return In(this,void 0,void 0,function*(){const i=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(e);if(i&&(yield this._handle.seek(i.offset))){const o=yield this._reader.readMessage(gi.DictionaryBatch);if(o!=null&&o.isDictionaryBatch()){const u=o.header(),h=yield this._reader.readMessageBody(o.bodyLength),c=this._loadDictionaryBatch(u,h);this.dictionaries.set(u.id,c)}}})}_readFooter(){return In(this,void 0,void 0,function*(){const{_handle:e}=this;e._pending&&(yield e._pending);const n=e.size-pC,i=yield e.readInt32(n),o=yield e.readAt(n-i,i);return nx.decode(o)})}_readNextMessageAndValidate(e){return In(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=this._footer.getRecordBatch(this._recordBatchIndex);if(n&&(yield this._handle.seek(n.offset)))return yield this._reader.readMessage(e)}return null})}}class dZ extends F1{constructor(e,n){super(e,n)}_loadVectors(e,n,i){return new IW(n,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}}function yC(t,e){return e&&typeof e.autoDestroy=="boolean"?e.autoDestroy:t.autoDestroy}function*_9(t){const e=Ic.from(t);try{if(!e.open({autoDestroy:!1}).closed)do yield e;while(!e.reset().open().closed)}finally{e.cancel()}}function g9(t){return Sl(this,arguments,function*(){const n=yield Pn(Ic.from(t));try{if(!(yield Pn(n.open({autoDestroy:!1}))).closed)do yield yield Pn(n);while(!(yield Pn(n.reset().open())).closed)}finally{yield Pn(n.cancel())}})}function fZ(t){return new z1(new dZ(t))}function pZ(t){const e=t.peek(Gm+7&-8);return e&&e.byteLength>=4?cx(e)?new mC(new gC(t.read())):new z1(new F1(t)):new z1(new F1(function*(){}()))}function mZ(t){return In(this,void 0,void 0,function*(){const e=yield t.peek(Gm+7&-8);return e&&e.byteLength>=4?cx(e)?new mC(new gC(yield t.read())):new B1(new N1(t)):new B1(new N1(function(){return Sl(this,arguments,function*(){})}()))})}function _Z(t){return In(this,void 0,void 0,function*(){const{size:e}=yield t.stat(),n=new P1(t,e);return e>=cZ&&cx(yield n.readAt(0,Gm+7&-8))?new uZ(new hZ(n)):new B1(new N1(n))})}function bC(t){const e=Ic.from(t);return lm(e)?e.then(n=>bC(n)):e.isAsync()?e.readAll().then(n=>new to(n)):new to(e.readAll())}var vC={exports:{}};(function(){function t(Z,ne){ne=ne||[];for(var be=ne.length,me=0;me<Z.length;me++)Array.isArray(Z[me])&&Array.isArray(Z[me][0])?(t(Z[me],ne),be=ne.length):ne[be++]=Z[me];return Array.isArray(ne[0])?ne:[ne]}function e(Z,ne=32e3){const be=[];for(let me=0;me<Z.length;me+=ne)be.push(Z.slice(me,me+ne));return be}function n(Z){return Math.min.apply(null,Z.map(ne=>Math.min.apply(null,ne)))}function i(Z){return Math.max.apply(null,Z.map(ne=>Math.max.apply(null,ne)))}function o(Z){return i(e(Z.map(function(ne){return ne[1]})))}function u(Z){return i(e(Z.map(function(ne){return ne[0]})))}function h(Z){return n(e(Z.map(function(ne){return ne[1]})))}function c(Z){return n(e(Z.map(function(ne){return ne[0]})))}function b(Z){var ne={minLng:c(Z),minLat:h(Z),maxLng:u(Z),maxLat:o(Z)};return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[ne.minLng,ne.minLat],[ne.minLng,ne.maxLat],[ne.maxLng,ne.maxLat],[ne.maxLng,ne.minLat],[ne.minLng,ne.minLat]]]}}}function w(Z){return[c(Z),h(Z),u(Z),o(Z)]}function S(Z){for(var ne={x:0,y:0},be=0,me=0,Te=0,Y=0,ye=0,qe=0,He=0;He<Z.length-1;He++)me=Z[He][0],Te=Z[He][1],Y=Z[He+1][0],ye=Z[He+1][1],qe=me*ye-Y*Te,be+=qe,ne.x+=(me+Y)*qe,ne.y+=(Te+ye)*qe;return me=Z[Z.length-1][0],Te=Z[Z.length-1][1],Y=Z[0][0],ye=Z[0][1],qe=me*ye-Y*Te,be+=qe,ne.x+=(me+Y)*qe,ne.y+=(Te+ye)*qe,be=be*.5,ne.x=ne.x/(6*be),ne.y=ne.y/(6*be),[ne.x,ne.y]}function M(Z){switch(Z.geometry.type){case"GeometryCollection":return P(Z.geometry);case"FeatureCollection":return A(Z.geometry);default:return t(Z.geometry.coordinates)}}function A(Z){return t(Z.features.map(M))}function P(Z){return t(Z.geometries.map(B))}function B(Z){if(!Z)return[];switch(Z.type){case"Feature":return M(Z);case"GeometryCollection":return P(Z);case"FeatureCollection":return A(Z);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiPolygon":case"MultiLineString":return t(Z.coordinates);default:return[]}}function U(Z){return b(B(Z))}function J(Z){return w(B(Z))}function Q(Z){return S(B(Z))}function K(Z){return c(B(Z))}function le(Z){return u(B(Z))}function ee(Z){return h(B(Z))}function oe(Z){return o(B(Z))}vC.exports={envelope:U,extent:J,centroid:Q,xMin:K,xMax:le,yMin:ee,yMax:oe}})();var gZ=vC.exports;const yZ=Q9(gZ);function bZ(t){let e,n,i='<path fill="currentColor" d="M16 21a5 5 0 1 1 5-5a5.006 5.006 0 0 1-5 5m0-8a3 3 0 1 0 3 3a3.003 3.003 0 0 0-3-3"/><path fill="currentColor" d="m22.652 4.182l-2.177 2.514l-1.404 1.621l1.715 1.288A7.94 7.94 0 0 1 23.996 16l.001.058l.002.041c.018.432.241 10.111-14.654 11.722l2.18-2.517l1.404-1.621l-1.715-1.288A7.94 7.94 0 0 1 8.004 16l-.001-.058L8 15.901c-.018-.431-.24-10.094 14.651-11.719M24.998 2l-.05.001C5.254 2.915 6.005 16 6.005 16a9.98 9.98 0 0 0 4.01 7.995l-3.777 4.36A1.004 1.004 0 0 0 7.002 30l.05-.001C26.747 29.085 25.996 16 25.996 16a9.98 9.98 0 0 0-4.009-7.995l3.776-4.36A1.004 1.004 0 0 0 24.998 2"/>',o=[{viewBox:"0 0 32 32"},{width:"1.2em"},{height:"1.2em"},t[0]],u={};for(let h=0;h<o.length;h+=1)u=zs(u,o[h]);return{c(){e=Al("svg"),n=new mm(!0),this.h()},l(h){e=Cl(h,"svg",{viewBox:!0,width:!0,height:!0});var c=ht(e);n=_m(c,!0),c.forEach(Fe),this.h()},h(){n.a=null,vu(e,u)},m(h,c){Jt(h,e,c),n.m(i,e)},p(h,[c]){vu(e,u=gm(o,[{viewBox:"0 0 32 32"},{width:"1.2em"},{height:"1.2em"},c&1&&h[0]]))},i:fi,o:fi,d(h){h&&Fe(e)}}}function vZ(t,e,n){return t.$$set=i=>{n(0,e=zs(zs({},e),xu(i)))},e=xu(e),[e]}class xZ extends jr{constructor(e){super(),qr(this,e,vZ,bZ,gr,{})}}function wZ(t){let e,n,i='<g fill="currentColor"><path d="M224 128a96 96 0 1 1-96-96a96 96 0 0 1 96 96" opacity=".2"/><path d="M144 176a8 8 0 0 1-8 8a16 16 0 0 1-16-16v-40a8 8 0 0 1 0-16a16 16 0 0 1 16 16v40a8 8 0 0 1 8 8m88-48A104 104 0 1 1 128 24a104.11 104.11 0 0 1 104 104m-16 0a88 88 0 1 0-88 88a88.1 88.1 0 0 0 88-88m-92-32a12 12 0 1 0-12-12a12 12 0 0 0 12 12"/></g>',o=[{viewBox:"0 0 256 256"},{width:"1.2em"},{height:"1.2em"},t[0]],u={};for(let h=0;h<o.length;h+=1)u=zs(u,o[h]);return{c(){e=Al("svg"),n=new mm(!0),this.h()},l(h){e=Cl(h,"svg",{viewBox:!0,width:!0,height:!0});var c=ht(e);n=_m(c,!0),c.forEach(Fe),this.h()},h(){n.a=null,vu(e,u)},m(h,c){Jt(h,e,c),n.m(i,e)},p(h,[c]){vu(e,u=gm(o,[{viewBox:"0 0 256 256"},{width:"1.2em"},{height:"1.2em"},c&1&&h[0]]))},i:fi,o:fi,d(h){h&&Fe(e)}}}function SZ(t,e,n){return t.$$set=i=>{n(0,e=zs(zs({},e),xu(i)))},e=xu(e),[e]}class ul extends jr{constructor(e){super(),qr(this,e,SZ,wZ,gr,{})}}function IZ(t){let e,n,i='<g fill="currentColor"><path d="m208 96l-80 80l-80-80Z" opacity=".2"/><path d="M215.39 92.94A8 8 0 0 0 208 88H48a8 8 0 0 0-5.66 13.66l80 80a8 8 0 0 0 11.32 0l80-80a8 8 0 0 0 1.73-8.72M128 164.69L67.31 104h121.38Z"/></g>',o=[{viewBox:"0 0 256 256"},{width:"1.2em"},{height:"1.2em"},t[0]],u={};for(let h=0;h<o.length;h+=1)u=zs(u,o[h]);return{c(){e=Al("svg"),n=new mm(!0),this.h()},l(h){e=Cl(h,"svg",{viewBox:!0,width:!0,height:!0});var c=ht(e);n=_m(c,!0),c.forEach(Fe),this.h()},h(){n.a=null,vu(e,u)},m(h,c){Jt(h,e,c),n.m(i,e)},p(h,[c]){vu(e,u=gm(o,[{viewBox:"0 0 256 256"},{width:"1.2em"},{height:"1.2em"},c&1&&h[0]]))},i:fi,o:fi,d(h){h&&Fe(e)}}}function TZ(t,e,n){return t.$$set=i=>{n(0,e=zs(zs({},e),xu(i)))},e=xu(e),[e]}class y9 extends jr{constructor(e){super(),qr(this,e,TZ,IZ,gr,{})}}function MZ(t){let e,n,i='<g fill="currentColor"><path d="M208 160H48l80-80Z" opacity=".2"/><path d="m213.66 154.34l-80-80a8 8 0 0 0-11.32 0l-80 80A8 8 0 0 0 48 168h160a8 8 0 0 0 5.66-13.66M67.31 152L128 91.31L188.69 152Z"/></g>',o=[{viewBox:"0 0 256 256"},{width:"1.2em"},{height:"1.2em"},t[0]],u={};for(let h=0;h<o.length;h+=1)u=zs(u,o[h]);return{c(){e=Al("svg"),n=new mm(!0),this.h()},l(h){e=Cl(h,"svg",{viewBox:!0,width:!0,height:!0});var c=ht(e);n=_m(c,!0),c.forEach(Fe),this.h()},h(){n.a=null,vu(e,u)},m(h,c){Jt(h,e,c),n.m(i,e)},p(h,[c]){vu(e,u=gm(o,[{viewBox:"0 0 256 256"},{width:"1.2em"},{height:"1.2em"},c&1&&h[0]]))},i:fi,o:fi,d(h){h&&Fe(e)}}}function AZ(t,e,n){return t.$$set=i=>{n(0,e=zs(zs({},e),xu(i)))},e=xu(e),[e]}class b9 extends jr{constructor(e){super(),qr(this,e,AZ,MZ,gr,{})}}const CZ=t=>t.replace(/-_$/g,"").replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase(),kZ=(t,e)=>{const i=t.getBoundingClientRect().width+2,o=window.getComputedStyle(t),u=parseInt(o.getPropertyValue("padding-left"),10),h=parseInt(o.getPropertyValue("padding-right"),10),c=u+h,b=i-c;return Math.round(Math.min(e,b||e))},EZ=(t,e=null,n)=>{const i=t.getBoundingClientRect(),o=window.innerWidth||document.documentElement.clientWidth,u=window.innerHeight||document.documentElement.clientHeight;let h=i.bottom>0&&i.top<u&&i.right>0&&i.left<o;if(e){const c=e.getBoundingClientRect();return n==="top"||n==="bottom"?h=c.bottom+c.height<u&&c.top<u:h=c.right+c.width<o&&c.left<o,h}return h},v9=(t,e,n,i)=>{if(!t||!e)return i;const o=e.getBoundingClientRect(),u=t.getBoundingClientRect(),h=window.getComputedStyle(t).position;window.getComputedStyle(t);let c=0,b=0,w=0,S=0,M=0,A=t;for(;A&&A!==document.body;){const U=window.getComputedStyle(A),J=U.position,Q=A.getBoundingClientRect();J==="fixed"?(w+=Q.top+window.scrollY,M+=Q.left+window.scrollX):J==="sticky"?(S+=Q.top,M+=Q.left+window.scrollX):(J==="absolute"||J==="relative")&&(J==="absolute"&&(c-=parseFloat(U.top)||0,b-=parseFloat(U.left)||0),J==="relative"&&(c-=A.offsetTop,b-=A.offsetLeft,n==="bottom"&&(c+=u.height),n==="right"&&(b-=u.width),h==="absolute"&&n==="right"&&(b+=u.width)));const K=U.transform;if(K&&K!=="none"){const le=new DOMMatrix(K);J==="relative"||J==="absolute"?(c-=le.m42,b-=le.m41):(c-=A.offsetTop+le.m42,b-=A.offsetLeft+le.m41)}A=A.parentElement}let P=u.top+c+S-w,B=u.left+b-M;switch(n){case"top":i.top=P,i.left=B+u.width/2;break;case"bottom":i.top=P-o.height,i.left=B+u.width/2;break;case"left":i.left=B,i.top=P+u.height/2;break;case"right":i.left=B+u.width-o.width,i.top=P+u.height/2;break}return i.top+=window.scrollY,i.left+=window.scrollX,i},DZ={left:"right",right:"left",top:"bottom",bottom:"top"};function x9(t){let e,n,i=!t[11]&&w9(t);return{c(){e=Ye("div"),i&&i.c(),this.h()},l(o){e=Je(o,"DIV",{class:!0,style:!0});var u=ht(e);i&&i.l(u),u.forEach(Fe),this.h()},h(){Me(e,"class",n="tooltip animation-"+t[8]+" "+t[0]+" "+t[4]+" svelte-16lxf1i"),qt(e,"bottom","auto"),qt(e,"right","auto"),qt(e,"left",t[10].left+"px"),qt(e,"min-width",t[7]+"px"),qt(e,"max-width",t[3]+"px"),qt(e,"text-align",t[2]),qt(e,"top",t[10].top+"px"),Rn(e,"show",t[9]),Rn(e,"arrowless",!t[5])},m(o,u){Jt(o,e,u),i&&i.m(e,null),t[20](e)},p(o,u){o[11]?i&&(i.d(1),i=null):i?i.p(o,u):(i=w9(o),i.c(),i.m(e,null)),u&273&&n!==(n="tooltip animation-"+o[8]+" "+o[0]+" "+o[4]+" svelte-16lxf1i")&&Me(e,"class",n),u&1024&&qt(e,"left",o[10].left+"px"),u&128&&qt(e,"min-width",o[7]+"px"),u&8&&qt(e,"max-width",o[3]+"px"),u&4&&qt(e,"text-align",o[2]),u&1024&&qt(e,"top",o[10].top+"px"),u&785&&Rn(e,"show",o[9]),u&305&&Rn(e,"arrowless",!o[5])},d(o){o&&Fe(e),i&&i.d(),t[20](null)}}}function w9(t){let e,n;return{c(){e=new mm(!1),n=er(),this.h()},l(i){e=_m(i,!1),n=er(),this.h()},h(){e.a=n},m(i,o){e.m(t[1],i,o),Jt(i,n,o)},p(i,o){o&2&&e.p(i[1])},d(i){i&&(Fe(n),e.d())}}}function PZ(t){let e,n,i,o=t[1]&&x9(t);return{c(){o&&o.c(),e=er()},l(u){o&&o.l(u),e=er()},m(u,h){o&&o.m(u,h),Jt(u,e,h),n||(i=Yn(window,"resize",t[12]),n=!0)},p(u,[h]){u[1]?o?o.p(u,h):(o=x9(u),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null)},i:fi,o:fi,d(u){u&&Fe(e),o&&o.d(u),n=!1,i()}}}function LZ(t,e,n){let i,{targetElement:o=null}=e,{action:u="hover"}=e,{content:h=""}=e,{align:c="left"}=e,{position:b="top"}=e,{maxWidth:w=200}=e,{style:S=null}=e,{theme:M=""}=e,{animation:A=""}=e,{delay:P=200}=e,{arrow:B=!0}=e,{autoPosition:U=!1}=e,{show:J=!1}=e,Q=null,K=0,le=null,ee=null,oe=!1,Z={bottom:0,top:0,right:0,left:0};const ne=A?P:0;Ev(()=>{if(Q!==null&&(i&&!le&&(le=new h.component({target:Q,props:{action:u,...h.props}})),n(7,K=kZ(Q,w)),S&&typeof S=="object"))for(let Te in S){const Y=CZ(Te),ye=S[Te];Q.style.setProperty(`--tooltip-${Y}`,ye)}U&&!EZ(Q,o,b)&&n(0,b=DZ[b]),n(10,Z=v9(o,Q,b,Z)),A&&n(8,ee=A),setTimeout(()=>n(9,oe=!0),ne)}),Ro(()=>{le&&(le.$destroy(),le=null,n(9,oe=!1),n(13,J=!1))});const be=()=>{oe&&n(10,Z=v9(o,Q,b,Z))};function me(Te){Fr[Te?"unshift":"push"](()=>{Q=Te,n(6,Q)})}return t.$$set=Te=>{"targetElement"in Te&&n(14,o=Te.targetElement),"action"in Te&&n(15,u=Te.action),"content"in Te&&n(1,h=Te.content),"align"in Te&&n(2,c=Te.align),"position"in Te&&n(0,b=Te.position),"maxWidth"in Te&&n(3,w=Te.maxWidth),"style"in Te&&n(16,S=Te.style),"theme"in Te&&n(4,M=Te.theme),"animation"in Te&&n(17,A=Te.animation),"delay"in Te&&n(18,P=Te.delay),"arrow"in Te&&n(5,B=Te.arrow),"autoPosition"in Te&&n(19,U=Te.autoPosition),"show"in Te&&n(13,J=Te.show)},t.$$.update=()=>{t.$$.dirty&2&&n(11,i=typeof h=="object"),t.$$.dirty&8256&&(Q&&J?setTimeout(()=>n(9,oe=!0),0):n(9,oe=!1))},[b,h,c,w,M,B,Q,K,ee,oe,Z,i,be,J,o,u,S,A,P,U,me]}class zZ extends jr{constructor(e){super(),qr(this,e,LZ,PZ,gr,{targetElement:14,action:15,content:1,align:2,position:0,maxWidth:3,style:16,theme:4,animation:17,delay:18,arrow:5,autoPosition:19,show:13})}}const hl=(t,e)=>{let n=null,i=t.getAttribute("title"),o=(e==null?void 0:e.action)||t.getAttribute("action")||"hover";const u=(e==null?void 0:e.hideOnClickOutside)||t.getAttribute("hideOnClickOutside")||!1,h=({target:P})=>{u&&P&&!P.classList.contains("tooltip")&&S()},c={...e,targetElement:t};c.hideOnClickOutside&&delete c.hideOnClickOutside,i&&(t.removeAttribute("title"),c.content=i);const b=()=>{n?o==="click"&&u||S():w()},w=()=>{n||(n=new zZ({target:t,props:c}))},S=()=>{n&&(n.$destroy(),n=null)},M=()=>{t!==null&&(A(),o==="click"&&(t.addEventListener("click",b),u&&document.addEventListener("click",h,{passive:!0,capture:!0})),o==="hover"&&(t.addEventListener("mouseenter",w),t.addEventListener("mouseleave",S)))},A=()=>{u&&document.removeEventListener("click",h),t!==null&&(t.removeEventListener("click",b),t.removeEventListener("mouseenter",w),t.removeEventListener("mouseleave",S))};return M(),c.show&&setTimeout(w,0),{destroy(){A(),i&&t.setAttribute("title",i)}}},BZ=""+new URL("../assets/pnnl-logo.CCC8ic1x.svg",import.meta.url).href,FZ=""+new URL("../assets/MSD.LIVE.horiz.CEME90N3.svg",import.meta.url).href,NZ="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'%20standalone='no'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20width='100%25'%20height='100%25'%20viewBox='0%200%20247%2080'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20xml:space='preserve'%20xmlns:serif='http://www.serif.com/'%20style='fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;'%3e%3cpath%20d='M131.09,2.61C114.208,2.615%20100.32,16.508%20100.32,33.39C100.32,50.275%20114.215,64.17%20131.1,64.17C147.985,64.17%20161.88,50.275%20161.88,33.39C161.858,16.509%20147.971,2.626%20131.09,2.61ZM131.09,51.05C126.101,51.049%20121.569,49.778%20118.488,46.84C115.234,43.736%20113.567,38.82%20113.44,33.39C113.352,29.625%20114.559,23.989%20118.193,20.515C121.826,17.042%20127.885,15.73%20131.1,15.73C137.493,15.73%20141.675,17.823%20144.611,21.43C146.969,24.327%20148.707,28.084%20148.76,33.39C148.814,38.843%20147.136,43.397%20144.096,46.449C141.057,49.501%20136.657,51.051%20131.09,51.05ZM18.2,78.49C15.622,78.49%2011.574,77.876%2011.5,73.79L11.5,6.13C11.5,3.101%2015.622,1.43%2018.2,1.43C20.778,1.43%2024.9,2.802%2024.9,6.13L24.9,73.79C24.922,77.358%2020.778,78.49%2018.2,78.49ZM236.85,11.75L236.85,71.75C236.731,75.743%20233.728,76.45%20231.15,76.45C228.572,76.45%20224.549,75.536%20224.45,71.75L224.45,19.75C224.45,19.54%20224.45,19.32%20224.04,19.23C223.63,19.14%20223.62,19.23%20223.54,19.34C223.54,19.34%20215.561,47.831%20215.51,48.03C213.383,56.36%20206.885,57.147%20202.73,57.13C198.587,57.12%20193.806,55.853%20191,48C190.931,47.807%20180.97,18.31%20180.97,18.31C180.89,18.2%20180.75,18.13%20180.48,18.2C180.06,18.29%20180.06,18.51%20180.06,18.72L180.06,60.83C180.049,70.514%20171.084,78.479%20161.4,78.49L79.16,78.49C59.74,77.99%2036.72,65.33%2032.34,45.83C30.009,35.838%2031.841,25.317%2037.41,16.7C43.23,7.79%2053.19,3.19%2063.41,1.7C68.416,1.419%2073.422,2.249%2078.07,4.13C87.07,7.96%2093.85,17.34%2094.07,27.22C94.067,31.852%2092.406,36.334%2089.39,39.85C86.49,43.28%2081.28,46.34%2076.7,46.56C75.22,46.63%2070.76,46.56%2069.89,45.16C68.89,43.47%2071.49,43.3%2072.55,43.07C77.31,42.07%2080.66,39.53%2082.55,34.96C86.55,25.32%2076.19,16.75%2066.99,17.89C57.22,19.1%2049.92,28.23%2049.76,37.89C49.58,48.15%2055.65,56.89%2064.41,61.89C73.17,66.89%2080.62,68.031%2096,68.09L161.31,68.09C165.839,68.085%20168.565,65.359%20168.57,60.83L168.57,11.75C168.579,6.303%20174.063,1.826%20179.51,1.826C183.293,1.826%20187.656,3.444%20189.43,7.38C189.514,7.567%20201.46,43.08%20201.46,43.08C201.737,43.486%20202.174,43.936%20202.666,43.936C203.157,43.936%20203.643,43.486%20203.92,43.08C203.92,43.08%20215.924,7.622%20216,7.43C217.552,3.511%20222.134,1.863%20225.92,1.863C231.367,1.863%20236.85,6.346%20236.85,11.793C236.85,11.796%20236.85,11.798%20236.85,11.8L236.85,11.75Z'%20style='fill:url(%23_Linear1);fill-rule:nonzero;'/%3e%3cdefs%3e%3clinearGradient%20id='_Linear1'%20x1='0'%20y1='0'%20x2='1'%20y2='0'%20gradientUnits='userSpaceOnUse'%20gradientTransform='matrix(91.58,158.62,-158.62,91.58,76.04,-39.62)'%3e%3cstop%20offset='0'%20style='stop-color:rgb(39,168,224);stop-opacity:1'/%3e%3cstop%20offset='1'%20style='stop-color:rgb(24,171,187);stop-opacity:1'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",R1=[{id:1614,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1614]",value:"not_named_1979_1614"},{id:1615,name:"Ana",year:1979,label:"Ana (1979) [id:1615]",value:"ana_1979_1615"},{id:1616,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1616]",value:"not_named_1979_1616"},{id:1617,name:"Bob",year:1979,label:"Bob (1979) [id:1617]",value:"bob_1979_1617"},{id:1618,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1618]",value:"not_named_1979_1618"},{id:1619,name:"Claudette",year:1979,label:"Claudette (1979) [id:1619]",value:"claudette_1979_1619"},{id:1620,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1620]",value:"not_named_1979_1620"},{id:1621,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1621]",value:"not_named_1979_1621"},{id:1622,name:"David",year:1979,label:"David (1979) [id:1622]",value:"david_1979_1622"},{id:1623,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1623]",value:"not_named_1979_1623"},{id:1624,name:"Frederic",year:1979,label:"Frederic (1979) [id:1624]",value:"frederic_1979_1624"},{id:1625,name:"Elena",year:1979,label:"Elena (1979) [id:1625]",value:"elena_1979_1625"},{id:1626,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1626]",value:"not_named_1979_1626"},{id:1627,name:"Gloria",year:1979,label:"Gloria (1979) [id:1627]",value:"gloria_1979_1627"},{id:1628,name:"Henri",year:1979,label:"Henri (1979) [id:1628]",value:"henri_1979_1628"},{id:1629,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1629]",value:"not_named_1979_1629"},{id:1630,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1630]",value:"not_named_1979_1630"},{id:1631,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1631]",value:"not_named_1979_1631"},{id:1632,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1632]",value:"not_named_1979_1632"},{id:1633,name:"Not_Named",year:1979,label:"Not_Named (1979) [id:1633]",value:"not_named_1979_1633"},{id:1634,name:"Not_Named",year:1980,label:"Not_Named (1980) [id:1634]",value:"not_named_1980_1634"},{id:1635,name:"Not_Named",year:1980,label:"Not_Named (1980) [id:1635]",value:"not_named_1980_1635"},{id:1636,name:"Not_Named",year:1980,label:"Not_Named (1980) [id:1636]",value:"not_named_1980_1636"},{id:1637,name:"Allen",year:1980,label:"Allen (1980) [id:1637]",value:"allen_1980_1637"},{id:1638,name:"Not_Named",year:1980,label:"Not_Named (1980) [id:1638]",value:"not_named_1980_1638"},{id:1639,name:"Bonnie",year:1980,label:"Bonnie (1980) [id:1639]",value:"bonnie_1980_1639"},{id:1640,name:"Charley",year:1980,label:"Charley (1980) [id:1640]",value:"charley_1980_1640"},{id:1641,name:"Not_Named",year:1980,label:"Not_Named (1980) [id:1641]",value:"not_named_1980_1641"},{id:1642,name:"Georges",year:1980,label:"Georges (1980) [id:1642]",value:"georges_1980_1642"},{id:1643,name:"Earl",year:1980,label:"Earl (1980) [id:1643]",value:"earl_1980_1643"},{id:1644,name:"Danielle",year:1980,label:"Danielle (1980) [id:1644]",value:"danielle_1980_1644"},{id:1645,name:"Frances",year:1980,label:"Frances (1980) [id:1645]",value:"frances_1980_1645"},{id:1646,name:"Hermine",year:1980,label:"Hermine (1980) [id:1646]",value:"hermine_1980_1646"},{id:1647,name:"Ivan",year:1980,label:"Ivan (1980) [id:1647]",value:"ivan_1980_1647"},{id:1648,name:"Not_Named",year:1980,label:"Not_Named (1980) [id:1648]",value:"not_named_1980_1648"},{id:1649,name:"Jeanne",year:1980,label:"Jeanne (1980) [id:1649]",value:"jeanne_1980_1649"},{id:1650,name:"Not_Named",year:1980,label:"Not_Named (1980) [id:1650]",value:"not_named_1980_1650"},{id:1651,name:"Karl",year:1980,label:"Karl (1980) [id:1651]",value:"karl_1980_1651"},{id:1652,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1652]",value:"not_named_1981_1652"},{id:1653,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1653]",value:"not_named_1981_1653"},{id:1654,name:"Arlene",year:1981,label:"Arlene (1981) [id:1654]",value:"arlene_1981_1654"},{id:1655,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1655]",value:"not_named_1981_1655"},{id:1656,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1656]",value:"not_named_1981_1656"},{id:1657,name:"Bret",year:1981,label:"Bret (1981) [id:1657]",value:"bret_1981_1657"},{id:1658,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1658]",value:"not_named_1981_1658"},{id:1659,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1659]",value:"not_named_1981_1659"},{id:1660,name:"Cindy",year:1981,label:"Cindy (1981) [id:1660]",value:"cindy_1981_1660"},{id:1661,name:"Dennis",year:1981,label:"Dennis (1981) [id:1661]",value:"dennis_1981_1661"},{id:1662,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1662]",value:"not_named_1981_1662"},{id:1663,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1663]",value:"not_named_1981_1663"},{id:1664,name:"Emily",year:1981,label:"Emily (1981) [id:1664]",value:"emily_1981_1664"},{id:1665,name:"Floyd",year:1981,label:"Floyd (1981) [id:1665]",value:"floyd_1981_1665"},{id:1666,name:"Gert",year:1981,label:"Gert (1981) [id:1666]",value:"gert_1981_1666"},{id:1667,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1667]",value:"not_named_1981_1667"},{id:1668,name:"Harvey",year:1981,label:"Harvey (1981) [id:1668]",value:"harvey_1981_1668"},{id:1669,name:"Irene",year:1981,label:"Irene (1981) [id:1669]",value:"irene_1981_1669"},{id:1670,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1670]",value:"not_named_1981_1670"},{id:1671,name:"Jose",year:1981,label:"Jose (1981) [id:1671]",value:"jose_1981_1671"},{id:1672,name:"Katrina",year:1981,label:"Katrina (1981) [id:1672]",value:"katrina_1981_1672"},{id:1673,name:"Not_Named",year:1981,label:"Not_Named (1981) [id:1673]",value:"not_named_1981_1673"},{id:1674,name:"Alberto",year:1982,label:"Alberto (1982) [id:1674]",value:"alberto_1982_1674"},{id:1675,name:"Not_Named",year:1982,label:"Not_Named (1982) [id:1675]",value:"not_named_1982_1675"},{id:1676,name:"Beryl",year:1982,label:"Beryl (1982) [id:1676]",value:"beryl_1982_1676"},{id:1677,name:"Not_Named",year:1982,label:"Not_Named (1982) [id:1677]",value:"not_named_1982_1677"},{id:1678,name:"Chris",year:1982,label:"Chris (1982) [id:1678]",value:"chris_1982_1678"},{id:1679,name:"Debby",year:1982,label:"Debby (1982) [id:1679]",value:"debby_1982_1679"},{id:1680,name:"Not_Named",year:1982,label:"Not_Named (1982) [id:1680]",value:"not_named_1982_1680"},{id:1681,name:"Ernesto",year:1982,label:"Ernesto (1982) [id:1681]",value:"ernesto_1982_1681"},{id:1682,name:"Not_Named",year:1983,label:"Not_Named (1983) [id:1682]",value:"not_named_1983_1682"},{id:1683,name:"Not_Named",year:1983,label:"Not_Named (1983) [id:1683]",value:"not_named_1983_1683"},{id:1684,name:"Alicia",year:1983,label:"Alicia (1983) [id:1684]",value:"alicia_1983_1684"},{id:1685,name:"Barry",year:1983,label:"Barry (1983) [id:1685]",value:"barry_1983_1685"},{id:1686,name:"Chantal",year:1983,label:"Chantal (1983) [id:1686]",value:"chantal_1983_1686"},{id:1687,name:"Dean",year:1983,label:"Dean (1983) [id:1687]",value:"dean_1983_1687"},{id:1688,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1688]",value:"not_named_1984_1688"},{id:1689,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1689]",value:"not_named_1984_1689"},{id:1690,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1690]",value:"not_named_1984_1690"},{id:1691,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1691]",value:"not_named_1984_1691"},{id:1692,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1692]",value:"not_named_1984_1692"},{id:1693,name:"Arthur",year:1984,label:"Arthur (1984) [id:1693]",value:"arthur_1984_1693"},{id:1694,name:"Bertha",year:1984,label:"Bertha (1984) [id:1694]",value:"bertha_1984_1694"},{id:1695,name:"Cesar",year:1984,label:"Cesar (1984) [id:1695]",value:"cesar_1984_1695"},{id:1696,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1696]",value:"not_named_1984_1696"},{id:1697,name:"Diana",year:1984,label:"Diana (1984) [id:1697]",value:"diana_1984_1697"},{id:1698,name:"Edouard",year:1984,label:"Edouard (1984) [id:1698]",value:"edouard_1984_1698"},{id:1699,name:"Fran",year:1984,label:"Fran (1984) [id:1699]",value:"fran_1984_1699"},{id:1700,name:"Gustav",year:1984,label:"Gustav (1984) [id:1700]",value:"gustav_1984_1700"},{id:1701,name:"Hortense",year:1984,label:"Hortense (1984) [id:1701]",value:"hortense_1984_1701"},{id:1702,name:"Isidore",year:1984,label:"Isidore (1984) [id:1702]",value:"isidore_1984_1702"},{id:1703,name:"Josephine",year:1984,label:"Josephine (1984) [id:1703]",value:"josephine_1984_1703"},{id:1704,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1704]",value:"not_named_1984_1704"},{id:1705,name:"Klaus",year:1984,label:"Klaus (1984) [id:1705]",value:"klaus_1984_1705"},{id:1706,name:"Not_Named",year:1984,label:"Not_Named (1984) [id:1706]",value:"not_named_1984_1706"},{id:1707,name:"Lili",year:1984,label:"Lili (1984) [id:1707]",value:"lili_1984_1707"},{id:1708,name:"Ana",year:1985,label:"Ana (1985) [id:1708]",value:"ana_1985_1708"},{id:1709,name:"Bob",year:1985,label:"Bob (1985) [id:1709]",value:"bob_1985_1709"},{id:1710,name:"Claudette",year:1985,label:"Claudette (1985) [id:1710]",value:"claudette_1985_1710"},{id:1711,name:"Danny",year:1985,label:"Danny (1985) [id:1711]",value:"danny_1985_1711"},{id:1712,name:"Elena",year:1985,label:"Elena (1985) [id:1712]",value:"elena_1985_1712"},{id:1713,name:"Not_Named",year:1985,label:"Not_Named (1985) [id:1713]",value:"not_named_1985_1713"},{id:1714,name:"Not_Named",year:1985,label:"Not_Named (1985) [id:1714]",value:"not_named_1985_1714"},{id:1715,name:"Fabian",year:1985,label:"Fabian (1985) [id:1715]",value:"fabian_1985_1715"},{id:1716,name:"Gloria",year:1985,label:"Gloria (1985) [id:1716]",value:"gloria_1985_1716"},{id:1717,name:"Henri",year:1985,label:"Henri (1985) [id:1717]",value:"henri_1985_1717"},{id:1718,name:"Isabel",year:1985,label:"Isabel (1985) [id:1718]",value:"isabel_1985_1718"},{id:1719,name:"Juan",year:1985,label:"Juan (1985) [id:1719]",value:"juan_1985_1719"},{id:1720,name:"Kate",year:1985,label:"Kate (1985) [id:1720]",value:"kate_1985_1720"},{id:1721,name:"Not_Named",year:1985,label:"Not_Named (1985) [id:1721]",value:"not_named_1985_1721"},{id:1722,name:"Andrew",year:1986,label:"Andrew (1986) [id:1722]",value:"andrew_1986_1722"},{id:1723,name:"Bonnie",year:1986,label:"Bonnie (1986) [id:1723]",value:"bonnie_1986_1723"},{id:1724,name:"Not_Named",year:1986,label:"Not_Named (1986) [id:1724]",value:"not_named_1986_1724"},{id:1725,name:"Not_Named",year:1986,label:"Not_Named (1986) [id:1725]",value:"not_named_1986_1725"},{id:1726,name:"Charley",year:1986,label:"Charley (1986) [id:1726]",value:"charley_1986_1726"},{id:1727,name:"Not_Named",year:1986,label:"Not_Named (1986) [id:1727]",value:"not_named_1986_1727"},{id:1728,name:"Not_Named",year:1986,label:"Not_Named (1986) [id:1728]",value:"not_named_1986_1728"},{id:1729,name:"Danielle",year:1986,label:"Danielle (1986) [id:1729]",value:"danielle_1986_1729"},{id:1730,name:"Earl",year:1986,label:"Earl (1986) [id:1730]",value:"earl_1986_1730"},{id:1731,name:"Frances",year:1986,label:"Frances (1986) [id:1731]",value:"frances_1986_1731"},{id:1732,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1732]",value:"not_named_1987_1732"},{id:1733,name:"Arlene",year:1987,label:"Arlene (1987) [id:1733]",value:"arlene_1987_1733"},{id:1734,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1734]",value:"not_named_1987_1734"},{id:1735,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1735]",value:"not_named_1987_1735"},{id:1736,name:"Bret",year:1987,label:"Bret (1987) [id:1736]",value:"bret_1987_1736"},{id:1737,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1737]",value:"not_named_1987_1737"},{id:1738,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1738]",value:"not_named_1987_1738"},{id:1739,name:"Cindy",year:1987,label:"Cindy (1987) [id:1739]",value:"cindy_1987_1739"},{id:1740,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1740]",value:"not_named_1987_1740"},{id:1741,name:"Dennis",year:1987,label:"Dennis (1987) [id:1741]",value:"dennis_1987_1741"},{id:1742,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1742]",value:"not_named_1987_1742"},{id:1743,name:"Emily",year:1987,label:"Emily (1987) [id:1743]",value:"emily_1987_1743"},{id:1744,name:"Floyd",year:1987,label:"Floyd (1987) [id:1744]",value:"floyd_1987_1744"},{id:1745,name:"Not_Named",year:1987,label:"Not_Named (1987) [id:1745]",value:"not_named_1987_1745"},{id:1746,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1746]",value:"not_named_1988_1746"},{id:1747,name:"Alberto",year:1988,label:"Alberto (1988) [id:1747]",value:"alberto_1988_1747"},{id:1748,name:"Beryl",year:1988,label:"Beryl (1988) [id:1748]",value:"beryl_1988_1748"},{id:1749,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1749]",value:"not_named_1988_1749"},{id:1750,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1750]",value:"not_named_1988_1750"},{id:1751,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1751]",value:"not_named_1988_1751"},{id:1752,name:"Chris",year:1988,label:"Chris (1988) [id:1752]",value:"chris_1988_1752"},{id:1753,name:"Debby",year:1988,label:"Debby (1988) [id:1753]",value:"debby_1988_1753"},{id:1754,name:"Ernesto",year:1988,label:"Ernesto (1988) [id:1754]",value:"ernesto_1988_1754"},{id:1755,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1755]",value:"not_named_1988_1755"},{id:1756,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1756]",value:"not_named_1988_1756"},{id:1757,name:"Florence",year:1988,label:"Florence (1988) [id:1757]",value:"florence_1988_1757"},{id:1758,name:"Gilbert",year:1988,label:"Gilbert (1988) [id:1758]",value:"gilbert_1988_1758"},{id:1759,name:"Helene",year:1988,label:"Helene (1988) [id:1759]",value:"helene_1988_1759"},{id:1760,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1760]",value:"not_named_1988_1760"},{id:1761,name:"Isaac",year:1988,label:"Isaac (1988) [id:1761]",value:"isaac_1988_1761"},{id:1762,name:"Joan:Miriam",year:1988,label:"Joan:Miriam (1988) [id:1762]",value:"joan:miriam_1988_1762"},{id:1763,name:"Not_Named",year:1988,label:"Not_Named (1988) [id:1763]",value:"not_named_1988_1763"},{id:1764,name:"Keith",year:1988,label:"Keith (1988) [id:1764]",value:"keith_1988_1764"},{id:1765,name:"Not_Named",year:1989,label:"Not_Named (1989) [id:1765]",value:"not_named_1989_1765"},{id:1766,name:"Allison",year:1989,label:"Allison (1989) [id:1766]",value:"allison_1989_1766"},{id:1767,name:"Barry",year:1989,label:"Barry (1989) [id:1767]",value:"barry_1989_1767"},{id:1768,name:"Dean",year:1989,label:"Dean (1989) [id:1768]",value:"dean_1989_1768"},{id:1769,name:"Chantal",year:1989,label:"Chantal (1989) [id:1769]",value:"chantal_1989_1769"},{id:1770,name:"Not_Named",year:1989,label:"Not_Named (1989) [id:1770]",value:"not_named_1989_1770"},{id:1771,name:"Erin",year:1989,label:"Erin (1989) [id:1771]",value:"erin_1989_1771"},{id:1772,name:"Felix",year:1989,label:"Felix (1989) [id:1772]",value:"felix_1989_1772"},{id:1773,name:"Not_Named",year:1989,label:"Not_Named (1989) [id:1773]",value:"not_named_1989_1773"},{id:1774,name:"Gabrielle",year:1989,label:"Gabrielle (1989) [id:1774]",value:"gabrielle_1989_1774"},{id:1775,name:"Hugo",year:1989,label:"Hugo (1989) [id:1775]",value:"hugo_1989_1775"},{id:1776,name:"Iris",year:1989,label:"Iris (1989) [id:1776]",value:"iris_1989_1776"},{id:1777,name:"Not_Named",year:1989,label:"Not_Named (1989) [id:1777]",value:"not_named_1989_1777"},{id:1778,name:"Jerry",year:1989,label:"Jerry (1989) [id:1778]",value:"jerry_1989_1778"},{id:1779,name:"Karen",year:1989,label:"Karen (1989) [id:1779]",value:"karen_1989_1779"},{id:1780,name:"Not_Named",year:1990,label:"Not_Named (1990) [id:1780]",value:"not_named_1990_1780"},{id:1781,name:"Arthur",year:1990,label:"Arthur (1990) [id:1781]",value:"arthur_1990_1781"},{id:1782,name:"Bertha",year:1990,label:"Bertha (1990) [id:1782]",value:"bertha_1990_1782"},{id:1783,name:"Cesar",year:1990,label:"Cesar (1990) [id:1783]",value:"cesar_1990_1783"},{id:1784,name:"Edouard",year:1990,label:"Edouard (1990) [id:1784]",value:"edouard_1990_1784"},{id:1785,name:"Diana",year:1990,label:"Diana (1990) [id:1785]",value:"diana_1990_1785"},{id:1786,name:"Fran",year:1990,label:"Fran (1990) [id:1786]",value:"fran_1990_1786"},{id:1787,name:"Gustav",year:1990,label:"Gustav (1990) [id:1787]",value:"gustav_1990_1787"},{id:1788,name:"Hortense",year:1990,label:"Hortense (1990) [id:1788]",value:"hortense_1990_1788"},{id:1789,name:"Isidore",year:1990,label:"Isidore (1990) [id:1789]",value:"isidore_1990_1789"},{id:1790,name:"Not_Named",year:1990,label:"Not_Named (1990) [id:1790]",value:"not_named_1990_1790"},{id:1791,name:"Josephine",year:1990,label:"Josephine (1990) [id:1791]",value:"josephine_1990_1791"},{id:1792,name:"Klaus",year:1990,label:"Klaus (1990) [id:1792]",value:"klaus_1990_1792"},{id:1793,name:"Lili",year:1990,label:"Lili (1990) [id:1793]",value:"lili_1990_1793"},{id:1794,name:"Marco",year:1990,label:"Marco (1990) [id:1794]",value:"marco_1990_1794"},{id:1795,name:"Nana",year:1990,label:"Nana (1990) [id:1795]",value:"nana_1990_1795"},{id:1796,name:"Ana",year:1991,label:"Ana (1991) [id:1796]",value:"ana_1991_1796"},{id:1797,name:"Not_Named",year:1991,label:"Not_Named (1991) [id:1797]",value:"not_named_1991_1797"},{id:1798,name:"Bob",year:1991,label:"Bob (1991) [id:1798]",value:"bob_1991_1798"},{id:1799,name:"Not_Named",year:1991,label:"Not_Named (1991) [id:1799]",value:"not_named_1991_1799"},{id:1800,name:"Not_Named",year:1991,label:"Not_Named (1991) [id:1800]",value:"not_named_1991_1800"},{id:1801,name:"Claudette",year:1991,label:"Claudette (1991) [id:1801]",value:"claudette_1991_1801"},{id:1802,name:"Danny",year:1991,label:"Danny (1991) [id:1802]",value:"danny_1991_1802"},{id:1803,name:"Erika",year:1991,label:"Erika (1991) [id:1803]",value:"erika_1991_1803"},{id:1804,name:"Fabian",year:1991,label:"Fabian (1991) [id:1804]",value:"fabian_1991_1804"},{id:1805,name:"Not_Named",year:1991,label:"Not_Named (1991) [id:1805]",value:"not_named_1991_1805"},{id:1806,name:"Grace",year:1991,label:"Grace (1991) [id:1806]",value:"grace_1991_1806"},{id:1807,name:"Not_Named",year:1991,label:"Not_Named (1991) [id:1807]",value:"not_named_1991_1807"},{id:1808,name:"Not_Named",year:1992,label:"Not_Named (1992) [id:1808]",value:"not_named_1992_1808"},{id:1809,name:"Not_Named",year:1992,label:"Not_Named (1992) [id:1809]",value:"not_named_1992_1809"},{id:1810,name:"Not_Named",year:1992,label:"Not_Named (1992) [id:1810]",value:"not_named_1992_1810"},{id:1811,name:"Andrew",year:1992,label:"Andrew (1992) [id:1811]",value:"andrew_1992_1811"},{id:1812,name:"Bonnie",year:1992,label:"Bonnie (1992) [id:1812]",value:"bonnie_1992_1812"},{id:1813,name:"Charley",year:1992,label:"Charley (1992) [id:1813]",value:"charley_1992_1813"},{id:1814,name:"Danielle",year:1992,label:"Danielle (1992) [id:1814]",value:"danielle_1992_1814"},{id:1815,name:"Not_Named",year:1992,label:"Not_Named (1992) [id:1815]",value:"not_named_1992_1815"},{id:1816,name:"Earl",year:1992,label:"Earl (1992) [id:1816]",value:"earl_1992_1816"},{id:1817,name:"Frances",year:1992,label:"Frances (1992) [id:1817]",value:"frances_1992_1817"},{id:1818,name:"Not_Named",year:1993,label:"Not_Named (1993) [id:1818]",value:"not_named_1993_1818"},{id:1819,name:"Arlene",year:1993,label:"Arlene (1993) [id:1819]",value:"arlene_1993_1819"},{id:1820,name:"Bret",year:1993,label:"Bret (1993) [id:1820]",value:"bret_1993_1820"},{id:1821,name:"Cindy",year:1993,label:"Cindy (1993) [id:1821]",value:"cindy_1993_1821"},{id:1822,name:"Emily",year:1993,label:"Emily (1993) [id:1822]",value:"emily_1993_1822"},{id:1823,name:"Dennis",year:1993,label:"Dennis (1993) [id:1823]",value:"dennis_1993_1823"},{id:1824,name:"Floyd",year:1993,label:"Floyd (1993) [id:1824]",value:"floyd_1993_1824"},{id:1825,name:"Gert",year:1993,label:"Gert (1993) [id:1825]",value:"gert_1993_1825"},{id:1826,name:"Harvey",year:1993,label:"Harvey (1993) [id:1826]",value:"harvey_1993_1826"},{id:1827,name:"Not_Named",year:1993,label:"Not_Named (1993) [id:1827]",value:"not_named_1993_1827"},{id:1828,name:"Alberto",year:1994,label:"Alberto (1994) [id:1828]",value:"alberto_1994_1828"},{id:1829,name:"Not_Named",year:1994,label:"Not_Named (1994) [id:1829]",value:"not_named_1994_1829"},{id:1830,name:"Beryl",year:1994,label:"Beryl (1994) [id:1830]",value:"beryl_1994_1830"},{id:1831,name:"Chris",year:1994,label:"Chris (1994) [id:1831]",value:"chris_1994_1831"},{id:1832,name:"Not_Named",year:1994,label:"Not_Named (1994) [id:1832]",value:"not_named_1994_1832"},{id:1833,name:"Debby",year:1994,label:"Debby (1994) [id:1833]",value:"debby_1994_1833"},{id:1834,name:"Ernesto",year:1994,label:"Ernesto (1994) [id:1834]",value:"ernesto_1994_1834"},{id:1835,name:"Not_Named",year:1994,label:"Not_Named (1994) [id:1835]",value:"not_named_1994_1835"},{id:1836,name:"Not_Named",year:1994,label:"Not_Named (1994) [id:1836]",value:"not_named_1994_1836"},{id:1837,name:"Not_Named",year:1994,label:"Not_Named (1994) [id:1837]",value:"not_named_1994_1837"},{id:1838,name:"Florence",year:1994,label:"Florence (1994) [id:1838]",value:"florence_1994_1838"},{id:1839,name:"Gordon",year:1994,label:"Gordon (1994) [id:1839]",value:"gordon_1994_1839"},{id:1840,name:"Allison",year:1995,label:"Allison (1995) [id:1840]",value:"allison_1995_1840"},{id:1841,name:"Barry",year:1995,label:"Barry (1995) [id:1841]",value:"barry_1995_1841"},{id:1842,name:"Chantal",year:1995,label:"Chantal (1995) [id:1842]",value:"chantal_1995_1842"},{id:1843,name:"Dean",year:1995,label:"Dean (1995) [id:1843]",value:"dean_1995_1843"},{id:1844,name:"Erin",year:1995,label:"Erin (1995) [id:1844]",value:"erin_1995_1844"},{id:1845,name:"Not_Named",year:1995,label:"Not_Named (1995) [id:1845]",value:"not_named_1995_1845"},{id:1846,name:"Felix",year:1995,label:"Felix (1995) [id:1846]",value:"felix_1995_1846"},{id:1847,name:"Gabrielle",year:1995,label:"Gabrielle (1995) [id:1847]",value:"gabrielle_1995_1847"},{id:1848,name:"Humberto",year:1995,label:"Humberto (1995) [id:1848]",value:"humberto_1995_1848"},{id:1849,name:"Iris",year:1995,label:"Iris (1995) [id:1849]",value:"iris_1995_1849"},{id:1850,name:"Jerry",year:1995,label:"Jerry (1995) [id:1850]",value:"jerry_1995_1850"},{id:1851,name:"Karen",year:1995,label:"Karen (1995) [id:1851]",value:"karen_1995_1851"},{id:1852,name:"Luis",year:1995,label:"Luis (1995) [id:1852]",value:"luis_1995_1852"},{id:1853,name:"Not_Named",year:1995,label:"Not_Named (1995) [id:1853]",value:"not_named_1995_1853"},{id:1854,name:"Marilyn",year:1995,label:"Marilyn (1995) [id:1854]",value:"marilyn_1995_1854"},{id:1855,name:"Noel",year:1995,label:"Noel (1995) [id:1855]",value:"noel_1995_1855"},{id:1856,name:"Opal",year:1995,label:"Opal (1995) [id:1856]",value:"opal_1995_1856"},{id:1857,name:"Pablo",year:1995,label:"Pablo (1995) [id:1857]",value:"pablo_1995_1857"},{id:1858,name:"Roxanne",year:1995,label:"Roxanne (1995) [id:1858]",value:"roxanne_1995_1858"},{id:1859,name:"Sebastien",year:1995,label:"Sebastien (1995) [id:1859]",value:"sebastien_1995_1859"},{id:1860,name:"Tanya",year:1995,label:"Tanya (1995) [id:1860]",value:"tanya_1995_1860"},{id:1861,name:"Arthur",year:1996,label:"Arthur (1996) [id:1861]",value:"arthur_1996_1861"},{id:1862,name:"Bertha",year:1996,label:"Bertha (1996) [id:1862]",value:"bertha_1996_1862"},{id:1863,name:"Cesar",year:1996,label:"Cesar (1996) [id:1863]",value:"cesar_1996_1863"},{id:1864,name:"Dolly",year:1996,label:"Dolly (1996) [id:1864]",value:"dolly_1996_1864"},{id:1865,name:"Edouard",year:1996,label:"Edouard (1996) [id:1865]",value:"edouard_1996_1865"},{id:1866,name:"Fran",year:1996,label:"Fran (1996) [id:1866]",value:"fran_1996_1866"},{id:1867,name:"Gustav",year:1996,label:"Gustav (1996) [id:1867]",value:"gustav_1996_1867"},{id:1868,name:"Hortense",year:1996,label:"Hortense (1996) [id:1868]",value:"hortense_1996_1868"},{id:1869,name:"Isidore",year:1996,label:"Isidore (1996) [id:1869]",value:"isidore_1996_1869"},{id:1870,name:"Josephine",year:1996,label:"Josephine (1996) [id:1870]",value:"josephine_1996_1870"},{id:1871,name:"Kyle",year:1996,label:"Kyle (1996) [id:1871]",value:"kyle_1996_1871"},{id:1872,name:"Lili",year:1996,label:"Lili (1996) [id:1872]",value:"lili_1996_1872"},{id:1873,name:"Marco",year:1996,label:"Marco (1996) [id:1873]",value:"marco_1996_1873"},{id:1874,name:"Not_Named",year:1997,label:"Not_Named (1997) [id:1874]",value:"not_named_1997_1874"},{id:1875,name:"Ana",year:1997,label:"Ana (1997) [id:1875]",value:"ana_1997_1875"},{id:1876,name:"Bill",year:1997,label:"Bill (1997) [id:1876]",value:"bill_1997_1876"},{id:1877,name:"Claudette",year:1997,label:"Claudette (1997) [id:1877]",value:"claudette_1997_1877"},{id:1878,name:"Not_Named",year:1997,label:"Not_Named (1997) [id:1878]",value:"not_named_1997_1878"},{id:1879,name:"Danny",year:1997,label:"Danny (1997) [id:1879]",value:"danny_1997_1879"},{id:1880,name:"Erika",year:1997,label:"Erika (1997) [id:1880]",value:"erika_1997_1880"},{id:1881,name:"Fabian",year:1997,label:"Fabian (1997) [id:1881]",value:"fabian_1997_1881"},{id:1882,name:"Grace",year:1997,label:"Grace (1997) [id:1882]",value:"grace_1997_1882"},{id:1883,name:"Alex",year:1998,label:"Alex (1998) [id:1883]",value:"alex_1998_1883"},{id:1884,name:"Bonnie",year:1998,label:"Bonnie (1998) [id:1884]",value:"bonnie_1998_1884"},{id:1885,name:"Charley",year:1998,label:"Charley (1998) [id:1885]",value:"charley_1998_1885"},{id:1886,name:"Danielle",year:1998,label:"Danielle (1998) [id:1886]",value:"danielle_1998_1886"},{id:1887,name:"Earl",year:1998,label:"Earl (1998) [id:1887]",value:"earl_1998_1887"},{id:1888,name:"Frances",year:1998,label:"Frances (1998) [id:1888]",value:"frances_1998_1888"},{id:1889,name:"Georges",year:1998,label:"Georges (1998) [id:1889]",value:"georges_1998_1889"},{id:1890,name:"Hermine",year:1998,label:"Hermine (1998) [id:1890]",value:"hermine_1998_1890"},{id:1891,name:"Ivan",year:1998,label:"Ivan (1998) [id:1891]",value:"ivan_1998_1891"},{id:1892,name:"Jeanne",year:1998,label:"Jeanne (1998) [id:1892]",value:"jeanne_1998_1892"},{id:1893,name:"Karl",year:1998,label:"Karl (1998) [id:1893]",value:"karl_1998_1893"},{id:1894,name:"Lisa",year:1998,label:"Lisa (1998) [id:1894]",value:"lisa_1998_1894"},{id:1895,name:"Mitch",year:1998,label:"Mitch (1998) [id:1895]",value:"mitch_1998_1895"},{id:1896,name:"Nicole",year:1998,label:"Nicole (1998) [id:1896]",value:"nicole_1998_1896"},{id:1897,name:"Arlene",year:1999,label:"Arlene (1999) [id:1897]",value:"arlene_1999_1897"},{id:1898,name:"Not_Named",year:1999,label:"Not_Named (1999) [id:1898]",value:"not_named_1999_1898"},{id:1899,name:"Cindy",year:1999,label:"Cindy (1999) [id:1899]",value:"cindy_1999_1899"},{id:1900,name:"Bret",year:1999,label:"Bret (1999) [id:1900]",value:"bret_1999_1900"},{id:1901,name:"Emily",year:1999,label:"Emily (1999) [id:1901]",value:"emily_1999_1901"},{id:1902,name:"Dennis",year:1999,label:"Dennis (1999) [id:1902]",value:"dennis_1999_1902"},{id:1903,name:"Not_Named",year:1999,label:"Not_Named (1999) [id:1903]",value:"not_named_1999_1903"},{id:1904,name:"Floyd",year:1999,label:"Floyd (1999) [id:1904]",value:"floyd_1999_1904"},{id:1905,name:"Gert",year:1999,label:"Gert (1999) [id:1905]",value:"gert_1999_1905"},{id:1906,name:"Harvey",year:1999,label:"Harvey (1999) [id:1906]",value:"harvey_1999_1906"},{id:1907,name:"Not_Named",year:1999,label:"Not_Named (1999) [id:1907]",value:"not_named_1999_1907"},{id:1908,name:"Not_Named",year:1999,label:"Not_Named (1999) [id:1908]",value:"not_named_1999_1908"},{id:1909,name:"Irene",year:1999,label:"Irene (1999) [id:1909]",value:"irene_1999_1909"},{id:1910,name:"Jose",year:1999,label:"Jose (1999) [id:1910]",value:"jose_1999_1910"},{id:1911,name:"Katrina",year:1999,label:"Katrina (1999) [id:1911]",value:"katrina_1999_1911"},{id:1912,name:"Lenny",year:1999,label:"Lenny (1999) [id:1912]",value:"lenny_1999_1912"},{id:1913,name:"Not_Named",year:2e3,label:"Not_Named (2000) [id:1913]",value:"not_named_2000_1913"},{id:1914,name:"Not_Named",year:2e3,label:"Not_Named (2000) [id:1914]",value:"not_named_2000_1914"},{id:1915,name:"Alberto",year:2e3,label:"Alberto (2000) [id:1915]",value:"alberto_2000_1915"},{id:1916,name:"Not_Named",year:2e3,label:"Not_Named (2000) [id:1916]",value:"not_named_2000_1916"},{id:1917,name:"Beryl",year:2e3,label:"Beryl (2000) [id:1917]",value:"beryl_2000_1917"},{id:1918,name:"Chris",year:2e3,label:"Chris (2000) [id:1918]",value:"chris_2000_1918"},{id:1919,name:"Debby",year:2e3,label:"Debby (2000) [id:1919]",value:"debby_2000_1919"},{id:1920,name:"Ernesto",year:2e3,label:"Ernesto (2000) [id:1920]",value:"ernesto_2000_1920"},{id:1921,name:"Not_Named",year:2e3,label:"Not_Named (2000) [id:1921]",value:"not_named_2000_1921"},{id:1922,name:"Florence",year:2e3,label:"Florence (2000) [id:1922]",value:"florence_2000_1922"},{id:1923,name:"Gordon",year:2e3,label:"Gordon (2000) [id:1923]",value:"gordon_2000_1923"},{id:1924,name:"Helene",year:2e3,label:"Helene (2000) [id:1924]",value:"helene_2000_1924"},{id:1925,name:"Isaac",year:2e3,label:"Isaac (2000) [id:1925]",value:"isaac_2000_1925"},{id:1926,name:"Joyce",year:2e3,label:"Joyce (2000) [id:1926]",value:"joyce_2000_1926"},{id:1927,name:"Keith",year:2e3,label:"Keith (2000) [id:1927]",value:"keith_2000_1927"},{id:1928,name:"Leslie",year:2e3,label:"Leslie (2000) [id:1928]",value:"leslie_2000_1928"},{id:1929,name:"Michael",year:2e3,label:"Michael (2000) [id:1929]",value:"michael_2000_1929"},{id:1930,name:"Nadine",year:2e3,label:"Nadine (2000) [id:1930]",value:"nadine_2000_1930"},{id:1931,name:"Not_Named",year:2e3,label:"Not_Named (2000) [id:1931]",value:"not_named_2000_1931"},{id:1932,name:"Allison",year:2001,label:"Allison (2001) [id:1932]",value:"allison_2001_1932"},{id:1933,name:"Not_Named",year:2001,label:"Not_Named (2001) [id:1933]",value:"not_named_2001_1933"},{id:1934,name:"Barry",year:2001,label:"Barry (2001) [id:1934]",value:"barry_2001_1934"},{id:1935,name:"Chantal",year:2001,label:"Chantal (2001) [id:1935]",value:"chantal_2001_1935"},{id:1936,name:"Dean",year:2001,label:"Dean (2001) [id:1936]",value:"dean_2001_1936"},{id:1937,name:"Erin",year:2001,label:"Erin (2001) [id:1937]",value:"erin_2001_1937"},{id:1938,name:"Felix",year:2001,label:"Felix (2001) [id:1938]",value:"felix_2001_1938"},{id:1939,name:"Gabrielle",year:2001,label:"Gabrielle (2001) [id:1939]",value:"gabrielle_2001_1939"},{id:1940,name:"Not_Named",year:2001,label:"Not_Named (2001) [id:1940]",value:"not_named_2001_1940"},{id:1941,name:"Humberto",year:2001,label:"Humberto (2001) [id:1941]",value:"humberto_2001_1941"},{id:1942,name:"Iris",year:2001,label:"Iris (2001) [id:1942]",value:"iris_2001_1942"},{id:1943,name:"Jerry",year:2001,label:"Jerry (2001) [id:1943]",value:"jerry_2001_1943"},{id:1944,name:"Karen",year:2001,label:"Karen (2001) [id:1944]",value:"karen_2001_1944"},{id:1945,name:"Lorenzo",year:2001,label:"Lorenzo (2001) [id:1945]",value:"lorenzo_2001_1945"},{id:1946,name:"Michelle",year:2001,label:"Michelle (2001) [id:1946]",value:"michelle_2001_1946"},{id:1947,name:"Noel",year:2001,label:"Noel (2001) [id:1947]",value:"noel_2001_1947"},{id:1948,name:"Olga",year:2001,label:"Olga (2001) [id:1948]",value:"olga_2001_1948"},{id:1949,name:"Arthur",year:2002,label:"Arthur (2002) [id:1949]",value:"arthur_2002_1949"},{id:1950,name:"Bertha",year:2002,label:"Bertha (2002) [id:1950]",value:"bertha_2002_1950"},{id:1951,name:"Cristobal",year:2002,label:"Cristobal (2002) [id:1951]",value:"cristobal_2002_1951"},{id:1952,name:"Dolly",year:2002,label:"Dolly (2002) [id:1952]",value:"dolly_2002_1952"},{id:1953,name:"Edouard",year:2002,label:"Edouard (2002) [id:1953]",value:"edouard_2002_1953"},{id:1954,name:"Fay",year:2002,label:"Fay (2002) [id:1954]",value:"fay_2002_1954"},{id:1955,name:"Not_Named",year:2002,label:"Not_Named (2002) [id:1955]",value:"not_named_2002_1955"},{id:1956,name:"Gustav",year:2002,label:"Gustav (2002) [id:1956]",value:"gustav_2002_1956"},{id:1957,name:"Hanna",year:2002,label:"Hanna (2002) [id:1957]",value:"hanna_2002_1957"},{id:1958,name:"Isidore",year:2002,label:"Isidore (2002) [id:1958]",value:"isidore_2002_1958"},{id:1959,name:"Josephine",year:2002,label:"Josephine (2002) [id:1959]",value:"josephine_2002_1959"},{id:1960,name:"Kyle",year:2002,label:"Kyle (2002) [id:1960]",value:"kyle_2002_1960"},{id:1961,name:"Lili",year:2002,label:"Lili (2002) [id:1961]",value:"lili_2002_1961"},{id:1962,name:"Not_Named",year:2002,label:"Not_Named (2002) [id:1962]",value:"not_named_2002_1962"},{id:1963,name:"Ana",year:2003,label:"Ana (2003) [id:1963]",value:"ana_2003_1963"},{id:1964,name:"Not_Named",year:2003,label:"Not_Named (2003) [id:1964]",value:"not_named_2003_1964"},{id:1965,name:"Bill",year:2003,label:"Bill (2003) [id:1965]",value:"bill_2003_1965"},{id:1966,name:"Claudette",year:2003,label:"Claudette (2003) [id:1966]",value:"claudette_2003_1966"},{id:1967,name:"Danny",year:2003,label:"Danny (2003) [id:1967]",value:"danny_2003_1967"},{id:1968,name:"Not_Named",year:2003,label:"Not_Named (2003) [id:1968]",value:"not_named_2003_1968"},{id:1969,name:"Not_Named",year:2003,label:"Not_Named (2003) [id:1969]",value:"not_named_2003_1969"},{id:1970,name:"Erika",year:2003,label:"Erika (2003) [id:1970]",value:"erika_2003_1970"},{id:1971,name:"Not_Named",year:2003,label:"Not_Named (2003) [id:1971]",value:"not_named_2003_1971"},{id:1972,name:"Fabian",year:2003,label:"Fabian (2003) [id:1972]",value:"fabian_2003_1972"},{id:1973,name:"Grace",year:2003,label:"Grace (2003) [id:1973]",value:"grace_2003_1973"},{id:1974,name:"Henri",year:2003,label:"Henri (2003) [id:1974]",value:"henri_2003_1974"},{id:1975,name:"Isabel",year:2003,label:"Isabel (2003) [id:1975]",value:"isabel_2003_1975"},{id:1976,name:"Not_Named",year:2003,label:"Not_Named (2003) [id:1976]",value:"not_named_2003_1976"},{id:1977,name:"Juan",year:2003,label:"Juan (2003) [id:1977]",value:"juan_2003_1977"},{id:1978,name:"Kate",year:2003,label:"Kate (2003) [id:1978]",value:"kate_2003_1978"},{id:1979,name:"Larry",year:2003,label:"Larry (2003) [id:1979]",value:"larry_2003_1979"},{id:1980,name:"Mindy",year:2003,label:"Mindy (2003) [id:1980]",value:"mindy_2003_1980"},{id:1981,name:"Nicholas",year:2003,label:"Nicholas (2003) [id:1981]",value:"nicholas_2003_1981"},{id:1982,name:"Odette",year:2003,label:"Odette (2003) [id:1982]",value:"odette_2003_1982"},{id:1983,name:"Peter",year:2003,label:"Peter (2003) [id:1983]",value:"peter_2003_1983"},{id:1984,name:"Alex",year:2004,label:"Alex (2004) [id:1984]",value:"alex_2004_1984"},{id:1985,name:"Bonnie",year:2004,label:"Bonnie (2004) [id:1985]",value:"bonnie_2004_1985"},{id:1986,name:"Charley",year:2004,label:"Charley (2004) [id:1986]",value:"charley_2004_1986"},{id:1987,name:"Earl",year:2004,label:"Earl (2004) [id:1987]",value:"earl_2004_1987"},{id:1988,name:"Danielle",year:2004,label:"Danielle (2004) [id:1988]",value:"danielle_2004_1988"},{id:1989,name:"Frances",year:2004,label:"Frances (2004) [id:1989]",value:"frances_2004_1989"},{id:1990,name:"Hermine",year:2004,label:"Hermine (2004) [id:1990]",value:"hermine_2004_1990"},{id:1991,name:"Gaston",year:2004,label:"Gaston (2004) [id:1991]",value:"gaston_2004_1991"},{id:1992,name:"Ivan",year:2004,label:"Ivan (2004) [id:1992]",value:"ivan_2004_1992"},{id:1993,name:"Not_Named",year:2004,label:"Not_Named (2004) [id:1993]",value:"not_named_2004_1993"},{id:1994,name:"Jeanne",year:2004,label:"Jeanne (2004) [id:1994]",value:"jeanne_2004_1994"},{id:1995,name:"Karl",year:2004,label:"Karl (2004) [id:1995]",value:"karl_2004_1995"},{id:1996,name:"Lisa",year:2004,label:"Lisa (2004) [id:1996]",value:"lisa_2004_1996"},{id:1997,name:"Matthew",year:2004,label:"Matthew (2004) [id:1997]",value:"matthew_2004_1997"},{id:1998,name:"Nicole",year:2004,label:"Nicole (2004) [id:1998]",value:"nicole_2004_1998"},{id:1999,name:"Otto",year:2004,label:"Otto (2004) [id:1999]",value:"otto_2004_1999"},{id:2e3,name:"Arlene",year:2005,label:"Arlene (2005) [id:2000]",value:"arlene_2005_2000"},{id:2001,name:"Bret",year:2005,label:"Bret (2005) [id:2001]",value:"bret_2005_2001"},{id:2002,name:"Cindy",year:2005,label:"Cindy (2005) [id:2002]",value:"cindy_2005_2002"},{id:2003,name:"Dennis",year:2005,label:"Dennis (2005) [id:2003]",value:"dennis_2005_2003"},{id:2004,name:"Emily",year:2005,label:"Emily (2005) [id:2004]",value:"emily_2005_2004"},{id:2005,name:"Franklin",year:2005,label:"Franklin (2005) [id:2005]",value:"franklin_2005_2005"},{id:2006,name:"Gert",year:2005,label:"Gert (2005) [id:2006]",value:"gert_2005_2006"},{id:2007,name:"Harvey",year:2005,label:"Harvey (2005) [id:2007]",value:"harvey_2005_2007"},{id:2008,name:"Irene",year:2005,label:"Irene (2005) [id:2008]",value:"irene_2005_2008"},{id:2009,name:"Not_Named",year:2005,label:"Not_Named (2005) [id:2009]",value:"not_named_2005_2009"},{id:2010,name:"Jose",year:2005,label:"Jose (2005) [id:2010]",value:"jose_2005_2010"},{id:2011,name:"Katrina",year:2005,label:"Katrina (2005) [id:2011]",value:"katrina_2005_2011"},{id:2012,name:"Lee",year:2005,label:"Lee (2005) [id:2012]",value:"lee_2005_2012"},{id:2013,name:"Maria",year:2005,label:"Maria (2005) [id:2013]",value:"maria_2005_2013"},{id:2014,name:"Ophelia",year:2005,label:"Ophelia (2005) [id:2014]",value:"ophelia_2005_2014"},{id:2015,name:"Nate",year:2005,label:"Nate (2005) [id:2015]",value:"nate_2005_2015"},{id:2016,name:"Philippe",year:2005,label:"Philippe (2005) [id:2016]",value:"philippe_2005_2016"},{id:2017,name:"Rita",year:2005,label:"Rita (2005) [id:2017]",value:"rita_2005_2017"},{id:2018,name:"Not_Named",year:2005,label:"Not_Named (2005) [id:2018]",value:"not_named_2005_2018"},{id:2019,name:"Stan",year:2005,label:"Stan (2005) [id:2019]",value:"stan_2005_2019"},{id:2020,name:"Not_Named",year:2005,label:"Not_Named (2005) [id:2020]",value:"not_named_2005_2020"},{id:2021,name:"Tammy",year:2005,label:"Tammy (2005) [id:2021]",value:"tammy_2005_2021"},{id:2022,name:"Not_Named",year:2005,label:"Not_Named (2005) [id:2022]",value:"not_named_2005_2022"},{id:2023,name:"Vince",year:2005,label:"Vince (2005) [id:2023]",value:"vince_2005_2023"},{id:2024,name:"Wilma",year:2005,label:"Wilma (2005) [id:2024]",value:"wilma_2005_2024"},{id:2025,name:"Alpha",year:2005,label:"Alpha (2005) [id:2025]",value:"alpha_2005_2025"},{id:2026,name:"Beta",year:2005,label:"Beta (2005) [id:2026]",value:"beta_2005_2026"},{id:2027,name:"Gamma",year:2005,label:"Gamma (2005) [id:2027]",value:"gamma_2005_2027"},{id:2028,name:"Delta",year:2005,label:"Delta (2005) [id:2028]",value:"delta_2005_2028"},{id:2029,name:"Epsilon",year:2005,label:"Epsilon (2005) [id:2029]",value:"epsilon_2005_2029"},{id:2030,name:"Zeta",year:2005,label:"Zeta (2005) [id:2030]",value:"zeta_2005_2030"},{id:2031,name:"Alberto",year:2006,label:"Alberto (2006) [id:2031]",value:"alberto_2006_2031"},{id:2032,name:"Not_Named",year:2006,label:"Not_Named (2006) [id:2032]",value:"not_named_2006_2032"},{id:2033,name:"Beryl",year:2006,label:"Beryl (2006) [id:2033]",value:"beryl_2006_2033"},{id:2034,name:"Chris",year:2006,label:"Chris (2006) [id:2034]",value:"chris_2006_2034"},{id:2035,name:"Debby",year:2006,label:"Debby (2006) [id:2035]",value:"debby_2006_2035"},{id:2036,name:"Ernesto",year:2006,label:"Ernesto (2006) [id:2036]",value:"ernesto_2006_2036"},{id:2037,name:"Florence",year:2006,label:"Florence (2006) [id:2037]",value:"florence_2006_2037"},{id:2038,name:"Gordon",year:2006,label:"Gordon (2006) [id:2038]",value:"gordon_2006_2038"},{id:2039,name:"Helene",year:2006,label:"Helene (2006) [id:2039]",value:"helene_2006_2039"},{id:2040,name:"Isaac",year:2006,label:"Isaac (2006) [id:2040]",value:"isaac_2006_2040"},{id:2041,name:"Andrea",year:2007,label:"Andrea (2007) [id:2041]",value:"andrea_2007_2041"},{id:2042,name:"Barry",year:2007,label:"Barry (2007) [id:2042]",value:"barry_2007_2042"},{id:2043,name:"Chantal",year:2007,label:"Chantal (2007) [id:2043]",value:"chantal_2007_2043"},{id:2044,name:"Dean",year:2007,label:"Dean (2007) [id:2044]",value:"dean_2007_2044"},{id:2045,name:"Erin",year:2007,label:"Erin (2007) [id:2045]",value:"erin_2007_2045"},{id:2046,name:"Felix",year:2007,label:"Felix (2007) [id:2046]",value:"felix_2007_2046"},{id:2047,name:"Gabrielle",year:2007,label:"Gabrielle (2007) [id:2047]",value:"gabrielle_2007_2047"},{id:2048,name:"Ingrid",year:2007,label:"Ingrid (2007) [id:2048]",value:"ingrid_2007_2048"},{id:2049,name:"Humberto",year:2007,label:"Humberto (2007) [id:2049]",value:"humberto_2007_2049"},{id:2050,name:"Not_Named",year:2007,label:"Not_Named (2007) [id:2050]",value:"not_named_2007_2050"},{id:2051,name:"Jerry",year:2007,label:"Jerry (2007) [id:2051]",value:"jerry_2007_2051"},{id:2052,name:"Karen",year:2007,label:"Karen (2007) [id:2052]",value:"karen_2007_2052"},{id:2053,name:"Lorenzo",year:2007,label:"Lorenzo (2007) [id:2053]",value:"lorenzo_2007_2053"},{id:2054,name:"Melissa",year:2007,label:"Melissa (2007) [id:2054]",value:"melissa_2007_2054"},{id:2055,name:"Not_Named",year:2007,label:"Not_Named (2007) [id:2055]",value:"not_named_2007_2055"},{id:2056,name:"Noel",year:2007,label:"Noel (2007) [id:2056]",value:"noel_2007_2056"},{id:2057,name:"Olga",year:2007,label:"Olga (2007) [id:2057]",value:"olga_2007_2057"},{id:2058,name:"Arthur",year:2008,label:"Arthur (2008) [id:2058]",value:"arthur_2008_2058"},{id:2059,name:"Bertha",year:2008,label:"Bertha (2008) [id:2059]",value:"bertha_2008_2059"},{id:2060,name:"Cristobal",year:2008,label:"Cristobal (2008) [id:2060]",value:"cristobal_2008_2060"},{id:2061,name:"Dolly",year:2008,label:"Dolly (2008) [id:2061]",value:"dolly_2008_2061"},{id:2062,name:"Edouard",year:2008,label:"Edouard (2008) [id:2062]",value:"edouard_2008_2062"},{id:2063,name:"Fay",year:2008,label:"Fay (2008) [id:2063]",value:"fay_2008_2063"},{id:2064,name:"Gustav",year:2008,label:"Gustav (2008) [id:2064]",value:"gustav_2008_2064"},{id:2065,name:"Hanna",year:2008,label:"Hanna (2008) [id:2065]",value:"hanna_2008_2065"},{id:2066,name:"Ike",year:2008,label:"Ike (2008) [id:2066]",value:"ike_2008_2066"},{id:2067,name:"Josephine",year:2008,label:"Josephine (2008) [id:2067]",value:"josephine_2008_2067"},{id:2068,name:"Kyle",year:2008,label:"Kyle (2008) [id:2068]",value:"kyle_2008_2068"},{id:2069,name:"Laura",year:2008,label:"Laura (2008) [id:2069]",value:"laura_2008_2069"},{id:2070,name:"Marco",year:2008,label:"Marco (2008) [id:2070]",value:"marco_2008_2070"},{id:2071,name:"Nana",year:2008,label:"Nana (2008) [id:2071]",value:"nana_2008_2071"},{id:2072,name:"Omar",year:2008,label:"Omar (2008) [id:2072]",value:"omar_2008_2072"},{id:2073,name:"Not_Named",year:2008,label:"Not_Named (2008) [id:2073]",value:"not_named_2008_2073"},{id:2074,name:"Paloma",year:2008,label:"Paloma (2008) [id:2074]",value:"paloma_2008_2074"},{id:2075,name:"Not_Named",year:2009,label:"Not_Named (2009) [id:2075]",value:"not_named_2009_2075"},{id:2076,name:"Ana",year:2009,label:"Ana (2009) [id:2076]",value:"ana_2009_2076"},{id:2077,name:"Bill",year:2009,label:"Bill (2009) [id:2077]",value:"bill_2009_2077"},{id:2078,name:"Claudette",year:2009,label:"Claudette (2009) [id:2078]",value:"claudette_2009_2078"},{id:2079,name:"Danny",year:2009,label:"Danny (2009) [id:2079]",value:"danny_2009_2079"},{id:2080,name:"Erika",year:2009,label:"Erika (2009) [id:2080]",value:"erika_2009_2080"},{id:2081,name:"Fred",year:2009,label:"Fred (2009) [id:2081]",value:"fred_2009_2081"},{id:2082,name:"Not_Named",year:2009,label:"Not_Named (2009) [id:2082]",value:"not_named_2009_2082"},{id:2083,name:"Grace",year:2009,label:"Grace (2009) [id:2083]",value:"grace_2009_2083"},{id:2084,name:"Henri",year:2009,label:"Henri (2009) [id:2084]",value:"henri_2009_2084"},{id:2085,name:"Ida",year:2009,label:"Ida (2009) [id:2085]",value:"ida_2009_2085"},{id:2086,name:"Alex",year:2010,label:"Alex (2010) [id:2086]",value:"alex_2010_2086"},{id:2087,name:"Not_Named",year:2010,label:"Not_Named (2010) [id:2087]",value:"not_named_2010_2087"},{id:2088,name:"Bonnie",year:2010,label:"Bonnie (2010) [id:2088]",value:"bonnie_2010_2088"},{id:2089,name:"Colin",year:2010,label:"Colin (2010) [id:2089]",value:"colin_2010_2089"},{id:2090,name:"Not_Named",year:2010,label:"Not_Named (2010) [id:2090]",value:"not_named_2010_2090"},{id:2091,name:"Danielle",year:2010,label:"Danielle (2010) [id:2091]",value:"danielle_2010_2091"},{id:2092,name:"Earl",year:2010,label:"Earl (2010) [id:2092]",value:"earl_2010_2092"},{id:2093,name:"Fiona",year:2010,label:"Fiona (2010) [id:2093]",value:"fiona_2010_2093"},{id:2094,name:"Gaston",year:2010,label:"Gaston (2010) [id:2094]",value:"gaston_2010_2094"},{id:2096,name:"Igor",year:2010,label:"Igor (2010) [id:2096]",value:"igor_2010_2096"},{id:2097,name:"Julia",year:2010,label:"Julia (2010) [id:2097]",value:"julia_2010_2097"},{id:2098,name:"Karl",year:2010,label:"Karl (2010) [id:2098]",value:"karl_2010_2098"},{id:2099,name:"Lisa",year:2010,label:"Lisa (2010) [id:2099]",value:"lisa_2010_2099"},{id:2100,name:"Matthew",year:2010,label:"Matthew (2010) [id:2100]",value:"matthew_2010_2100"},{id:2101,name:"Nicole",year:2010,label:"Nicole (2010) [id:2101]",value:"nicole_2010_2101"},{id:2102,name:"Otto",year:2010,label:"Otto (2010) [id:2102]",value:"otto_2010_2102"},{id:2103,name:"Paula",year:2010,label:"Paula (2010) [id:2103]",value:"paula_2010_2103"},{id:2104,name:"Richard",year:2010,label:"Richard (2010) [id:2104]",value:"richard_2010_2104"},{id:2105,name:"Tomas",year:2010,label:"Tomas (2010) [id:2105]",value:"tomas_2010_2105"},{id:2106,name:"Shary",year:2010,label:"Shary (2010) [id:2106]",value:"shary_2010_2106"},{id:2107,name:"Arlene",year:2011,label:"Arlene (2011) [id:2107]",value:"arlene_2011_2107"},{id:2108,name:"Bret",year:2011,label:"Bret (2011) [id:2108]",value:"bret_2011_2108"},{id:2109,name:"Cindy",year:2011,label:"Cindy (2011) [id:2109]",value:"cindy_2011_2109"},{id:2110,name:"Don",year:2011,label:"Don (2011) [id:2110]",value:"don_2011_2110"},{id:2111,name:"Emily",year:2011,label:"Emily (2011) [id:2111]",value:"emily_2011_2111"},{id:2112,name:"Gert",year:2011,label:"Gert (2011) [id:2112]",value:"gert_2011_2112"},{id:2113,name:"Franklin",year:2011,label:"Franklin (2011) [id:2113]",value:"franklin_2011_2113"},{id:2114,name:"Harvey",year:2011,label:"Harvey (2011) [id:2114]",value:"harvey_2011_2114"},{id:2115,name:"Irene",year:2011,label:"Irene (2011) [id:2115]",value:"irene_2011_2115"},{id:2116,name:"Not_Named",year:2011,label:"Not_Named (2011) [id:2116]",value:"not_named_2011_2116"},{id:2117,name:"Jose",year:2011,label:"Jose (2011) [id:2117]",value:"jose_2011_2117"},{id:2118,name:"Katia",year:2011,label:"Katia (2011) [id:2118]",value:"katia_2011_2118"},{id:2119,name:"Not_Named",year:2011,label:"Not_Named (2011) [id:2119]",value:"not_named_2011_2119"},{id:2120,name:"Lee",year:2011,label:"Lee (2011) [id:2120]",value:"lee_2011_2120"},{id:2121,name:"Maria",year:2011,label:"Maria (2011) [id:2121]",value:"maria_2011_2121"},{id:2122,name:"Nate",year:2011,label:"Nate (2011) [id:2122]",value:"nate_2011_2122"},{id:2123,name:"Ophelia",year:2011,label:"Ophelia (2011) [id:2123]",value:"ophelia_2011_2123"},{id:2124,name:"Philippe",year:2011,label:"Philippe (2011) [id:2124]",value:"philippe_2011_2124"},{id:2125,name:"Rina",year:2011,label:"Rina (2011) [id:2125]",value:"rina_2011_2125"},{id:2126,name:"Sean",year:2011,label:"Sean (2011) [id:2126]",value:"sean_2011_2126"},{id:2127,name:"Alberto",year:2012,label:"Alberto (2012) [id:2127]",value:"alberto_2012_2127"},{id:2128,name:"Beryl",year:2012,label:"Beryl (2012) [id:2128]",value:"beryl_2012_2128"},{id:2129,name:"Chris",year:2012,label:"Chris (2012) [id:2129]",value:"chris_2012_2129"},{id:2130,name:"Debby",year:2012,label:"Debby (2012) [id:2130]",value:"debby_2012_2130"},{id:2131,name:"Ernesto",year:2012,label:"Ernesto (2012) [id:2131]",value:"ernesto_2012_2131"},{id:2132,name:"Florence",year:2012,label:"Florence (2012) [id:2132]",value:"florence_2012_2132"},{id:2133,name:"Helene",year:2012,label:"Helene (2012) [id:2133]",value:"helene_2012_2133"},{id:2134,name:"Gordon",year:2012,label:"Gordon (2012) [id:2134]",value:"gordon_2012_2134"},{id:2135,name:"Isaac",year:2012,label:"Isaac (2012) [id:2135]",value:"isaac_2012_2135"},{id:2136,name:"Joyce",year:2012,label:"Joyce (2012) [id:2136]",value:"joyce_2012_2136"},{id:2137,name:"Leslie",year:2012,label:"Leslie (2012) [id:2137]",value:"leslie_2012_2137"},{id:2138,name:"Kirk",year:2012,label:"Kirk (2012) [id:2138]",value:"kirk_2012_2138"},{id:2139,name:"Michael",year:2012,label:"Michael (2012) [id:2139]",value:"michael_2012_2139"},{id:2140,name:"Nadine",year:2012,label:"Nadine (2012) [id:2140]",value:"nadine_2012_2140"},{id:2141,name:"Oscar",year:2012,label:"Oscar (2012) [id:2141]",value:"oscar_2012_2141"},{id:2142,name:"Patty",year:2012,label:"Patty (2012) [id:2142]",value:"patty_2012_2142"},{id:2143,name:"Rafael",year:2012,label:"Rafael (2012) [id:2143]",value:"rafael_2012_2143"},{id:2144,name:"Sandy",year:2012,label:"Sandy (2012) [id:2144]",value:"sandy_2012_2144"},{id:2145,name:"Tony",year:2012,label:"Tony (2012) [id:2145]",value:"tony_2012_2145"},{id:2147,name:"Andrea",year:2013,label:"Andrea (2013) [id:2147]",value:"andrea_2013_2147"},{id:2148,name:"Barry",year:2013,label:"Barry (2013) [id:2148]",value:"barry_2013_2148"},{id:2149,name:"Chantal",year:2013,label:"Chantal (2013) [id:2149]",value:"chantal_2013_2149"},{id:2150,name:"Dorian",year:2013,label:"Dorian (2013) [id:2150]",value:"dorian_2013_2150"},{id:2151,name:"Erin",year:2013,label:"Erin (2013) [id:2151]",value:"erin_2013_2151"},{id:2152,name:"Fernand",year:2013,label:"Fernand (2013) [id:2152]",value:"fernand_2013_2152"},{id:2153,name:"Gabrielle",year:2013,label:"Gabrielle (2013) [id:2153]",value:"gabrielle_2013_2153"},{id:2154,name:"Not_Named",year:2013,label:"Not_Named (2013) [id:2154]",value:"not_named_2013_2154"},{id:2155,name:"Humberto",year:2013,label:"Humberto (2013) [id:2155]",value:"humberto_2013_2155"},{id:2156,name:"Ingrid",year:2013,label:"Ingrid (2013) [id:2156]",value:"ingrid_2013_2156"},{id:2157,name:"Jerry",year:2013,label:"Jerry (2013) [id:2157]",value:"jerry_2013_2157"},{id:2158,name:"Karen",year:2013,label:"Karen (2013) [id:2158]",value:"karen_2013_2158"},{id:2159,name:"Lorenzo",year:2013,label:"Lorenzo (2013) [id:2159]",value:"lorenzo_2013_2159"},{id:2160,name:"Melissa",year:2013,label:"Melissa (2013) [id:2160]",value:"melissa_2013_2160"},{id:2161,name:"Not_Named",year:2013,label:"Not_Named (2013) [id:2161]",value:"not_named_2013_2161"},{id:2162,name:"Arthur",year:2014,label:"Arthur (2014) [id:2162]",value:"arthur_2014_2162"},{id:2163,name:"Not_Named",year:2014,label:"Not_Named (2014) [id:2163]",value:"not_named_2014_2163"},{id:2164,name:"Bertha",year:2014,label:"Bertha (2014) [id:2164]",value:"bertha_2014_2164"},{id:2165,name:"Cristobal",year:2014,label:"Cristobal (2014) [id:2165]",value:"cristobal_2014_2165"},{id:2166,name:"Dolly",year:2014,label:"Dolly (2014) [id:2166]",value:"dolly_2014_2166"},{id:2167,name:"Edouard",year:2014,label:"Edouard (2014) [id:2167]",value:"edouard_2014_2167"},{id:2168,name:"Fay",year:2014,label:"Fay (2014) [id:2168]",value:"fay_2014_2168"},{id:2169,name:"Gonzalo",year:2014,label:"Gonzalo (2014) [id:2169]",value:"gonzalo_2014_2169"},{id:2170,name:"Hanna",year:2014,label:"Hanna (2014) [id:2170]",value:"hanna_2014_2170"},{id:2171,name:"Ana",year:2015,label:"Ana (2015) [id:2171]",value:"ana_2015_2171"},{id:2172,name:"Bill",year:2015,label:"Bill (2015) [id:2172]",value:"bill_2015_2172"},{id:2173,name:"Claudette",year:2015,label:"Claudette (2015) [id:2173]",value:"claudette_2015_2173"},{id:2174,name:"Danny",year:2015,label:"Danny (2015) [id:2174]",value:"danny_2015_2174"},{id:2175,name:"Erika",year:2015,label:"Erika (2015) [id:2175]",value:"erika_2015_2175"},{id:2176,name:"Fred",year:2015,label:"Fred (2015) [id:2176]",value:"fred_2015_2176"},{id:2177,name:"Grace",year:2015,label:"Grace (2015) [id:2177]",value:"grace_2015_2177"},{id:2178,name:"Henri",year:2015,label:"Henri (2015) [id:2178]",value:"henri_2015_2178"},{id:2179,name:"Not_Named",year:2015,label:"Not_Named (2015) [id:2179]",value:"not_named_2015_2179"},{id:2180,name:"Ida",year:2015,label:"Ida (2015) [id:2180]",value:"ida_2015_2180"},{id:2181,name:"Joaquin",year:2015,label:"Joaquin (2015) [id:2181]",value:"joaquin_2015_2181"},{id:2182,name:"Kate",year:2015,label:"Kate (2015) [id:2182]",value:"kate_2015_2182"},{id:2183,name:"Alex",year:2016,label:"Alex (2016) [id:2183]",value:"alex_2016_2183"},{id:2184,name:"Bonnie",year:2016,label:"Bonnie (2016) [id:2184]",value:"bonnie_2016_2184"},{id:2185,name:"Colin",year:2016,label:"Colin (2016) [id:2185]",value:"colin_2016_2185"},{id:2186,name:"Danielle",year:2016,label:"Danielle (2016) [id:2186]",value:"danielle_2016_2186"},{id:2187,name:"Earl",year:2016,label:"Earl (2016) [id:2187]",value:"earl_2016_2187"},{id:2188,name:"Fiona",year:2016,label:"Fiona (2016) [id:2188]",value:"fiona_2016_2188"},{id:2189,name:"Gaston",year:2016,label:"Gaston (2016) [id:2189]",value:"gaston_2016_2189"},{id:2190,name:"Not_Named",year:2016,label:"Not_Named (2016) [id:2190]",value:"not_named_2016_2190"},{id:2191,name:"Hermine",year:2016,label:"Hermine (2016) [id:2191]",value:"hermine_2016_2191"},{id:2192,name:"Ian",year:2016,label:"Ian (2016) [id:2192]",value:"ian_2016_2192"},{id:2193,name:"Karl",year:2016,label:"Karl (2016) [id:2193]",value:"karl_2016_2193"},{id:2194,name:"Julia",year:2016,label:"Julia (2016) [id:2194]",value:"julia_2016_2194"},{id:2195,name:"Lisa",year:2016,label:"Lisa (2016) [id:2195]",value:"lisa_2016_2195"},{id:2196,name:"Matthew",year:2016,label:"Matthew (2016) [id:2196]",value:"matthew_2016_2196"},{id:2197,name:"Nicole",year:2016,label:"Nicole (2016) [id:2197]",value:"nicole_2016_2197"},{id:2198,name:"Otto",year:2016,label:"Otto (2016) [id:2198]",value:"otto_2016_2198"},{id:2199,name:"Arlene",year:2017,label:"Arlene (2017) [id:2199]",value:"arlene_2017_2199"},{id:2200,name:"Bret",year:2017,label:"Bret (2017) [id:2200]",value:"bret_2017_2200"},{id:2201,name:"Cindy",year:2017,label:"Cindy (2017) [id:2201]",value:"cindy_2017_2201"},{id:2202,name:"Not_Named",year:2017,label:"Not_Named (2017) [id:2202]",value:"not_named_2017_2202"},{id:2203,name:"Don",year:2017,label:"Don (2017) [id:2203]",value:"don_2017_2203"},{id:2204,name:"Emily",year:2017,label:"Emily (2017) [id:2204]",value:"emily_2017_2204"},{id:2205,name:"Franklin",year:2017,label:"Franklin (2017) [id:2205]",value:"franklin_2017_2205"},{id:2206,name:"Gert",year:2017,label:"Gert (2017) [id:2206]",value:"gert_2017_2206"},{id:2207,name:"Harvey",year:2017,label:"Harvey (2017) [id:2207]",value:"harvey_2017_2207"},{id:2208,name:"Not_Named",year:2017,label:"Not_Named (2017) [id:2208]",value:"not_named_2017_2208"},{id:2209,name:"Irma",year:2017,label:"Irma (2017) [id:2209]",value:"irma_2017_2209"},{id:2210,name:"Jose",year:2017,label:"Jose (2017) [id:2210]",value:"jose_2017_2210"},{id:2211,name:"Katia",year:2017,label:"Katia (2017) [id:2211]",value:"katia_2017_2211"},{id:2212,name:"Lee",year:2017,label:"Lee (2017) [id:2212]",value:"lee_2017_2212"},{id:2213,name:"Maria",year:2017,label:"Maria (2017) [id:2213]",value:"maria_2017_2213"},{id:2214,name:"Nate",year:2017,label:"Nate (2017) [id:2214]",value:"nate_2017_2214"},{id:2215,name:"Ophelia",year:2017,label:"Ophelia (2017) [id:2215]",value:"ophelia_2017_2215"},{id:2216,name:"Philippe",year:2017,label:"Philippe (2017) [id:2216]",value:"philippe_2017_2216"},{id:2217,name:"Rina",year:2017,label:"Rina (2017) [id:2217]",value:"rina_2017_2217"},{id:2218,name:"Alberto",year:2018,label:"Alberto (2018) [id:2218]",value:"alberto_2018_2218"},{id:2219,name:"Beryl",year:2018,label:"Beryl (2018) [id:2219]",value:"beryl_2018_2219"},{id:2220,name:"Chris",year:2018,label:"Chris (2018) [id:2220]",value:"chris_2018_2220"},{id:2221,name:"Debby",year:2018,label:"Debby (2018) [id:2221]",value:"debby_2018_2221"},{id:2222,name:"Ernesto",year:2018,label:"Ernesto (2018) [id:2222]",value:"ernesto_2018_2222"},{id:2223,name:"Florence",year:2018,label:"Florence (2018) [id:2223]",value:"florence_2018_2223"},{id:2224,name:"Gordon",year:2018,label:"Gordon (2018) [id:2224]",value:"gordon_2018_2224"},{id:2225,name:"Isaac",year:2018,label:"Isaac (2018) [id:2225]",value:"isaac_2018_2225"},{id:2226,name:"Helene",year:2018,label:"Helene (2018) [id:2226]",value:"helene_2018_2226"},{id:2227,name:"Joyce",year:2018,label:"Joyce (2018) [id:2227]",value:"joyce_2018_2227"},{id:2228,name:"Kirk",year:2018,label:"Kirk (2018) [id:2228]",value:"kirk_2018_2228"},{id:2229,name:"Not_Named",year:2018,label:"Not_Named (2018) [id:2229]",value:"not_named_2018_2229"},{id:2230,name:"Leslie",year:2018,label:"Leslie (2018) [id:2230]",value:"leslie_2018_2230"},{id:2231,name:"Michael",year:2018,label:"Michael (2018) [id:2231]",value:"michael_2018_2231"},{id:2232,name:"Nadine",year:2018,label:"Nadine (2018) [id:2232]",value:"nadine_2018_2232"},{id:2233,name:"Oscar",year:2018,label:"Oscar (2018) [id:2233]",value:"oscar_2018_2233"}];function S9(t,e,n){const i=t.slice();return i[63]=e[n],i}function I9(t,e,n){const i=t.slice();return i[66]=e[n],i}function T9(t,e,n){const i=t.slice();return i[66]=e[n],i}function M9(t,e,n){const i=t.slice();return i[63]=e[n],i}function RZ(t){let e,n,i=`<div class="flex-1 flex flex-row items-center justify-start"><img class="w-12 h-12 mr-4 rounded-full overflow-hidden" alt="" src="${x_}/cyclone_bw.png"/> <div class="flex flex-col"><h1 class="text-xl font-semibold leading-tight">ICoM RAFT</h1> <h2 class="text-lg leading-tight">Hurricane <span class="hidden sm:inline">Projections</span> Dashboard</h2></div></div>`,o,u,h,c="Type in the name, year, or ID for the storm you're interested in.",b,w,S,M,A,P,B,U=`<p class="mt-2">Welcome to the <span class="font-semibold">ICoM RAFT Hurricane Projections Dashboard</span>!</p> <p class="mt-2">This dashboard visualizes any of the <span class="font-semibold">620 historic tropical cyclones</span>
                from 1979 to 2018 replayed under eight different future climate scenarios, as described in the poster presentation:
                <a class="italic text-blue-400 font-semibold hover:underline underline-offset-4" target="_blank" rel="noreferrer" href="${x_}/HydroML_2024_RAFT_hurricane_projections_poster.pdf">North Atlantic tropical cyclone intensity projections based on thermodynamic modifications of historic environments</a>.
                A paper and data download link will be available soon!</p> <p class="mt-2">When a storm is selected, the <span class="font-semibold">intensity plot</span> and <span class="font-semibold">map</span>
                display <span class="font-semibold">RAFT&#39;s deep learning baseline simulation</span> of the historic event. The intensity plot
                also includes a white line representing the observed intensities from the IBTrACS dataset. To assess the impact of future climate
                scenarios, select options from the menu in the top left corner. For a deeper dive into the changes for each scenario, click
                the &quot;<span class="font-semibold">MORE</span>&quot; section at the bottom which reveals how the model inputs are modified for the
                selected scenarios.</p>`,J,Q,K=`<a class="h-12" href="https://icom.pnnl.gov/" target="_blank" rel="noreferrer"><img src="${NZ}" alt="ICOM" class="h-full object-contain"/></a> <a class="h-12" href="https://msdlive.org/" target="_blank" rel="noreferrer"><img src="${FZ}" alt="MSD-LIVE" class="h-full object-contain"/></a> <a class="h-24" href="https://pnnl.gov/" target="_blank" rel="noreferrer"><img src="${BZ}" alt="PNNL" class="h-full object-contain"/></a>`,le;function ee(Z){t[59](Z)}let oe={id:"storm",required:!0,searchable:!0,items:R1,placeholder:"Search storms by name, year, or ID",$$slots:{required:[VZ],prepend:[UZ]},$$scope:{ctx:t}};return t[11]!==void 0&&(oe.value=t[11]),S=new K9({props:oe}),Fr.push(()=>V1(S,"value",ee)),{c(){e=Ye("div"),n=Ye("div"),n.innerHTML=i,o=Mt(),u=Ye("div"),h=Ye("h3"),h.textContent=c,b=Mt(),w=Ye("div"),M=Ye("div"),ii(S.$$.fragment),P=Mt(),B=Ye("div"),B.innerHTML=U,J=Mt(),Q=Ye("div"),Q.innerHTML=K,this.h()},l(Z){e=Je(Z,"DIV",{class:!0});var ne=ht(e);n=Je(ne,"DIV",{class:!0,"data-svelte-h":!0}),Li(n)!=="svelte-1hyxq68"&&(n.innerHTML=i),o=At(ne),u=Je(ne,"DIV",{class:!0});var be=ht(u);h=Je(be,"H3",{class:!0,style:!0,"data-svelte-h":!0}),Li(h)!=="svelte-g1z99r"&&(h.textContent=c),b=At(be),w=Je(be,"DIV",{class:!0});var me=ht(w);M=Je(me,"DIV",{style:!0});var Te=ht(M);ri(S.$$.fragment,Te),me.forEach(Fe),P=At(be),B=Je(be,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),Li(B)!=="svelte-1fjlbf3"&&(B.innerHTML=U),J=At(be),Q=Je(be,"DIV",{class:!0,"data-svelte-h":!0}),Li(Q)!=="svelte-q4tqqq"&&(Q.innerHTML=K),be.forEach(Fe),ne.forEach(Fe),this.h()},h(){Me(n,"class","z-10 sticky top-0 flex flex-row text-white h-20 px-4 bg-black items-center justify-between shrink-0"),Me(h,"class","text-3xl text-white font-semibold max-w-4xl leading-relaxed"),qt(h,"text-shadow","1px 1px 3px rgba(0,0,0,0.5)"),qt(M,"display","contents"),qt(M,"--border-radius","0"),qt(M,"--border-radius-focused","0"),qt(M,"--item-first-border-radius","0"),qt(M,"--list-border-radius","0"),qt(M,"--height","64px"),qt(M,"--item-color","black"),qt(M,"--selected-item-color","black"),qt(M,"--chevron-color","black"),qt(M,"--clear-icon-color","red"),qt(M,"--item-hover-color","black"),Me(w,"class","w-full max-w-4xl"),Me(B,"class","text-base text-white max-w-4xl text-justify"),qt(B,"text-shadow","1px 1px 3px rgba(0,0,0,0.25)"),Me(Q,"class","w-full max-w-4xl p-2 flex flex-row flex-wrap mt-12 items-center justify-evenly gap-x-12 gap-y-8"),Me(u,"class","w-full h-full flex flex-col items-center justify-start sm:justify-center gap-y-6 p-4"),Me(e,"class","w-screen h-screen overflow-y-auto relative flex flex-col bg-black/60 backdrop-blur-sm")},m(Z,ne){Jt(Z,e,ne),Ce(e,n),Ce(e,o),Ce(e,u),Ce(u,h),Ce(u,b),Ce(u,w),Ce(w,M),ai(S,M,null),Ce(u,P),Ce(u,B),Ce(u,J),Ce(u,Q),le=!0},p(Z,ne){const be={};ne[0]&2048|ne[2]&2048&&(be.$$scope={dirty:ne,ctx:Z}),!A&&ne[0]&2048&&(A=!0,be.value=Z[11],U1(()=>A=!1)),S.$set(be)},i(Z){le||(rt(S.$$.fragment,Z),le=!0)},o(Z){mt(S.$$.fragment,Z),le=!1},d(Z){Z&&Fe(e),si(S)}}}function OZ(t){let e,n,i,o=`<img class="w-12 h-12 mr-4 rounded-full overflow-hidden" alt="" src="${x_}/cyclone_bw.png"/> <div class="flex flex-col"><h1 class="text-xl font-semibold leading-tight">ICoM RAFT</h1> <h2 class="text-lg leading-tight">Hurricane <span class="hidden sm:inline">Projections</span> Dashboard</h2></div>`,u,h,c,b="STORM:",w,S,M,A,P,B,U,J,Q,K,le,ee,oe,Z,ne,be,me,Te="SELECT ALL",Y,ye,qe="RESET",He,Be,lt,Ge,ot,je,Ve="Knots",$e,st,ct,Pt,Ut,Lt=t[20][t[20].length-1].min+10+"",gt,Bt,tt,Le,ut,Re,Ke,Ee,wt,De='<span class="text-xs">Overland:</span> <div class="w-3 h-5 bg-white/25"></div>',wn,Wn,on,An,yr,br,Zn,Tn,pi,vr,Jn="VMPI",dt,at,Un,ji,Bn,Ne,yt,Zt,ti,Gn="U200",Qt,qi,ar,Oi,ie,V,j,H,se,_e="SHRD",xe,we,de,Pe,Xe,We,Ue,Ft,Nt,gn="DELV",Kt,tn,en,Kn,ni,nn,Fn,$n,Ai,xr="RHLO",mi,sr,ps,Vn,Ta,uo,_i,Bi,fa,wr="LP500",or,Xr,Sr,Ci,pa,Na,Xn,Pr,tr,ho="PSLV",Qr,Hr,$r,zn,Ma,fe,zt,Nn,Hi,Ra="Latitude",Lr,Wr,is,fo,po,Fu,rs,ms,ma,Ol="Longitude",Ir,Fi,_s,Jo,gs,Ko,ys,Nu,bs,Aa,Oa,mo,Ru,Ul;function Ou(xt){t[38](xt)}let Vl={id:"storm",searchable:!0,items:R1,placeholder:"search storms..."};t[11]!==void 0&&(Vl.value=t[11]),S=new K9({props:Vl}),Fr.push(()=>V1(S,"value",Ou)),S.$on("change",t[22]),S.$on("clear",t[23]),Z=new ul({});let Rs=Qs(t[19]),Wi=[];for(let xt=0;xt<Rs.length;xt+=1)Wi[xt]=A9(M9(t,Rs,xt));let lr=Qs(t[20]),sn=[];for(let xt=0;xt<lr.length;xt+=1)sn[xt]=C9(T9(t,lr,xt));let Os=Qs(t[20]),Zi=[];for(let xt=0;xt<Os.length;xt+=1)Zi[xt]=k9(I9(t,Os,xt));let ki=t[17]&&E9(t);Un=new ul({}),ar=new ul({}),de=new ul({}),en=new ul({}),ps=new ul({}),Sr=new ul({}),$r=new ul({}),is=new ul({}),_s=new ul({});const Vh=[XZ,KZ],as=[];function jh(xt,Qi){return xt[18]?0:1}return Aa=jh(t),Oa=as[Aa]=Vh[Aa](t),{c(){e=Ye("div"),n=Ye("div"),i=Ye("button"),i.innerHTML=o,u=Mt(),h=Ye("div"),c=Ye("label"),c.textContent=b,w=Mt(),M=Ye("div"),ii(S.$$.fragment),P=Mt(),B=Ye("div"),U=Ye("div"),J=Ye("div"),Q=Ye("div"),K=Ye("div"),le=Ye("h3"),ee=wa(`Scenarios
                            `),oe=Ye("button"),ii(Z.$$.fragment),ne=Mt(),be=Ye("div"),me=Ye("button"),me.textContent=Te,Y=Mt(),ye=Ye("button"),ye.textContent=qe,He=Mt(),Be=Ye("div");for(let xt=0;xt<Wi.length;xt+=1)Wi[xt].c();lt=Mt(),Ge=Ye("div"),ot=Ye("div"),je=Ye("span"),je.textContent=Ve,$e=Mt(),st=Ye("div"),ct=Ye("div");for(let xt=0;xt<sn.length;xt+=1)sn[xt].c();Pt=Mt(),Ut=Ye("span"),gt=wa(Lt),Bt=wa(" -"),tt=Mt(),Le=Ye("div");for(let xt=0;xt<Zi.length;xt+=1)Zi[xt].c();ut=Mt(),Re=Ye("div"),Ee=Mt(),wt=Ye("div"),wt.innerHTML=De,wn=Mt(),Wn=Ye("div"),on=Mt(),An=Ye("div"),ki&&ki.c(),yr=Mt(),br=Ye("div"),Zn=Ye("div"),Tn=Ye("div"),pi=Ye("div"),vr=Ye("span"),vr.textContent=Jn,dt=Mt(),at=Ye("button"),ii(Un.$$.fragment),ji=Mt(),Bn=Ye("div"),Ne=Mt(),yt=Ye("div"),Zt=Ye("div"),ti=Ye("span"),ti.textContent=Gn,Qt=Mt(),qi=Ye("button"),ii(ar.$$.fragment),Oi=Mt(),ie=Ye("div"),V=Mt(),j=Ye("div"),H=Ye("div"),se=Ye("span"),se.textContent=_e,xe=Mt(),we=Ye("button"),ii(de.$$.fragment),Pe=Mt(),Xe=Ye("div"),We=Mt(),Ue=Ye("div"),Ft=Ye("div"),Nt=Ye("span"),Nt.textContent=gn,Kt=Mt(),tn=Ye("button"),ii(en.$$.fragment),Kn=Mt(),ni=Ye("div"),nn=Mt(),Fn=Ye("div"),$n=Ye("div"),Ai=Ye("span"),Ai.textContent=xr,mi=Mt(),sr=Ye("button"),ii(ps.$$.fragment),Vn=Mt(),Ta=Ye("div"),uo=Mt(),_i=Ye("div"),Bi=Ye("div"),fa=Ye("span"),fa.textContent=wr,or=Mt(),Xr=Ye("button"),ii(Sr.$$.fragment),Ci=Mt(),pa=Ye("div"),Na=Mt(),Xn=Ye("div"),Pr=Ye("div"),tr=Ye("span"),tr.textContent=ho,Qr=Mt(),Hr=Ye("button"),ii($r.$$.fragment),zn=Mt(),Ma=Ye("div"),fe=Mt(),zt=Ye("div"),Nn=Ye("div"),Hi=Ye("span"),Hi.textContent=Ra,Lr=Mt(),Wr=Ye("button"),ii(is.$$.fragment),fo=Mt(),po=Ye("div"),Fu=Mt(),rs=Ye("div"),ms=Ye("div"),ma=Ye("span"),ma.textContent=Ol,Ir=Mt(),Fi=Ye("button"),ii(_s.$$.fragment),Jo=Mt(),gs=Ye("div"),Nu=Mt(),bs=Ye("button"),Oa.c(),this.h()},l(xt){e=Je(xt,"DIV",{class:!0});var Qi=ht(e);n=Je(Qi,"DIV",{class:!0});var Ni=ht(n);i=Je(Ni,"BUTTON",{class:!0,"data-svelte-h":!0}),Li(i)!=="svelte-zar9cv"&&(i.innerHTML=o),u=At(Ni),h=Je(Ni,"DIV",{class:!0});var Us=ht(h);c=Je(Us,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Li(c)!=="svelte-1qwdzly"&&(c.textContent=b),w=At(Us),M=Je(Us,"DIV",{style:!0});var Sn=ht(M);ri(S.$$.fragment,Sn),Us.forEach(Fe),Ni.forEach(Fe),P=At(Qi),B=Je(Qi,"DIV",{class:!0});var Tr=ht(B);U=Je(Tr,"DIV",{class:!0});var jl=ht(U);J=Je(jl,"DIV",{class:!0,style:!0});var ql=ht(J);Q=Je(ql,"DIV",{class:!0});var Hl=ht(Q);K=Je(Hl,"DIV",{class:!0});var _o=ht(K);le=Je(_o,"H3",{class:!0});var vs=ht(le);ee=Sa(vs,`Scenarios
                            `),oe=Je(vs,"BUTTON",{class:!0,style:!0});var Uu=ht(oe);ri(Z.$$.fragment,Uu),Uu.forEach(Fe),vs.forEach(Fe),ne=At(_o),be=Je(_o,"DIV",{class:!0});var Nc=ht(be);me=Je(Nc,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Li(me)!=="svelte-17bethp"&&(me.textContent=Te),Y=At(Nc),ye=Je(Nc,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),Li(ye)!=="svelte-8wrf83"&&(ye.textContent=qe),Nc.forEach(Fe),He=At(_o),Be=Je(_o,"DIV",{class:!0});var qh=ht(Be);for(let Ar=0;Ar<Wi.length;Ar+=1)Wi[Ar].l(qh);qh.forEach(Fe),_o.forEach(Fe),lt=At(Hl),Ge=Je(Hl,"DIV",{class:!0});var Wl=ht(Ge);ot=Je(Wl,"DIV",{class:!0});var Vs=ht(ot);je=Je(Vs,"SPAN",{class:!0,"data-svelte-h":!0}),Li(je)!=="svelte-1oqrbys"&&(je.textContent=Ve),$e=At(Vs),st=Je(Vs,"DIV",{class:!0});var Rc=ht(st);ct=Je(Rc,"DIV",{class:!0});var go=ht(ct);for(let Ar=0;Ar<sn.length;Ar+=1)sn[Ar].l(go);Pt=At(go),Ut=Je(go,"SPAN",{class:!0});var Vu=ht(Ut);gt=Sa(Vu,Lt),Bt=Sa(Vu," -"),Vu.forEach(Fe),go.forEach(Fe),tt=At(Rc),Le=Je(Rc,"DIV",{class:!0});var Oc=ht(Le);for(let Ar=0;Ar<Zi.length;Ar+=1)Zi[Ar].l(Oc);ut=At(Oc),Re=Je(Oc,"DIV",{style:!0}),ht(Re).forEach(Fe),Oc.forEach(Fe),Rc.forEach(Fe),Vs.forEach(Fe),Ee=At(Wl),wt=Je(Wl,"DIV",{class:!0,"data-svelte-h":!0}),Li(wt)!=="svelte-164zjvu"&&(wt.innerHTML=De),Wl.forEach(Fe),Hl.forEach(Fe),wn=At(ql),Wn=Je(ql,"DIV",{class:!0,role:!0}),ht(Wn).forEach(Fe),ql.forEach(Fe),on=At(jl),An=Je(jl,"DIV",{class:!0});var ju=ht(An);ki&&ki.l(ju),ju.forEach(Fe),jl.forEach(Fe),yr=At(Tr),br=Je(Tr,"DIV",{class:!0});var qu=ht(br);Zn=Je(qu,"DIV",{class:!0});var nr=ht(Zn);Tn=Je(nr,"DIV",{class:!0});var Xo=ht(Tn);pi=Je(Xo,"DIV",{class:!0});var Zl=ht(pi);vr=Je(Zl,"SPAN",{class:!0,"data-svelte-h":!0}),Li(vr)!=="svelte-soxz9f"&&(vr.textContent=Jn),dt=At(Zl),at=Je(Zl,"BUTTON",{class:!0,style:!0});var yo=ht(at);ri(Un.$$.fragment,yo),yo.forEach(Fe),Zl.forEach(Fe),ji=At(Xo),Bn=Je(Xo,"DIV",{class:!0,role:!0}),ht(Bn).forEach(Fe),Xo.forEach(Fe),Ne=At(nr),yt=Je(nr,"DIV",{class:!0});var Ca=ht(yt);Zt=Je(Ca,"DIV",{class:!0});var Qo=ht(Zt);ti=Je(Qo,"SPAN",{class:!0,"data-svelte-h":!0}),Li(ti)!=="svelte-1cy3wlo"&&(ti.textContent=Gn),Qt=At(Qo),qi=Je(Qo,"BUTTON",{class:!0,style:!0});var Uc=ht(qi);ri(ar.$$.fragment,Uc),Uc.forEach(Fe),Qo.forEach(Fe),Oi=At(Ca),ie=Je(Ca,"DIV",{class:!0,role:!0}),ht(ie).forEach(Fe),Ca.forEach(Fe),V=At(nr),j=Je(nr,"DIV",{class:!0});var $o=ht(j);H=Je($o,"DIV",{class:!0});var vi=ht(H);se=Je(vi,"SPAN",{class:!0,"data-svelte-h":!0}),Li(se)!=="svelte-1cyltpu"&&(se.textContent=_e),xe=At(vi),we=Je(vi,"BUTTON",{class:!0,style:!0});var Vc=ht(we);ri(de.$$.fragment,Vc),Vc.forEach(Fe),vi.forEach(Fe),Pe=At($o),Xe=Je($o,"DIV",{class:!0,role:!0}),ht(Xe).forEach(Fe),$o.forEach(Fe),We=At(nr),Ue=Je(nr,"DIV",{class:!0});var dn=ht(Ue);Ft=Je(dn,"DIV",{class:!0});var js=ht(Ft);Nt=Je(js,"SPAN",{class:!0,"data-svelte-h":!0}),Li(Nt)!=="svelte-xgrsp6"&&(Nt.textContent=gn),Kt=At(js),tn=Je(js,"BUTTON",{class:!0,style:!0});var xi=ht(tn);ri(en.$$.fragment,xi),xi.forEach(Fe),js.forEach(Fe),Kn=At(dn),ni=Je(dn,"DIV",{class:!0,role:!0}),ht(ni).forEach(Fe),dn.forEach(Fe),nn=At(nr),Fn=Je(nr,"DIV",{class:!0});var oi=ht(Fn);$n=Je(oi,"DIV",{class:!0});var bo=ht($n);Ai=Je(bo,"SPAN",{class:!0,"data-svelte-h":!0}),Li(Ai)!=="svelte-12zx9q8"&&(Ai.textContent=xr),mi=At(bo),sr=Je(bo,"BUTTON",{class:!0,style:!0});var Hu=ht(sr);ri(ps.$$.fragment,Hu),Hu.forEach(Fe),bo.forEach(Fe),Vn=At(oi),Ta=Je(oi,"DIV",{class:!0,role:!0}),ht(Ta).forEach(Fe),oi.forEach(Fe),uo=At(nr),_i=Je(nr,"DIV",{class:!0});var el=ht(_i);Bi=Je(el,"DIV",{class:!0});var jc=ht(Bi);fa=Je(jc,"SPAN",{class:!0,"data-svelte-h":!0}),Li(fa)!=="svelte-1nv9zqe"&&(fa.textContent=wr),or=At(jc),Xr=Je(jc,"BUTTON",{class:!0,style:!0});var Wu=ht(Xr);ri(Sr.$$.fragment,Wu),Wu.forEach(Fe),jc.forEach(Fe),Ci=At(el),pa=Je(el,"DIV",{class:!0,role:!0}),ht(pa).forEach(Fe),el.forEach(Fe),Na=At(nr),Xn=Je(nr,"DIV",{class:!0});var vo=ht(Xn);Pr=Je(vo,"DIV",{class:!0});var xo=ht(Pr);tr=Je(xo,"SPAN",{class:!0,"data-svelte-h":!0}),Li(tr)!=="svelte-39uoao"&&(tr.textContent=ho),Qr=At(xo),Hr=Je(xo,"BUTTON",{class:!0,style:!0});var tl=ht(Hr);ri($r.$$.fragment,tl),tl.forEach(Fe),xo.forEach(Fe),zn=At(vo),Ma=Je(vo,"DIV",{class:!0,role:!0}),ht(Ma).forEach(Fe),vo.forEach(Fe),fe=At(nr),zt=Je(nr,"DIV",{class:!0});var wo=ht(zt);Nn=Je(wo,"DIV",{class:!0});var Ua=ht(Nn);Hi=Je(Ua,"SPAN",{class:!0,"data-svelte-h":!0}),Li(Hi)!=="svelte-1oye1gl"&&(Hi.textContent=Ra),Lr=At(Ua),Wr=Je(Ua,"BUTTON",{class:!0,style:!0});var qs=ht(Wr);ri(is.$$.fragment,qs),qs.forEach(Fe),Ua.forEach(Fe),fo=At(wo),po=Je(wo,"DIV",{class:!0,role:!0}),ht(po).forEach(Fe),wo.forEach(Fe),Fu=At(nr),rs=Je(nr,"DIV",{class:!0});var Mr=ht(rs);ms=Je(Mr,"DIV",{class:!0});var Gl=ht(ms);ma=Je(Gl,"SPAN",{class:!0,"data-svelte-h":!0}),Li(ma)!=="svelte-6pv5a0"&&(ma.textContent=Ol),Ir=At(Gl),Fi=Je(Gl,"BUTTON",{class:!0,style:!0});var Zu=ht(Fi);ri(_s.$$.fragment,Zu),Zu.forEach(Fe),Gl.forEach(Fe),Jo=At(Mr),gs=Je(Mr,"DIV",{class:!0,role:!0}),ht(gs).forEach(Fe),Mr.forEach(Fe),nr.forEach(Fe),qu.forEach(Fe),Nu=At(Tr),bs=Je(Tr,"BUTTON",{class:!0});var qc=ht(bs);Oa.l(qc),qc.forEach(Fe),Tr.forEach(Fe),Qi.forEach(Fe),this.h()},h(){Me(i,"class","flex flex-row items-center justify-start select-none text-start"),Me(c,"class","mr-2 text-base font-light"),Me(c,"for","storm"),qt(M,"display","contents"),qt(M,"--border-radius","0"),qt(M,"--border-radius-focused","0"),qt(M,"--item-first-border-radius","0"),qt(M,"--list-border-radius","0"),qt(M,"--item-color","black"),qt(M,"--selected-item-color","black"),qt(M,"--chevron-color","black"),qt(M,"--clear-icon-color","red"),qt(M,"--item-hover-color","black"),Me(h,"class","flex-1 max-w-96 flex flex-row items-center justify-center"),Me(n,"class","z-10 sticky top-0 flex flex-row text-white h-20 px-4 bg-black items-center justify-between shrink-0"),Me(oe,"class","relative tooltip-container cursor-help"),qt(oe,"--tooltip-background-color","#fff"),qt(oe,"--tooltip-color","#000"),Me(le,"class","text-xl font-semibold flex flex-row items-center gap-x-2"),Me(me,"type","button"),Me(me,"class","text-xs font-light border border-white px-2 shadow-md shadow-white/25 hover:shadow-white/50 active:shadow-none active:mt-1"),Me(ye,"type","button"),Me(ye,"class","text-xs font-light border border-white px-2 shadow-md shadow-white/25 hover:shadow-white/50 active:shadow-none active:mt-1"),Me(be,"class","flex flex-row items-center gap-x-4 h-8 pb-2 "),Me(Be,"class","flex flex-row flex-wrap gap-x-8 gap-y-4"),Me(K,"class","flex flex-col gap-y-2"),Me(je,"class",""),Me(Ut,"class","w-8 h-4 text-xs text-end"),Me(ct,"class","flex flex-col-reverse pt-2"),qt(Re,"width","0"),qt(Re,"height","0"),qt(Re,"border","0.5rem solid transparent"),qt(Re,"border-top","0"),qt(Re,"border-bottom","1rem solid "+t[20][t[20].length-1].color),Me(Le,"class","flex flex-col-reverse"),Me(st,"class","flex flex-row items-start"),Me(ot,"class",Ke="transition-all "+(t[12].filter(B9).length<=1?"grayscale-0 opacity-100":"grayscale opacity-25")),Me(wt,"class","flex flex-row items-end justify-center gap-x-1 mt-2"),Me(Ge,"class","flex flex-col items-end"),Me(Q,"class","flex flex-row"),Me(Wn,"class","svg-container w-full flex-1 shrink-0"),Me(Wn,"role","img"),Me(J,"class","w-[var(--width)] shrink-0 h-full p-4 flex flex-col gap-y-8"),qt(J,"--width",xC+"px"),Me(An,"class","flex-1 w-full min-w-96 min-h-96 h-auto p-4"),Me(U,"class","flex flex-row flex-wrap w-full min-h-[calc(100vh-7.5rem)]"),Me(vr,"class",""),Me(at,"class","relative tooltip-container-bottom cursor-help"),qt(at,"--tooltip-background-color","#fff"),qt(at,"--tooltip-color","#000"),qt(at,"--tooltip-offset-x","10px"),Me(pi,"class","flex flex-row items-center gap-x-2"),Me(Bn,"class","flex-1 svg-container"),Me(Bn,"role","img"),Me(Tn,"class","w-96 h-64 flex flex-col items-center"),Me(ti,"class",""),Me(qi,"class","relative tooltip-container-bottom cursor-help"),qt(qi,"--tooltip-background-color","#fff"),qt(qi,"--tooltip-color","#000"),qt(qi,"--tooltip-offset-x","10px"),Me(Zt,"class","flex flex-row items-center gap-x-2"),Me(ie,"class","flex-1 svg-container"),Me(ie,"role","img"),Me(yt,"class","w-96 h-64 flex flex-col items-center"),Me(se,"class",""),Me(we,"class","relative tooltip-container-bottom cursor-help"),qt(we,"--tooltip-background-color","#fff"),qt(we,"--tooltip-color","#000"),qt(we,"--tooltip-offset-x","10px"),Me(H,"class","flex flex-row items-center gap-x-2"),Me(Xe,"class","flex-1 svg-container"),Me(Xe,"role","img"),Me(j,"class","w-96 h-64 flex flex-col items-center"),Me(Nt,"class",""),Me(tn,"class","relative tooltip-container-bottom cursor-help"),qt(tn,"--tooltip-background-color","#fff"),qt(tn,"--tooltip-color","#000"),qt(tn,"--tooltip-offset-x","10px"),Me(Ft,"class","flex flex-row items-center gap-x-2"),Me(ni,"class","flex-1 svg-container"),Me(ni,"role","img"),Me(Ue,"class","w-96 h-64 flex flex-col items-center"),Me(Ai,"class",""),Me(sr,"class","relative tooltip-container-bottom cursor-help"),qt(sr,"--tooltip-background-color","#fff"),qt(sr,"--tooltip-color","#000"),qt(sr,"--tooltip-offset-x","10px"),Me($n,"class","flex flex-row items-center gap-x-2"),Me(Ta,"class","flex-1 svg-container"),Me(Ta,"role","img"),Me(Fn,"class","w-96 h-64 flex flex-col items-center"),Me(fa,"class",""),Me(Xr,"class","relative tooltip-container-bottom cursor-help"),qt(Xr,"--tooltip-background-color","#fff"),qt(Xr,"--tooltip-color","#000"),qt(Xr,"--tooltip-offset-x","10px"),Me(Bi,"class","flex flex-row items-center gap-x-2"),Me(pa,"class","flex-1 svg-container"),Me(pa,"role","img"),Me(_i,"class","w-96 h-64 flex flex-col items-center"),Me(tr,"class",""),Me(Hr,"class","relative tooltip-container-bottom cursor-help"),qt(Hr,"--tooltip-background-color","#fff"),qt(Hr,"--tooltip-color","#000"),qt(Hr,"--tooltip-offset-x","10px"),Me(Pr,"class","flex flex-row items-center gap-x-2"),Me(Ma,"class","flex-1 svg-container"),Me(Ma,"role","img"),Me(Xn,"class","w-96 h-64 flex flex-col items-center"),Me(Hi,"class",""),Me(Wr,"class","relative tooltip-container-bottom cursor-help"),qt(Wr,"--tooltip-background-color","#fff"),qt(Wr,"--tooltip-color","#000"),qt(Wr,"--tooltip-offset-x","10px"),Me(Nn,"class","flex flex-row items-center gap-x-2"),Me(po,"class","flex-1 svg-container"),Me(po,"role","img"),Me(zt,"class","w-96 h-64 flex flex-col items-center"),Me(ma,"class",""),Me(Fi,"class","relative tooltip-container-bottom cursor-help"),qt(Fi,"--tooltip-background-color","#fff"),qt(Fi,"--tooltip-color","#000"),qt(Fi,"--tooltip-offset-x","10px"),Me(ms,"class","flex flex-row items-center gap-x-2"),Me(gs,"class","flex-1 svg-container"),Me(gs,"role","img"),Me(rs,"class","w-96 h-64 flex flex-col items-center"),Me(Zn,"class",Ko=(t[18]?"flex":"hidden")+" gap-x-4 gap-y-6 flex-row flex-wrap items-center justify-around"),Me(br,"class",ys="flex flex-row w-full transition-all px-4 "+(t[18]?"min-h-[calc(100vh-7.5rem)]":"h-0")),Me(bs,"class","flex flex-row w-full h-10 items-center justify-center gap-x-2 cursor-pointer hover:bg-white/20 active:bg-white/10 transition-all select-none "),Me(B,"class","flex flex-col w-full bg-black/90 backdrop-blur backdrop-grayscale"),Me(e,"class","w-screen h-screen overflow-y-auto relative")},m(xt,Qi){Jt(xt,e,Qi),Ce(e,n),Ce(n,i),Ce(n,u),Ce(n,h),Ce(h,c),Ce(h,w),Ce(h,M),ai(S,M,null),Ce(e,P),Ce(e,B),Ce(B,U),Ce(U,J),Ce(J,Q),Ce(Q,K),Ce(K,le),Ce(le,ee),Ce(le,oe),ai(Z,oe,null),Ce(K,ne),Ce(K,be),Ce(be,me),Ce(be,Y),Ce(be,ye),Ce(K,He),Ce(K,Be);for(let Ni=0;Ni<Wi.length;Ni+=1)Wi[Ni]&&Wi[Ni].m(Be,null);Ce(Q,lt),Ce(Q,Ge),Ce(Ge,ot),Ce(ot,je),Ce(ot,$e),Ce(ot,st),Ce(st,ct);for(let Ni=0;Ni<sn.length;Ni+=1)sn[Ni]&&sn[Ni].m(ct,null);Ce(ct,Pt),Ce(ct,Ut),Ce(Ut,gt),Ce(Ut,Bt),Ce(st,tt),Ce(st,Le);for(let Ni=0;Ni<Zi.length;Ni+=1)Zi[Ni]&&Zi[Ni].m(Le,null);Ce(Le,ut),Ce(Le,Re),Ce(Ge,Ee),Ce(Ge,wt),Ce(J,wn),Ce(J,Wn),t[41](Wn),Ce(U,on),Ce(U,An),ki&&ki.m(An,null),Ce(B,yr),Ce(B,br),Ce(br,Zn),Ce(Zn,Tn),Ce(Tn,pi),Ce(pi,vr),Ce(pi,dt),Ce(pi,at),ai(Un,at,null),Ce(Tn,ji),Ce(Tn,Bn),t[47](Bn),Ce(Zn,Ne),Ce(Zn,yt),Ce(yt,Zt),Ce(Zt,ti),Ce(Zt,Qt),Ce(Zt,qi),ai(ar,qi,null),Ce(yt,Oi),Ce(yt,ie),t[48](ie),Ce(Zn,V),Ce(Zn,j),Ce(j,H),Ce(H,se),Ce(H,xe),Ce(H,we),ai(de,we,null),Ce(j,Pe),Ce(j,Xe),t[49](Xe),Ce(Zn,We),Ce(Zn,Ue),Ce(Ue,Ft),Ce(Ft,Nt),Ce(Ft,Kt),Ce(Ft,tn),ai(en,tn,null),Ce(Ue,Kn),Ce(Ue,ni),t[50](ni),Ce(Zn,nn),Ce(Zn,Fn),Ce(Fn,$n),Ce($n,Ai),Ce($n,mi),Ce($n,sr),ai(ps,sr,null),Ce(Fn,Vn),Ce(Fn,Ta),t[51](Ta),Ce(Zn,uo),Ce(Zn,_i),Ce(_i,Bi),Ce(Bi,fa),Ce(Bi,or),Ce(Bi,Xr),ai(Sr,Xr,null),Ce(_i,Ci),Ce(_i,pa),t[52](pa),Ce(Zn,Na),Ce(Zn,Xn),Ce(Xn,Pr),Ce(Pr,tr),Ce(Pr,Qr),Ce(Pr,Hr),ai($r,Hr,null),Ce(Xn,zn),Ce(Xn,Ma),t[53](Ma),Ce(Zn,fe),Ce(Zn,zt),Ce(zt,Nn),Ce(Nn,Hi),Ce(Nn,Lr),Ce(Nn,Wr),ai(is,Wr,null),Ce(zt,fo),Ce(zt,po),t[54](po),Ce(Zn,Fu),Ce(Zn,rs),Ce(rs,ms),Ce(ms,ma),Ce(ms,Ir),Ce(ms,Fi),ai(_s,Fi,null),Ce(rs,Jo),Ce(rs,gs),t[55](gs),Ce(B,Nu),Ce(B,bs),as[Aa].m(bs,null),t[56](e),mo=!0,Ru||(Ul=[Yn(i,"click",t[23]),Ga(hl.call(null,oe,{content:`<div class="cursor-default">
                                        Eight future climate scenarios are derived by analyzing monthly data from two emission scenarios,
                                        SSP585 and SSP245, using global climate models categorized as 'hot' or 'cold' based on their
                                        sensitivity to global warming. The 'near future' period spans from 2020 to 2059 while the
                                        'far future' covers 2060 to 2099. The future climate signals are directly applied to the following
                                        model inputs: VMPI, U200, SHRD, and RHLO. Changes to these inputs can be viewed in the 'MORE'
                                        section when future scenarios are selected. Future climate signals are derived following the method
                                        in the Jones et. al.'s
                                        <a
                                            class="text-blue-400 cursor-pointer hover:underline underline-offset-4"
                                            href="https://tgw-data.msdlive.org" target="_blank" rel="noreferrer"
                                        >
                                        <i>Continental United States climate projections based on thermodynamic modification of
                                        historical weather</i></a>.</div>
                                    `,theme:"offset-tooltip",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"right",maxWidth:600})),Yn(me,"click",t[24]),Yn(ye,"click",t[25]),Yn(at,"click",Ya(La(t[37]))),Ga(hl.call(null,at,{content:"Maximum potential intensity from Kerry Emanuel equation (kt)",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(qi,"click",Ya(La(t[36]))),Ga(hl.call(null,qi,{content:"200 hPa zonal wind (kt*10) vs time (r=200-800 km)",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(we,"click",Ya(La(t[35]))),Ga(hl.call(null,we,{content:"850-200 hPa shear magnitude (kt*10) vs time (200-800 km)",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(tn,"click",Ya(La(t[34]))),Ga(hl.call(null,tn,{content:"Last 6 hourly intensity change (kt)",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(sr,"click",Ya(La(t[33]))),Ga(hl.call(null,sr,{content:"850-700 hPa relative humidity (%) vs time (200-800 km)",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(Xr,"click",Ya(La(t[32]))),Ga(hl.call(null,Xr,{content:"Land percentage within 500 kilometers at current position",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(Hr,"click",Ya(La(t[31]))),Ga(hl.call(null,Hr,{content:"The observed zonal storm motion component (m/s*10) at position in 6 hours",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(Wr,"click",Ya(La(t[30]))),Ga(hl.call(null,Wr,{content:"Storm center latitude in degrees North",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(Fi,"click",Ya(La(t[29]))),Ga(hl.call(null,Fi,{content:"Storm center longitude in degrees East (negative values for West of Prime Meridian)",autoPosition:!0,hideOnClickOutside:!0,action:"click",position:"bottom"})),Yn(bs,"click",t[21])],Ru=!0)},p(xt,Qi){const Ni={};if(!A&&Qi[0]&2048&&(A=!0,Ni.value=xt[11],U1(()=>A=!1)),S.$set(Ni),Qi[0]&524289){Rs=Qs(xt[19]);let Sn;for(Sn=0;Sn<Rs.length;Sn+=1){const Tr=M9(xt,Rs,Sn);Wi[Sn]?Wi[Sn].p(Tr,Qi):(Wi[Sn]=A9(Tr),Wi[Sn].c(),Wi[Sn].m(Be,null))}for(;Sn<Wi.length;Sn+=1)Wi[Sn].d(1);Wi.length=Rs.length}if(Qi[0]&1048576){lr=Qs(xt[20]);let Sn;for(Sn=0;Sn<lr.length;Sn+=1){const Tr=T9(xt,lr,Sn);sn[Sn]?sn[Sn].p(Tr,Qi):(sn[Sn]=C9(Tr),sn[Sn].c(),sn[Sn].m(ct,Pt))}for(;Sn<sn.length;Sn+=1)sn[Sn].d(1);sn.length=lr.length}if(Qi[0]&1048576){Os=Qs(xt[20]);let Sn;for(Sn=0;Sn<Os.length;Sn+=1){const Tr=I9(xt,Os,Sn);Zi[Sn]?Zi[Sn].p(Tr,Qi):(Zi[Sn]=k9(Tr),Zi[Sn].c(),Zi[Sn].m(Le,ut))}for(;Sn<Zi.length;Sn+=1)Zi[Sn].d(1);Zi.length=Os.length}(!mo||Qi[0]&4096&&Ke!==(Ke="transition-all "+(xt[12].filter(B9).length<=1?"grayscale-0 opacity-100":"grayscale opacity-25")))&&Me(ot,"class",Ke),xt[17]?ki?(ki.p(xt,Qi),Qi[0]&131072&&rt(ki,1)):(ki=E9(xt),ki.c(),rt(ki,1),ki.m(An,null)):ki&&(Ji(),mt(ki,1,1,()=>{ki=null}),Ki()),(!mo||Qi[0]&262144&&Ko!==(Ko=(xt[18]?"flex":"hidden")+" gap-x-4 gap-y-6 flex-row flex-wrap items-center justify-around"))&&Me(Zn,"class",Ko),(!mo||Qi[0]&262144&&ys!==(ys="flex flex-row w-full transition-all px-4 "+(xt[18]?"min-h-[calc(100vh-7.5rem)]":"h-0")))&&Me(br,"class",ys);let Us=Aa;Aa=jh(xt),Aa!==Us&&(Ji(),mt(as[Us],1,1,()=>{as[Us]=null}),Ki(),Oa=as[Aa],Oa||(Oa=as[Aa]=Vh[Aa](xt),Oa.c()),rt(Oa,1),Oa.m(bs,null))},i(xt){mo||(rt(S.$$.fragment,xt),rt(Z.$$.fragment,xt),rt(ki),rt(Un.$$.fragment,xt),rt(ar.$$.fragment,xt),rt(de.$$.fragment,xt),rt(en.$$.fragment,xt),rt(ps.$$.fragment,xt),rt(Sr.$$.fragment,xt),rt($r.$$.fragment,xt),rt(is.$$.fragment,xt),rt(_s.$$.fragment,xt),rt(Oa),mo=!0)},o(xt){mt(S.$$.fragment,xt),mt(Z.$$.fragment,xt),mt(ki),mt(Un.$$.fragment,xt),mt(ar.$$.fragment,xt),mt(de.$$.fragment,xt),mt(en.$$.fragment,xt),mt(ps.$$.fragment,xt),mt(Sr.$$.fragment,xt),mt($r.$$.fragment,xt),mt(is.$$.fragment,xt),mt(_s.$$.fragment,xt),mt(Oa),mo=!1},d(xt){xt&&Fe(e),si(S),si(Z),Od(Wi,xt),Od(sn,xt),Od(Zi,xt),t[41](null),ki&&ki.d(),si(Un),t[47](null),si(ar),t[48](null),si(de),t[49](null),si(en),t[50](null),si(ps),t[51](null),si(Sr),t[52](null),si($r),t[53](null),si(is),t[54](null),si(_s),t[55](null),as[Aa].d(),t[56](null),Ru=!1,Ph(Ul)}}}function UZ(t){let e,n,i;return n=new xZ({}),{c(){e=Ye("div"),ii(n.$$.fragment),this.h()},l(o){e=Je(o,"DIV",{slot:!0,class:!0});var u=ht(e);ri(n.$$.fragment,u),u.forEach(Fe),this.h()},h(){Me(e,"slot","prepend"),Me(e,"class","mr-2 text-gray-600 text-3xl")},m(o,u){Jt(o,e,u),ai(n,e,null),i=!0},p:fi,i(o){i||(rt(n.$$.fragment,o),i=!0)},o(o){mt(n.$$.fragment,o),i=!1},d(o){o&&Fe(e),si(n)}}}function VZ(t){let e,n,i="Try:",o,u,h="Irene (2011)",c,b,w="Katrina (2005)",S,M;return{c(){e=Ye("div"),n=Ye("span"),n.textContent=i,o=Mt(),u=Ye("button"),u.textContent=h,c=Mt(),b=Ye("button"),b.textContent=w,this.h()},l(A){e=Je(A,"DIV",{slot:!0,class:!0});var P=ht(e);n=Je(P,"SPAN",{class:!0,"data-svelte-h":!0}),Li(n)!=="svelte-4jaio"&&(n.textContent=i),o=At(P),u=Je(P,"BUTTON",{class:!0,"data-svelte-h":!0}),Li(u)!=="svelte-1gtrzgi"&&(u.textContent=h),c=At(P),b=Je(P,"BUTTON",{class:!0,"data-svelte-h":!0}),Li(b)!=="svelte-1aq02pp"&&(b.textContent=w),P.forEach(Fe),this.h()},h(){Me(n,"class",""),Me(u,"class","rounded-sm px-2 py-1 bg-sky-700 hover:bg-sky-600 text-white shadow-sm shadow-black/25"),Me(b,"class","rounded-sm px-2 py-1 bg-fuchsia-800 hover:bg-fuchsia-700 text-white shadow-sm shadow-black/25"),Me(e,"slot","required"),Me(e,"class","hidden md:flex flex-row items-center justify-end text-gray-600 gap-x-2 pr-2")},m(A,P){Jt(A,e,P),Ce(e,n),Ce(e,o),Ce(e,u),Ce(e,c),Ce(e,b),S||(M=[Yn(u,"click",t[57]),Yn(b,"click",t[58])],S=!0)},p:fi,d(A){A&&Fe(e),S=!1,Ph(M)}}}function jZ(t){let e;return{c(){e=Ye("div"),this.h()},l(n){e=Je(n,"DIV",{class:!0,style:!0}),ht(e).forEach(Fe),this.h()},h(){Me(e,"class","w-4 h-1 bg-custom-color"),qt(e,"--custom-color",t[63].color)},m(n,i){Jt(n,e,i)},p:fi,d(n){n&&Fe(e)}}}function qZ(t){let e;return{c(){e=Ye("div"),this.h()},l(n){e=Je(n,"DIV",{class:!0,style:!0}),ht(e).forEach(Fe),this.h()},h(){Me(e,"class","w-4 h-4 bg-custom-color/50 border border-custom-color"),qt(e,"--custom-color",t[63].color)},m(n,i){Jt(n,e,i)},p:fi,d(n){n&&Fe(e)}}}function HZ(t){let e;return{c(){e=Ye("div"),this.h()},l(n){e=Je(n,"DIV",{class:!0,style:!0}),ht(e).forEach(Fe),this.h()},h(){Me(e,"class","w-4 h-4 rounded-full bg-custom-color/50 border border-custom-color"),qt(e,"--custom-color",t[63].color)},m(n,i){Jt(n,e,i)},p:fi,d(n){n&&Fe(e)}}}function A9(t){let e,n,i,o,u=t[63].name+"",h,c,b,w,S;function M(B,U){if(B[63].symbol==="circle")return HZ;if(B[63].symbol==="square")return qZ;if(B[63].symbol==="line")return jZ}let A=M(t),P=A&&A(t);return b=yk(t[40][0]),{c(){e=Ye("label"),n=Ye("input"),i=Mt(),P&&P.c(),o=Mt(),h=wa(u),c=Mt(),this.h()},l(B){e=Je(B,"LABEL",{class:!0});var U=ht(e);n=Je(U,"INPUT",{class:!0,type:!0}),i=At(U),P&&P.l(U),o=At(U),h=Sa(U,u),c=At(U),U.forEach(Fe),this.h()},h(){Me(n,"class",""),Me(n,"type","checkbox"),n.disabled=t[63].id==="ibtracs",n.__value=t[63].id,vb(n,n.__value),Me(e,"class","w-56 flex flex-row items-center gap-x-2"),b.p(n)},m(B,U){Jt(B,e,U),Ce(e,n),n.checked=~(t[0]||[]).indexOf(n.__value),Ce(e,i),P&&P.m(e,null),Ce(e,o),Ce(e,h),Ce(e,c),w||(S=Yn(n,"change",t[39]),w=!0)},p(B,U){U[0]&1&&(n.checked=~(B[0]||[]).indexOf(n.__value)),P&&P.p(B,U)},d(B){B&&Fe(e),P&&P.d(),b.r(),w=!1,S()}}}function C9(t){let e,n=t[66].min+"",i,o;return{c(){e=Ye("span"),i=wa(n),o=wa(" -"),this.h()},l(u){e=Je(u,"SPAN",{class:!0});var h=ht(e);i=Sa(h,n),o=Sa(h," -"),h.forEach(Fe),this.h()},h(){Me(e,"class","w-8 h-4 text-xs text-end")},m(u,h){Jt(u,e,h),Ce(e,i),Ce(e,o)},p:fi,d(u){u&&Fe(e)}}}function k9(t){let e;return{c(){e=Ye("div"),this.h()},l(n){e=Je(n,"DIV",{class:!0,style:!0}),ht(e).forEach(Fe),this.h()},h(){Me(e,"class","w-4 h-4 bg-[var(--color)]"),qt(e,"--color",t[66].color)},m(n,i){Jt(n,e,i)},p:fi,d(n){n&&Fe(e)}}}function E9(t){let e,n;return e=new ED({props:{bounds:t[17],class:"w-full h-full",standardControls:!0,cooperativeGestures:!0,style:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",$$slots:{default:[JZ]},$$scope:{ctx:t}}}),{c(){ii(e.$$.fragment)},l(i){ri(e.$$.fragment,i)},m(i,o){ai(e,i,o),n=!0},p(i,o){const u={};o[0]&131072&&(u.bounds=i[17]),o[0]&114689|o[2]&2048&&(u.$$scope={dirty:o,ctx:i}),e.$set(u)},i(i){n||(rt(e.$$.fragment,i),n=!0)},o(i){mt(e.$$.fragment,i),n=!1},d(i){si(e,i)}}}function D9(t){let e,n,i,o;return e=new F8({props:{id:"track",data:t[15],$$slots:{default:[WZ]},$$scope:{ctx:t}}}),i=new F8({props:{id:"points",data:t[16],$$slots:{default:[YZ]},$$scope:{ctx:t}}}),{c(){ii(e.$$.fragment),n=Mt(),ii(i.$$.fragment)},l(u){ri(e.$$.fragment,u),n=At(u),ri(i.$$.fragment,u)},m(u,h){ai(e,u,h),Jt(u,n,h),ai(i,u,h),o=!0},p(u,h){const c={};h[0]&32768&&(c.data=u[15]),h[2]&2048&&(c.$$scope={dirty:h,ctx:u}),e.$set(c);const b={};h[0]&65536&&(b.data=u[16]),h[0]&16385|h[2]&2048&&(b.$$scope={dirty:h,ctx:u}),i.$set(b)},i(u){o||(rt(e.$$.fragment,u),rt(i.$$.fragment,u),o=!0)},o(u){mt(e.$$.fragment,u),mt(i.$$.fragment,u),o=!1},d(u){u&&Fe(n),si(e,u),si(i,u)}}}function WZ(t){let e,n;return e=new gD({props:{layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":4,"line-color":"#ffffff","line-opacity":.8}}}),{c(){ii(e.$$.fragment)},l(i){ri(e.$$.fragment,i)},m(i,o){ai(e,i,o),n=!0},p:fi,i(i){n||(rt(e.$$.fragment,i),n=!0)},o(i){mt(e.$$.fragment,i),n=!1},d(i){si(e,i)}}}function P9(t){let e,n,i=t[63].name+"",o,u,h,c=t[62][0].properties[`vmax_kts_${t[63].id}`].toFixed(0)+"",b,w;return{c(){e=Ye("p"),n=Ye("span"),o=wa(i),u=wa(" intensity vmax (knots):"),h=Mt(),b=wa(c),w=Mt(),this.h()},l(S){e=Je(S,"P",{});var M=ht(e);n=Je(M,"SPAN",{class:!0});var A=ht(n);o=Sa(A,i),u=Sa(A," intensity vmax (knots):"),A.forEach(Fe),h=At(M),b=Sa(M,c),w=At(M),M.forEach(Fe),this.h()},h(){Me(n,"class","font-semibold")},m(S,M){Jt(S,e,M),Ce(e,n),Ce(n,o),Ce(n,u),Ce(e,h),Ce(e,b),Ce(e,w)},p(S,M){M[0]&1&&i!==(i=S[63].name+"")&&Il(o,i),M[0]&1|M[2]&1&&c!==(c=S[62][0].properties[`vmax_kts_${S[63].id}`].toFixed(0)+"")&&Il(b,c)},d(S){S&&Fe(e)}}}function ZZ(t){let e,n,i,o="Time (UTC):",u,h=lv(t[62][0].properties.time)+"",c,b,w,S,M="Latitude:",A,P=t[62][0].geometry.coordinates[1].toFixed(2)+"",B,U,J,Q,K="Longitude:",le,ee=t[62][0].geometry.coordinates[0].toFixed(2)+"",oe,Z,ne=Qs(t[19].filter(t[42])),be=[];for(let me=0;me<ne.length;me+=1)be[me]=P9(S9(t,ne,me));return{c(){e=Ye("div"),n=Ye("p"),i=Ye("span"),i.textContent=o,u=Mt(),c=wa(h),b=Mt(),w=Ye("p"),S=Ye("span"),S.textContent=M,A=Mt(),B=wa(P),U=Mt(),J=Ye("p"),Q=Ye("span"),Q.textContent=K,le=Mt(),oe=wa(ee),Z=Mt();for(let me=0;me<be.length;me+=1)be[me].c();this.h()},l(me){e=Je(me,"DIV",{class:!0});var Te=ht(e);n=Je(Te,"P",{});var Y=ht(n);i=Je(Y,"SPAN",{class:!0,"data-svelte-h":!0}),Li(i)!=="svelte-15p1uy"&&(i.textContent=o),u=At(Y),c=Sa(Y,h),Y.forEach(Fe),b=At(Te),w=Je(Te,"P",{});var ye=ht(w);S=Je(ye,"SPAN",{class:!0,"data-svelte-h":!0}),Li(S)!=="svelte-1gsnrl6"&&(S.textContent=M),A=At(ye),B=Sa(ye,P),ye.forEach(Fe),U=At(Te),J=Je(Te,"P",{});var qe=ht(J);Q=Je(qe,"SPAN",{class:!0,"data-svelte-h":!0}),Li(Q)!=="svelte-1qm4w35"&&(Q.textContent=K),le=At(qe),oe=Sa(qe,ee),qe.forEach(Fe),Z=At(Te);for(let He=0;He<be.length;He+=1)be[He].l(Te);Te.forEach(Fe),this.h()},h(){Me(i,"class","font-semibold"),Me(S,"class","font-semibold"),Me(Q,"class","font-semibold"),Me(e,"class","text-sm text-white")},m(me,Te){Jt(me,e,Te),Ce(e,n),Ce(n,i),Ce(n,u),Ce(n,c),Ce(e,b),Ce(e,w),Ce(w,S),Ce(w,A),Ce(w,B),Ce(e,U),Ce(e,J),Ce(J,Q),Ce(J,le),Ce(J,oe),Ce(e,Z);for(let Y=0;Y<be.length;Y+=1)be[Y]&&be[Y].m(e,null)},p(me,Te){if(Te[2]&1&&h!==(h=lv(me[62][0].properties.time)+"")&&Il(c,h),Te[2]&1&&P!==(P=me[62][0].geometry.coordinates[1].toFixed(2)+"")&&Il(B,P),Te[2]&1&&ee!==(ee=me[62][0].geometry.coordinates[0].toFixed(2)+"")&&Il(oe,ee),Te[0]&524289|Te[2]&1){ne=Qs(me[19].filter(me[42]));let Y;for(Y=0;Y<ne.length;Y+=1){const ye=S9(me,ne,Y);be[Y]?be[Y].p(ye,Te):(be[Y]=P9(ye),be[Y].c(),be[Y].m(e,null))}for(;Y<be.length;Y+=1)be[Y].d(1);be.length=ne.length}},d(me){me&&Fe(e),Od(be,me)}}}function GZ(t){let e,n;return e=new JP({props:{openOn:t[14],$$slots:{default:[ZZ,({features:i})=>({62:i}),({features:i})=>[0,0,i?1:0]]},$$scope:{ctx:t}}}),{c(){ii(e.$$.fragment)},l(i){ri(e.$$.fragment,i)},m(i,o){ai(e,i,o),n=!0},p(i,o){const u={};o[0]&16384&&(u.openOn=i[14]),o[0]&1|o[2]&2049&&(u.$$scope={dirty:o,ctx:i}),e.$set(u)},i(i){n||(rt(e.$$.fragment,i),n=!0)},o(i){mt(e.$$.fragment,i),n=!1},d(i){si(e,i)}}}function YZ(t){var i,o;let e,n;return e=new aD({props:{paint:{"circle-radius":["interpolate",["exponential",.9],["zoom"],4,7,23,100],"circle-color":t[19].filter(t[43]).length<=1?["get",`color_${(i=t[19].find(t[44]))==null?void 0:i.id}`]:"black","circle-opacity":.9,"circle-stroke-width":3,"circle-stroke-color":t[19].filter(t[45]).length<=1?["get",`color_${(o=t[19].find(t[46]))==null?void 0:o.id}`]:"white","circle-stroke-opacity":1},$$slots:{default:[GZ]},$$scope:{ctx:t}}}),{c(){ii(e.$$.fragment)},l(u){ri(e.$$.fragment,u)},m(u,h){ai(e,u,h),n=!0},p(u,h){var b,w;const c={};h[0]&1&&(c.paint={"circle-radius":["interpolate",["exponential",.9],["zoom"],4,7,23,100],"circle-color":u[19].filter(u[43]).length<=1?["get",`color_${(b=u[19].find(u[44]))==null?void 0:b.id}`]:"black","circle-opacity":.9,"circle-stroke-width":3,"circle-stroke-color":u[19].filter(u[45]).length<=1?["get",`color_${(w=u[19].find(u[46]))==null?void 0:w.id}`]:"white","circle-stroke-opacity":1}),h[0]&16385|h[2]&2048&&(c.$$scope={dirty:h,ctx:u}),e.$set(c)},i(u){n||(rt(e.$$.fragment,u),n=!0)},o(u){mt(e.$$.fragment,u),n=!1},d(u){si(e,u)}}}function JZ(t){let e,n,i=t[15]&&D9(t);return{c(){i&&i.c(),e=er()},l(o){i&&i.l(o),e=er()},m(o,u){i&&i.m(o,u),Jt(o,e,u),n=!0},p(o,u){o[15]?i?(i.p(o,u),u[0]&32768&&rt(i,1)):(i=D9(o),i.c(),rt(i,1),i.m(e.parentNode,e)):i&&(Ji(),mt(i,1,1,()=>{i=null}),Ki())},i(o){n||(rt(i),n=!0)},o(o){mt(i),n=!1},d(o){o&&Fe(e),i&&i.d(o)}}}function KZ(t){let e,n,i,o="MORE",u,h,c;return e=new y9({props:{class:"text-xl pb-px"}}),h=new y9({props:{class:"text-xl pb-px"}}),{c(){ii(e.$$.fragment),n=Mt(),i=Ye("p"),i.textContent=o,u=Mt(),ii(h.$$.fragment),this.h()},l(b){ri(e.$$.fragment,b),n=At(b),i=Je(b,"P",{class:!0,"data-svelte-h":!0}),Li(i)!=="svelte-1sl7u1c"&&(i.textContent=o),u=At(b),ri(h.$$.fragment,b),this.h()},h(){Me(i,"class","ml-px text-xs font-semibold tracking-widest")},m(b,w){ai(e,b,w),Jt(b,n,w),Jt(b,i,w),Jt(b,u,w),ai(h,b,w),c=!0},i(b){c||(rt(e.$$.fragment,b),rt(h.$$.fragment,b),c=!0)},o(b){mt(e.$$.fragment,b),mt(h.$$.fragment,b),c=!1},d(b){b&&(Fe(n),Fe(i),Fe(u)),si(e,b),si(h,b)}}}function XZ(t){let e,n,i,o="LESS",u,h,c;return e=new b9({props:{class:"text-xl pb-px"}}),h=new b9({props:{class:"text-xl pb-px"}}),{c(){ii(e.$$.fragment),n=Mt(),i=Ye("p"),i.textContent=o,u=Mt(),ii(h.$$.fragment),this.h()},l(b){ri(e.$$.fragment,b),n=At(b),i=Je(b,"P",{class:!0,"data-svelte-h":!0}),Li(i)!=="svelte-jz70g0"&&(i.textContent=o),u=At(b),ri(h.$$.fragment,b),this.h()},h(){Me(i,"class","ml-px text-xs font-semibold tracking-widest")},m(b,w){ai(e,b,w),Jt(b,n,w),Jt(b,i,w),Jt(b,u,w),ai(h,b,w),c=!0},i(b){c||(rt(e.$$.fragment,b),rt(h.$$.fragment,b),c=!0)},o(b){mt(e.$$.fragment,b),mt(h.$$.fragment,b),c=!1},d(b){b&&(Fe(n),Fe(i),Fe(u)),si(e,b),si(h,b)}}}function QZ(t){let e,n,i,o,u,h,c,b;const w=[OZ,RZ],S=[];function M(A,P){return A[11]?0:1}return i=M(t),o=S[i]=w[i](t),{c(){e=Ye("div"),n=Mt(),o.c(),u=er(),this.h()},l(A){e=Je(A,"DIV",{class:!0}),ht(e).forEach(Fe),n=At(A),o.l(A),u=er(),this.h()},h(){Me(e,"class","absolute top-0 left-0 w-full h-full bg-fixed bg-cover bg-no-repeat -z-10 bg-[url('$lib/img/patricia_nasa_scott_kelly.jpg')]")},m(A,P){Jt(A,e,P),Jt(A,n,P),S[i].m(A,P),Jt(A,u,P),h=!0,c||(b=Yn(window,"keyup",t[26]),c=!0)},p(A,P){let B=i;i=M(A),i===B?S[i].p(A,P):(Ji(),mt(S[B],1,1,()=>{S[B]=null}),Ki(),o=S[i],o?o.p(A,P):(o=S[i]=w[i](A),o.c()),rt(o,1),o.m(u.parentNode,u))},i(A){h||(rt(o),h=!0)},o(A){mt(o),h=!1},d(A){A&&(Fe(e),Fe(n),Fe(u)),S[i].d(A),c=!1,b()}}}const xC=640,$Z=500,L9=320,z9=250,B9=t=>t.id!=="ibtracs";function eG(t,e,n){let i,o,u="hover";const h=[{name:"IBTrACS",id:"ibtracs",color:"0      0%     100%  ",symbol:"line",description:"IBTrACS"},{name:"RAFT baseline",id:"baseline",color:"280    30.51% 76.86%",symbol:"square",description:"RAFT baseline"},{name:"ssp245 Near Cold",id:"ssp245_near_cold",color:"200.66 52.14% 77.06%",symbol:"circle",description:"RAFT ssp245 Near Cold"},{name:"ssp245 Far Cold",id:"ssp245_far_cold",color:"91.76  57.05% 70.78%",symbol:"circle",description:"RAFT ssp245 Far Cold"},{name:"ssp245 Near Hot",id:"ssp245_near_hot",color:"204.16 70.62% 41.37%",symbol:"circle",description:"RAFT ssp245 Near Hot"},{name:"ssp245 Far Hot",id:"ssp245_far_hot",color:"116.38 56.86% 40%   ",symbol:"circle",description:"RAFT ssp245 Far Hot"},{name:"ssp585 Near Cold",id:"ssp585_near_cold",color:"0.61   92.45% 79.22%",symbol:"circle",description:"RAFT ssp585 Near Cold"},{name:"ssp585 Far Cold",id:"ssp585_far_cold",color:"33.8   97.26% 71.37%",symbol:"circle",description:"RAFT ssp585 Far Cold"},{name:"ssp585 Near Hot",id:"ssp585_near_hot",color:"359.4  79.45% 49.61%",symbol:"circle",description:"RAFT ssp585 Near Hot"},{name:"ssp585 Far Hot",id:"ssp585_far_hot",color:"29.88  100%   50%   ",symbol:"circle",description:"RAFT ssp585 Far Hot"}];let c=h.slice(0,2).map(at=>at.id);const b=[{min:0,max:25,color:"#211459"},{min:25,max:35,color:"#334080"},{min:35,max:45,color:"#4f7d9e"},{min:45,max:55,color:"#5ca9a3"},{min:55,max:65,color:"#6bc28c"},{min:65,max:75,color:"#94d68c"},{min:75,max:85,color:"#c7eb8c"},{min:85,max:95,color:"#fff273"},{min:95,max:105,color:"#f2d67d"},{min:105,max:115,color:"#e6ab6e"},{min:115,max:125,color:"#d98254"},{min:125,max:135,color:"#cc5940"},{min:135,max:145,color:"#bd3d3d"},{min:145,max:155,color:"#ab2b40"},{min:155,max:1/0,color:"#8a083d"}];function w(at){var Un;return(Un=b.find(ji=>at>=ji.min&&at<ji.max))==null?void 0:Un.color}let S,M,A,P,B,U,J,Q,K,le,ee,oe=!1,Z,ne,be,me,Te=!1;function Y(){n(18,Te=!Te),setTimeout(()=>{requestAnimationFrame(()=>{o==null||o.scroll({top:o==null?void 0:o.scrollHeight,behavior:"smooth"})})},200)}function ye(at){n(27,oe=!0);const Un=`${x_}/data/${at.value}.arrow`;bC(fetch(Un)).then(ji=>ji.toArray().map(Bn=>Bn.toJSON())).then(ji=>{n(28,Z=ji),n(15,ne={type:"Feature",geometry:{type:"LineString",coordinates:Z.map(Bn=>[Bn.lon,Bn.lat])}}),n(17,me=yZ.extent(ne)),n(17,me=[me[0]-2,me[1]-2,me[2]+2,me[3]+2]),n(16,be={type:"FeatureCollection",features:Z.filter(Bn=>Bn.vmax_kts_baseline).map(Bn=>({type:"Feature",geometry:{type:"Point",coordinates:[Bn.lon,Bn.lat]},properties:{time:Bn.time,color_undefined:"white",...h.reduce((Ne,yt)=>(Ne[`vmax_kts_${yt.id}`]=Bn[`vmax_kts_${yt.id}`],Ne[`color_${yt.id}`]=w(Bn[`vmax_kts_${yt.id}`]),Ne),{})}}))})}).catch(ji=>{console.log(ji)}).finally(()=>{n(27,oe=!1)})}function qe(at=!0){n(28,Z=null),n(15,ne=null),n(16,be=null),n(18,Te=!1),at&&(o==null||o.scroll({top:o==null?void 0:o.scrollHeight,behavior:"smooth"}))}function He(){n(11,ee=void 0),qe(!1),S==null||S.firstChild.remove()}function Be(){n(0,c=h.map(at=>at.id))}function lt(){n(0,c=h.slice(0,2).map(at=>at.id))}function Ge(at){at.key==="`"&&n(14,u=u==="click"?"hover":"click")}const ot=[[]];function je(at){Yi.call(this,t,at)}function Ve(at){Yi.call(this,t,at)}function $e(at){Yi.call(this,t,at)}function st(at){Yi.call(this,t,at)}function ct(at){Yi.call(this,t,at)}function Pt(at){Yi.call(this,t,at)}function Ut(at){Yi.call(this,t,at)}function Lt(at){Yi.call(this,t,at)}function gt(at){Yi.call(this,t,at)}function Bt(at){ee=at,n(11,ee)}function tt(){c=gk(ot[0],this.__value,this.checked),n(0,c)}function Le(at){Fr[at?"unshift":"push"](()=>{S=at,n(1,S)})}const ut=at=>c.includes(at.id),Re=at=>c.includes(at.id)&&at.id!=="ibtracs",Ke=at=>at.id===c[c.length-1],Ee=at=>c.includes(at.id)&&at.id!=="ibtracs",wt=at=>at.id===c[c.length-1];function De(at){Fr[at?"unshift":"push"](()=>{M=at,n(2,M)})}function wn(at){Fr[at?"unshift":"push"](()=>{A=at,n(3,A)})}function Wn(at){Fr[at?"unshift":"push"](()=>{P=at,n(4,P)})}function on(at){Fr[at?"unshift":"push"](()=>{B=at,n(5,B)})}function An(at){Fr[at?"unshift":"push"](()=>{Q=at,n(8,Q)})}function yr(at){Fr[at?"unshift":"push"](()=>{U=at,n(6,U)})}function br(at){Fr[at?"unshift":"push"](()=>{J=at,n(7,J)})}function Zn(at){Fr[at?"unshift":"push"](()=>{K=at,n(9,K)})}function Tn(at){Fr[at?"unshift":"push"](()=>{le=at,n(10,le)})}function pi(at){Fr[at?"unshift":"push"](()=>{o=at,n(13,o)})}const vr=()=>{n(11,ee=R1.find(at=>at.id==2115))},Jn=()=>{n(11,ee=R1.find(at=>at.id==2011))};function dt(at){ee=at,n(11,ee)}return t.$$.update=()=>{var at;if(t.$$.dirty[0]&402655232&&ee&&!Z&&!oe&&ye(ee),t.$$.dirty[0]&1&&n(12,i=h.filter(Un=>c.includes(Un.id))),t.$$.dirty[0]&268443646&&ee&&Z&&i){const Un=i.filter(Ne=>Ne.id!=="ibtracs").length<=1;(at=S==null?void 0:S.firstChild)==null||at.remove(),S==null||S.append(h_({width:xC/1.25,height:$Z/1.25,x:{type:"utc",label:"Time (UTC)"},y:{grid:!0,label:"Intensity vmax (knots)",domain:[0,185]},marks:[Uq(Z.reduce((Ne,yt)=>{if(Ne.length===0)return yt.over_land&&(Ne=[{x1:yt.time}]),Ne;if(Ne[Ne.length-1].x2)return yt.over_land&&Ne.push({x1:yt.time}),Ne;if(yt.over_land){if(yt===Z[Z.length-1])return Ne[Ne.length-1].x2=yt.time,Ne}else return Ne[Ne.length-1].x2=yt.time,Ne;return Ne},[]),{x1:"x1",x2:"x2",y1:0,y2:185,fill:"white",fillOpacity:.1}),i.find(Ne=>Ne.id=="ibtracs")&&fb(Z.filter(Ne=>Ne.vmax_kts_ibtracs!=null),{x:"time",y:"vmax_kts_ibtracs",strokeWidth:4,curve:"catmull-rom",stroke:`hsl(${h[0].color})`}),RT(Z.filter(Ne=>Ne.vmax_kts_baseline!=null),AT({x:"time",stroke:"red",channels:{Latitude:"lat",Longitude:"lon",...i.reduce((Ne,yt)=>({...Ne,[yt.name]:`vmax_kts_${yt.id}`}),{})},tip:{fill:"black",pointerSize:0,frameAnchor:"top",fontSize:12,format:{x:!0,y:!1,stroke:!1,fill:!1,Latitude:!0,Longitude:!0,...i.reduce((Ne,yt)=>({...Ne,[yt.name]:Zt=>Zt.toFixed(0)}),{})}}})),...i.filter(Ne=>Ne.id!=="ibtracs").map(Ne=>db(Z.filter(yt=>yt[`vmax_kts_${Ne.id}`]),{x:"time",y:`vmax_kts_${Ne.id}`,symbol:Ne.symbol,r:7,strokeWidth:2,fillOpacity:.8,stroke:Un?yt=>w(yt.vmax_kts_baseline):`hsl(${Ne.color})`,fill:Un?yt=>w(yt.vmax_kts_baseline):`hsl(${Ne.color})`})),...[{color:"#bd3d3d",knots:137},{color:"#d98254",knots:113},{color:"#f2d67d",knots:96},{color:"#c7eb8c",knots:83},{color:"#6bc28c",knots:64},{color:"#4f7d9e",knots:34},{color:"#ffffff",knots:0}].map(Ne=>[u_([Ne.knots],{stroke:Ne.color,strokeOpacity:Ne.knots===0?1:.667,strokeWidth:Ne.knots===0?1:1.5})]),o1({grid:!0,label:"Intensity vmax (knots)",domain:[0,185]}),o1({label:"",anchor:"right",labelAnchor:"center",labelArrow:!1,labelOffset:0,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,ticks:[0,34,64,83,96,113,137],tickSize:0,tickPadding:0,dx:-28,dy:-6,lineAnchor:"bottom",tickFormat:(Ne,yt,Zt)=>["    TD","    TS","Cat 1","Cat 2","Cat 3","Cat 4","Cat 5"][yt]})]}));const ji=[{element:M,variable:"VMPI_t0",title:"VMPI",domain:[0,200]},{element:A,variable:"U200_t0",title:"U200",domain:[-500,1100]},{element:P,variable:"SHRD_t0",title:"SHRD",domain:[0,1e3]},{element:B,variable:"DELV_6",title:"DELV",domain:[-50,20]},{element:Q,variable:"RHLO_t0",title:"RHLO",domain:[20,100]}],Bn=[{element:U,variable:"LP500_t0_baseline",title:"LP500",domain:[0,1]},{element:J,variable:"PSLV_v3_baseline",title:"PSLV",domain:[0,450]},{element:K,variable:"lat",title:"latitude",domain:[0,55]},{element:le,variable:"lon",title:"longitude",domain:[-115,0]}];ji.forEach(Ne=>{var yt,Zt,ti;(Zt=(yt=Ne.element)==null?void 0:yt.firstChild)==null||Zt.remove(),(ti=Ne.element)==null||ti.append(h_({width:L9,height:z9,x:{type:"utc",label:"",labelArrow:"none"},y:{grid:!0,label:"",labelArrow:"none",domain:Ne.domain},marks:[...i.filter(Gn=>Gn.id!=="ibtracs").flatMap(Gn=>[fb(Z.filter(Qt=>Qt[`${Ne.variable}_${Gn.id}`]),{x:"time",y:`${Ne.variable}_${Gn.id}`,strokeWidth:1,curve:"catmull-rom",stroke:`hsl(${Gn.color})`}),db(Z.filter(Qt=>Qt[`${Ne.variable}_${Gn.id}`]!=null),{x:"time",y:`${Ne.variable}_${Gn.id}`,symbol:Gn.symbol,r:2,fill:`hsl(${Gn.color})`})]),u_([0])]}))}),Bn.forEach(Ne=>{var yt,Zt,ti;(Zt=(yt=Ne.element)==null?void 0:yt.firstChild)==null||Zt.remove(),(ti=Ne.element)==null||ti.append(h_({width:L9,height:z9,x:{type:"utc",label:"",labelArrow:"none"},y:{grid:!0,label:"",labelArrow:"none",domain:Ne.domain},marks:[fb(Z.filter(Gn=>Gn[`${Ne.variable}`]!=null),{x:"time",y:`${Ne.variable}`,strokeWidth:2,curve:"catmull-rom",stroke:"white"}),db(Z.filter(Gn=>Gn.vmax_kts_baseline!=null&&Gn[`${Ne.variable}`]!=null),{x:"time",y:`${Ne.variable}`,r:2,stroke:"white"}),u_([0])]}))})}},[c,S,M,A,P,B,U,J,Q,K,le,ee,i,o,u,ne,be,me,Te,h,b,Y,qe,He,Be,lt,Ge,oe,Z,je,Ve,$e,st,ct,Pt,Ut,Lt,gt,Bt,tt,ot,Le,ut,Re,Ke,Ee,wt,De,wn,Wn,on,An,yr,br,Zn,Tn,pi,vr,Jn,dt]}class sG extends jr{constructor(e){super(),qr(this,e,eG,QZ,gr,{},null,[-1,-1,-1])}}export{sG as component};
